ggplot()+
geom_ribbon(aes(x = sqrt(area), y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area), y = fit,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
total %>%
ggplot(aes(x = area, y = loss, group = true, color =true_fct))+
geom_line()+
theme_Bede_Map()
if(file.exists("Data/Resampled_saved_data_total.csv")){
total <- read.csv( "Data/Resampled_saved_data_total.csv") %>%
mutate(true_fct = as.factor(true))
}else{
for(i in 1:nrow(df)){
print(i)
img <- rast(c(df$validation[i],df$Pred[i]))
names(img) <- c("true","pred")
df_img <- img %>%
as.data.frame() %>%
dplyr::filter(!true == 0,
!pred == 0) %>%
dplyr::mutate(res = df$res[i],
site = df$site[i])
if(i == 1){
df_compare <- df_img
}else{
df_compare <- rbind(df_compare,df_img)
}
}
validation = df_compare %>%
mutate(same = case_when(pred == true ~ T,
T ~ F))
total <- validation %>%
dtplyr::lazy_dt() %>%
group_by(res,true) %>%
dplyr::summarise(agreed = sum(same, na.rm = T),
n_obs = n()) %>%
# ungroup() %>%
mutate(prop = agreed/n_obs,
loss = 1-prop) %>%
as_tibble() %>%
mutate(true_fct = as.factor(true),
area = (res/100)*(res/100))
write.csv(total, "Data/Resampled_saved_data_total.csv", row.names = F)
}
total %>%
ggplot(aes(x = area, y = loss, group = true, color =true_fct))+
geom_line()+
theme_Bede_Map()
total
total %>%
mutate(loss = 1-prop) %>%
ggplot(aes(x = area, y = loss, group = true, color =true_fct))+
geom_line()+
theme_Bede_Map()
glm_res_true <- glm(loss ~ area*true_fct , data = total)
total <-  %>%
total <-  total %>%
mutate(loss = 1-prop)
total %>%
ggplot(aes(x = area, y = loss, group = true, color =true_fct))+
geom_line()+
theme_Bede_Map()
glm_res_true <- glm(loss ~ area*true_fct , data = total)
a <- total %>%
group_by(res, true) %>%
reframe(mean = mean(loss))
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res_true)
NewData<-expand_grid(area=unique(total$area),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
true_fct=(true_fct))
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
a <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area), y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area), y = fit,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
NewData
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
true_fct=(true_fct)) %>%
group_by(true_fct) %>%
mutate(fitted = ((fit-min(fit))/(max(fit)-min(fit)))*(max(fit)/100))
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
a <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area), y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area), y = fit,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
# geom_ribbon(aes(x = sqrt(area)/100, y = fitted, ymax = fit+se, ymin = fit-se,
#                 color = true_fct, group = true_fct, fill = true_fct
#                 ), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
true_fct=(true_fct)) %>%
group_by(true_fct) %>%
mutate(fitted = ((fit-min(fit))/(max(fit)-min(fit)))*(max(fit)/100),
fitted_se = ((se-min(se))/(max(se)-min(se)))*(max(se)/100))
NewData<-expand_grid(area=unique(total$area),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
true_fct=(true_fct)) %>%
group_by(true_fct) %>%
mutate(fitted = ((fit-min(fit))/(max(fit)-min(fit)))*(max(fit)/100),
fitted_se = ((se-min(se))/(max(se)-min(se)))*(max(se)/100))
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted, ymax = fitted+fitted_se, ymin = fitted-fitted_se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
ggsave("Figures/High_res/resolution_plot.png", plot, bg = "white", height = 803*3, width = 1184*3, units = "px")
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted*100, ymax = (fitted+fitted_se)*100, ymin = (fitted-fitted_se)*100,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted*100,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
ggsave("Figures/High_res/resolution_plot.png", plot, bg = "white", height = 803*3, width = 1184*3, units = "px")
View(NewData)
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
true_fct=(true_fct),
res = sqrt(area)/100) %>%
group_by(true_fct) %>%
mutate(fitted = ((fit-min(fit))/(max(fit)-min(fit)))*(max(fit)/100),
fitted_se = ((se-min(se))/(max(se)-min(se)))*(max(se)/100))
NewData<-expand_grid(area=unique(total$area),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
true_fct=(true_fct),
res = sqrt(area)/100) %>%
group_by(true_fct) %>%
mutate(fitted = ((fit-min(fit))/(max(fit)-min(fit)))*(max(fit)/100),
fitted_se = ((se-min(se))/(max(se)-min(se)))*(max(se)/100))
NewData
NewData %>%
filter(res == 10)
NewData %>%
filter(res == 30)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted*100, ymax = (fitted+fitted_se)*100, ymin = (fitted-fitted_se)*100,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted*100,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)+
xlim(0,10)
# scale_x_log10()
)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted*100, ymax = (fitted+fitted_se)*100, ymin = (fitted-fitted_se)*100,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted*100,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)+
xlim(0,10)+
ylim(0,15)
# scale_x_log10()
)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted*100, ymax = (fitted+fitted_se)*100, ymin = (fitted-fitted_se)*100,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted*100,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)+
xlim(0,1)+
ylim(0,0.1)
# scale_x_log10()
)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted*100, ymax = (fitted+fitted_se)*100, ymin = (fitted-fitted_se)*100,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted*100,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)+
xlim(0,1)+
ylim(0,0.12)
# scale_x_log10()
)
(plot <- NewData %>%
dplyr::filter(true_fct != 1,
true_fct != 6,
true_fct != 7,
true_fct != 8) %>%
ggplot()+
geom_ribbon(aes(x = sqrt(area)/100, y = fitted*100, ymax = (fitted+fitted_se)*100, ymin = (fitted-fitted_se)*100,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = sqrt(area)/100, y = fitted*100,
color = true_fct, group = true_fct
))+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Predicted area loss")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm")
)
# scale_x_log10()
)
NewData %>%
filter(res == 1)
NewData %>%
filter(res == 10)
NewData %>%
filter(res == 30)
