), alpha = 0.2)+
geom_line(aes(x = area, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))+
scale_x_log10()
)
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = area, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = area, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
res = sqrt(area)/100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = area, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = area, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))+
# scale_x_log10()
)
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = area, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = area, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
res = sqrt(area)/100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = area, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = area, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
res = sqrt(area)/100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = area, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = area, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = res, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = res, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
# glm_res_true <- glm(prop ~ area * true_fct , data = total, familly = mgcv::betar(link="logit"))
glm_res_true <- mgcv::gam(prop ~ res * true_fct , data = total, familly = mgcv::betar(link="logit"))
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res)
NewData<-expand_grid(area=unique(total$area),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
res = sqrt(area)/100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res)
NewData<-expand_grid(res=unique(total$res),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100,
res = sqrt(area)/100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
NewData<-expand_grid(res=unique(total$res),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = res, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = res, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
total
validation
total <- validation %>%
lazy_dt() %>%
group_by(res,true,site) %>%
dplyr::summarise(agreed = sum(same, na.rm = T),
n_obs = n()) %>%
# ungroup() %>%
mutate(prop = agreed/n_obs) %>%
as_tibble() %>%
dplyr::filter(true != 1,
true != 6,
true != 7,
true != 8) %>%
mutate(true_fct = as.factor(true),
area = res*res)
total %>%
ggplot(aes(x = res, y = prop, group = true, color =true_fct))+
geom_line()+
scale_x_log10()
total %>%
ggplot(aes(x = res, y = prop, group = interaction(true, site), color =true_fct))+
geom_line()+
scale_x_log10()
# glm_res_true <- glm(prop ~ area * true_fct , data = total, familly = mgcv::betar(link="logit"))
glm_res_true <- mgcv::gam(prop ~ res * true_fct , data = total, familly = mgcv::betar(link="logit"))
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res)
NewData<-expand_grid(res=unique(total$res),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = res, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = res, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
total <- validation %>%
lazy_dt() %>%
group_by(res,true) %>%
dplyr::summarise(agreed = sum(same, na.rm = T),
n_obs = n()) %>%
# ungroup() %>%
mutate(prop = agreed/n_obs) %>%
as_tibble() %>%
dplyr::filter(true != 1,
true != 6,
true != 7,
true != 8) %>%
mutate(true_fct = as.factor(true),
area = res*res)
total %>%
ggplot(aes(x = res, y = prop, group = interaction(true, site), color =true_fct))+
geom_line()+
scale_x_log10()
total %>%
ggplot(aes(x = res, y = prop, group = true, color =true_fct))+
geom_line()+
scale_x_log10()
# glm_res_true <- glm(prop ~ area * true_fct , data = total, familly = mgcv::betar(link="logit"))
glm_res_true <- mgcv::gam(prop ~ res * true_fct , data = total, familly = mgcv::betar(link="logit"))
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res)
NewData<-expand_grid(res=unique(total$res),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = res, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = res, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
mgcv::betar(link="logit")
Utilities.Package::Model_Check(glm_res)
plot(density(total$prop))
total %>%
ggplot(aes(x = res, y = prop, group = true, color =true_fct))+
geom_line()+
scale_x_log10()
total %>%
ggplot(aes(x = res, y = prop, group = true, color =true_fct))+
geom_line()
total %>%
ggplot(aes(x = res, y = prop, group = true, color =true_fct))+
geom_line()+
theme_Bede_Map()
# glm_res_true <- glm(prop ~ area * true_fct , data = total, familly = mgcv::betar(link="logit"))
glm_res_true <- mgcv::gam(prop ~ res  , data = total, familly = mgcv::betar(link="logit"))
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res)
NewData<-expand_grid(res=unique(total$res),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = res, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = res, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
validation
total
# glm_res_true <- glm(prop ~ area * true_fct , data = total, familly = mgcv::betar(link="logit"))
glm_res_true <- mgcv::gam(prop ~ res * true_fct , data = total, familly = mgcv::betar(link="logit"))
summary(glm_res_true)
Utilities.Package::Model_Check(glm_res)
NewData<-expand_grid(res=unique(total$res),
true_fct=unique(total$true_fct))
pred <- predict(glm_res_true, NewData, se.fit = T, type = "link")
NewData <- NewData %>%
mutate(fit = pred$fit*100,
se = pred$se.fit*100)
cols_fill <- c("1" = "#DAA520",
"2" = "#b3ff1a",
"3" = "#389318",
"4" = "#873e23",
"5" = "#b3002d",
"6" = "#70543e",
"7" = 'grey',
"8" = "#42c9bc")
(plot <- ggplot(NewData)+
geom_ribbon(aes(x = res, y = fit, ymax = fit+se, ymin = fit-se,
color = true_fct, group = true_fct, fill = true_fct
), alpha = 0.2)+
geom_line(aes(x = res, y = fit,
color = true_fct, group = true_fct
))+
# ylim(0,1)+
scale_fill_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water")) +
scale_color_manual(name = NULL,
values = cols_fill,
labels = c("Green algae", "Seagrass", "Brown algae", "Red algae", "Sediment", "Sunglint","Water"))+
theme_Bede()+
xlab("Resolution (m)") +
ylab("Agreement")+
theme(axis.title = element_text(size = 20),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
legend.text = element_text(size = 15),
legend.key.size = unit(1, "cm"))
# scale_x_log10()
)
total %>%
ggplot(aes(x = res, y = prop, group = true, color =true_fct))+
geom_line()+
theme_Bede_Map()
