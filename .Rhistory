crs = st_crs(UnitedKingdom) )
UnitedKingdom<-st_make_valid(UnitedKingdom)
UK_map_cropped <- st_crop(UnitedKingdom, bbox_UK)  %>%
st_transform("+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ")
Europe_sf<-european_union_map_cropped %>%
dplyr::bind_rows(UK_map_cropped)
Projects<-data.frame(
Name=c(
"Portugal - Aveiro Lagoon Flights\nLower-Resolution: 4\nHigher-Resolution: 1",
"France - Morbihan Gulf Flights\nLower-Resolution: 3\nHigher-Resolution: 3",
"France - Bourgneuf Bay Flights\nLower-Resolution: 4\nHigher-Resolution: 0"
) ,
Long=c(-8.745730,
-2.840592,
-2.111868) ,
Lat=c(40.617610,
47.578736,
47.024719)
)  %>%
st_as_sf(coords=c("Long","Lat") )  %>%
st_set_crs("EPSG:4326")  %>%
st_transform("+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ")
Projects_df<-Projects %>%
dplyr::mutate(lon = sf::st_coordinates(.) [,1],
lat = sf::st_coordinates(.) [,2]) %>%
sf::st_set_geometry(NULL)  %>%
separate(Name, into=c("Country","Bay") ,sep=" - ")  %>%
dplyr::mutate(Country=as.factor(Country) ,
Bay=as.factor(Bay) )
Miniworld_map <- sovereignty10 %>%
st_as_sf()
sf_use_s2(FALSE)
bbox_EU <- st_bbox(c(xmin = -30, ymin = 20,
xmax = 50, ymax = 70) ,
crs = st_crs(Miniworld_map) )
MiniEU_map<-st_crop(Miniworld_map, bbox_EU)  %>%
st_transform("+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ")
df_P1<-Projects_df %>%
mutate(ID = c(1:nrow(.))) %>%
mutate(Site = case_when(ID == 1 ~ "Aveiro Lagoon",
ID == 2 ~ "Morbihan Gulf",
ID == 3 ~ "Bourgneuf Bay",
TRUE ~ "NA"),
ID = case_when(ID == 1 ~ "Portugal",
ID == 2 ~ "France",
TRUE ~ "France")) %>%
dplyr::select(c(lon,lat,ID,Site))
scaleFUN <- function(x) paste0(sprintf("%.2f", x),"Â°N")
(p1  <-
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_Bede_Map()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)+
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title = element_blank(),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20) )
)
(p1  <-
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)+
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title = element_blank(),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20) )
)
(p1  <-
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_bw()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)+
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title = element_blank(),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20) )
)
(p1  <-
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_bw()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
# theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), "cm"),
#       axis.title = element_blank(),
#       axis.text.x = element_text(size = 20),
#       axis.text.y = element_text(size = 20) )
)
(p1  <-
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
# theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), "cm"),
#       axis.title = element_blank(),
#       axis.text.x = element_text(size = 20),
#       axis.text.y = element_text(size = 20) )
)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(5, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
# theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), "cm"),
#       axis.title = element_blank(),
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(4, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(5, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
# theme(plot.margin = unit(c(0.1,0.1,0.1,
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 5,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(20, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(20, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P1,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 10,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
df_P2<-Projects_df %>%
mutate(ID = c(1:nrow(.))) %>%
mutate(Site = case_when(ID == 1 ~ "Aveiro Lagoon",
ID == 2 ~ "Morbihan Gulf",
ID == 3 ~ "Bourgneuf Bay",
TRUE ~ "NA"),
ID = case_when(ID == 1 ~ "Portugal",
ID == 2 ~ "France",
TRUE ~ "France")) %>%
dplyr::select(c(lon,lat,ID,Site))
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P2,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
label.width = 10,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P2,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
label.width = 20,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
p2  <-
ggplot(MiniEU_map) +
geom_sf(linewidth=0.5,alpha=0.93,
fill="#CFCFCF",colour="grey30")+
ggforce::geom_mark_ellipse(data=df_P2,
aes(x=lon,
y=lat,
label = ID,
description=Site) ,
linewidth=0.3,
label.width = 20,
fill="goldenrod",
show.legend=F,
label.hjust = 0.5,
con.size = 2,
con.colour = "goldenrod4",
label.fontsize = c(25,20),
alpha=0.8,
expand = unit(2, "mm") ,
radius = unit(2, "mm") ,
label.buffer = unit(10, "mm") ,
label.fill = "grey90")+
coord_sf(xlim=c(2600000,4100000) ,
ylim=c(1600000,3100000))+
theme_void()+
labs(x="Longitude",
y="Latitude")+
scale_y_continuous(labels=scaleFUN)
ggsave("Figures/High_res/Figure1/Graphical_Abstract_Map.png",p2,width= 10, height=10)
