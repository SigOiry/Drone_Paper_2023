<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>Discriminating Seagrasses From Green Macroalgae in
European Intertidal areas using high resolution multispectral drone
imagery.</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0001-7161-5246</contrib-id>
<name>
<surname>Oiry</surname>
<given-names>Simon</given-names>
</name>
<string-name>Simon Oiry</string-name>

<email>oirysimon@gmail.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">Writing</role>
<role>Data acquisition</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Davies</surname>
<given-names>Bede Ffinian Rowe</given-names>
</name>
<string-name>Bede Ffinian Rowe Davies</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gernez</surname>
<given-names>Pierre</given-names>
</name>
<string-name>Pierre Gernez</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sousa</surname>
<given-names>Ana I.</given-names>
</name>
<string-name>Ana I. Sousa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rosa</surname>
<given-names>Philippe</given-names>
</name>
<string-name>Philippe Rosa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zoffoli</surname>
<given-names>Maria Laura</given-names>
</name>
<string-name>Maria Laura Zoffoli</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-3">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brunier</surname>
<given-names>Guillaume</given-names>
</name>
<string-name>Guillaume Brunier</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-4">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Barillé</surname>
<given-names>Laurent</given-names>
</name>
<string-name>Laurent Barillé</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Nantes University</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Aveiro University</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>CNR ISMAR</institution>
</institution-wrap>







</aff>
<aff id="aff-4">
<institution-wrap>
<institution>JeSaisPas</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">oirysimon@gmail.com</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-02-27">
<year>2024</year>
<month>2</month>
<day>27</day>
</pub-date>







<history></history>


<abstract>
<p>Coastal areas host seagrass meadows, which offer crucial ecosystem
services including erosion control and carbon sequestration. However,
these areas are increasingly impacted by human activities, leading to
seagrass decline and habitat fragmentation. In situ surveys,
traditionally performed to monitor these ecosystems face limitations on
temporal and spatial coverage, particularly in intertidal zones,
prompting the use of satellite data within monitoring programs. Yet,
satellite remote sensing struggles with spatial and spectral resolution,
making it difficult to discriminate seagrass from other macrophytes in
highly heterogenous meadows. To address these challenges, drone images
acquired with multi-spectral sensors offer a promising solution. This
study focuses on using drones acquisitions for mapping intertidal
macrophytes, effectively discriminating between seagrass and green
macroalgae. Ten drone flights were conducted at two different altitudes
(12m and 120m) across diverse European habitats in France and Portugal.
Low altitude flights were used to train a Deep Learning classifier based
on Neural Networks to discrimintate among 5 intertidal vegetation
classes. Drone mapping demonstrated an overall accuracy of 94% across
all the sites and images, covering a total area of 467 000 m². The model
exhibited an accuracy of 96.4% in identifying seagrass.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Drone</kwd>
<kwd>Remote Sensing</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1. Introduction</title>
  <p>Coastal areas are vital hotshots for marine biodiversity, with
  intertidal seagrass meadows playing a crucial role at the interface
  between land and ocean
  (<xref alt="Unsworth et al. 2022" rid="ref-unsworth2022" ref-type="bibr">Unsworth
  et al. 2022</xref>). These meadows offer a myriad of ecosystem
  services to humanity, including limitation of coastline erosion,
  reducing the risk of eutrophication, carbon sequestration, and oxygen
  production. They serve as vital habitats for a diverse array of marine
  and terrestrial species, providing living, breeding, and feeding
  grounds
  (<xref alt="Gardner and Finlayson 2018" rid="ref-gardner2018" ref-type="bibr">Gardner
  and Finlayson 2018</xref> ;
  <xref alt="Zoffoli et al. 2022" rid="ref-Zoffoli2022" ref-type="bibr">Zoffoli
  et al. 2022</xref> ;
  <xref alt="Jankowska et al. 2019" rid="ref-jankowska2019" ref-type="bibr">Jankowska
  et al. 2019</xref>). Due to their proximity to human activities,
  seagrass meadows are directly exposed to and impacted by anthropogenic
  pressures. Global regression and fragmentation are currently observed
  due to diseases, disasters, coastal urbanization, sea reclamation, as
  well as fishing activities, dredging, sea level rise, coastal erosion,
  competition with alien species, and reduction in water quality
  (<xref alt="Nguyen et al. 2021" rid="ref-nguyen2021" ref-type="bibr">Nguyen
  et al. 2021</xref> ;
  <xref alt="Soissons et al. 2018" rid="ref-soissons2018" ref-type="bibr">Soissons
  et al. 2018</xref> ;
  <xref alt="Orth et al. 2006" rid="ref-orth2006" ref-type="bibr">Orth
  et al. 2006</xref> ;
  <xref alt="Lin et al. 2018" rid="ref-lin2018" ref-type="bibr">Lin et
  al. 2018</xref> ;
  <xref alt="Duffy et al. 2019" rid="ref-duffy2019" ref-type="bibr">Duffy
  et al. 2019</xref>). While improvements in water quality have been
  recently reported in European sites, allowing an overall recovery of
  seagrass ecosystems at the local scale, many other coastal waters
  worldwide are still subjected to strong eutrophication processes
  (<xref alt="Los Santos et al. 2019" rid="ref-deSantos2019" ref-type="bibr">Los
  Santos et al. 2019</xref> ;
  <xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021" ref-type="bibr">Zoffoli
  et al. 2021</xref>). Coastal eutrophication has been associated to
  anomalous accumulation of green macroalgae, the so-called green tides.
  Green tides produce shade and suffication over seagrass individuals,
  thus threatening the health of seagrass ecosystems
  (<xref alt="Duarte2002?" rid="ref-Duarte2002" ref-type="bibr"><bold>Duarte2002?</bold></xref>
  ; <xref alt="Wang et al. 2022" rid="ref-wang2022" ref-type="bibr">Wang
  et al. 2022</xref>).</p>
  <p>The importance of seagrass meadows and the variety of ecosystem
  services they provide have led to the enhancement of global and
  regional monitoring programs for systematically surveying different
  Essential Oceanic Variable
  (<xref alt="Miloslavich et al. 2018" rid="ref-Miloslavich2018" ref-type="bibr">Miloslavich
  et al. 2018</xref>) as seagrass coverage and composition; as well as
  Essential Biodiversity Variable
  (<xref alt="Pereira et al. 2013" rid="ref-Pereira2013" ref-type="bibr">Pereira
  et al. 2013</xref>) such as seagrass taxonomic diversity; species
  distribution, population abundance, and phenology. Monitoring programs
  also prioritize the identification of threats to these ecosystems,
  particularly during early stages, to facilitate effective mitigation
  actions. Traditionally, these ecological parameters have been
  quantified through in situ measurements, although this approach faces
  several constraints over intertidal zones. Intertidal meadows are only
  partially exposed during low tide and can be situated in
  difficult-to-reach mudflats, potentially leading to inaccurate and
  limited estimations with conventional sampling techniques
  (<xref alt="Nijland, Reshitnyk, and Rubidge 2019" rid="ref-nijland2019" ref-type="bibr">Nijland,
  Reshitnyk, and Rubidge 2019</xref>). However, satellite data have been
  proven effective in complenmenting in situ surveys, allowing for the
  rapid and consitent retrieval of EOV’s over extensive seagrass
  meadows.
  (<xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021" ref-type="bibr">Zoffoli
  et al. 2021</xref> ;
  <xref alt="Xu et al. 2021" rid="ref-xu2021" ref-type="bibr">Xu et al.
  2021</xref> ;
  <xref alt="Traganos and Reinartz 2018" rid="ref-Traganos2018" ref-type="bibr">Traganos
  and Reinartz 2018</xref> ;
  <xref alt="Coffer et al. 2023" rid="ref-coffer2023" ref-type="bibr">Coffer
  et al. 2023</xref>)</p>
  <p>Satellite remote sensing offers the advantage of acquiring
  large-scale data in real-time but presents its inherent challenges.
  Free access satellite data (e.g., Sentinel-2 and Landsat8/9) provide
  relatively low spatial resolution data (10 - 30 m) across a limited
  number of spectral bands. These characteristics can be a limitation to
  accurately discriminating seagrass from others co-existing macrophytes
  over the meadow. Chlorophyceae (Green Algae) and marine Magnoliopsida
  (Seagrass) share the same pigment composition
  (<xref alt="Ralph et al. 2002" rid="ref-ralph2002" ref-type="bibr">Ralph
  et al. 2002</xref> ;
  <xref alt="Douay et al. 2022" rid="ref-Douay2022" ref-type="bibr">Douay
  et al. 2022</xref>). As a result, their respective spectral signatures
  can be considered similar by a non-expert observer
  (<xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023" ref-type="bibr">Davies,
  Gernez, et al. 2023</xref> ;
  <xref alt="Bannari, Ali, and Abahussain 2022" rid="ref-bannari2022" ref-type="bibr">Bannari,
  Ali, and Abahussain 2022</xref>). Recently, using a hyperspectral
  library, Davies, Gernez, et al.
  (<xref alt="2023" rid="ref-Davies2023" ref-type="bibr">2023</xref>)
  demonstrated that the spectral resolution of Sentinel-2, might be
  enough for the discrimination between Magnoliopsida and Chlorophyceae.
  However, green tide events occur at small spatial scales that are not
  observable using satellite imagery
  (<xref alt="Tuya et al. 2013" rid="ref-tuya2013" ref-type="bibr">Tuya
  et al. 2013</xref>), especially during the initial stage of the
  event.</p>
  <p>Remote sensing drone acquisitions are presented as a tool that can
  potentially fill gaps left by satellite and in situ data. Drone can
  cover large expanses while recording imagery at significantly higher
  spatial resolutions than satellite (pixel size from cm to mm) and
  still capturing data at multi-spectral resolution
  (<xref alt="Fairley et al. 2022" rid="ref-fairley2022drone" ref-type="bibr">Fairley
  et al. 2022</xref> ;
  <xref alt="Oh, Kim, and Lee 2017" rid="ref-oh2017use" ref-type="bibr">Oh,
  Kim, and Lee 2017</xref>). The versatility of drones allows for their
  application across a diverse thematic range , from coastal zone
  management
  (<xref alt="Adade et al. 2021" rid="ref-adade2021" ref-type="bibr">Adade
  et al. 2021</xref> ;
  <xref alt="Casella et al. 2020" rid="ref-casella2020" ref-type="bibr">Casella
  et al. 2020</xref> ;
  <xref alt="Angnuureng et al. 2022" rid="ref-angnuureng2022" ref-type="bibr">Angnuureng
  et al. 2022</xref>) to mapping the spatial distribution of species
  (<xref alt="Joyce, Fickas, and Kalamandeen 2023" rid="ref-joyce2023" ref-type="bibr">Joyce,
  Fickas, and Kalamandeen 2023</xref> ;
  <xref alt="Tallam et al. 2023" rid="ref-tallam2023" ref-type="bibr">Tallam
  et al. 2023</xref> ;
  <xref alt="Roca et al. 2022" rid="ref-Roca2022" ref-type="bibr">Roca
  et al. 2022</xref> ;
  <xref alt="Román et al. 2021" rid="ref-Roman2021" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic" ref-type="bibr">Brunier
  et al. 2022</xref>). However, when applied to coastal habitat mapping,
  many studies showcase their findings with study case limited to a
  single flight, restricting the generalizability of their application
  to other sites
  (<xref alt="Román et al. 2021" rid="ref-Roman2021" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Collin et al. 2019" rid="ref-collin2019improving" ref-type="bibr">Collin
  et al. 2019</xref> ;
  <xref alt="Rossiter et al. 2020" rid="ref-rossiter2020uav" ref-type="bibr">Rossiter
  et al. 2020</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic" ref-type="bibr">Brunier
  et al. 2022</xref>). This study aimed to analyze the potential of a
  drone equipped with a multispectral sensor for maping intertidal
  macrophytes, with a particular focus on discriminating Magnoliopsida
  and Chlorophyceae. Ten drone flights were performed over soft-bottom
  intertidal areas along two European countries (France and Portugal),
  covering a wide range of habitats, from monospecific seagrass meadows
  to meadows mixed with green or red algae. A deep learning algorithm
  was trained and validated for macrophyte discrimination, emphasizing
  applicability across diverse sites without a loss of accuracy in
  predictions.</p>
</sec>
<sec id="material-methods">
  <title>2. Material &amp; Methods</title>
  <sec id="study-sites">
    <title>2.1 Study sites</title>
    <p>Seven study sites distributed between France and Portugal were
    selected for their relatively extensive intertidal seagrass beds.
    Two sites are located in Gulf of Morbihan
    (<xref alt="Figure 1" rid="fig-map">Figure 1</xref> A), France
    (47.5791°N, 2.8018°W). This gulf covers an area of 115 km² and is
    only connect to the sea through a 900m wide channel. A total of 53
    small islands are scattered across the gulf leading to 250 km of
    shorelines. Patchy seagrass meadows can be found on a lot of these
    islands. Within the Gulf of Morbihan we have chosen two sites : One
    is located in one of these island (Arz island). The other one is
    located in the sourthern part of the Gulf (Duer). Two others sites
    are located in Bourgneuf Bay, France (46.9849°N, 2.1488°W). This bay
    is a semi-enclosed macrotidal bay, protected from waves by
    Noirmoutier Island. With up to 6m in tidal range during spring tide,
    a 6 km² seagrass meadow can uncover at low tide. The sites we
    surveyed (L’Epine and Barbatre,
    <xref alt="Figure 1" rid="fig-map">Figure 1</xref> B) are located in
    the southernmost part of the bay, along the Noirmoutier Island, and
    host a monospecific <italic>Zostera noltei</italic> seagrass bed
    with very little mixing with other macrophytes. Three sites have
    been survey in the Ria de Aveiro Lagoon in Portugal (40.6887°N,
    8.6810°W). The extent of this lagoon is about 80 km² with many
    narrow channels, large salt marshes and many mudflats that uncovers
    at low tide. It is connected to the open sea through a single
    channel, with a tidal lag between the North and the South of the
    lagoon. The southernmost site (Gafanha) is a mudflat located in an
    affluent of the lagoon whereas the two other sites are situated in
    the middle of the lagoon and are only accessible by boat
    (<xref alt="Figure 1" rid="fig-map">Figure 1</xref> C). These
    Portuguese sites were characterized by a more diverse intertidal
    area, where the seagrass meadow could intermingle with red algae
    (Rhodophyceae), brown algae (Phaeophyceae), or green algae
    (Chlorophyceae).</p>
    <fig id="fig-map">
      <caption><p>Figure 1: Sites where the different drone flights were
      made. A: Gulf of Morbihan, B: Bourngeuf Bay, C: Ria de Aveiro
      Lagoon. Light green represent terrestrial areas whereas darkgreen
      represent intertidal areas.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Fig1_Map_Drone_Sites.png" />
    </fig>
  </sec>
  <sec id="drone-data">
    <title>2.2 Drone Data</title>
    <p>At each location, a DJI Matrice 200 quadcopter drone equipped
    with a Micasense RedEdge Dual MX multispectral camera was flown to
    take 1.2 million pixel reflectance photographs in 10 spectral bands,
    from blue (444 nm) to near infrared (840 nm). An angle of 90° has
    been maintained between the sun and the drone’s route to guarantee
    uniform lighting conditions between flight lines. A side overlap of
    70% and a front overlap of 80% between each image has been set.
    Images have been calibrated in reflectance using a calibration panel
    reflective at ~50% provided by the camera’s manufaturer and a
    Downwelling Light Sensor (DLS2) that was utilized to acquire
    irradiance data during the flight. A Structure-from-Motion
    photogrammetry software (Agisoft Metashape) has been used to process
    images to obtain multispectral orthomosaics of each flight. The
    workflow for orthomosaicking has remained consistent for every
    flight. First, tying key points were detected inside of each image
    and between overlapping images in order to obtain a sparse point
    cloud. This cloud was cleaned using reprojection accuracy metric in
    order to remove noisy points. A dense point cloud has been then
    produced using a structure from motion algorithm. A surface
    interpolation of this dense point cloud has been made to obtain a
    Digital Surface Model (DSM), used to reconstruct the multispectral
    ortho-image. Across all the sites, flights were made at two
    different altitudes : 12 m or/and 120 m. Low altitude drone flights
    produce ortho-images with a very high spatial resolution (8 mm per
    pixel), making it simple to visually distinguish between the various
    types of vegetation. High altitude fights on the other hand allow to
    cover large areas and produced images with a pixel size of 80 mm
    (Table 1).</p>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table1-1.png" />
  </sec>
  <sec id="field-sampling">
    <title>2.3 Field sampling</title>
    <p>Before each flight, targets used as Ground Control Points (GCPs)
    were dispersed and georeferenced with a Trimble © Geo XH 6000
    differential GPS (dGPS). GCPs were used to correct georeferencing
    imprecision of orthomosaics with an horizontal and vertical accuracy
    of 10cm. dGPS was also used to georeference quardrats of 0.25cm²
    used to assess the presence or absence of 5 key classes of
    vegetation : Bacillariophyceae (Diatoms forming large biofilm over
    the sediment during low tide), Phaeophyceae (Brown algae),
    Magnoliopsida (Seagrass), Chlorophyceae (Green algae) and
    Rhodophyceae (Red algae)
    (<xref alt="Figure 2" rid="fig-vegetation">Figure 2</xref>). Picture
    of each quadrat were taken and uploaded on the online on the Global
    Biodiversity Information Facility (GBIF) platform
    (<xref alt="Davies, Sousa, et al. 2023" rid="ref-BedeGbif" ref-type="bibr">Davies,
    Sousa, et al. 2023</xref>). Each photograph was also processed to
    estimate the percent cover of each type of vegetation. Georeferenced
    hyperspectral reflectance signatures of each vegetation class were
    also sampled using an ASD FieldSpec HandHeld 2 spectroradiomete,
    which acquires reflectance between 325 and 1075 nm, with 1 nm of
    spectral resolution. The methodological scheme followed in this
    study is presented in
    <xref alt="Figure 3" rid="fig-workflow">Figure 3</xref>.</p>
    <fig id="fig-vegetation">
      <caption><p>Figure 2: Class of vegetation used to train the CNN
      model and their standardised spectral signature</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Spectral_shapes_total.png" />
    </fig>
  </sec>
  <sec id="intertidal-vegetation-mapping">
    <title>2.4 Intertidal vegetation mapping</title>
    <fig id="fig-workflow">
      <caption><p>Figure 3: Schematic representation of the workflow.
      Diamonds represent input or output data, and rectangles represent
      Python processing algorithms. The overall workflow of this study
      is divided into two distinct parts based on the spatial resolution
      of the drone flights: high-resolution flights were utilized for
      training and prediction of the CNN model, whereas low-resolution
      flights were solely employed for prediction
      purposes.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Figure3_workflow.png" />
    </fig>
    <p>The spectral similarities of reflectance signatures between
    intertidal green macrophytes (Magnoliopsida and Chlorophyceae) make
    their discrimination challenging using simple classification
    algorithms
    (<xref alt="Figure 2" rid="fig-vegetation">Figure 2</xref> F). To
    overcome this challenge, a deep learning classification method was
    developed, trained, validated, and applied to each drone flight
    (<xref alt="Figure 3" rid="fig-workflow">Figure 3</xref>).</p>
    <sec id="neural-network-model-building">
      <title>2.4.1 Neural Network model building</title>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table2-1.png" />
      <p>A dataset containing photo-interpreted drone reflectance pixels
      was built to train a Convolutional Neural Network (CNN) model with
      2 hidden layers. The training pixels were categorized into 7
      different classes, representing the various habitats encountered
      at the different study sites: Sediment, Water, Chlorophyceae,
      Magnoliopsida, Bacillariophyceae, Phaeophyceae and Rhodophyceae.
      Only low-altitude flights (Table 1) were used for training
      purposes because of their 8 mm spatial resolution allowing to
      avoid spectral sub-pixel mixing and to accurately visually
      differentiate various vegetation classes. More than 418,000 pixels
      at 8 mm resolution from the 3 training flights have been used to
      train the model (Table 2). Twenty one variables were used by the
      model as predictors: 10 raw spectral bands of the Micasense
      RedEdge Dual MX multispectral camera (ranging from 444 nm to 840
      nm), the same 10 spectral bands standardized using a min/max
      transformation
      (<xref alt="Equation 1" rid="eq-std">Equation 1</xref> ;
      (<xref alt="cao2017?" rid="ref-cao2017" ref-type="bibr"><bold>cao2017?</bold></xref>))
      and the NDVI
      (<xref alt="Equation 2" rid="eq-ndvi">Equation 2</xref>).
      Standardisation of spectral bands is used to eliminate the scaling
      differences between spectra and to limit the effect of biomass on
      the shape of the spectra
      (<xref alt="Douay et al. 2022" rid="ref-Douay2022" ref-type="bibr">Douay
      et al. 2022</xref> ;
      <xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023" ref-type="bibr">Davies,
      Gernez, et al. 2023</xref>).</p>
      <p><styled-content id="eq-std"><disp-formula><alternatives>
      <tex-math><![CDATA[
      R_{i}^{*}(\lambda) = \frac{R_{i}(\lambda) - min(R_{i})}{max(R_{i})- min(R_{i})}
       \qquad(1)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R_{i}(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at the wavelength
      <inline-formula><alternatives>
      <tex-math><![CDATA[(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      of each individual spectra <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives>
      <tex-math><![CDATA[min(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives>
      <tex-math><![CDATA[max(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      are the minimum and maximum value of the spectra
      <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p><styled-content id="eq-ndvi"><disp-formula><alternatives>
      <tex-math><![CDATA[
      NDVI = \frac{R(840nm)-R(668nm)}{R(840nm)+R(668nm)}
       \qquad(2)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R(840nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 840 nm and <inline-formula><alternatives>
      <tex-math><![CDATA[R(668nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 668 nm.</p>
    </sec>
    <sec id="validation">
      <title>2.4.2 Validation</title>
      <p>The CNN model was applied to all the 9 flights at both 12 and
      120 m of altitude. In situ information on georeferenced class type
      and percent cover collected during each flight has been used to
      assess the CNN accuracy. These images were used to construct a
      validation dataset indicating the presence or absence of each
      class. Additionally to the quadrat-based validation dataset,
      polygons of each class were photo interpreted in order to increase
      the number of pixels of the validation dataset. A confusion
      matrix, along with precision metrics such as the global accuracy,
      the sensitivity, the specificity, and the Kappa coefficient, was
      generated for each of the study sites. Finally each validation
      matrix has been merge to create a unique matrix of the model. A
      total of 536,000 pixels has been used to globally validate the CNN
      model.</p>
    </sec>
  </sec>
</sec>
<sec id="results">
  <title>3. Results</title>
  <sec id="classification">
    <title>3.1 Classification</title>
    <p>A total of 9 prediction maps corresponding to the 9 drone flights
    were obtained. Each prediction map is associated with a probability
    map, indicating the probability of the selected class for every
    pixel. The low-altitude flight conducted in Gafanaha, Portugal,
    represents the site with the highest complexity
    (<xref alt="Figure 4" rid="fig-GafLow">Figure 4</xref>). Among the 5
    vegetation classes on which the CNN model was trained, 4 were
    present on this site. On this site, there is a mixture of
    Chlorophyceae and Rhodophyceae over the seagrass meadow. This is
    also where Bacillariophyceae is most abundant. Although the seagrass
    bed is solely composed of <italic>Zostera noltei</italic>, various
    colors can be observed: dark green (indicating healthy beds with
    100% coverage) and whitish/brown (indicating beds where leaves are
    dying). Regardless of the color, the meadow is predicted as
    Magnoliopsida by the CNN model.</p>
    <fig id="fig-GafLow">
      <caption><p>Figure 4: RGB orthomosaic (Left) and Prediction
      (Right) of the low altitude flight of Gafanaha, Portugal. The
      total extent of this flight is 3000m² with a resolution of 8 mm
      per pixel. Background colors means intertidal area (Light Green)
      and land area (Light Grey). The zoom covers an area equivalent to
      a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_Low_Pred.png" />
    </fig>
    <p>The high-altitude flight over Gafanha covered nearly 1 km² in
    total (<xref alt="Figure 5" rid="fig-GafHigh">Figure 5</xref>). A
    channel delineating a small island was present in the flight, but it
    has been masked in the prediction map due to glinting and
    misclassification caused by the turbid shallow water. Most of the
    intertidal area has been classified as Magnoliopsida by the model,
    even though there is discoloration of seagrass blades. Only a few
    pixels have been classified as Chlorophyceae at this scale.
    Furthermore, the area that was classified as Bacillariophyceae in
    the low-altitude flight remains mostly classified as such in the
    high-altitude flight, but some pixels of it are now classified as
    Magnoliopsida. The patches of Rhodophyceae are still well
    classified. <italic>Spartina sp.</italic> was present in the
    northern part of the flight, near the land, and has been classified
    either as Magnoliopsida or as Phaeophyceae.</p>
    <fig id="fig-GafHigh">
      <caption><p>Figure 5: RGB orthomosaic (Left) and Prediction
      (Right) of the high altitude flight of Gafanaha, Portugal. The
      total extent of this flight is about 1 km² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green), land area (Light Grey) and water (Light Blue). The red
      triangle shows the extent of the low altitude flight of Gafanha.
      The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel
      size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_High_Pred.png" />
    </fig>
    <p>The High altitude flight made in the inner lagoon of the Ria de
    Aveiro is the largest of all flights, covering almost 1.5 km²
    (<xref alt="Figure 6" rid="fig-Boat">Figure 6</xref>). On this site,
    only seagrass and red algae where seen on the field. The
    classification follows the same pattern, with a patchy Magnoliopsida
    meadow mixed on the eastern part of the flight with Rhodophyceae. As
    shown in the zoom
    (<xref alt="Figure 6" rid="fig-Boat">Figure 6</xref>), the edges of
    the meadow can be colonised by Chlorophyceae.</p>
    <fig id="fig-Boat">
      <caption><p>Figure 6: RGB orthomosaic (Top) and Prediction
      (Bottom) of the flight made in the inner part of Ria de Aveiro
      Lagoon, Portugal. The total extent of this flight is about 1.5 km²
      with a resolution of 80 mm per pixel. Background colors means
      intertidal area (Light Green), land area (Light Grey) and water
      (Light Blue). The zoom covers an area equivalent to a 10-meter
      Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Boat_Pred.png" />
    </fig>
    <p>The flight over L’Epine in Noirmoutier Island, France
    (<xref alt="Figure 7" rid="fig-Dike">Figure 7</xref>) was conducted
    near a dike crossing the northern part of the flight from west to
    east. Alongside this dike, brown algae attached to rocks and
    stranded green algae could be found. Despite the high mixture
    between Chlorophyceae and Magnoliopsida in this flight, these two
    classes are well discriminated by the classifier.</p>
    <fig id="fig-Dike">
      <caption><p>Figure 7: RGB orthomosaic (Top) and Prediction
      (Bottom) of Northern part of Noirmoutier Island, France. The total
      extent of this flight is about 28 000 m² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green) and land area (Light Grey). The zoom covers an area
      equivalent to a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Dike_Pred.png" />
    </fig>
  </sec>
  <sec id="validation-1">
    <title>3.2 Validation</title>
    <fig id="fig-Validation">
      <caption><p>Figure 8: A global confusion matrix on the left is
      derived from validation data across each flight, while a mosaic of
      confusion matrices from individual flights is presented on the
      right. The labels inside the matrices indicate the balanced
      accuracy for each class. The labels at the bottom of the matrices
      indicate the User’s accuracy for each class, and those on the
      right indicate the Producer’s Accuracy. The values adjacent to the
      names of each site represent the proportion of total pixels from
      that site contributing to the overall matrix. Grey lines within
      the mosaic indicate the absence of validation data for the class
      at that site. The table at the bottom summarizes the Sensitivity,
      Specificity, and Accuracy for each class and for the overall
      model.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Validation/ConfusionMatrixGlobal.png" />
    </fig>
    <p>A total amount of 536,000 pixels have been used to validate the
    Neural Network classifier. The site with the least amount of
    validation data is Kerdrean with a total of 5557 pixels whereas
    Marinha Lanzarote is the site with the most amount of validation
    data with 159713 pixels. The global accuracy of the model is 94.26%
    and a Kappa coefficient of 0.92
    (<xref alt="Figure 8" rid="fig-Validation">Figure 8</xref>). The
    least performing site is Gafanha High with an accuracy of 75.45%
    whereas Mataducos is the site with most accurate prediction, with a
    global accuracy of 98.05%. Overall Phaeophyceae, Magnoliopsida,
    Sediment and Rhodophyceae are well classified with a balanced
    accuracy of 1, 0.96, 0.96 and 0.91 respectively. Bacillariophyceae
    is the least performing class with an accuracy of 0.72 mainly due to
    a confusion with Magnoliopsida and Sediment.</p>
  </sec>
  <sec id="variable-importance">
    <title>3.3 Variable importance</title>
    <fig id="fig-VIP">
      <caption><p>Figure 9: Variable Importance of the Neural Network
      Classifier for each vegetation class. The bigger the slice, the
      more important is the variable to predict accuratly this class.
      The bottom right plot shows the drone standardised reflectance
      spectra of each class.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/VIP/Fig_VIP.png" />
    </fig>
    <p>The computation of the importance variable of each class indicate
    which wavelength is mandatory to accurately predict the class
    (<xref alt="Figure 9" rid="fig-VIP">Figure 9</xref>). Bands at 444
    nm, 717 nm and 842 nm of the Micasense camera are important for none
    of the vegetation classes. The band at 531 nm is the only important
    predictor for the classifier to accuratly predict chlorophyceae. In
    fact, at this wavelength, the Chlorophyceae spectra has the maximum
    reflectance value of all the classes. 531 nm and 740 nm are the most
    important predictors to predict Phaeophyceae, corresponding to the
    minimum reflectance value among all the classes. Bands at 475 and
    560 nm are the most important predictors for Bacillariophyceae and
    Rhodophyceae, respectively. 4 predictors, ranging from the Green
    (560 nm) to the RedEdge (705 nm) are important to predict accurately
    magnoliopsida.</p>
  </sec>
  <sec id="effect-of-the-flight-height-on-the-prediction">
    <title>3.4 Effect of the flight height on the prediction</title>
    <fig id="fig-upscaling">
      <caption><p>Figure 10: Kernel density plot showing the proportion
      of pixel well classified based on the percent cover of the class
      in high altitude flight pixels of Gafanha, Portugal. Each subplot
      shows all the pixels of the same classes on the hight altitude
      flight. Percent cover of classes is retrieve using the result of
      the classification of the low altitude flight of Gafanha,
      Portugal. The vertical dashed line shows the 0.85 probability of
      the model. Everything on the right of this line has a probability
      higher then 0.85 and everuthing on the left of this line has a
      probability lower.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Upscaling/density_vs_Proportion.png" />
    </fig>
    <p><xref alt="Figure 10" rid="fig-upscaling">Figure 10</xref> is
    showing the percent cover of a class required to classify correctly
    the high altitude flight. When the percent cover of the class is 100
    %, big pixels are well classified for all the classes excepted for
    Bare Sediment, where it’s well classified 80% of the time. A
    vegetative percent cover of at least 80% is need to have all the big
    pixels well classified, at the exception of Magnoliopsida that needs
    an higher percent cover (&gt;90 %) to be well classified. Concerning
    the probability of each class, a really high Percent cover is needed
    to confidently predict Bacillariophyceae. To predict Chlorophyceae
    with a confidence of 0.85, a percent cover of 93 % is needed, 90 %
    for magnoliopsida, 92 % for Rhodophyceae and 97 % for
    Bacillariophyceae.</p>
  </sec>
</sec>
<sec id="discussion">
  <title>4. Discussion</title>
  <sec id="seagrass-discrimination">
    <title>4.1 Seagrass Discrimination</title>
  </sec>
  <sec id="spatial-and-spectral-resolution-impact-on-the-prediction">
    <title>4.2 Spatial and Spectral Resolution impact on the
    prediction</title>
    <fig id="fig-Pigm">
      <caption><p>Figure 11: Photosynthetic and carotenoid pigments
      present (Green) or absent (Red) in each taxonomic class present in
      the Neural Network Classifier, along with their absorption
      wavelength measured with spectroradiometer. Chl b: chlorophyll b,
      Chl c: chlorophyll c, Fuco: fucoxanthin, Zea: zeaxanthin, Diato:
      diatoxanthin, Diadino: diadinoxanthin, Neo:
      neoxanthin.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Disc_Pigment_Table.png" />
    </fig>
    <fig id="fig-CompareRef">
      <caption><p>Figure 12: Comparison of reflectance retrieved from
      both low-altitude and high-altitude flights over a common area.
      The red dashed line represents a 1 to 1
      relationship.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Compare_reflectance.png" />
    </fig>
  </sec>
  <sec id="big-picture">
    <title>4.3 Big picture</title>
  </sec>
</sec>
<sec id="conclusion">
  <title>5. Conclusion</title>
</sec>
</body>

<back>
<ref-list>
  <title>6. Bibliography</title>
  <ref id="ref-unsworth2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Unsworth</surname><given-names>Richard KF</given-names></name>
        <name><surname>Cullen-Unsworth</surname><given-names>Leanne C</given-names></name>
        <name><surname>Jones</surname><given-names>Benjamin LH</given-names></name>
        <name><surname>Lilley</surname><given-names>Richard J</given-names></name>
      </person-group>
      <article-title>The planetary role of seagrass conservation</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>377</volume>
      <issue>6606</issue>
      <fpage>609</fpage>
      <lpage>613</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gardner2018">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Gardner</surname><given-names>Royal C</given-names></name>
        <name><surname>Finlayson</surname><given-names>C</given-names></name>
      </person-group>
      <source>Global wetland outlook: State of the world’s wetlands and their services to people</source>
      <year iso-8601-date="2018">2018</year>
      <fpage>2020</fpage>
      <lpage>5</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Dalloyau</surname><given-names>Sébastien</given-names></name>
        <name><surname>Davies</surname><given-names>Bede Ffinian Rowe</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Remote sensing in seagrass ecology: Coupled dynamics between migratory herbivorous birds and intertidal meadows observed by satellite during four decades</article-title>
      <source>Remote Sensing in Ecology and Conservation</source>
      <year iso-8601-date="2022-12">2022</year><month>12</month>
      <issn>2056-3485</issn>
      <pub-id pub-id-type="doi">10.1002/rse2.319</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-jankowska2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jankowska</surname><given-names>Emilia</given-names></name>
        <name><surname>Michel</surname><given-names>Loı̈c N</given-names></name>
        <name><surname>Lepoint</surname><given-names>Gilles</given-names></name>
        <name><surname>Włodarska-Kowalczuk</surname><given-names>Maria</given-names></name>
      </person-group>
      <article-title>Stabilizing effects of seagrass meadows on coastal water benthic food webs</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>510</volume>
      <fpage>54</fpage>
      <lpage>63</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nguyen2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nguyen</surname><given-names>Hung Manh</given-names></name>
        <name><surname>Ralph</surname><given-names>Peter J</given-names></name>
        <name><surname>Marı́n-Guirao</surname><given-names>Lázaro</given-names></name>
        <name><surname>Pernice</surname><given-names>Mathieu</given-names></name>
        <name><surname>Procaccini</surname><given-names>Gabriele</given-names></name>
      </person-group>
      <article-title>Seagrasses in an era of ocean warming: A review</article-title>
      <source>Biological Reviews</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>96</volume>
      <issue>5</issue>
      <fpage>2009</fpage>
      <lpage>2030</lpage>
    </element-citation>
  </ref>
  <ref id="ref-soissons2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Soissons</surname><given-names>Laura M</given-names></name>
        <name><surname>Haanstra</surname><given-names>Eeke P</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Asmus</surname><given-names>Ragnhild</given-names></name>
        <name><surname>Auby</surname><given-names>Isabelle</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
        <name><surname>Brun</surname><given-names>Fernando G</given-names></name>
        <name><surname>Cardoso</surname><given-names>Patricia G</given-names></name>
        <name><surname>Desroy</surname><given-names>Nicolas</given-names></name>
        <name><surname>Fournier</surname><given-names>Jerome</given-names></name>
        <etal/>
      </person-group>
      <article-title>Latitudinal patterns in european seagrass carbon reserves: Influence of seasonal fluctuations versus short-term stress and disturbance events</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>88</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-orth2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Orth</surname><given-names>Robert J</given-names></name>
        <name><surname>Carruthers</surname><given-names>Tim JB</given-names></name>
        <name><surname>Dennison</surname><given-names>William C</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Fourqurean</surname><given-names>James W</given-names></name>
        <name><surname>Heck</surname><given-names>Kenneth L</given-names></name>
        <name><surname>Hughes</surname><given-names>A Randall</given-names></name>
        <name><surname>Kendrick</surname><given-names>Gary A</given-names></name>
        <name><surname>Kenworthy</surname><given-names>W Judson</given-names></name>
        <name><surname>Olyarnik</surname><given-names>Suzanne</given-names></name>
        <etal/>
      </person-group>
      <article-title>A global crisis for seagrass ecosystems</article-title>
      <source>Bioscience</source>
      <publisher-name>American Institute of Biological Sciences</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>56</volume>
      <issue>12</issue>
      <fpage>987</fpage>
      <lpage>996</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lin2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lin</surname><given-names>Haiying</given-names></name>
        <name><surname>Sun</surname><given-names>Tao</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Yang</surname><given-names>Wei</given-names></name>
      </person-group>
      <article-title>Which genes in a typical intertidal seagrass (zostera japonica) indicate copper-, lead-, and cadmium pollution?</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>1545</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-duffy2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Duffy</surname><given-names>J Emmett</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Trinanes</surname><given-names>Joaquin</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E</given-names></name>
        <name><surname>Ambo-Rappe</surname><given-names>Rohani</given-names></name>
        <name><surname>Boström</surname><given-names>Christoffer</given-names></name>
        <name><surname>Buschmann</surname><given-names>Alejandro H</given-names></name>
        <name><surname>Byrnes</surname><given-names>Jarrett</given-names></name>
        <name><surname>Coles</surname><given-names>Robert G</given-names></name>
        <name><surname>Creed</surname><given-names>Joel</given-names></name>
        <etal/>
      </person-group>
      <article-title>Toward a coordinated global observing system for seagrasses and marine macroalgae</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>6</volume>
      <fpage>317</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deSantos2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Los Santos</surname><given-names>Carmen B de</given-names></name>
        <name><surname>Krause-Jensen</surname><given-names>Dorte</given-names></name>
        <name><surname>Alcoverro</surname><given-names>Teresa</given-names></name>
        <name><surname>Marbà</surname><given-names>Núria</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Pérez</surname><given-names>Marta</given-names></name>
        <name><surname>Romero</surname><given-names>Javier</given-names></name>
        <name><surname>Sánchez-Lizaso</surname><given-names>José L</given-names></name>
        <name><surname>Roca</surname><given-names>Guillem</given-names></name>
        <etal/>
      </person-group>
      <article-title>Recent trend reversal for declining european seagrass meadows</article-title>
      <source>Nature communications</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>10</volume>
      <issue>1</issue>
      <fpage>3356</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Peters</surname><given-names>Steef</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series</article-title>
      <source>Ecological Indicators</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>130</volume>
      <issn>1470160X</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S1470160X21006981</uri>
      <pub-id pub-id-type="doi">10.1016/j.ecolind.2021.108033</pub-id>
      <fpage>108033</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Zhongyuan</given-names></name>
        <name><surname>Fang</surname><given-names>Zhixiang</given-names></name>
        <name><surname>Liang</surname><given-names>Jianfeng</given-names></name>
        <name><surname>Song</surname><given-names>Xiao</given-names></name>
      </person-group>
      <article-title>Assessment of global habitat suitability and risk of ocean green tides</article-title>
      <source>Harmful Algae</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>119</volume>
      <fpage>102324</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Miloslavich2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Miloslavich</surname><given-names>Patricia</given-names></name>
        <name><surname>Bax</surname><given-names>Nicholas J.</given-names></name>
        <name><surname>Simmons</surname><given-names>Samantha E.</given-names></name>
        <name><surname>Klein</surname><given-names>Eduardo</given-names></name>
        <name><surname>Appeltans</surname><given-names>Ward</given-names></name>
        <name><surname>Aburto-Oropeza</surname><given-names>Octavio</given-names></name>
        <name><surname>Garcia</surname><given-names>Melissa Andersen</given-names></name>
        <name><surname>Batten</surname><given-names>Sonia D.</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Checkley</surname><given-names>David M.</given-names></name>
        <name><surname>Chiba</surname><given-names>Sanae</given-names></name>
        <name><surname>Duffy</surname><given-names>J. Emmett</given-names></name>
        <name><surname>Dunn</surname><given-names>Daniel C.</given-names></name>
        <name><surname>Fischer</surname><given-names>Albert</given-names></name>
        <name><surname>Gunn</surname><given-names>John</given-names></name>
        <name><surname>Kudela</surname><given-names>Raphael</given-names></name>
        <name><surname>Marsac</surname><given-names>Francis</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E.</given-names></name>
        <name><surname>Obura</surname><given-names>David</given-names></name>
        <name><surname>Shin</surname><given-names>Yunne Jai</given-names></name>
      </person-group>
      <article-title>Essential ocean variables for global sustained observations of biodiversity and ecosystem changes</article-title>
      <source>Global Change Biology</source>
      <publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>
      <year iso-8601-date="2018-06">2018</year><month>06</month>
      <volume>24</volume>
      <issn>1365-2486</issn>
      <uri>https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/10.1111/gcb.14108</uri>
      <pub-id pub-id-type="doi">10.1111/GCB.14108</pub-id>
      <fpage>2416</fpage>
      <lpage>2433</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nijland2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nijland</surname><given-names>Wiebe</given-names></name>
        <name><surname>Reshitnyk</surname><given-names>Luba</given-names></name>
        <name><surname>Rubidge</surname><given-names>Emily</given-names></name>
      </person-group>
      <article-title>Satellite remote sensing of canopy-forming kelp on a complex coastline: A novel procedure using the landsat image archive</article-title>
      <source>Remote Sensing of Environment</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>220</volume>
      <fpage>41</fpage>
      <lpage>50</lpage>
    </element-citation>
  </ref>
  <ref id="ref-xu2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Xu</surname><given-names>Shaochun</given-names></name>
        <name><surname>Xu</surname><given-names>Shuai</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Yue</surname><given-names>Shidong</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Yu</given-names></name>
        <name><surname>Qiao</surname><given-names>Yongliang</given-names></name>
        <name><surname>Liu</surname><given-names>Mingjie</given-names></name>
      </person-group>
      <article-title>Long-term changes in the unique and largest seagrass meadows in the bohai sea (china) using satellite (1974–2019) and sonar data: Implication for conservation and restoration</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>13</volume>
      <issue>5</issue>
      <fpage>856</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Traganos2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Traganos</surname><given-names>Dimosthenis</given-names></name>
        <name><surname>Reinartz</surname><given-names>Peter</given-names></name>
      </person-group>
      <article-title>Mapping mediterranean seagrasses with sentinel-2 imagery</article-title>
      <source>Marine Pollution Bulletin</source>
      <publisher-name>Elsevier Ltd</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>134</volume>
      <issn>18793363</issn>
      <pub-id pub-id-type="doi">10.1016/j.marpolbul.2017.06.075</pub-id>
      <fpage>197</fpage>
      <lpage>209</lpage>
    </element-citation>
  </ref>
  <ref id="ref-coffer2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coffer</surname><given-names>Megan M</given-names></name>
        <name><surname>Graybill</surname><given-names>David D</given-names></name>
        <name><surname>Whitman</surname><given-names>Peter J</given-names></name>
        <name><surname>Schaeffer</surname><given-names>Blake A</given-names></name>
        <name><surname>Salls</surname><given-names>Wilson B</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Richard C</given-names></name>
        <name><surname>Hill</surname><given-names>Victoria</given-names></name>
        <name><surname>Lebrasse</surname><given-names>Marie Cindy</given-names></name>
        <name><surname>Li</surname><given-names>Jiang</given-names></name>
        <name><surname>Keith</surname><given-names>Darryl J</given-names></name>
        <etal/>
      </person-group>
      <article-title>Providing a framework for seagrass mapping in united states coastal ecosystems using high spatial resolution satellite imagery</article-title>
      <source>Journal of Environmental Management</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>337</volume>
      <fpage>117669</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ralph2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ralph</surname><given-names>PJ</given-names></name>
        <name><surname>Polk</surname><given-names>SM</given-names></name>
        <name><surname>Moore</surname><given-names>KA</given-names></name>
        <name><surname>Orth</surname><given-names>RJ</given-names></name>
        <name><surname>Smith Jr</surname><given-names>WO</given-names></name>
      </person-group>
      <article-title>Operation of the xanthophyll cycle in the seagrass zostera marina in response to variable irradiance</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <volume>271</volume>
      <issue>2</issue>
      <fpage>189</fpage>
      <lpage>207</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Douay2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Douay</surname><given-names>Florian</given-names></name>
        <name><surname>Verpoorter</surname><given-names>Charles</given-names></name>
        <name><surname>Duong</surname><given-names>Gwendoline</given-names></name>
        <name><surname>Spilmont</surname><given-names>Nicolas</given-names></name>
        <name><surname>Gevaert</surname><given-names>François</given-names></name>
      </person-group>
      <article-title>New hyperspectral procedure to discriminate intertidal macroalgae</article-title>
      <source>Remote Sensing</source>
      <year iso-8601-date="2022">2022</year>
      <volume>14</volume>
      <issue>2</issue>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/346</uri>
      <pub-id pub-id-type="doi">10.3390/rs14020346</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Davies2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Geraud</surname><given-names>Andréa</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Rosa</surname><given-names>Philippe</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Multi- and hyperspectral classification of soft-bottom intertidal vegetation using a spectral library for coastal biodiversity remote sensing</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2023">2023</year>
      <volume>290</volume>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425723001050</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2023.113554</pub-id>
      <fpage>113554</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bannari2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bannari</surname><given-names>Abderrazak</given-names></name>
        <name><surname>Ali</surname><given-names>Thamer Salim</given-names></name>
        <name><surname>Abahussain</surname><given-names>Asma</given-names></name>
      </person-group>
      <article-title>The capabilities of sentinel-MSI (2A/2B) and landsat-OLI (8/9) in seagrass and algae species differentiation using spectral reflectance</article-title>
      <source>Ocean Science</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>18</volume>
      <issue>2</issue>
      <fpage>361</fpage>
      <lpage>388</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tuya2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tuya</surname><given-names>Fernando</given-names></name>
        <name><surname>Hernandez-Zerpa</surname><given-names>Harue</given-names></name>
        <name><surname>Espino</surname><given-names>Fernando</given-names></name>
        <name><surname>Haroun</surname><given-names>Ricardo</given-names></name>
      </person-group>
      <article-title>Drastic decadal decline of the seagrass cymodocea nodosa at gran canaria (eastern atlantic): Interactions with the green algae caulerpa prolifera</article-title>
      <source>Aquatic Botany</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>105</volume>
      <fpage>1</fpage>
      <lpage>6</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fairley2022drone">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fairley</surname><given-names>Iain</given-names></name>
        <name><surname>Williamson</surname><given-names>Benjamin J</given-names></name>
        <name><surname>McIlvenny</surname><given-names>Jason</given-names></name>
        <name><surname>King</surname><given-names>Nicholas</given-names></name>
        <name><surname>Masters</surname><given-names>Ian</given-names></name>
        <name><surname>Lewis</surname><given-names>Matthew</given-names></name>
        <name><surname>Neill</surname><given-names>Simon</given-names></name>
        <name><surname>Glasby</surname><given-names>David</given-names></name>
        <name><surname>Coles</surname><given-names>Daniel</given-names></name>
        <name><surname>Powell</surname><given-names>Ben</given-names></name>
        <etal/>
      </person-group>
      <article-title>Drone-based large-scale particle image velocimetry applied to tidal stream energy resource assessment</article-title>
      <source>Renewable Energy</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>196</volume>
      <fpage>839</fpage>
      <lpage>855</lpage>
    </element-citation>
  </ref>
  <ref id="ref-oh2017use">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Oh</surname><given-names>Jaehong</given-names></name>
        <name><surname>Kim</surname><given-names>Duk-jin</given-names></name>
        <name><surname>Lee</surname><given-names>Hyoseong</given-names></name>
      </person-group>
      <article-title>Use of a drone for mapping and time series image acquisition of tidal zones</article-title>
      <source>Journal of the Korean Institute of Intelligent Systems</source>
      <publisher-name>Korean Institute of Intelligent Systems</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>27</volume>
      <issue>2</issue>
      <fpage>119</fpage>
      <lpage>125</lpage>
    </element-citation>
  </ref>
  <ref id="ref-adade2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Adade</surname><given-names>Richard</given-names></name>
        <name><surname>Aibinu</surname><given-names>Abiodun Musa</given-names></name>
        <name><surname>Ekumah</surname><given-names>Bernard</given-names></name>
        <name><surname>Asaana</surname><given-names>Jerry</given-names></name>
      </person-group>
      <article-title>Unmanned aerial vehicle (UAV) applications in coastal zone management—a review</article-title>
      <source>Environmental Monitoring and Assessment</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>193</volume>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-casella2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Casella</surname><given-names>Elisa</given-names></name>
        <name><surname>Drechsel</surname><given-names>Jan</given-names></name>
        <name><surname>Winter</surname><given-names>Christian</given-names></name>
        <name><surname>Benninghoff</surname><given-names>Markus</given-names></name>
        <name><surname>Rovere</surname><given-names>Alessio</given-names></name>
      </person-group>
      <article-title>Accuracy of sand beach topography surveying by drones and photogrammetry</article-title>
      <source>Geo-Marine Letters</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>40</volume>
      <fpage>255</fpage>
      <lpage>268</lpage>
    </element-citation>
  </ref>
  <ref id="ref-angnuureng2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Angnuureng</surname><given-names>Donatus B</given-names></name>
        <name><surname>Brempong</surname><given-names>KE</given-names></name>
        <name><surname>Jayson-Quashigah</surname><given-names>PN</given-names></name>
        <name><surname>Dada</surname><given-names>OA</given-names></name>
        <name><surname>Akuoko</surname><given-names>SGI</given-names></name>
        <name><surname>Frimpomaa</surname><given-names>J</given-names></name>
        <name><surname>Mattah</surname><given-names>PA</given-names></name>
        <name><surname>Almar</surname><given-names>Rafaël</given-names></name>
      </person-group>
      <article-title>Satellite, drone and video camera multi-platform monitoring of coastal erosion at an engineered pocket beach: A showcase for coastal management at elmina bay, ghana (west africa)</article-title>
      <source>Regional Studies in Marine Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>53</volume>
      <fpage>102437</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-joyce2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Joyce</surname><given-names>Karen E</given-names></name>
        <name><surname>Fickas</surname><given-names>Kate C</given-names></name>
        <name><surname>Kalamandeen</surname><given-names>Michelle</given-names></name>
      </person-group>
      <article-title>The unique value proposition for using drones to map coastal ecosystems</article-title>
      <source>Cambridge Prisms: Coastal Futures</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>1</volume>
      <fpage>e6</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-tallam2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tallam</surname><given-names>Krti</given-names></name>
        <name><surname>Nguyen</surname><given-names>Nam</given-names></name>
        <name><surname>Ventura</surname><given-names>Jonathan</given-names></name>
        <name><surname>Fricker</surname><given-names>Andrew</given-names></name>
        <name><surname>Calhoun</surname><given-names>Sadie</given-names></name>
        <name><surname>O’Leary</surname><given-names>Jennifer</given-names></name>
        <name><surname>Fitzgibbons</surname><given-names>Mauriça</given-names></name>
        <name><surname>Robbins</surname><given-names>Ian</given-names></name>
        <name><surname>Walter</surname><given-names>Ryan K</given-names></name>
      </person-group>
      <article-title>Application of deep learning for classification of intertidal eelgrass from drone-acquired imagery</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>15</volume>
      <issue>9</issue>
      <fpage>2321</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Roca2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Roca</surname><given-names>Mar</given-names></name>
        <name><surname>Dunbar</surname><given-names>Martha Bonnet</given-names></name>
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Caballero</surname><given-names>Isabel</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Monitoring the marine invasive alien species rugulopteryx okamurae using unmanned aerial vehicles and satellites</article-title>
      <source>Frontiers in Marine Science</source>
      <year iso-8601-date="2022-10">2022</year><month>10</month>
      <volume>9</volume>
      <issn>2296-7745</issn>
      <pub-id pub-id-type="doi">10.3389/fmars.2022.1004012</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Roman2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Tovar-Sánchez</surname><given-names>Antonio</given-names></name>
        <name><surname>Olivé</surname><given-names>Irene</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <fpage>1225</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brunier2022Topographic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brunier</surname><given-names>Guillaume</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Gruet</surname><given-names>Yves</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas F.</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Topographic analysis of intertidal polychaete reefs (sabellaria alveolata) at a very high spatial resolution</article-title>
      <source>Remote Sensing 2022, Vol. 14, Page 307</source>
      <publisher-name>Multidisciplinary Digital Publishing Institute</publisher-name>
      <year iso-8601-date="2022-01">2022</year><month>01</month>
      <volume>14</volume>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/307</uri>
      <pub-id pub-id-type="doi">10.3390/RS14020307</pub-id>
      <fpage>307</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-collin2019improving">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Collin</surname><given-names>Antoine</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas</given-names></name>
        <name><surname>James</surname><given-names>Dorothée</given-names></name>
        <name><surname>Houet</surname><given-names>Thomas</given-names></name>
      </person-group>
      <article-title>Improving intertidal reef mapping using UAV surface, red edge, and near-infrared data</article-title>
      <source>Drones</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>3</volume>
      <issue>3</issue>
      <fpage>67</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-rossiter2020uav">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rossiter</surname><given-names>Thomas</given-names></name>
        <name><surname>Furey</surname><given-names>Thomas</given-names></name>
        <name><surname>McCarthy</surname><given-names>Tim</given-names></name>
        <name><surname>Stengel</surname><given-names>Dagmar B</given-names></name>
      </person-group>
      <article-title>UAV-mounted hyperspectral mapping of intertidal macroalgae</article-title>
      <source>Estuarine, Coastal and Shelf Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>242</volume>
      <fpage>106789</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-BedeGbif">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Sousa</surname><given-names>A I.</given-names></name>
        <name><surname>Figueira</surname><given-names>R</given-names></name>
        <name><surname>Oiry</surname><given-names>S</given-names></name>
        <name><surname>Gernez</surname><given-names>P</given-names></name>
        <name><surname>Barillé</surname><given-names>L</given-names></name>
      </person-group>
      <article-title>Benthic intertidal vegetation from the tagus estuary and aveiro lagoon</article-title>
      <publisher-name>Université de Nantes via GBIF.org</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.15468/n4ak6x</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Pereira2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pereira</surname><given-names>Henrique Miguel</given-names></name>
        <name><surname>Ferrier</surname><given-names>Simon</given-names></name>
        <name><surname>Walters</surname><given-names>Michele</given-names></name>
        <name><surname>Geller</surname><given-names>Gary N</given-names></name>
        <name><surname>Jongman</surname><given-names>Rob HG</given-names></name>
        <name><surname>Scholes</surname><given-names>Robert J</given-names></name>
        <name><surname>Bruford</surname><given-names>Michael William</given-names></name>
        <name><surname>Brummitt</surname><given-names>Neil</given-names></name>
        <name><surname>Butchart</surname><given-names>Stuart HM</given-names></name>
        <name><surname>Cardoso</surname><given-names>AC</given-names></name>
        <etal/>
      </person-group>
      <article-title>Essential biodiversity variables</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>339</volume>
      <issue>6117</issue>
      <fpage>277</fpage>
      <lpage>278</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

<sub-article article-type="notebook" id="nb-4-nb-article">
<front-stub>
<title-group>
<article-title>Discriminating Seagrasses From Green Macroalgae in
European Intertidal areas using high resolution multispectral drone
imagery.</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0001-7161-5246</contrib-id>
<name>
<surname>Oiry</surname>
<given-names>Simon</given-names>
</name>
<string-name>Simon Oiry</string-name>

<email>oirysimon@gmail.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">Writing</role>
<role>Data acquisition</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="corresp" rid="cor-1-nb-article">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Davies</surname>
<given-names>Bede Ffinian Rowe</given-names>
</name>
<string-name>Bede Ffinian Rowe Davies</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gernez</surname>
<given-names>Pierre</given-names>
</name>
<string-name>Pierre Gernez</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sousa</surname>
<given-names>Ana I.</given-names>
</name>
<string-name>Ana I. Sousa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-2-nb-article">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rosa</surname>
<given-names>Philippe</given-names>
</name>
<string-name>Philippe Rosa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zoffoli</surname>
<given-names>Maria Laura</given-names>
</name>
<string-name>Maria Laura Zoffoli</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-3-nb-article">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brunier</surname>
<given-names>Guillaume</given-names>
</name>
<string-name>Guillaume Brunier</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-4-nb-article">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Barillé</surname>
<given-names>Laurent</given-names>
</name>
<string-name>Laurent Barillé</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>Nantes University</institution>
</institution-wrap>







</aff>
<aff id="aff-2-nb-article">
<institution-wrap>
<institution>Aveiro University</institution>
</institution-wrap>







</aff>
<aff id="aff-3-nb-article">
<institution-wrap>
<institution>CNR ISMAR</institution>
</institution-wrap>







</aff>
<aff id="aff-4-nb-article">
<institution-wrap>
<institution>JeSaisPas</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1-nb-article">oirysimon@gmail.com</corresp>
</author-notes>
<abstract>
<p>Coastal areas host seagrass meadows, which offer crucial ecosystem
services including erosion control and carbon sequestration. However,
these areas are increasingly impacted by human activities, leading to
seagrass decline and habitat fragmentation. In situ surveys,
traditionally performed to monitor these ecosystems face limitations on
temporal and spatial coverage, particularly in intertidal zones,
prompting the use of satellite data within monitoring programs. Yet,
satellite remote sensing struggles with spatial and spectral resolution,
making it difficult to discriminate seagrass from other macrophytes in
highly heterogenous meadows. To address these challenges, drone images
acquired with multi-spectral sensors offer a promising solution. This
study focuses on using drones acquisitions for mapping intertidal
macrophytes, effectively discriminating between seagrass and green
macroalgae. Ten drone flights were conducted at two different altitudes
(12m and 120m) across diverse European habitats in France and Portugal.
Low altitude flights were used to train a Deep Learning classifier based
on Neural Networks to discrimintate among 5 intertidal vegetation
classes. Drone mapping demonstrated an overall accuracy of 94% across
all the sites and images, covering a total area of 467 000 m². The model
exhibited an accuracy of 96.4% in identifying seagrass.</p>
</abstract>
</front-stub>

<body>
<sec id="nb-code-cell-1-nb-article" specific-use="notebook-code">
<code language="r script">library(flextable)</code>
<code language="r script">library(tidyverse)</code>
<code language="r script">library(tidyterra)</code>
<code language="r script">library(tidymodels)</code>
<code language="r script">library(Utilities.Package) </code>
<code language="r script">library(patchwork)
library(sf) </code>
<code language="r script">library(rnaturalearth) </code>
<code language="r script">library(rnaturalearthdata) </code>
<code language="r script">library(rnaturalearthhires)
library(ggforce) 
library(patchwork)
library(terra)</code>
<code language="r script">library(gt)</code>
<code language="r script">library(scales)
library(magick)</code>
<code language="r script">library(grid)</code>
<code language="r script">library(ggforce)
library(statebins)
library(ggridges)</code>
<code language="r script">library(ggspatial)</code>
<code language="r script">library(terrainr)</code>
<code language="r script"># library(ggpmisc)
library(broom)
library(stars)</code>
<code language="r script">library(gmodels)
library(caret)</code>
<code language="r script">options(scipen = 100000000)</code>
<sec id="nb-code-cell-1-output-0-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'flextable' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-1-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'ggplot2' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-2-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'purrr' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-3-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'dplyr' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-4-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'lubridate' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-5-nb-article" specific-use="notebook-output">
<preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::compose() masks flextable::compose()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
</sec>
<sec id="nb-code-cell-1-output-6-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'tidyterra' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-7-nb-article" specific-use="notebook-output">
<preformat>
Attachement du package : 'tidyterra'

L'objet suivant est masqué depuis 'package:stats':

    filter</preformat>
</sec>
<sec id="nb-code-cell-1-output-8-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'tidymodels' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-9-nb-article" specific-use="notebook-output">
<preformat>── Attaching packages ────────────────────────────────────── tidymodels 1.1.1 ──
✔ broom        1.0.5     ✔ rsample      1.2.0
✔ dials        1.2.0     ✔ tune         1.1.2
✔ infer        1.0.5     ✔ workflows    1.1.3
✔ modeldata    1.2.0     ✔ workflowsets 1.0.1
✔ parsnip      1.1.1     ✔ yardstick    1.2.0
✔ recipes      1.0.8     </preformat>
</sec>
<sec id="nb-code-cell-1-output-10-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'broom' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-11-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'dials' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-12-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'infer' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-13-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'modeldata' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-14-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'parsnip' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-15-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'recipes' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-16-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'rsample' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-17-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'tune' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-18-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'workflows' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-19-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'workflowsets' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-20-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'yardstick' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-21-nb-article" specific-use="notebook-output">
<preformat>── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ purrr::compose()    masks flextable::compose()
✖ scales::discard()   masks purrr::discard()
✖ tidyterra::filter() masks dplyr::filter(), stats::filter()
✖ recipes::fixed()    masks stringr::fixed()
✖ dplyr::lag()        masks stats::lag()
✖ yardstick::spec()   masks readr::spec()
✖ recipes::step()     masks stats::step()
• Search for functions across packages at https://www.tidymodels.org/find/</preformat>
</sec>
<sec id="nb-code-cell-1-output-22-nb-article" specific-use="notebook-output">
<preformat>Le chargement a nécessité le package : cowplot</preformat>
</sec>
<sec id="nb-code-cell-1-output-23-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'cowplot' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-24-nb-article" specific-use="notebook-output">
<preformat>
Attachement du package : 'cowplot'

L'objet suivant est masqué depuis 'package:lubridate':

    stamp

Le chargement a nécessité le package : patchwork</preformat>
</sec>
<sec id="nb-code-cell-1-output-25-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'patchwork' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-26-nb-article" specific-use="notebook-output">
<preformat>
Attachement du package : 'patchwork'

L'objet suivant est masqué depuis 'package:cowplot':

    align_plots

Le chargement a nécessité le package : magrittr

Attachement du package : 'magrittr'

L'objet suivant est masqué depuis 'package:purrr':

    set_names

L'objet suivant est masqué depuis 'package:tidyr':

    extract</preformat>
</sec>
<sec id="nb-code-cell-1-output-27-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'sf' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-28-nb-article" specific-use="notebook-output">
<preformat>Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE</preformat>
</sec>
<sec id="nb-code-cell-1-output-29-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'rnaturalearth' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-30-nb-article" specific-use="notebook-output">
<preformat>Support for Spatial objects (`sp`) will be deprecated in {rnaturalearth} and will be removed in a future release of the package. Please use `sf` objects with {rnaturalearth}. For example: `ne_download(returnclass = 'sf')`</preformat>
</sec>
<sec id="nb-code-cell-1-output-31-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'rnaturalearthdata' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-32-nb-article" specific-use="notebook-output">
<preformat>
Attachement du package : 'rnaturalearthdata'

L'objet suivant est masqué depuis 'package:rnaturalearth':

    countries110</preformat>
</sec>
<sec id="nb-code-cell-1-output-33-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'terra' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-34-nb-article" specific-use="notebook-output">
<preformat>terra 1.7.55

Attachement du package : 'terra'

Les objets suivants sont masqués depuis 'package:magrittr':

    extract, inset

L'objet suivant est masqué depuis 'package:patchwork':

    area

L'objet suivant est masqué depuis 'package:scales':

    rescale

L'objet suivant est masqué depuis 'package:tidyr':

    extract

Les objets suivants sont masqués depuis 'package:flextable':

    align, colorize, rotate, width</preformat>
</sec>
<sec id="nb-code-cell-1-output-35-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'gt' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-36-nb-article" specific-use="notebook-output">
<preformat>Linking to ImageMagick 6.9.12.3
Enabled features: cairo, freetype, fftw, ghostscript, heic, lcms, pango, raw, rsvg, webp
Disabled features: fontconfig, x11</preformat>
</sec>
<sec id="nb-code-cell-1-output-37-nb-article" specific-use="notebook-output">
<preformat>
Attachement du package : 'grid'

L'objet suivant est masqué depuis 'package:terra':

    depth</preformat>
</sec>
<sec id="nb-code-cell-1-output-38-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'ggridges' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-39-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'ggspatial' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-40-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'terrainr' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-41-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'stars' a été compilé avec la version R 4.3.1</preformat>
</sec>
<sec id="nb-code-cell-1-output-42-nb-article" specific-use="notebook-output">
<preformat>Le chargement a nécessité le package : abind</preformat>
</sec>
<sec id="nb-code-cell-1-output-43-nb-article" specific-use="notebook-output">
<preformat>Le chargement a nécessité le package : lattice</preformat>
</sec>
<sec id="nb-code-cell-1-output-44-nb-article" specific-use="notebook-output">
<preformat>Warning: le package 'lattice' a été compilé avec la version R 4.3.2</preformat>
</sec>
<sec id="nb-code-cell-1-output-45-nb-article" specific-use="notebook-output">
<preformat>
Attachement du package : 'caret'

Les objets suivants sont masqués depuis 'package:yardstick':

    precision, recall, sensitivity, specificity

L'objet suivant est masqué depuis 'package:purrr':

    lift</preformat>
</sec>
</sec>
<sec id="nb-code-cell-2-nb-article" specific-use="notebook-code">
<code language="r script">my_comma&lt;-scales::label_comma(accuracy = NULL, big.mark = &quot;,&quot;,decimal.mark = &quot;.&quot;)</code>
</sec>
<sec id="introduction-nb-article">
  <title>1. Introduction</title>
  <p>Coastal areas are vital hotshots for marine biodiversity, with
  intertidal seagrass meadows playing a crucial role at the interface
  between land and ocean
  (<xref alt="Unsworth et al. 2022" rid="ref-unsworth2022-nb-article" ref-type="bibr">Unsworth
  et al. 2022</xref>). These meadows offer a myriad of ecosystem
  services to humanity, including limitation of coastline erosion,
  reducing the risk of eutrophication, carbon sequestration, and oxygen
  production. They serve as vital habitats for a diverse array of marine
  and terrestrial species, providing living, breeding, and feeding
  grounds
  (<xref alt="Gardner and Finlayson 2018" rid="ref-gardner2018-nb-article" ref-type="bibr">Gardner
  and Finlayson 2018</xref> ;
  <xref alt="Zoffoli et al. 2022" rid="ref-Zoffoli2022-nb-article" ref-type="bibr">Zoffoli
  et al. 2022</xref> ;
  <xref alt="Jankowska et al. 2019" rid="ref-jankowska2019-nb-article" ref-type="bibr">Jankowska
  et al. 2019</xref>). Due to their proximity to human activities,
  seagrass meadows are directly exposed to and impacted by anthropogenic
  pressures. Global regression and fragmentation are currently observed
  due to diseases, disasters, coastal urbanization, sea reclamation, as
  well as fishing activities, dredging, sea level rise, coastal erosion,
  competition with alien species, and reduction in water quality
  (<xref alt="Nguyen et al. 2021" rid="ref-nguyen2021-nb-article" ref-type="bibr">Nguyen
  et al. 2021</xref> ;
  <xref alt="Soissons et al. 2018" rid="ref-soissons2018-nb-article" ref-type="bibr">Soissons
  et al. 2018</xref> ;
  <xref alt="Orth et al. 2006" rid="ref-orth2006-nb-article" ref-type="bibr">Orth
  et al. 2006</xref> ;
  <xref alt="Lin et al. 2018" rid="ref-lin2018-nb-article" ref-type="bibr">Lin et
  al. 2018</xref> ;
  <xref alt="Duffy et al. 2019" rid="ref-duffy2019-nb-article" ref-type="bibr">Duffy
  et al. 2019</xref>). While improvements in water quality have been
  recently reported in European sites, allowing an overall recovery of
  seagrass ecosystems at the local scale, many other coastal waters
  worldwide are still subjected to strong eutrophication processes
  (<xref alt="Los Santos et al. 2019" rid="ref-deSantos2019-nb-article" ref-type="bibr">Los
  Santos et al. 2019</xref> ;
  <xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021-nb-article" ref-type="bibr">Zoffoli
  et al. 2021</xref>). Coastal eutrophication has been associated to
  anomalous accumulation of green macroalgae, the so-called green tides.
  Green tides produce shade and suffication over seagrass individuals,
  thus threatening the health of seagrass ecosystems
  (<xref alt="Duarte2002?" rid="ref-Duarte2002-nb-article" ref-type="bibr"><bold>Duarte2002?</bold></xref>
  ; <xref alt="Wang et al. 2022" rid="ref-wang2022-nb-article" ref-type="bibr">Wang
  et al. 2022</xref>).</p>
  <p>The importance of seagrass meadows and the variety of ecosystem
  services they provide have led to the enhancement of global and
  regional monitoring programs for systematically surveying different
  Essential Oceanic Variable
  (<xref alt="Miloslavich et al. 2018" rid="ref-Miloslavich2018-nb-article" ref-type="bibr">Miloslavich
  et al. 2018</xref>) as seagrass coverage and composition; as well as
  Essential Biodiversity Variable
  (<xref alt="Pereira et al. 2013" rid="ref-Pereira2013-nb-article" ref-type="bibr">Pereira
  et al. 2013</xref>) such as seagrass taxonomic diversity; species
  distribution, population abundance, and phenology. Monitoring programs
  also prioritize the identification of threats to these ecosystems,
  particularly during early stages, to facilitate effective mitigation
  actions. Traditionally, these ecological parameters have been
  quantified through in situ measurements, although this approach faces
  several constraints over intertidal zones. Intertidal meadows are only
  partially exposed during low tide and can be situated in
  difficult-to-reach mudflats, potentially leading to inaccurate and
  limited estimations with conventional sampling techniques
  (<xref alt="Nijland, Reshitnyk, and Rubidge 2019" rid="ref-nijland2019-nb-article" ref-type="bibr">Nijland,
  Reshitnyk, and Rubidge 2019</xref>). However, satellite data have been
  proven effective in complenmenting in situ surveys, allowing for the
  rapid and consitent retrieval of EOV’s over extensive seagrass
  meadows.
  (<xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021-nb-article" ref-type="bibr">Zoffoli
  et al. 2021</xref> ;
  <xref alt="Xu et al. 2021" rid="ref-xu2021-nb-article" ref-type="bibr">Xu et al.
  2021</xref> ;
  <xref alt="Traganos and Reinartz 2018" rid="ref-Traganos2018-nb-article" ref-type="bibr">Traganos
  and Reinartz 2018</xref> ;
  <xref alt="Coffer et al. 2023" rid="ref-coffer2023-nb-article" ref-type="bibr">Coffer
  et al. 2023</xref>)</p>
  <p>Satellite remote sensing offers the advantage of acquiring
  large-scale data in real-time but presents its inherent challenges.
  Free access satellite data (e.g., Sentinel-2 and Landsat8/9) provide
  relatively low spatial resolution data (10 - 30 m) across a limited
  number of spectral bands. These characteristics can be a limitation to
  accurately discriminating seagrass from others co-existing macrophytes
  over the meadow. Chlorophyceae (Green Algae) and marine Magnoliopsida
  (Seagrass) share the same pigment composition
  (<xref alt="Ralph et al. 2002" rid="ref-ralph2002-nb-article" ref-type="bibr">Ralph
  et al. 2002</xref> ;
  <xref alt="Douay et al. 2022" rid="ref-Douay2022-nb-article" ref-type="bibr">Douay
  et al. 2022</xref>). As a result, their respective spectral signatures
  can be considered similar by a non-expert observer
  (<xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023-nb-article" ref-type="bibr">Davies,
  Gernez, et al. 2023</xref> ;
  <xref alt="Bannari, Ali, and Abahussain 2022" rid="ref-bannari2022-nb-article" ref-type="bibr">Bannari,
  Ali, and Abahussain 2022</xref>). Recently, using a hyperspectral
  library, Davies, Gernez, et al.
  (<xref alt="2023" rid="ref-Davies2023-nb-article" ref-type="bibr">2023</xref>)
  demonstrated that the spectral resolution of Sentinel-2, might be
  enough for the discrimination between Magnoliopsida and Chlorophyceae.
  However, green tide events occur at small spatial scales that are not
  observable using satellite imagery
  (<xref alt="Tuya et al. 2013" rid="ref-tuya2013-nb-article" ref-type="bibr">Tuya
  et al. 2013</xref>), especially during the initial stage of the
  event.</p>
  <p>Remote sensing drone acquisitions are presented as a tool that can
  potentially fill gaps left by satellite and in situ data. Drone can
  cover large expanses while recording imagery at significantly higher
  spatial resolutions than satellite (pixel size from cm to mm) and
  still capturing data at multi-spectral resolution
  (<xref alt="Fairley et al. 2022" rid="ref-fairley2022drone-nb-article" ref-type="bibr">Fairley
  et al. 2022</xref> ;
  <xref alt="Oh, Kim, and Lee 2017" rid="ref-oh2017use-nb-article" ref-type="bibr">Oh,
  Kim, and Lee 2017</xref>). The versatility of drones allows for their
  application across a diverse thematic range , from coastal zone
  management
  (<xref alt="Adade et al. 2021" rid="ref-adade2021-nb-article" ref-type="bibr">Adade
  et al. 2021</xref> ;
  <xref alt="Casella et al. 2020" rid="ref-casella2020-nb-article" ref-type="bibr">Casella
  et al. 2020</xref> ;
  <xref alt="Angnuureng et al. 2022" rid="ref-angnuureng2022-nb-article" ref-type="bibr">Angnuureng
  et al. 2022</xref>) to mapping the spatial distribution of species
  (<xref alt="Joyce, Fickas, and Kalamandeen 2023" rid="ref-joyce2023-nb-article" ref-type="bibr">Joyce,
  Fickas, and Kalamandeen 2023</xref> ;
  <xref alt="Tallam et al. 2023" rid="ref-tallam2023-nb-article" ref-type="bibr">Tallam
  et al. 2023</xref> ;
  <xref alt="Roca et al. 2022" rid="ref-Roca2022-nb-article" ref-type="bibr">Roca
  et al. 2022</xref> ;
  <xref alt="Román et al. 2021" rid="ref-Roman2021-nb-article" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic-nb-article" ref-type="bibr">Brunier
  et al. 2022</xref>). However, when applied to coastal habitat mapping,
  many studies showcase their findings with study case limited to a
  single flight, restricting the generalizability of their application
  to other sites
  (<xref alt="Román et al. 2021" rid="ref-Roman2021-nb-article" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Collin et al. 2019" rid="ref-collin2019improving-nb-article" ref-type="bibr">Collin
  et al. 2019</xref> ;
  <xref alt="Rossiter et al. 2020" rid="ref-rossiter2020uav-nb-article" ref-type="bibr">Rossiter
  et al. 2020</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic-nb-article" ref-type="bibr">Brunier
  et al. 2022</xref>). This study aimed to analyze the potential of a
  drone equipped with a multispectral sensor for maping intertidal
  macrophytes, with a particular focus on discriminating Magnoliopsida
  and Chlorophyceae. Ten drone flights were performed over soft-bottom
  intertidal areas along two European countries (France and Portugal),
  covering a wide range of habitats, from monospecific seagrass meadows
  to meadows mixed with green or red algae. A deep learning algorithm
  was trained and validated for macrophyte discrimination, emphasizing
  applicability across diverse sites without a loss of accuracy in
  predictions.</p>
</sec>
<sec id="material-methods-nb-article">
  <title>2. Material &amp; Methods</title>
  <sec id="study-sites-nb-article">
    <title>2.1 Study sites</title>
    <p>Seven study sites distributed between France and Portugal were
    selected for their relatively extensive intertidal seagrass beds.
    Two sites are located in Gulf of Morbihan
    (<xref alt="Figure 1" rid="fig-map-nb-article">Figure 1</xref> A), France
    (47.5791°N, 2.8018°W). This gulf covers an area of 115 km² and is
    only connect to the sea through a 900m wide channel. A total of 53
    small islands are scattered across the gulf leading to 250 km of
    shorelines. Patchy seagrass meadows can be found on a lot of these
    islands. Within the Gulf of Morbihan we have chosen two sites : One
    is located in one of these island (Arz island). The other one is
    located in the sourthern part of the Gulf (Duer). Two others sites
    are located in Bourgneuf Bay, France (46.9849°N, 2.1488°W). This bay
    is a semi-enclosed macrotidal bay, protected from waves by
    Noirmoutier Island. With up to 6m in tidal range during spring tide,
    a 6 km² seagrass meadow can uncover at low tide. The sites we
    surveyed (L’Epine and Barbatre,
    <xref alt="Figure 1" rid="fig-map-nb-article">Figure 1</xref> B) are located in
    the southernmost part of the bay, along the Noirmoutier Island, and
    host a monospecific <italic>Zostera noltei</italic> seagrass bed
    with very little mixing with other macrophytes. Three sites have
    been survey in the Ria de Aveiro Lagoon in Portugal (40.6887°N,
    8.6810°W). The extent of this lagoon is about 80 km² with many
    narrow channels, large salt marshes and many mudflats that uncovers
    at low tide. It is connected to the open sea through a single
    channel, with a tidal lag between the North and the South of the
    lagoon. The southernmost site (Gafanha) is a mudflat located in an
    affluent of the lagoon whereas the two other sites are situated in
    the middle of the lagoon and are only accessible by boat
    (<xref alt="Figure 1" rid="fig-map-nb-article">Figure 1</xref> C). These
    Portuguese sites were characterized by a more diverse intertidal
    area, where the seagrass meadow could intermingle with red algae
    (Rhodophyceae), brown algae (Phaeophyceae), or green algae
    (Chlorophyceae).</p>
    <sec id="nb-code-cell-3-nb-article" specific-use="notebook-code">
    <code language="r script">world_map &lt;- sovereignty10 %&gt;% 
  st_as_sf() %&gt;% 
  dplyr::filter(SOVEREIGNT%in%c(&quot;Spain&quot;,&quot;France&quot;,&quot;Portugal&quot;,
                                &quot;Italy&quot;,&quot;Andorra&quot;,
                                &quot;United Kingdom&quot;,
                                &quot;Switzerland&quot;,&quot;Belgium&quot;,
                                &quot;Germany&quot;,&quot;Luxembourg&quot;) ) 

bbox_europe &lt;- st_bbox(c(xmin = -20, ymin = 34,
                         xmax = 20, ymax = 55) ,
                       crs = st_crs(world_map) ) 

world_map&lt;-st_make_valid(world_map) 

european_union_map_cropped &lt;- st_crop(world_map, bbox_europe)  %&gt;% 
  st_transform(&quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs &quot;)  


UnitedKingdom&lt;-sovereignty10 %&gt;% 
  st_as_sf() %&gt;% 
  dplyr::filter(SOVEREIGNT%in%c(&quot;United Kingdom&quot;) ) %&gt;% 
  st_cast(&quot;POLYGON&quot;) 

bbox_UK &lt;- st_bbox(c(xmin = -20, ymin = 45,
                         xmax = 20, ymax = 55) ,
                       crs = st_crs(UnitedKingdom) ) 

UnitedKingdom&lt;-st_make_valid(UnitedKingdom) 

UK_map_cropped &lt;- st_crop(UnitedKingdom, bbox_UK)  %&gt;% 
  st_transform(&quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs &quot;) 

Europe_sf&lt;-european_union_map_cropped %&gt;% 
  dplyr::bind_rows(UK_map_cropped) 

Projects&lt;-data.frame(
  Name=c(
  &quot;Portugal - Aveiro Lagoon Flights\nLower-Resolution: 4\nHigher-Resolution: 1&quot;,
  &quot;France - Morbihan Gulf Flights\nLower-Resolution: 3\nHigher-Resolution: 3&quot;,
  &quot;France - Bourgneuf Bay Flights\nLower-Resolution: 4\nHigher-Resolution: 0&quot;
  ) ,
  Long=c(-8.745730,
         -2.840592, 
         -2.111868) ,
  Lat=c(40.617610, 
        47.578736,
        47.024719) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(&quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs &quot;)  

Projects_df&lt;-Projects %&gt;%
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)  %&gt;% 
  separate(Name, into=c(&quot;Country&quot;,&quot;Bay&quot;) ,sep=&quot; - &quot;)  %&gt;% 
  dplyr::mutate(Country=as.factor(Country) ,
                Bay=as.factor(Bay) ) 

Miniworld_map &lt;- sovereignty10 %&gt;% 
  st_as_sf()

sf_use_s2(FALSE)

bbox_EU &lt;- st_bbox(c(xmin = -30, ymin = 20,
                         xmax = 50, ymax = 70) ,
                       crs = st_crs(Miniworld_map) ) 

  MiniEU_map&lt;-st_crop(Miniworld_map, bbox_EU)  %&gt;% 
  st_transform(&quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs &quot;)  

  df_P1&lt;-Projects_df %&gt;% 
    mutate(ID = c(1:nrow(.))) %&gt;% 
    mutate(Site = case_when(ID == 1 ~ &quot;Aveiro Lagoon&quot;,
                            ID == 2 ~ &quot;Morbihan Gulf&quot;,
                            ID == 3 ~ &quot;Bourgneuf Bay&quot;,
                            TRUE ~ &quot;NA&quot;),
           ID = case_when(ID == 1 ~ &quot;C&quot;,
                          ID == 2 ~ &quot;A&quot;,
                          TRUE ~ &quot;B&quot;)) %&gt;% 
    dplyr::select(c(lon,lat,ID,Site))
    
    scaleFUN &lt;- function(x) paste0(sprintf(&quot;%.2f&quot;, x),&quot;°N&quot;)
  

p1  &lt;-
  ggplot(MiniEU_map) +
  geom_sf(linewidth=0.5,alpha=0.93,
          fill=&quot;#CFCFCF&quot;,colour=&quot;grey30&quot;)+
    ggforce::geom_mark_ellipse(data=df_P1,
                 aes(x=lon,
                     y=lat,
                     label = ID,
                     description=Site) ,
                 linewidth=0.3,
                 fill=&quot;goldenrod&quot;,
                 show.legend=F,
                 label.hjust = 0.5,
                 con.size = 2,
                 con.colour = &quot;goldenrod4&quot;,
                 label.fontsize = c(25,20),
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) , 
  label.buffer = unit(5, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;)+
  coord_sf(xlim=c(2600000,4100000) ,
          ylim=c(1600000,3100000))+
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  scale_y_continuous(labels=scaleFUN)+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;),
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20) )



ggsave(&quot;Figures/Figure1/Map_Drone_Sites.png&quot;,p1,width= 10, height=10)  </code>
    </sec>
    <sec id="nb-code-cell-4-nb-article" specific-use="notebook-code">
    <code language="r script">filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_aveiro &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_Aveiro&quot;)] %&gt;% 
  read_sf()

Flight_aveiro&lt;-data.frame(
  Name=c(
  &quot;Gafanha&quot;,
  &quot;Mataducos&quot;,
  &quot;Marinha Lanzarote&quot;
  ) ,
  Description = c(&quot;12m and 120m Flights&quot;,
                  &quot;120m Flight&quot;,
                  &quot;120m Flight&quot;),
  Long=c(-8.742485,
         -8.646980, 
         -8.690677) ,
  Lat=c(40.597599, 
        40.666634,
        40.665120) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_aveiro))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)

aveiro_plot &lt;-
ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;))+
  geom_sf(data = mask_aveiro, mapping = aes(fill = Type),linewidth=0.05,alpha=0.93,colour=&quot;grey30&quot;)+
      coord_sf(xlim=c(519749,535233) ,
          ylim=c(4493310,4508794) )+
  ggforce::geom_mark_ellipse(data=Flight_aveiro,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 label.fontsize = 25,
                 label.hjust = 0.5,
                 con.size = 2,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
    # theme_void()+
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  geom_label(aes(x = 521000, y = 4507794, label = &quot;C&quot;), size = 20)+
  scale_x_continuous(breaks = seq(-8.70, -8.60, by = 0.10))+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;) ,
        legend.position = &quot;none&quot;,
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))


ggsave(&quot;Figures/Figure1/Map_Aveiro.png&quot;,aveiro_plot,width= 10, height=10)  </code>
    </sec>
    <sec id="nb-code-cell-5-nb-article" specific-use="notebook-code">
    <code language="r script">filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_BB &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_BB&quot;)] %&gt;% 
  read_sf()

Flight_BB&lt;-data.frame(
  Name=c(
  &quot;Barbâtre&quot;,
  &quot;L'Epine&quot;
  ) ,
  Description = c(&quot;120m Flight&quot;,
                  &quot;120m Flight&quot;),
  Long=c(-2.166313,
         -2.228239) ,
  Lat=c(46.956420, 
        46.989515) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_BB))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)

BB_plot &lt;- ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;))+
  geom_sf(data = mask_BB, mapping = aes(fill = Type),linewidth=0.05,alpha=0.93,colour=&quot;grey30&quot;)+
      coord_sf(xlim=c(550609,579539) ,
          ylim=c(5189447,5218377) )+
  ggforce::geom_mark_ellipse(data=Flight_BB,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 con.size = 2,
                 label.fontsize = 25,
                 label.hjust = 0.5,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  geom_label(aes(x = 553460, y = 5216442, label = &quot;B&quot;), size = 20)+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;) ,
        legend.position = c(0.95,0.2),
        legend.key.size =  unit(1, &quot;cm&quot;),
        legend.text = element_text(size = 20),
        legend.title=element_blank(),
        legend.background = element_rect(linewidth = 0.5, 
                                         fill = &quot;white&quot;,
                                         linetype=&quot;solid&quot;, 
                                  colour =&quot;black&quot;),
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))


ggsave(&quot;Figures/Figure1/Map_BB.png&quot;,width= 10, height=10)  </code>
    </sec>
    <sec id="nb-code-cell-6-nb-article" specific-use="notebook-code">
    <code language="r script">filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_Morb &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_Morbihan&quot;)] %&gt;% 
  read_sf()

Flight_Morbihan&lt;-data.frame(
  Name=c(
  &quot;Arz&quot;,
  &quot;Duer&quot;
  ) ,
  Description = c(&quot;12m Flight&quot;,
                  &quot;12m and 120m Flight&quot;),
  Long=c(-2.795961,
         -2.746186) ,
  Lat=c(47.603260, 
        47.543877) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_Morb))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)

Morbihan_plot&lt;-ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land mask&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;))+
  geom_sf(data = mask_Morb, mapping = aes(fill = Type),linewidth=0.05,alpha=0.93,colour=&quot;grey30&quot;)+
      coord_sf(xlim=c(503019,526177) ,
          ylim=c(5257824,5280982))+
  ggforce::geom_mark_ellipse(data=Flight_Morbihan,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 con.size = 2,
                 label.hjust = 0.5,
                 label.fontsize = 25,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  geom_label(aes(x = 505000, y = 5280982-1981, label = &quot;A&quot;), size = 20)+
  scale_x_continuous(breaks = seq(-3, -2.6, by = 0.1))+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;),
        legend.position = &quot;none&quot;,
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))


  ggsave(&quot;Figures/Figure1/Map_Morbihan.png&quot;,width= 10, height=10)  </code>
    </sec>
    <sec id="nb-code-cell-7-nb-article" specific-use="notebook-code">
    <code language="r script">layout &lt;- c(
  patchwork::area(t = 1, l = 1, b = 10, r = 10),
  patchwork::area(t = 1, l = 11, b = 10, r = 20),
  patchwork::area(t = 11, l = 1, b = 20, r = 10),
  patchwork::area(t = 11, l = 11, b = 20, r = 20)
)
# plot(layout)

Tot &lt;- magick::image_ggplot(magick::image_read(&quot;Figures/Figure1/Map_Drone_Sites.png&quot;), interpolate = T)
BB &lt;- magick::image_ggplot(magick::image_read(&quot;Figures/Figure1/Map_BB.png&quot;), interpolate = T)
Mor &lt;- magick::image_ggplot(magick::image_read(&quot;Figures/Figure1/Map_Morbihan.png&quot;), interpolate = T)
Av &lt;- magick::image_ggplot(magick::image_read(&quot;Figures/Figure1/Map_Aveiro.png&quot;), interpolate = T)


a&lt;-Tot+Mor+BB+Av+patchwork::plot_layout(design=layout)

ggsave(&quot;./Figures/Fig1_Map_Drone_Sites.png&quot;,a, width= 10, height=10, dpi = 800)</code>
    </sec>
    <sec id="cell-fig-map-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Fig1_Map_Drone_Sites.png&quot;)</code>
    <fig id="fig-map-nb-article">
      <caption><p>Figure 1: Sites where the different drone flights were
      made. A: Gulf of Morbihan, B: Bourngeuf Bay, C: Ria de Aveiro
      Lagoon. Light green represent terrestrial areas whereas darkgreen
      represent intertidal areas.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Fig1_Map_Drone_Sites.png" />
    </fig>
    </sec>
  </sec>
  <sec id="drone-data-nb-article">
    <title>2.2 Drone Data</title>
    <p>At each location, a DJI Matrice 200 quadcopter drone equipped
    with a Micasense RedEdge Dual MX multispectral camera was flown to
    take 1.2 million pixel reflectance photographs in 10 spectral bands,
    from blue (444 nm) to near infrared (840 nm). An angle of 90° has
    been maintained between the sun and the drone’s route to guarantee
    uniform lighting conditions between flight lines. A side overlap of
    70% and a front overlap of 80% between each image has been set.
    Images have been calibrated in reflectance using a calibration panel
    reflective at ~50% provided by the camera’s manufaturer and a
    Downwelling Light Sensor (DLS2) that was utilized to acquire
    irradiance data during the flight. A Structure-from-Motion
    photogrammetry software (Agisoft Metashape) has been used to process
    images to obtain multispectral orthomosaics of each flight. The
    workflow for orthomosaicking has remained consistent for every
    flight. First, tying key points were detected inside of each image
    and between overlapping images in order to obtain a sparse point
    cloud. This cloud was cleaned using reprojection accuracy metric in
    order to remove noisy points. A dense point cloud has been then
    produced using a structure from motion algorithm. A surface
    interpolation of this dense point cloud has been made to obtain a
    Digital Surface Model (DSM), used to reconstruct the multispectral
    ortho-image. Across all the sites, flights were made at two
    different altitudes : 12 m or/and 120 m. Low altitude drone flights
    produce ortho-images with a very high spatial resolution (8 mm per
    pixel), making it simple to visually distinguish between the various
    types of vegetation. High altitude fights on the other hand allow to
    cover large areas and produced images with a pixel size of 80 mm
    (Table 1).</p>
    <sec id="nb-code-cell-8-nb-article" specific-use="notebook-code">
    <code language="r script">df&lt;-data.frame(
  Country = c(
    rep(&quot;France&quot;,5),
    rep(&quot;Portugal&quot;,4)
  ),
  Site = c(
    rep(&quot;Morbihan&quot;,3),
    rep(&quot;Bourgneuf Bay&quot;,2),
    rep(&quot;Aveiro Lagoon&quot;,4)
  ),
  Name = c(
    &quot;Arz Island&quot;,
    &quot;Duer&quot;,
    &quot;Duer&quot;,
    &quot;Barbâtre&quot;,
    &quot;L'Epine&quot;,
    &quot;Inner Lagoon&quot;,
    &quot;Mataducos&quot;,
    &quot;Gafanha&quot;,
    &quot;Gafanha&quot;
  ),
  Altitude = c(
    &quot;12m&quot;,
    &quot;12m&quot;,
    &quot;120m&quot;,
    &quot;120m&quot;,
    &quot;120m&quot;,
    &quot;120m&quot;,
    &quot;120m&quot;,
    &quot;120m&quot;,
    &quot;12m&quot;
  ),
  Utility = c(
    &quot;Training&quot;,
    &quot;Training&quot;,
    &quot;Validation&quot;,
    &quot;Validation&quot;,
    &quot;Validation&quot;,
    &quot;Validation&quot;,
    &quot;Validation&quot;,
    &quot;Validation&quot;,
    &quot;Training&quot;
  )
)

brdr1 &lt;- fp_border_default(color = &quot;black&quot;, width = 1.5)
brdr2 &lt;- fp_border_default(color = &quot;grey&quot;, width = 1.5)
brdr3 &lt;- fp_border_default(color = &quot;grey40&quot;, width = 1.5)


flextable(df)  %&gt;%
  merge_v(j = 1) %&gt;%
  merge_v(j = 2) %&gt;%
    border_remove() %&gt;%
    hline_top(border=brdr1) %&gt;%
    hline(i=5, border=brdr1) %&gt;%
    hline(i=1,j = 3:5, border=brdr2) %&gt;%
    hline(i=2, border=brdr2) %&gt;%
    hline(i=3, j = 2:5, border=brdr3) %&gt;%
    hline(i=4, j = 3:5, border=brdr2) %&gt;%
    hline(i=6, border=brdr2) %&gt;%
    hline(i=6, j = 1:2, border=brdr1) %&gt;%
    hline(i=7, border=brdr2) %&gt;%
    hline(i=8, border=brdr2) %&gt;%
    hline(i=9, border=brdr1) %&gt;%
    vline(j=2, border = brdr1) %&gt;%
    flextable::align(align = &quot;center&quot;,part = &quot;all&quot;) %&gt;%
    flextable::align(align = &quot;center&quot;,part = &quot;header&quot;) %&gt;%
  # set_caption(caption = &quot;Table 1 List of drone Flight, summarising the date, the altitude and the purpose of each flight.&quot;) %&gt;%
  set_table_properties(layout = &quot;autofit&quot;) </code>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table1-1.png" />
    </sec>
  </sec>
  <sec id="field-sampling-nb-article">
    <title>2.3 Field sampling</title>
    <p>Before each flight, targets used as Ground Control Points (GCPs)
    were dispersed and georeferenced with a Trimble © Geo XH 6000
    differential GPS (dGPS). GCPs were used to correct georeferencing
    imprecision of orthomosaics with an horizontal and vertical accuracy
    of 10cm. dGPS was also used to georeference quardrats of 0.25cm²
    used to assess the presence or absence of 5 key classes of
    vegetation : Bacillariophyceae (Diatoms forming large biofilm over
    the sediment during low tide), Phaeophyceae (Brown algae),
    Magnoliopsida (Seagrass), Chlorophyceae (Green algae) and
    Rhodophyceae (Red algae)
    (<xref alt="Figure 2" rid="fig-vegetation-nb-article">Figure 2</xref>). Picture
    of each quadrat were taken and uploaded on the online on the Global
    Biodiversity Information Facility (GBIF) platform
    (<xref alt="Davies, Sousa, et al. 2023" rid="ref-BedeGbif-nb-article" ref-type="bibr">Davies,
    Sousa, et al. 2023</xref>). Each photograph was also processed to
    estimate the percent cover of each type of vegetation. Georeferenced
    hyperspectral reflectance signatures of each vegetation class were
    also sampled using an ASD FieldSpec HandHeld 2 spectroradiomete,
    which acquires reflectance between 325 and 1075 nm, with 1 nm of
    spectral resolution. The methodological scheme followed in this
    study is presented in
    <xref alt="Figure 3" rid="fig-workflow-nb-article">Figure 3</xref>.</p>
    <sec id="nb-code-cell-9-nb-article" specific-use="notebook-code">
    <code language="r script">micasense&lt;-list.files(pattern = &quot;Wavelength_Micasense_DualMX.csv&quot;,recursive = T) %&gt;% 
  read.delim(sep = &quot;;&quot;)

imglist&lt;-
  data.frame(path = list.files(pattern = &quot;.tif&quot;, recursive = T, full.names = T)) %&gt;% 
  mutate(folder = case_when(str_detect(path, &quot;Data&quot;) ~ &quot;Input&quot;,
                            TRUE ~ &quot;Output&quot;),
         alt = case_when(str_detect(path, &quot;high&quot;) ~ &quot;high&quot;,
                         str_detect(path, &quot;High&quot;) ~ &quot;high&quot;,
                         TRUE ~ &quot;low&quot;),
         site = case_when(str_detect(path, &quot;Gafanha&quot;) ~ &quot;Gafanha&quot;,
                          str_detect(path, &quot;Arz&quot;) ~ &quot;Arz&quot;,
                          TRUE ~ &quot;Duer&quot;),
         type = case_when(str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;NDVI&quot;) ~ &quot;NDVI&quot;,
                          str_detect(path, &quot;Pred&quot;) ~ &quot;Pred&quot;,
                          TRUE ~ &quot;ortho&quot;),
         resampled = case_when(str_detect(path, &quot;resampled&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         correction = case_when(str_detect(path, &quot;corrected_per_bands&quot;) ~ &quot;Bands&quot;,
                          str_detect(path, &quot;corrected.tif&quot;) ~ &quot;lm_all&quot;,
                          TRUE ~ &quot;NA&quot;)) %&gt;% 
  dplyr::filter(alt != &quot;NA&quot;,
                !str_detect(path,&quot;.xml&quot;),
                !str_detect(path,&quot;.enp&quot;))

gaf_low_multi&lt;- imglist %&gt;% 
  filter(site == &quot;Gafanha&quot;,
         alt == &quot;low&quot;,
         type == &quot;ortho&quot;,
         resampled == &quot;FALSE&quot;,
         folder == &quot;Input&quot;) %&gt;%
  slice(1) %&gt;% 
  pull(path) %&gt;%
  rast() 
 names(gaf_low_multi)&lt;-c(paste0(&quot;B&quot;,c(1:10)))

 Gafanha_low_pred&lt;-&quot;./Data/image/prediction/NewPreds/AveiroLowPrediction_nnNewStanRawMetrics_Preds_NoXantho_7.tif&quot; %&gt;% 
     rast()
 names(Gafanha_low_pred)&lt;-&quot;pred&quot;


# arz_multi&lt;- imglist %&gt;% 
#   filter(site == &quot;Arz&quot;, 
#          type == &quot;ortho&quot;) %&gt;% 
#   slice(1) %&gt;% 
#   pull(path) %&gt;% 
#   rast()
#  names(arz_multi)&lt;-c(paste0(&quot;B&quot;,c(1:10)))
# 
# arz_pred&lt;- imglist %&gt;% 
#   filter(site == &quot;Arz&quot;, 
#          type == &quot;Pred&quot;,
#          str_detect(path, &quot;7by7&quot;)) %&gt;% 
#   slice(1) %&gt;% 
#   pull(path) %&gt;% 
#   rast()
#  names(arz_pred)&lt;-&quot;pred&quot;
 
 
 
gaf&lt;-rast(list(gaf_low_multi,Gafanha_low_pred)) %&gt;% 
  as.data.frame(xy = F) %&gt;% 
  dtplyr::lazy_dt() %&gt;% 
  dplyr::filter(B1 != 65535,
                pred != 0) %&gt;%
  as_tibble() %&gt;% 
  rename(Class = &quot;pred&quot;) %&gt;%
  mutate(pxl_ID = c(1:nrow(.))) %&gt;% 
  pivot_longer(-c(Class,pxl_ID), names_to = &quot;band&quot;,values_to = &quot;value&quot;) %&gt;% 
  left_join(micasense, by = c(&quot;band&quot; = &quot;Band_ID&quot;)) %&gt;% 
  group_by(Class, Wavelength) %&gt;% 
  dplyr::summarise(mean = mean(value),
                   sd = sd(value),
                   max = max(value),
                   min = min(value),
                   median = median(value)) %&gt;%  
  mutate(Class = case_when(Class == 1 ~ &quot;Bare Sediment&quot;,
                              Class == 2 ~ &quot;D - Chloropyceae&quot;,
                              Class == 3 ~ &quot;Bare Sediment&quot;,
                              Class == 4 ~ &quot;A - MagnoliopsidaL&quot;,
                              Class == 5 ~ &quot;E - Microphytobenthos&quot;,
                              Class == 6 ~ &quot;A - Magnoliopsida&quot;,
                              Class == 7 ~ &quot;B - Phaeophyceae&quot;,
                              Class == 8 ~ &quot;C - Rhodophyceae&quot;,
                              Class == 9 ~ &quot;Sun Glint&quot;,
                              Class == 10 ~ &quot;Water&quot;,
                              Class == 11 ~ &quot;Xanthophyceae&quot;,
                              TRUE ~ &quot;NA&quot;))

spectra&lt;-gaf %&gt;% 
  dplyr::filter(Class != &quot;Bare Sediment&quot;,
                Class != &quot;Sun Glint&quot;,
                Class != &quot;Water&quot;,
                Class != &quot;Xanthophyceae&quot;,
                Class != &quot;A - MagnoliopsidaL&quot;) %&gt;% 
  ggplot(aes(x=Wavelength, y = mean/10000, color = Class))+
  geom_line(linewidth = 0.5)+
  scale_color_manual(values=c(&quot;#389318&quot;, &quot;#873e23&quot;, &quot;#b3002d&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;))+
  ylab(&quot;Reflectance&quot;)+
  xlab(&quot;Wavelength (nm)&quot;)+
  theme_Bede()+
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 7),
        axis.title.y = element_text(size = 7),
        legend.position = c(0.2, 0.7),
        plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
        legend.title=element_blank(),
        legend.text = element_text(size = 5),
        legend.key.size = unit(0.25, &quot;cm&quot;),
        legend.text.align = 0,
        panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.line = element_line(color=&quot;black&quot;))

ggsave(&quot;Figures/Spectral_shapes.png&quot;,spectra, bg = &quot;transparent&quot;,  height = 2, width = 3, dpi = 2000)

sp &lt;- image_ggplot(magick::image_read(&quot;Figures/Spectral_shapes.png&quot;), interpolate = T)

# sp&lt;-ggplot()+
#   geom_spatraster_rgb(data = rast(&quot;Figures/Spectral_shapes.png&quot;),maxcell = 4009008)+
#   coord_equal()+
#     theme_void()+
#   theme(axis.text = element_blank(), 
#         axis.title = element_blank(), 
#         axis.ticks = element_blank(),
#         panel.background = element_rect(fill='transparent'),
#         plot.background = element_rect(fill='transparent', color=NA),
#         axis.ticks.length = unit(0, &quot;pt&quot;),
#         panel.grid.major=element_blank(), 
#         panel.grid.minor=element_blank(), 
#         plot.margin = margin(0, 0, 0, 0, &quot;pt&quot;))
# 
# 
# Magno &lt;- magick::image_read(&quot;Data/Pictures/Figure2/Magnoliopsida_cropped2.png&quot;)%&gt;%
#   # magick::image_rotate(90)%&gt;%
#   grid::rasterGrob()
# 
# Brown &lt;- magick::image_read(&quot;Data/Pictures/Figure2/Phaeophyceae_cropped.png&quot;)%&gt;%
#   grid::rasterGrob()
# 
# Red &lt;- magick::image_read(&quot;Data/Pictures/Figure2/Rhodophyceae_cropped.png&quot;)%&gt;% 
#   grid::rasterGrob()
# 
# green &lt;- magick::image_read(&quot;Data/Pictures/Figure2/Chlorophyceae_cropped.png&quot;)%&gt;% 
#   grid::rasterGrob()
# 
# MPB &lt;- magick::image_read(&quot;Data/Pictures/Figure2/Bacillariophyceae_cropped.png&quot;)%&gt;% 
#   grid::rasterGrob()
# 
# Lines&lt;-data.frame(x=c(10,20,10),
#                   y=c(-0.1,-0.1,10),
#                   xend=c(10,20,30),
#                   yend=c(20,20,10))
# labels&lt;-data.frame(name = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;),
#                    x= c(1,11,21,11,21),
#                    y=c(19,19,19,1,1))
# 
# a&lt;-ggplot(expand_grid(x = 0:30,y=0:20),aes(x = x, y = y) ) +
#   geom_point(alpha=0) +
#   coord_fixed()+
#   ggplot2::annotation_custom(Magno, 0,10, 0, 20) +
#   ggplot2::annotation_custom(green, 10,20, 10, 20)+
#   ggplot2::annotation_custom(Red, 10,20, 0, 10)+
#   ggplot2::annotation_custom(Brown, 20,30, 10, 20)+
#   ggplot2::annotation_custom(MPB, 20,30, 0,10)+
#   geom_segment(data=Lines,aes(x=x,y=y,xend=xend,yend=yend),
#                colour=&quot;white&quot;,linewidth=2)+
#   ggplot2::annotation_custom(ggplotGrob(spectra), 5,25, 5,15)+
#   geom_label(data=labels,aes(x=x,y=y,label=name), size = 10)+
#   theme_void()+
#   theme(axis.title.x = element_blank(),
#         axis.title.y = element_blank(),
#         axis.text.x = element_blank(),
#         axis.text.y = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.ticks.y = element_blank(),
#         plot.margin = grid::unit(c(0.01,0.01,0.01,0.01), &quot;mm&quot;),
#         # rect = element_blank(),
#         panel.margin = grid::unit(c(0.01, 0.01, 0.01, 0.01), &quot;mm&quot;))
# 
# Lines1&lt;-data.frame(x=c(0,10,20,30),
#                   y=c(10,0,0,0),
#                   xend=c(40.1,10,20,30),
#                   yend=c(10,10,10,10))
# 
# labels1&lt;-data.frame(name = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;),
#                    x= c(1,1,11,21,31),
#                    y=c(29,9,9,9,9))
# 
# ggplot(expand_grid(x = 0:40,y=0:30),aes(x = x, y = y) ) +
#   geom_point(alpha=0) +
#   coord_fixed()+
#   ggplot2::annotation_custom(Magno, 0,10, 10, 30) +
#   ggplot2::annotation_custom(Brown, 0,10, 0, 10)+
#   ggplot2::annotation_custom(Red, 10,20, 0, 10)+
#   ggplot2::annotation_custom(green, 20,30, 0, 10)+
#   ggplot2::annotation_custom(MPB, 30,40, 0,10)+
#   geom_segment(data=Lines1,aes(x=x,y=y,xend=xend,yend=yend),
#                colour=&quot;white&quot;,linewidth=2)+
#   ggplot2::annotation_custom(ggplotGrob(spectra), 10,40, 10,30)+
#   geom_label(data=labels1,aes(x=x,y=y,label=name), size = 10)+
#   theme_void()+
#   theme(axis.title.x = element_blank(),
#         axis.title.y = element_blank(),
#         axis.text.x = element_blank(),
#         axis.text.y = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.ticks.y = element_blank(),
#         plot.margin = grid::unit(c(0.01,0.01,0.01,0.01), &quot;mm&quot;),
#         # rect = element_blank(),
#         panel.margin = grid::unit(c(0.01, 0.01, 0.01, 0.01), &quot;mm&quot;),
#         legend.text.align = 0)

Magno&lt;-ggplot()+
  geom_spatraster_rgb(data = rast(&quot;Data/Pictures/Figure2/Magnoliopsida_cropped2.png&quot;))+
  coord_equal()+
  geom_label(aes(x = 50,y= 950, label = &quot;A&quot;))+
    theme_void()+
  theme(axis.text = element_blank(), 
        axis.title = element_blank(), 
        axis.ticks = element_blank(), 
        axis.ticks.length = unit(0, &quot;pt&quot;),
        panel.grid.major=element_blank(), 
        panel.grid.minor=element_blank(), 
        plot.margin = margin(0, 0, 0, 0, &quot;pt&quot;))

Brown&lt;-ggplot()+
  geom_spatraster_rgb(data = rast(&quot;Data/Pictures/Figure2/Pheophyceae_cropped.png&quot;))+
  coord_equal()+
  geom_label(aes(x = 50,y=450, label = &quot;B&quot;))+
    theme_void()+
  theme(axis.text = element_blank(), 
        axis.title = element_blank(), 
        axis.ticks = element_blank(), 
        axis.ticks.length = unit(0, &quot;pt&quot;),
        panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        plot.margin = margin(0, 0, 0, 0, &quot;pt&quot;))

Red &lt;- ggplot()+
  geom_spatraster_rgb(data = rast(&quot;Data/Pictures/Figure2/Rodophyceae_cropped.png&quot;))+
  coord_equal()+
  geom_label(aes(x = 50,y=450, label = &quot;C&quot;))+
    theme_void()+
  theme(axis.text = element_blank(), 
        axis.title = element_blank(), 
        axis.ticks = element_blank(), 
        axis.ticks.length = unit(0, &quot;pt&quot;),
        panel.grid.major=element_blank(), 
        panel.grid.minor=element_blank(), 
        plot.margin = margin(0, 0, 0, 0, &quot;pt&quot;))


green &lt;- ggplot()+
  geom_spatraster_rgb(data = rast(&quot;Data/Pictures/Figure2/Chlorophyceae_cropped.png&quot;))+
  coord_equal()+
  geom_label(aes(x = 50,y=450, label = &quot;D&quot;))+
    theme_void()+
  theme(axis.text = element_blank(), 
        axis.title = element_blank(), 
        axis.ticks = element_blank(), 
        axis.ticks.length = unit(0, &quot;pt&quot;),
        panel.grid.major=element_blank(), 
        panel.grid.minor=element_blank(), 
        plot.margin = margin(0, 0, 0, 0, &quot;pt&quot;))
  
  

MPB &lt;- ggplot()+
  geom_spatraster_rgb(data = rast(&quot;Data/Pictures/Figure2/Bacillariophyceae_cropped.png&quot;))+
  coord_equal()+
  geom_label(aes(x = 50,y=450, label = &quot;E&quot;))+
  theme_void()+
  theme(axis.text = element_blank(), 
        axis.title = element_blank(), 
        axis.ticks = element_blank(), 
        axis.ticks.length = unit(0, &quot;pt&quot;),
        panel.grid.major=element_blank(), 
        panel.grid.minor=element_blank(), 
        plot.margin = margin(0, 0, 0, 0, &quot;pt&quot;))

layout &lt;- c(
  patchwork::area(t = 10, l = 0, b = 30, r = 10),
    patchwork::area(t = 0, l = 0, b = 10, r = 10),
    patchwork::area(t = 0, l = 10, b = 10, r = 20),
    patchwork::area(t = 0, l = 20, b = 10, r = 30),
    patchwork::area(t = 0, l = 30, b = 10, r = 40),
    patchwork::area(t = 10, l = 10, b = 30, r = 40)
)

layout1 &lt;- c(
  patchwork::area(t = 1, l = 1, b = 20, r = 10),
    patchwork::area(t = 20, l = 1, b = 29, r = 10),
    patchwork::area(t = 20, l = 9, b = 29, r = 18),
    patchwork::area(t = 20, l = 17, b = 29, r = 26),
    patchwork::area(t = 20, l = 25, b = 29, r = 34),
    patchwork::area(t = 1, l = 9, b = 20, r = 34)
)

# plot(layout1)

plot&lt;-Magno+
  Brown+
  Red+
  green+
  MPB+
  sp+
  patchwork::plot_layout(design=layout1)

ggsave(&quot;Figures/Spectral_shapes_total.png&quot;,plot, height = 7, width = 10, dpi = 800)</code>
    </sec>
    <sec id="cell-fig-vegetation-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;Figures/Spectral_shapes_total.png&quot;)</code>
    <fig id="fig-vegetation-nb-article">
      <caption><p>Figure 2: Class of vegetation used to train the CNN
      model and their standardised spectral signature</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Spectral_shapes_total.png" />
    </fig>
    </sec>
  </sec>
  <sec id="intertidal-vegetation-mapping-nb-article">
    <title>2.4 Intertidal vegetation mapping</title>
    <sec id="nb-code-cell-10-nb-article" specific-use="notebook-code">
    <code language="r script">layout&lt;-&quot;Data/Figure2_Workflow&quot; %&gt;%
  list.files(&quot;V4.txt&quot;,full.names = T, recursive = T) %&gt;%
  read_delim(delim = &quot;\t&quot;, escape_double = FALSE,
    trim_ws = TRUE) %&gt;%
  dplyr::filter(Evaluate == T)


layout$Text&lt;- gsub(&quot;alaligne&quot;,&quot;\n&quot;, layout$Text)

boxes&lt;- layout %&gt;% 
  dplyr::filter(Type == &quot;Box&quot;,
                shape == &quot;square&quot;)


text&lt;- layout %&gt;% 
  dplyr::filter(Type == &quot;Box&quot;)

diamonds&lt;- layout %&gt;% 
  dplyr::filter(Type == &quot;Box&quot;,
                shape == &quot;diamond&quot;)
diff = 0.1
for (i in 1:nrow(diamonds)) {
  diam_a&lt;-diamonds[i,]
  
df&lt;-data.frame(  
  x = c(diam_a$xmin - diff, diam_a$xmin + diff, diam_a$xmax + diff, diam_a$xmax - diff),
  y = c(diam_a$ymin, diam_a$ymax, diam_a$ymax, diam_a$ymin),
  Type = rep(diam_a$Type,4),
  Text = rep(diam_a$Text,4),
  Color = rep(diam_a$color,4),
  Evaluate = rep(diam_a$Evaluate,4),
  Resolution =  rep(diam_a$Resolution,4),
  Evaluate_bigbox = rep(diam_a$Evaluate_bigbox,4),
  alpha = rep(diam_a$alpha,4),
  shape =  rep(diam_a$shape,4)
)
  if(i == 1){
    diamond_list&lt;-list(df)
  }else{
    diamond_list[[i]]&lt;-df
  }
}



Arrows&lt;- layout %&gt;% 
  dplyr::filter(Type == &quot;Arrow&quot;,
                Evaluate == T)

Group_box&lt;-layout %&gt;% 
  dplyr::filter(Type == &quot;Box&quot;,
                Evaluate_bigbox == T) %&gt;% 
  group_by(Group) %&gt;% 
  dplyr::summarise(xmin = min(xmin)-0.1,
                   xmax = max(xmax)+0.1,
                   ymin = min(ymin)-0.1,
                   ymax = max(ymax)+0.1,
                   alpha = 0.1,
                   color = color)

resolution_box&lt;-layout %&gt;% 
  dplyr::filter(Type == &quot;Box&quot;,
                Resolution != &quot;NA&quot;) %&gt;% 
  group_by(Resolution) %&gt;% 
  dplyr::summarise(xmin = min(xmin)-0.1,
                   xmax = max(xmax)+0.1,
                   ymin = min(ymin)-0.1,
                   ymax = max(ymax)+0.1,
                   alpha = 0.1,
                   color = color)

legend = data.frame(color = unique(layout$color)) %&gt;% 
  dplyr::filter(!is.na(color)) %&gt;% 
  mutate(label = case_when(color == &quot;#EA6155&quot; ~ &quot;Input Data&quot;,
                           color == &quot;#DC9614&quot; ~ &quot;Pre-processing&quot;,
                           color == &quot;#52A4DA&quot; ~ &quot;Model Building&quot;,
                           color == &quot;#79DA52&quot; ~ &quot;Validation&quot;,
                           color == &quot;#DA9652&quot; ~ &quot;Output Data&quot;,
                           color == &quot;darkcyan&quot; ~ &quot;Final Product&quot;,
                           color == &quot;#DA5273&quot;  ~ &quot;Prediction&quot;,
                           TRUE ~ &quot;NA&quot;)) %&gt;% 
  arrange

segment&lt;-layout %&gt;% 
  dplyr::filter(Type == &quot;Segment&quot;)</code>
    </sec>
    <sec id="nb-code-cell-11-nb-article" specific-use="notebook-code">
    <code language="r script">building &lt;- F

if(building == T){
  
text_size = 6 #### 6 to plot it fullscreen in R,  1.8 for exporting with ggsave
line_size =1 ####arrow_size 0.3 to export  1 to for R plotting

legend_size = 1 #### 0.3 to export, 1 for R ploting
legend_text = 10 #### 4 to export, 10 for R ploting
}else{
  
text_size = 1.85 #### 6 to plot it fullscreen in R,  1.8 for exporting with ggsave
line_size =0.3 ####arrow_size 0.3 to export  1 to for R plotting

legend_size = 0.3 #### 0.3 to export, 1 for R ploting
legend_text = 5 #### 5 to export, 10 for R ploting
  
}


a&lt;-ggplot()+
  
  statebins:::geom_rrect(data = Group_box,
            mapping = aes(xmin = xmin,
                          xmax= xmax,
                          ymin = ymin,
                          ymax = ymax),
            alpha = 0.05,
            size = 0.2,
            show.legend = F,
            fill = Group_box$color,
            color = &quot;black&quot;)+
  
    statebins:::geom_rrect(data = resolution_box,
            mapping = aes(xmin = xmin,
                          xmax= xmax,
                          ymin = ymin,
                          ymax = ymax,
                          alpha = rep(c(&quot;Input Data&quot;, &quot;Pre-processing&quot;, &quot;Model Building&quot;, &quot;Prediction&quot;, &quot;Validation&quot;, &quot;Output Data&quot;, &quot;Final Product&quot;),2)),
            fill = &quot;NA&quot;,
            linetype = 2,
            size = 0.4,
            color = &quot;black&quot;)+
  
  scale_alpha_manual(name = &quot;&quot;, 
                     values = c(1,1,1,1,1,1,1),
                     labels = c(&quot;Input Data&quot;, &quot;Pre-Processing&quot;, &quot;Model Building&quot;, &quot;Prediction&quot;, &quot;Validation&quot;, &quot;Output Data&quot;, &quot;Final Product&quot;),
                     guide = guide_legend(ncol = 1, override.aes = list(fill = c(&quot;#f94144&quot;, &quot;#f3722c&quot;, &quot;#f8961e&quot;, &quot;#f9c74f&quot;, &quot;#90be6d&quot;, &quot;#43aa8b&quot;, &quot;#577590&quot;),
                                                                        shape = c(22),
                                                                        linetype = c(1),
                                                                        alpha = c(0.5)
                                                                        )
                                          )
                     )+
  
  statebins:::geom_rrect(data = boxes,
            mapping = aes(xmin = xmin,
                          xmax= xmax,
                          ymin = ymin,
                          ymax = ymax
                          ),
            size = 0.2,
            alpha = as.numeric(boxes$alpha),
            fill = boxes$color,
            color = &quot;black&quot;)
  
  for(i in 1:length(diamond_list)){
    poly_i&lt;-diamond_list[[i]]
    a&lt;-a+
      geom_polygon(data = poly_i, 
                   mapping = aes(x = x, 
                                 y = y
                                 ),
                  size = 0.2,
                   alpha = poly_i$alpha,
                   fill = poly_i$Color,
                   color = &quot;black&quot;)
    
  }

if(building == T){
    a&lt;-a+
    geom_text(data = text,
            mapping = aes(x = (xmax+xmin)/2, y = (ymax + ymin)/2, label = (ID)), size = text_size)
  
}else{
    a&lt;-a+
    geom_text(data = text,
            mapping = aes(x = (xmax+xmin)/2, y = (ymax + ymin)/2, label = (Text)), size = text_size)
}


  a&lt;-a+
    geom_segment(data = Arrows, aes( x = xmin, xend = xmax, y = ymin, yend = ymax),
    size=line_size, linejoin = &quot;mitre&quot;, lineend = &quot;butt&quot;,
    arrow = arrow(length = unit(1, &quot;mm&quot;), type= &quot;closed&quot;)
    )+
    geom_segment(data = segment, aes( x = xmin, xend = xmax, y = ymin, yend = ymax),
    size=line_size, linejoin = &quot;mitre&quot;, lineend = &quot;square&quot;
    )+
  
  geom_text(aes(x = -5.4, y = -2, label = &quot;Flight height: 12 m \n Pixel size : 8 mm&quot;, angle = 90), size = text_size+1)+
  
  geom_text(aes(x = -5.4, y = -6.8, label = &quot;Flight height: 120 m \n Pixel size : 80 mm&quot;, angle = 90), size = text_size+1)+
  
  geom_text(aes(x = 4, y = 1.75, label = &quot;Pre Processing&quot;), size = text_size)
    
  if(building == F){
  a&lt;- a+ theme_void()
  }
  
  a&lt;-a+
  theme(legend.position = c(0.88,0.3),
        legend.text = element_text(size = legend_text),
        legend.key.size = unit(legend_size, 'cm')
        )+
  scale_x_continuous(breaks = scales::breaks_width(0.5))+
  scale_y_continuous(breaks = scales::breaks_width(0.5))
  
if(building == T){
a
}else{
  ggsave(&quot;Figures/Figure3_workflow.png&quot;,a, width = 1920, height = 1129, units = &quot;px&quot;)
}</code>
    </sec>
    <sec id="cell-fig-workflow-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Figure3_workflow.png&quot;)</code>
    <fig id="fig-workflow-nb-article">
      <caption><p>Figure 3: Schematic representation of the workflow.
      Diamonds represent input or output data, and rectangles represent
      Python processing algorithms. The overall workflow of this study
      is divided into two distinct parts based on the spatial resolution
      of the drone flights: high-resolution flights were utilized for
      training and prediction of the CNN model, whereas low-resolution
      flights were solely employed for prediction
      purposes.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Figure3_workflow.png" />
    </fig>
    </sec>
    <p>The spectral similarities of reflectance signatures between
    intertidal green macrophytes (Magnoliopsida and Chlorophyceae) make
    their discrimination challenging using simple classification
    algorithms
    (<xref alt="Figure 2" rid="fig-vegetation-nb-article">Figure 2</xref> F). To
    overcome this challenge, a deep learning classification method was
    developed, trained, validated, and applied to each drone flight
    (<xref alt="Figure 3" rid="fig-workflow-nb-article">Figure 3</xref>).</p>
    <sec id="neural-network-model-building-nb-article">
      <title>2.4.1 Neural Network model building</title>
      <sec id="nb-code-cell-12-nb-article" specific-use="notebook-code">
      <code language="r script">df_training&lt;-&quot;Data/training/TrainandValid_NewStanRawMetrics.csv&quot; %&gt;% 
  read_delim(delim = &quot;;&quot;, escape_double = FALSE, trim_ws = TRUE) %&gt;% 
  dplyr::filter(True_Class != &quot;Xanthophyceae&quot;,
                True_Class != &quot;Deep_Sediment&quot;,
                True_Class != &quot;Water&quot;,
                True_Class != &quot;SunGlint&quot;,
                True_Class != &quot;Bare_Sediment&quot;) %&gt;% 
  mutate(True_Class = case_when(True_Class == &quot;Clorophyta&quot; ~ &quot;Chlorophyceae&quot;,
                               True_Class == &quot;Rhodphyta&quot; ~ &quot;Rhodophyceae&quot;,
                               True_Class == &quot;MPB&quot; ~ &quot;Bacillariophyceae&quot;,
                               True_Class == &quot;Magnoliosida&quot; ~ &quot;Magnoliopsida&quot;,
                               True_Class == &quot;Phaeophyta&quot; ~ &quot;Phaeophyceae&quot;,
                               True_Class == &quot;Low_SPC&quot; ~ &quot;Magnoliopsida&quot;,
                               TRUE ~ &quot;NA&quot;
                               )) %&gt;% 
  group_by(True_Class) %&gt;% 
  summarise(n = n()) %&gt;% 
  rename(True = &quot;True_Class&quot;, 
         Training_Pixels = &quot;n&quot;)

write.csv(df_training,&quot;Data/training/TrainandValid_NewStanRawMetrics_Processed.csv&quot;,row.names = F)</code>
      </sec>
      <sec id="nb-code-cell-13-nb-article" specific-use="notebook-code">
      <code language="r script">df_training&lt;-read.csv(&quot;Data/training/TrainandValid_NewStanRawMetrics_Processed.csv&quot;)</code>
      </sec>
      <sec id="nb-code-cell-14-nb-article" specific-use="notebook-code">
      <code language="r script">df_validation&lt;-&quot;Data/accuracy_assesment_low&amp;high_flights.csv&quot; %&gt;% 
  read_delim(delim = &quot;,&quot;, escape_double = FALSE, trim_ws = TRUE) %&gt;% 
  dplyr::filter(True != &quot;Sediment&quot;,
                True != &quot;Sun Glint&quot;,
                True != &quot;Water&quot;,
                True != &quot;Xanthophyceae&quot;) %&gt;% 
  mutate(True = case_when(True == &quot;Green Algae&quot; ~ &quot;Chlorophyceae&quot;,
                          True == &quot;Microphytobenthos&quot; ~ &quot;Bacillariophyceae&quot;,
                          True == &quot;Rhodophyceae&quot; ~ &quot;Rhodophyceae&quot;,
                          True == &quot;Pheophyceae&quot; ~ &quot;Phaeophyceae&quot;,
                          TRUE ~ True)) %&gt;% 
  group_by(True) %&gt;% 
  summarise(n = n()) 

write.csv(df_validation,&quot;Data/training/TrainandValid_NewStanRawMetrics_Processed_valid.csv&quot;,row.names = F)</code>
      </sec>
      <sec id="nb-code-cell-15-nb-article" specific-use="notebook-code">
      <code language="r script">df_validation&lt;-read.csv(&quot;Data/training/TrainandValid_NewStanRawMetrics_Processed_valid.csv&quot;)

df_training %&gt;% 
  left_join(df_validation, by = &quot;True&quot;) %&gt;% 
  rename(`Validation Pixels` = &quot;n&quot;,
         Class = &quot;True&quot;,
         `Training Pixels` = &quot;Training_Pixels&quot;) %&gt;% 
  flextable() %&gt;% 
  # border_remove() %&gt;%
  flextable::align(align = &quot;center&quot;,part = &quot;all&quot;) %&gt;%
  flextable::align(align = &quot;center&quot;,part = &quot;header&quot;) %&gt;% 
  set_table_properties(layout = &quot;autofit&quot;) </code>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table2-1.png" />
      </sec>
      <p>A dataset containing photo-interpreted drone reflectance pixels
      was built to train a Convolutional Neural Network (CNN) model with
      2 hidden layers. The training pixels were categorized into 7
      different classes, representing the various habitats encountered
      at the different study sites: Sediment, Water, Chlorophyceae,
      Magnoliopsida, Bacillariophyceae, Phaeophyceae and Rhodophyceae.
      Only low-altitude flights (Table 1) were used for training
      purposes because of their 8 mm spatial resolution allowing to
      avoid spectral sub-pixel mixing and to accurately visually
      differentiate various vegetation classes. More than 418,000 pixels
      at 8 mm resolution from the 3 training flights have been used to
      train the model (Table 2). Twenty one variables were used by the
      model as predictors: 10 raw spectral bands of the Micasense
      RedEdge Dual MX multispectral camera (ranging from 444 nm to 840
      nm), the same 10 spectral bands standardized using a min/max
      transformation
      (<xref alt="Equation 1" rid="eq-std-nb-article">Equation 1</xref> ;
      (<xref alt="cao2017?" rid="ref-cao2017-nb-article" ref-type="bibr"><bold>cao2017?</bold></xref>))
      and the NDVI
      (<xref alt="Equation 2" rid="eq-ndvi-nb-article">Equation 2</xref>).
      Standardisation of spectral bands is used to eliminate the scaling
      differences between spectra and to limit the effect of biomass on
      the shape of the spectra
      (<xref alt="Douay et al. 2022" rid="ref-Douay2022-nb-article" ref-type="bibr">Douay
      et al. 2022</xref> ;
      <xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023-nb-article" ref-type="bibr">Davies,
      Gernez, et al. 2023</xref>).</p>
      <p><styled-content id="eq-std-nb-article"><disp-formula><alternatives>
      <tex-math><![CDATA[
      R_{i}^{*}(\lambda) = \frac{R_{i}(\lambda) - min(R_{i})}{max(R_{i})- min(R_{i})}
       \qquad(1)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R_{i}(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at the wavelength
      <inline-formula><alternatives>
      <tex-math><![CDATA[(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      of each individual spectra <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives>
      <tex-math><![CDATA[min(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives>
      <tex-math><![CDATA[max(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      are the minimum and maximum value of the spectra
      <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p><styled-content id="eq-ndvi-nb-article"><disp-formula><alternatives>
      <tex-math><![CDATA[
      NDVI = \frac{R(840nm)-R(668nm)}{R(840nm)+R(668nm)}
       \qquad(2)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R(840nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 840 nm and <inline-formula><alternatives>
      <tex-math><![CDATA[R(668nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 668 nm.</p>
    </sec>
    <sec id="validation-nb-article">
      <title>2.4.2 Validation</title>
      <sec id="nb-code-cell-16-nb-article" specific-use="notebook-code">
      <code language="r script">df&lt;-&quot;Output/Validation_data&quot; %&gt;% 
  list.files(&quot;ResultsNewNN_NoXanthowithNDVIWithOldandBoat.csv&quot;,recursive = T, full.names = T) %&gt;% 
  read.csv() %&gt;% 
  as_tibble() %&gt;% 
  rename(Truth_ID = &quot;Truth&quot;) %&gt;% 
  mutate(Truth =  case_when(Truth_ID == 1 ~ &quot;Bare_Sediment&quot;,
                          Truth_ID == 2 ~ &quot;Chlorophyta&quot;,
                          Truth_ID == 3 ~ &quot;Bare_Sediment&quot;,
                          Truth_ID == 4 ~ &quot;Magnoliosida&quot;,
                          Truth_ID == 5 ~ &quot;Bare_Sediment&quot;,
                          Truth_ID == 6 ~ &quot;Magnoliosida&quot;,
                          Truth_ID == 7 ~ &quot;Phaeophyta&quot;,
                          Truth_ID == 8 ~ &quot;Rhodphyta&quot;,
                          Truth_ID == 9 ~ &quot;SunGlint&quot;,
                          Truth_ID == 10 ~ &quot;Water&quot;,
                          Truth_ID == 11 ~ &quot;Xanthophyceae&quot;,
                          Truth_ID == 12 ~ &quot;Spartina&quot;,
                          Truth_ID == 41 ~ &quot;Bleached seagrasses&quot;,
                          TRUE ~ &quot;NA&quot;),
         Pred_Class = case_when(Pred_Class == &quot;Clorophyta&quot; ~ &quot;Chlorophyta&quot;,
                                Pred_Class == &quot;Rhodphyta&quot; ~ &quot;Rhodphyta&quot;,
                                Pred_Class == &quot;Deep_Sediment&quot; ~ &quot;Bare_Sediment&quot;,
                                Pred_Class == &quot;MPB&quot; ~ &quot;Bare_Sediment&quot;,
                                (Pred_Class == &quot;Low_SPC&quot; &amp; NDVI &gt; 0.2) ~ &quot;Magnoliosida&quot;,
                                (Pred_Class == &quot;Low_SPC&quot; &amp; NDVI &lt;= 0.2 )~ &quot;Bare_Sediment&quot;,
                          TRUE ~ Pred_Class)) %&gt;% 
  dplyr::filter(Truth != &quot;Water&quot;,
                Truth  != &quot;Spartina&quot;,
                Truth != &quot;SunGlint&quot;,
                Truth != &quot;Bleached seagrasses&quot;,
                Truth != &quot;Xanthophyceae&quot;,
                # Pred_Class != &quot;Low_SPC&quot;,
                Pred_Class != &quot;Xanthophyceae&quot;,
                 Pred_Class != &quot;Water&quot;,
                 Pred_Class != &quot;SunGlint&quot;,
                !Flight == &quot;Handfisher_1_old&quot;,
                !Flight == &quot;Handfisher_2_old&quot;,
                !Flight == &quot;Handfisher_2&quot;) %&gt;%
  dplyr::select(-NDVI)



count_validation_pixel&lt;-nrow(df)
write.csv(count_validation_pixel,&quot;Output/count_validation_pixel.csv&quot;, row.names = F)</code>
      </sec>
      <sec id="nb-code-cell-17-nb-article" specific-use="notebook-code">
      <code language="r script">count_validation_pixel&lt;-read.csv(&quot;Output/count_validation_pixel.csv&quot;) %&gt;% 
  pull(x)</code>
      </sec>
      <p>The CNN model was applied to all the 9 flights at both 12 and
      120 m of altitude. In situ information on georeferenced class type
      and percent cover collected during each flight has been used to
      assess the CNN accuracy. These images were used to construct a
      validation dataset indicating the presence or absence of each
      class. Additionally to the quadrat-based validation dataset,
      polygons of each class were photo interpreted in order to increase
      the number of pixels of the validation dataset. A confusion
      matrix, along with precision metrics such as the global accuracy,
      the sensitivity, the specificity, and the Kappa coefficient, was
      generated for each of the study sites. Finally each validation
      matrix has been merge to create a unique matrix of the model. A
      total of 536,000 pixels has been used to globally validate the CNN
      model.</p>
    </sec>
  </sec>
</sec>
<sec id="results-nb-article">
  <title>3. Results</title>
  <sec id="classification-nb-article">
    <title>3.1 Classification</title>
    <p>A total of 9 prediction maps corresponding to the 9 drone flights
    were obtained. Each prediction map is associated with a probability
    map, indicating the probability of the selected class for every
    pixel. The low-altitude flight conducted in Gafanaha, Portugal,
    represents the site with the highest complexity
    (<xref alt="Figure 4" rid="fig-GafLow-nb-article">Figure 4</xref>). Among the 5
    vegetation classes on which the CNN model was trained, 4 were
    present on this site. On this site, there is a mixture of
    Chlorophyceae and Rhodophyceae over the seagrass meadow. This is
    also where Bacillariophyceae is most abundant. Although the seagrass
    bed is solely composed of <italic>Zostera noltei</italic>, various
    colors can be observed: dark green (indicating healthy beds with
    100% coverage) and whitish/brown (indicating beds where leaves are
    dying). Regardless of the color, the meadow is predicted as
    Magnoliopsida by the CNN model.</p>
    <sec id="nb-code-cell-18-nb-article" specific-use="notebook-code">
    <code language="r script">imglist&lt;-
  data.frame(path = list.files(pattern = &quot;.tif&quot;, recursive = T, full.names = T)) %&gt;% 
  mutate(folder = case_when(str_detect(path, &quot;Data&quot;) ~ &quot;Input&quot;,
                            TRUE ~ &quot;Output&quot;),
         alt = case_when(str_detect(path, &quot;high&quot;) ~ &quot;high&quot;,
                         TRUE ~ &quot;low&quot;),
         site = case_when(str_detect(path, &quot;Gafanha&quot;) ~ &quot;Gafanha&quot;,
                          TRUE ~ &quot;Duer&quot;),
         type = case_when(str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;NDVI&quot;) ~ &quot;NDVI&quot;,
                          TRUE ~ &quot;ortho&quot;),
         resampled = case_when(str_detect(path, &quot;resampled&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         new = case_when(str_detect(path, &quot;no_Xantho&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         col = case_when(str_detect(path, &quot;colored&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         correction = case_when(str_detect(path, &quot;corrected_per_bands&quot;) ~ &quot;Bands&quot;,
                          str_detect(path, &quot;corrected.tif&quot;) ~ &quot;lm_all&quot;,
                          TRUE ~ &quot;NA&quot;)) %&gt;% 
  dplyr::filter(alt != &quot;NA&quot;,
                !str_detect(path,&quot;.aux.xml&quot;))

shp_roi&lt;-&quot;Data/reflectance_calibration_low_&amp;_high_flights/&quot; %&gt;%
  list.files(pattern = &quot;.shp&quot;, recursive = T, full.names = T) %&gt;%
  read_sf() %&gt;%
  mutate(ID = case_when(name == &quot;Microphytobenthos&quot; ~ 1,
                        name == &quot;ZOS&quot; ~ 2,
                        name == &quot;BL&quot; ~ 3,
                        name == &quot;SED&quot; ~ 4,
                        name == &quot;GRE&quot; ~ 5,
                        name == &quot;RED&quot; ~ 6,
                        name == &quot;Xanthophyceae&quot; ~ 7)) %&gt;% 
  as(&quot;Spatial&quot;) %&gt;% 
  vect()


zoom_extent&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom_extent_map_Gafanha_comparison&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

background_GafHigh&lt;-&quot;Data/shp/Aveiro&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;background_Gafanha_high&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()
###### Preview ###########

filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_aveiro &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_Aveiro&quot;)] %&gt;% 
  read_sf()

Flight_aveiro&lt;-data.frame(
  Name=c(
  &quot;Gafanha&quot;
  ) ,
  Description = c(&quot;12m and 120m Flights&quot;),
  Long=c(-8.742485) ,
  Lat=c(40.597599) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_aveiro))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)


p1_background&lt;- read_sf(&quot;Data/shp/Aveiro/Background_p1_aveiro.shp&quot;)

p1&lt;-ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#BDBDBD&quot;))+
  geom_sf(data = p1_background, fill = &quot;white&quot;,show.legend = F, linewidth=0.05,alpha=0.93,colour=&quot;transparent&quot;)+
  geom_sf(data = mask_aveiro, mapping = aes(fill = Type),show.legend = F, linewidth=0.05,alpha=0.93,colour=&quot;grey30&quot;)+

      coord_sf(xlim=c(519749,535233) ,
          ylim=c(4493310,4508794) )+
  ggforce::geom_mark_ellipse(data=Flight_aveiro,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 label.fontsize = 18,
                 label.hjust = 0.5,
                 con.size = 2,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
    # theme_void()+
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  # geom_label(aes(x = 521000, y = 4507794, label = &quot;C&quot;), size = 20)+
  scale_x_continuous(breaks = seq(-8.75, -8.6, by = 0.1))+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;) ,
        legend.position = &quot;none&quot;,
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))+
  theme_void()
######### RGB #########
 Gafanha_low_ortho&lt;-imglist %&gt;% 
  filter(site == &quot;Gafanha&quot;,
         alt == &quot;low&quot;,
         type == &quot;ortho&quot;,
         resampled == &quot;TRUE&quot;,
         col == &quot;TRUE&quot;) %&gt;%
  pull(path) %&gt;% 
  rast() 
 names(Gafanha_low_ortho)&lt;-c(&quot;B1&quot;, &quot;B3&quot;, &quot;B5&quot;,&quot;alpha&quot;)

 values(Gafanha_low_ortho)[values(Gafanha_low_ortho$alpha) == 0] = NA
  
 Gafanha_low_ortho_zoomed&lt;-Gafanha_low_ortho %&gt;% 
   crop(zoom_extent)
 
 
 map_extent_full&lt;- st_as_sf(as.polygons(ext(Gafanha_low_ortho)))
 sf::st_crs(map_extent_full)&lt;-st_crs(Gafanha_low_ortho)
 

  map_extent_zommed&lt;- st_as_sf(as.polygons(ext(Gafanha_low_ortho_zoomed)))
 sf::st_crs(map_extent_zommed)&lt;-st_crs(Gafanha_low_ortho_zoomed)
 
 
 rgb_Gafanha_low_zoomed&lt;-ggplot()+
   tidyterra::geom_spatraster_rgb(data = Gafanha_low_ortho_zoomed, 
                                  r = 3,
                                  g = 2,
                                  b = 1)+
   theme_Bede_Map()+
   geom_sf(data = zoom_extent, fill = &quot;transparent&quot;, colour = &quot;black&quot;,linetype = &quot;dashed&quot;, linewidth = 1)+
   coord_sf(crs = 4326)+
     theme_void()



 scale_labels&lt;-data.frame(x = c(-8.74368, -8.743565,-8.74342),
                          y = c(rep(40.59792,3)),
                          text = c(&quot;0&quot;,&quot;10&quot;,&quot;20 m&quot;))
 
 
 
  rgb_Gafanha_low&lt;- ggplot()+
  scale_fill_manual(&quot;&quot;, 
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  geom_sf(data = background_GafHigh,
          fill = &quot;white&quot;,
          show.legend = F,
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;white&quot;)+
  geom_sf(data = background_GafHigh,
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;grey30&quot;)+
   tidyterra::geom_spatraster_rgb(data = Gafanha_low_ortho,
         r = 1,
         g = 2,
         b = 3,
         maxcell = 4010533
         )+
    ggspatial::annotation_scale(location = &quot;tl&quot;,
                                text_cex=2)+
      annotation_custom(ggplotGrob(p1),
                        xmin = -8.7430,
                        xmax = -8.742702,
                        ymin = 40.5970515, 
                        ymax = 40.5974) +
   theme_Bede_Map()+
   geom_sf(data = zoom_extent, 
           fill = &quot;transparent&quot;,
           colour = &quot;black&quot;,
           linetype = &quot;dashed&quot;, 
           linewidth = 1)+
   coord_sf(crs = 4326)+
  annotation_custom(ggplotGrob(rgb_Gafanha_low_zoomed),
                    xmin = -8.7430,
                    xmax=-8.7427,
                    ymin = 40.5977) +
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.7432439,-8.743,-8.7432439,-8.743),
                              y=c(40.5976275,40.5979,40.5975373,40.59771),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, linewidth = 1)+
  theme(axis.title = element_blank(),
        axis.text.y = element_text(size = 20),
        axis.text.x = element_text(size = 20, angle = 20, hjust = 1))+
    scale_x_continuous(limits = c(-8.7437, -8.74275), breaks = -8.743)+
    scale_y_continuous(limits = c(40.59715, 40.5979), breaks = 40.5975)

 
 
  
  

ggsave(&quot;Figures/Gaf_Low_RGB.png&quot;,rgb_Gafanha_low , width = 1920*4, height = 1129*4, units = &quot;px&quot;)

zoom_extent&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom_extent_map_Gafanha_comparison&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

####### Zoomed map ########


Gafanha_low_pred_zoomed&lt;-imglist %&gt;% 
filter(site == &quot;Gafanha&quot;,
       alt == &quot;low&quot;,
       type == &quot;Pred&quot;,
       resampled == &quot;FALSE&quot;,
       folder == &quot;Input&quot;,
       new == &quot;TRUE&quot;) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Gafanha_low_pred_zoomed)&lt;-&quot;layer&quot;

Gafanha_low_pred_zoomed&lt;-Gafanha_low_pred_zoomed %&gt;% 
  crop(zoom_extent)
Gafanha_low_pred_zoomed&lt;-as.factor(Gafanha_low_pred_zoomed)

Gafanha_low_pred_map_zoomed&lt;-ggplot()+
  tidyterra::geom_spatraster(data = Gafanha_low_pred_zoomed, mapping = aes(fill = layer))+
  geom_sf(data = zoom_extent, fill = &quot;transparent&quot;, colour = &quot;black&quot;,linetype = &quot;dashed&quot;, linewidth = 1)+
  coord_sf(crs = 4326)+
  scale_fill_manual(values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;,&quot;#70543e&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, NA, &quot;#42c9bc&quot;), na.value = NA)+
  theme_void()+
  # coord_equal()+
  theme(axis.text.x = element_blank(),
      axis.text.y = element_blank(),
      axis.title = element_blank())+
  theme(legend.position = &quot;none&quot;)
 # Gafanha_low_pred_map_zoomed

####  Overall map
Gafanha_low_pred&lt;-imglist %&gt;% 
filter(site == &quot;Gafanha&quot;,
       alt == &quot;low&quot;,
       type == &quot;Pred&quot;,
       # resampled == &quot;TRUE&quot;,
       new == &quot;TRUE&quot;) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Gafanha_low_pred)&lt;-&quot;layer&quot;


values(Gafanha_low_pred)[values(Gafanha_low_pred) == 0] = NA

Gafanha_low_pred&lt;-Gafanha_low_pred %&gt;% 
  as.factor()

####### Pred ######


Gafanha_low_pred_map &lt;-
  ggplot()+
  scale_fill_manual(&quot;&quot;, 
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  geom_sf(data = background_GafHigh,
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;grey30&quot;)+
  # geom_sf(data = background_GafHigh,
  #         fill = &quot;white&quot;,
  #         show.legend = F, 
  #         linewidth=0.05,
  #         alpha=1,
  #         colour=&quot;white&quot;)+
   ggnewscale::new_scale(&quot;fill&quot;)+
    tidyterra::geom_spatraster(data = Gafanha_low_pred, 
                               mapping = aes(fill = layer),
                               maxcell = 500832*8)+
  geom_sf(data = zoom_extent, 
          fill = &quot;transparent&quot;, 
          colour = &quot;black&quot;,
          linetype = &quot;dashed&quot;, 
          linewidth = 1)+
  coord_sf(crs = 4326)+
  annotation_custom(ggplotGrob(Gafanha_low_pred_map_zoomed), 
                    xmin = -8.7430,
                    xmax=-8.7427, 
                    ymin = 40.5977) +
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.7432439,-8.743,-8.7432439,-8.743),
                              y=c(40.5976275,40.5979,40.5975373,40.59771),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, linewidth = 1)+
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA,NA,NA),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorophyceae&quot;,
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
  theme_Bede_Map()+
  # coord_equal()+
   theme(axis.text.x = element_text(size = 20, angle = 20,hjust = 1),
         # axis.text.y = element_text(size = 20),
         axis.text.y = element_blank(),
         axis.title = element_blank(),
         legend.background = element_blank(),
         legend.position = c(0.98,0.3),
         legend.text = element_text(size = 20),
         legend.key.size = unit(1,&quot;cm&quot;))+
    scale_x_continuous(limits = c(-8.7437, -8.74275), breaks = -8.743)+
    scale_y_continuous(limits = c(40.59715, 40.5979), breaks = 40.5975)


ggsave(&quot;Figures/Gaf_Low_Pred.png&quot;,Gafanha_low_pred_map , width = 1920*4, height = 1129*4, units = &quot;px&quot;)

################# PLOT AND SAVING ###########

plot_Gaf_Low&lt;-rgb_Gafanha_low+
  Gafanha_low_pred_map
 



ggsave(&quot;Figures/Maps Pred/FigX-Gaf_Low_Pred.png&quot;,plot_Gaf_Low , width = 1920*4, height = 1009*4, units = &quot;px&quot;)</code>
    </sec>
    <sec id="cell-fig-GafLow-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Maps Pred/FigX-Gaf_Low_Pred.png&quot;)</code>
    <fig id="fig-GafLow-nb-article">
      <caption><p>Figure 4: RGB orthomosaic (Left) and Prediction
      (Right) of the low altitude flight of Gafanaha, Portugal. The
      total extent of this flight is 3000m² with a resolution of 8 mm
      per pixel. Background colors means intertidal area (Light Green)
      and land area (Light Grey). The zoom covers an area equivalent to
      a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_Low_Pred.png" />
    </fig>
    </sec>
    <sec id="nb-code-cell-19-nb-article" specific-use="notebook-code">
    <code language="r script">imglist&lt;-
  data.frame(&quot;Data&quot;,
             path = list.files(pattern = &quot;.tif&quot;, recursive = T, full.names = T)) %&gt;% 
  mutate(folder = case_when(str_detect(path, &quot;Data&quot;) ~ &quot;Input&quot;,
                            TRUE ~ &quot;Output&quot;),
         alt = case_when(str_detect(path, &quot;high&quot;) ~ &quot;high&quot;,
                         str_detect(path, &quot;High&quot;) ~ &quot;high&quot;,
                         TRUE ~ &quot;low&quot;),
         site = case_when(str_detect(path, &quot;Gafanha&quot;) ~ &quot;Gafanha&quot;,
                          str_detect(path,&quot;AveiroHigh&quot;)~&quot;Gafanha&quot;,
                          TRUE ~ &quot;Duer&quot;),
         type = case_when(str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;NDVI&quot;) ~ &quot;NDVI&quot;,
                          TRUE ~ &quot;ortho&quot;),
         resampled = case_when(str_detect(path, &quot;resampled&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         new = case_when(str_detect(path, &quot;no_Xantho&quot;) ~ &quot;TRUE&quot;,
                         str_detect(path, &quot;NewPreds&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         col = case_when(str_detect(path, &quot;colored&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         correction = case_when(str_detect(path, &quot;corrected_per_bands&quot;) ~ &quot;Bands&quot;,
                          str_detect(path, &quot;corrected.tif&quot;) ~ &quot;lm_all&quot;,
                          TRUE ~ &quot;NA&quot;)) %&gt;% 
  dplyr::filter(alt != &quot;NA&quot;,
                !str_detect(path,&quot;.aux.xml&quot;))

########## ZOOM #############

zoom_extent&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

mask_low&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;mask_Gafanha_low&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

Gafanha_low_ortho_zoomed&lt;-imglist %&gt;% 
  filter(site == &quot;Gafanha&quot;,
         alt == &quot;low&quot;,
         type == &quot;ortho&quot;,
         resampled == &quot;TRUE&quot;,
         col == &quot;TRUE&quot;) %&gt;%
  pull(path) %&gt;% 
  rast() %&gt;% 
  crop(zoom_extent)

names(Gafanha_low_ortho_zoomed)&lt;-c(&quot;B1&quot;, &quot;B3&quot;, &quot;B5&quot;,&quot;alpha&quot;)

 Gafanha_low_pred_zoomed&lt;-imglist %&gt;% 
  filter(site == &quot;Gafanha&quot;,
         alt == &quot;low&quot;,
         type == &quot;Pred&quot;,
         # resampled == &quot;TRUE&quot;,
         new == &quot;TRUE&quot;) %&gt;% 
  pull(path) %&gt;% 
  rast() %&gt;% 
  crop(zoom_extent) %&gt;% 
  mask(mask_low, inverse = T) %&gt;% 
   as.factor()
   
names(Gafanha_low_pred_zoomed)&lt;-&quot;layer&quot;

zoomed_low_map&lt;-ggplot()+
  tidyterra::geom_spatraster_rgb(data = Gafanha_low_ortho_zoomed,
                                 r = 1,
                                 g = 2,
                                 b = 3)+
  tidyterra::geom_spatraster(data = Gafanha_low_pred_zoomed, mapping = aes(fill = layer), show.legend = F)+
  
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA), 
                    na.value = NA,
                    name = &quot;&quot;, 
                    labels = c(&quot;Sediment&quot;, 
                               &quot;Chlorophyceae&quot;, 
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
  geom_sf(data = zoom_extent, fill = &quot;transparent&quot;, colour = &quot;black&quot;,linetype = &quot;dashed&quot;, linewidth = 2)+
  theme(legend.position = &quot;none&quot;)+
  theme_void()



#############

 Gafanha_low_ortho&lt;-imglist %&gt;% 
  filter(site == &quot;Gafanha&quot;,
         alt == &quot;low&quot;,
         type == &quot;ortho&quot;,
         resampled == &quot;TRUE&quot;,
         col == &quot;TRUE&quot;) %&gt;%
  pull(path) %&gt;% 
  rast() 
 names(Gafanha_low_ortho)&lt;-c(&quot;B1&quot;, &quot;B3&quot;, &quot;B5&quot;,&quot;alpha&quot;)
values(Gafanha_low_ortho)[values(Gafanha_low_ortho$alpha) == 0] = NA

 
 Gafanha_low_pred&lt;-imglist %&gt;% 
  filter(site == &quot;Gafanha&quot;,
         alt == &quot;low&quot;,
         type == &quot;Pred&quot;,
         # resampled == &quot;TRUE&quot;,
         new == &quot;TRUE&quot;) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Gafanha_low_pred)&lt;-&quot;layer&quot;

Gafanha_low_pred_masked&lt;-Gafanha_low_pred %&gt;% 
  # crop(mask_low) %&gt;% 
  mask(mask_low, inverse = T)

values(Gafanha_low_pred_masked)[values(Gafanha_low_pred_masked) == 0] = NA

Gafanha_low_pred_masked&lt;-Gafanha_low_pred_masked %&gt;% 
  as.factor()

rgb_Gafanha_low &lt;- ggplot()+
  tidyterra::geom_spatraster_rgb(data = Gafanha_low_ortho,
                                 r = 1,
                                 g = 2,
                                 b = 3)+
  tidyterra::geom_spatraster(data = Gafanha_low_pred_masked, mapping = aes(fill = layer))+
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA), 
                    na.value = NA,
                    name = &quot;&quot;, 
                    labels = c(&quot;Sediment&quot;, 
                               &quot;Chlorophyceae&quot;, 
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
  ggspatial::annotation_scale(location = &quot;bl&quot;,text_cex=2)+
  geom_sf(data = zoom_extent, fill = &quot;transparent&quot;, colour = &quot;black&quot;,linetype = &quot;dashed&quot;, linewidth = 1)+

  geom_segment(aes(x = -8.7434247325, y=40.5977530006, xend = -8.7430558162, yend = 40.5972152706), linetype =&quot;dashed&quot; ,linewidth=2)+
  annotation_custom(ggplotGrob(zoomed_low_map), xmin = -8.743725, xmax = -8.7434057328, ymin = 40.5977200450, ymax = 40.59798) +
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.74336194,-8.74371,-8.743243794,-8.7434057328), y=c(40.59762751,40.5977400850,40.59762725,40.5977200450),grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, linewidth = 1)+
  theme_Bede_Map()+
  coord_sf(crs = 4326)+
  theme(axis.title = element_blank(),
        axis.text.y = element_text(size = 20),
        axis.text.x = element_text(size = 20, angle = 20,hjust = 1),
        legend.position=c(0.3, 0.3))+
  # ggtitle(&quot;a &quot;)+
  scale_x_continuous(breaks=seq(-8.7437, -8.7430, 0.0002))
rgb_Gafanha_low

ggsave(&quot;Figures/Gaf_Low_RGB_Pred_V2.png&quot;,rgb_Gafanha_low , width = 890*4, height = 1120*4, units = &quot;px&quot;)</code>
    </sec>
    <p>The high-altitude flight over Gafanha covered nearly 1 km² in
    total (<xref alt="Figure 5" rid="fig-GafHigh-nb-article">Figure 5</xref>). A
    channel delineating a small island was present in the flight, but it
    has been masked in the prediction map due to glinting and
    misclassification caused by the turbid shallow water. Most of the
    intertidal area has been classified as Magnoliopsida by the model,
    even though there is discoloration of seagrass blades. Only a few
    pixels have been classified as Chlorophyceae at this scale.
    Furthermore, the area that was classified as Bacillariophyceae in
    the low-altitude flight remains mostly classified as such in the
    high-altitude flight, but some pixels of it are now classified as
    Magnoliopsida. The patches of Rhodophyceae are still well
    classified. <italic>Spartina sp.</italic> was present in the
    northern part of the flight, near the land, and has been classified
    either as Magnoliopsida or as Phaeophyceae.</p>
    <sec id="nb-code-cell-20-nb-article" specific-use="notebook-code">
    <code language="r script">imglist&lt;-
  data.frame(path = list.files(pattern = &quot;.tif&quot;, recursive = T, full.names = T)) %&gt;% 
  mutate(folder = case_when(str_detect(path, &quot;Data&quot;) ~ &quot;Input&quot;,
                            TRUE ~ &quot;Output&quot;),
         alt = case_when(str_detect(path, &quot;high&quot;) ~ &quot;high&quot;,
                         str_detect(path, &quot;High&quot;) ~ &quot;high&quot;,
                         TRUE ~ &quot;low&quot;),
         site = case_when(str_detect(path, &quot;Gafanha&quot;) ~ &quot;Gafanha&quot;,
                          str_detect(path, &quot;AveiroHigh&quot;) ~ &quot;Gafanha&quot;,
                          TRUE ~ &quot;Duer&quot;),
         type = case_when(str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;Preds&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;NDVI&quot;) ~ &quot;NDVI&quot;,
                          TRUE ~ &quot;ortho&quot;),
         resampled = case_when(str_detect(path, &quot;resampled&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         new = case_when(str_detect(path, &quot;no_Xantho&quot;) ~ &quot;TRUE&quot;,
                         str_detect(path, &quot;NewPreds&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         col = case_when(str_detect(path, &quot;colored&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         correction = case_when(str_detect(path, &quot;corrected_per_bands&quot;) ~ &quot;Bands&quot;,
                          str_detect(path, &quot;corrected.tif&quot;) ~ &quot;lm_all&quot;,
                          TRUE ~ &quot;NA&quot;)) %&gt;% 
  dplyr::filter(alt != &quot;NA&quot;,
                !str_detect(path,&quot;.aux.xml&quot;))

#### Preview ####

filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_aveiro &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_Aveiro&quot;)] %&gt;% 
  read_sf()

Flight_aveiro&lt;-data.frame(
  Name=c(
  &quot;Gafanha&quot;
  ) ,
  Description = c(&quot;12m and 120m Flights&quot;),
  Long=c(-8.742485) ,
  Lat=c(40.597599) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_aveiro))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)

p1_background&lt;- read_sf(&quot;Data/shp/Aveiro/Background_p1_aveiro.shp&quot;)

p1&lt;-ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#BDBDBD&quot;))+
  geom_sf(data = p1_background, fill = &quot;white&quot;,show.legend = F, linewidth=0.05,alpha=0.93,colour=&quot;transparent&quot;)+
  geom_sf(data = mask_aveiro, mapping = aes(fill = Type),show.legend = F, linewidth=0.05,alpha=0.93,colour=&quot;grey30&quot;)+
      coord_sf(xlim=c(519749,535233) ,
          ylim=c(4493310,4508794) )+
  ggforce::geom_mark_ellipse(data=Flight_aveiro,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 label.fontsize = 20,
                 label.hjust = 0.5,
                 con.size = 2,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
    # theme_void()+
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  # geom_label(aes(x = 521000, y = 4507794, label = &quot;C&quot;), size = 20)+
  scale_x_continuous(breaks = seq(-8.75, -8.6, by = 0.1))+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;) ,
        legend.position = &quot;none&quot;,
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))+
  theme_void()

#####

land_mask_GafHigh&lt;-&quot;Data/shp/Aveiro&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;mask_Gafanha_high1&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

background_GafHigh&lt;-&quot;Data/shp/Aveiro&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;background_Gafanha_high&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

GafHigh_ortho&lt;-imglist %&gt;% 
  dplyr::filter(site == &quot;Gafanha&quot;,
                type == &quot;ortho&quot;,
                alt==&quot;high&quot;,
                col == &quot;TRUE&quot;) %&gt;%
  pull(path) %&gt;% 
  rast()
names(GafHigh_ortho)&lt;-c(&quot;B1&quot;,&quot;B3&quot;, &quot;B5&quot;, &quot;alpha&quot;)

# values(GafHigh_ortho)[values(GafHigh_ortho$B1) == 0] = NA

GafHigh_ortho_masked&lt;-GafHigh_ortho %&gt;% 
  mask(land_mask_GafHigh, inverse = F) %&gt;% 
  crop(land_mask_GafHigh)

GafHigh_ortho_masked&lt;-na.omit(GafHigh_ortho_masked, field=NA, geom=FALSE)


###### RGB ########
zoom_gaf_high_sf&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom_extent_map_Gafanha_High_comparison&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

Gaflow_extent&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;GafLow_extent.shp&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

rgb_Gafanha_High_zoomed&lt;-GafHigh_ortho_masked %&gt;% 
  crop(zoom_gaf_high_sf)

rgb_Gafanha_High_zoomed&lt;-
  ggplot()+
  tidyterra::geom_spatraster_rgb(data = rgb_Gafanha_High_zoomed,
         r = 1,
         g = 2,
         b = 3)+
     geom_sf(data = zoom_gaf_high_sf, fill = &quot;transparent&quot;, colour = &quot;black&quot;,linetype = &quot;dashed&quot;, linewidth = 1)+
  theme_void()

  
  

rgb_Gafanha_High &lt;- ggplot()+
  scale_fill_manual(&quot;&quot;,  
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  geom_sf(data = background_GafHigh,
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.93,
          colour=&quot;grey30&quot;)+
  geom_sf(data = background_GafHigh,
          fill = &quot;white&quot;,
          show.legend = F,
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;white&quot;)+
   tidyterra::geom_spatraster_rgb(data = GafHigh_ortho_masked,
         r = 1,
         g = 2,
         b = 3,
         maxcell = 5007120)+
    ggspatial::annotation_scale(location = &quot;bl&quot;,
                                text_cex=2)+
    annotation_custom(ggplotGrob(p1), 
                      xmin = -8.744, 
                      xmax = -8.7412,
                      ymin = 40.5923,
                      ymax = 40.595) +
    geom_sf(data = zoom_gaf_high_sf,
            fill = &quot;transparent&quot;, 
            colour = &quot;black&quot;,
            linetype = &quot;dashed&quot;, 
            linewidth = 1)+
    geom_sf(data = Gaflow_extent,
            fill = &quot;transparent&quot;, 
            colour = &quot;red&quot;,
            linetype = &quot;dashed&quot;, 
            linewidth = 2)+
    geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.74363778,-8.74757,-8.74351982,-8.7453), 
                              y=c(40.5983781677,40.5995,40.598377893,40.5995),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, 
            linewidth = 1)+
  annotation_custom(ggplotGrob(rgb_Gafanha_High_zoomed),
                    xmin = -8.7479, 
                    xmax = -8.7452, 
                    ymin = 40.5979,
                    ymax = 40.603) +
   theme_Bede_Map()+
   coord_sf(crs = 4326)+
   # xlim(c(-8.748, -8.741))+
  # ylim(c(40.593,40.601))+
  theme(axis.title = element_blank(),
         axis.text.x = element_text(size = 20, angle = 20, hjust = 1),
         axis.text.y = element_text(size = 20))+
  scale_x_continuous(limits = c(-8.747576, -8.741465),breaks =  -8.745)+
  scale_y_continuous(limits = c(40.59297,40.60109),breaks =  40.595)
# rgb_Gafanha_High

ggsave(&quot;Figures/Gaf_High_RGB.png&quot;,rgb_Gafanha_High , width = 712*4, height = 1120*4, units = &quot;px&quot;)




######### Pred #######
Gafanha_high_pred&lt;-imglist %&gt;% 
filter(site == &quot;Gafanha&quot;,
       alt == &quot;high&quot;,
       type == &quot;Pred&quot;,
       new == &quot;TRUE&quot;,
       !str_detect(path, &quot;Probs&quot;)) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Gafanha_high_pred)&lt;-&quot;layer&quot;

GafHigh_pred_masked&lt;-Gafanha_high_pred %&gt;% 
  mask(land_mask_GafHigh, inverse = F) %&gt;% 
  crop(land_mask_GafHigh)

GafHigh_pred_masked&lt;-na.omit(GafHigh_pred_masked, field=NA, geom=FALSE) 

values(GafHigh_pred_masked)[values(GafHigh_pred_masked) == 0] = NA
values(GafHigh_pred_masked)[values(GafHigh_pred_masked) == 3] = 1

GafHigh_pred_masked&lt;-GafHigh_pred_masked %&gt;% 
  as.factor()

Gafanha_High_zoomed_pred&lt;-GafHigh_pred_masked %&gt;% 
  crop(zoom_gaf_high_sf)

Gafanha_High_zoomed_pred&lt;-
  ggplot()+
   tidyterra::geom_spatraster(data = Gafanha_High_zoomed_pred, mapping = aes(fill = layer),
                            show.legend = F,
                             maxcell = 5007120)+
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorophyceae&quot;,
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
     geom_sf(data = zoom_gaf_high_sf, fill = &quot;transparent&quot;, colour = &quot;black&quot;,linetype = &quot;dashed&quot;, linewidth = 1)+
  theme_void()

Gafanha_high_pred_map&lt;-ggplot()+
  geom_sf(data = background_GafHigh, 
          mapping = aes(fill = Type),
          show.legend = F,
          linewidth=0.05,
          alpha=0.93,
          colour=&quot;grey30&quot;)+
  geom_sf(data = background_GafHigh,
          fill = &quot;white&quot;,
          show.legend = F,
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;white&quot;)+
    scale_fill_manual(&quot;&quot;, 
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  ggnewscale::new_scale(&quot;fill&quot;)+
  tidyterra::geom_spatraster(data = GafHigh_pred_masked, 
                             # show.legend = F,
                             mapping = aes(fill = layer),
                             maxcell = 5010420)+
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorophyceae&quot;,
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
       geom_sf(data = zoom_gaf_high_sf, 
               fill = &quot;transparent&quot;, 
               colour = &quot;black&quot;,
               linetype = &quot;dashed&quot;, 
               linewidth = 1)+
    geom_sf(data = Gaflow_extent,
            fill = &quot;transparent&quot;, 
            colour = &quot;red&quot;,
            linetype = &quot;dashed&quot;, 
            linewidth = 2)+
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.74363778,-8.74757,-8.74351982,-8.7453), 
                              y=c(40.5983781677,40.5995,40.598377893,40.5995),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, linewidth = 1)+
  annotation_custom(ggplotGrob(Gafanha_High_zoomed_pred), 
                    xmin = -8.7479, 
                    xmax = -8.7452, 
                    ymin = 40.5979,
                    ymax = 40.603) +
  coord_sf(crs = 4326)+
  theme_Bede_Map()+
   theme(axis.text.x = element_text(size = 20, angle = 20,hjust = 1),
         axis.title = element_blank(),
        # axis.text.y = element_text(size = 20),
        axis.text.y = element_blank(),
         legend.background = element_blank(),
         legend.position = c(0.96,0.23),
         legend.text = element_text(size = 23),
         legend.key.size = unit(1.2,&quot;cm&quot;))+
  scale_x_continuous(limits = c(-8.747576, -8.741465),breaks =  -8.745)+
  scale_y_continuous(limits = c(40.59297,40.60109),breaks =  40.595)
# Gafanha_high_pred_map

ggsave(&quot;Figures/Gaf_High_Pred.png&quot;,Gafanha_high_pred_map , width = 712*4, height = 1120*4, units = &quot;px&quot;)

################# PLOT AND SAVING ###########
plot_GafHigh&lt;-rgb_Gafanha_High+
  Gafanha_high_pred_map

ggsave(&quot;Figures/Maps Pred/FigX-Gaf_High_Pred.png&quot;,plot_GafHigh , width = 2105*4, height = 1363*4, units = &quot;px&quot;)


#########</code>
    </sec>
    <sec id="cell-fig-GafHigh-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Maps Pred/FigX-Gaf_High_Pred.png&quot;)</code>
    <fig id="fig-GafHigh-nb-article">
      <caption><p>Figure 5: RGB orthomosaic (Left) and Prediction
      (Right) of the high altitude flight of Gafanaha, Portugal. The
      total extent of this flight is about 1 km² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green), land area (Light Grey) and water (Light Blue). The red
      triangle shows the extent of the low altitude flight of Gafanha.
      The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel
      size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_High_Pred.png" />
    </fig>
    </sec>
    <p>The High altitude flight made in the inner lagoon of the Ria de
    Aveiro is the largest of all flights, covering almost 1.5 km²
    (<xref alt="Figure 6" rid="fig-Boat-nb-article">Figure 6</xref>). On this site,
    only seagrass and red algae where seen on the field. The
    classification follows the same pattern, with a patchy Magnoliopsida
    meadow mixed on the eastern part of the flight with Rhodophyceae. As
    shown in the zoom
    (<xref alt="Figure 6" rid="fig-Boat-nb-article">Figure 6</xref>), the edges of
    the meadow can be colonised by Chlorophyceae.</p>
    <sec id="nb-code-cell-21-nb-article" specific-use="notebook-code">
    <code language="r script">imglist&lt;-
  data.frame(path = list.files(pattern = &quot;.tif&quot;, recursive = T, full.names = T)) %&gt;% 
  mutate(folder = case_when(str_detect(path, &quot;Data&quot;) ~ &quot;Input&quot;,
                            TRUE ~ &quot;Output&quot;),
         alt = case_when(str_detect(path, &quot;high&quot;) ~ &quot;high&quot;,
                         str_detect(path, &quot;High&quot;) ~ &quot;high&quot;,
                         TRUE ~ &quot;low&quot;),
         site = case_when(str_detect(path, &quot;Gafanha&quot;) ~ &quot;Gafanha&quot;,
                          str_detect(path, &quot;AveiroHigh&quot;) ~ &quot;Gafanha&quot;,
                          TRUE ~ &quot;Duer&quot;),
         type = case_when(str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;Preds&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;NDVI&quot;) ~ &quot;NDVI&quot;,
                          TRUE ~ &quot;ortho&quot;),
         resampled = case_when(str_detect(path, &quot;resampled&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         new = case_when(str_detect(path, &quot;no_Xantho&quot;) ~ &quot;TRUE&quot;,
                         str_detect(path, &quot;NewPreds&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         col = case_when(str_detect(path, &quot;colored&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         correction = case_when(str_detect(path, &quot;corrected_per_bands&quot;) ~ &quot;Bands&quot;,
                          str_detect(path, &quot;corrected.tif&quot;) ~ &quot;lm_all&quot;,
                          TRUE ~ &quot;NA&quot;)) %&gt;% 
  dplyr::filter(alt != &quot;NA&quot;,
                !str_detect(path,&quot;.aux.xml&quot;))
########### PREVIEW #############
filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_aveiro &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_Aveiro&quot;)] %&gt;% 
  read_sf()

Flight_aveiro&lt;-data.frame(
  Name=c(
  &quot;Marinha Lanzarote&quot;
  ) ,
  Description = c(
                  &quot;120m Flight&quot;),
  Long=c( 
         -8.690677) ,
  Lat=c(
        40.665120) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_aveiro))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)


p1_background&lt;- read_sf(&quot;Data/shp/Aveiro/Background_p1_aveiro.shp&quot;)

p1&lt;-ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#BDBDBD&quot;))+
  geom_sf(data = p1_background, fill = &quot;white&quot;,show.legend = F, linewidth=0.05,alpha=0.93,colour=&quot;transparent&quot;)+
  geom_sf(data = mask_aveiro, mapping = aes(fill = Type),linewidth=0.05,alpha=0.93,show.legend = F,colour=&quot;grey30&quot;)+
      coord_sf(xlim=c(519749,535233) ,
          ylim=c(4493310,4508794) )+
  ggforce::geom_mark_ellipse(data=Flight_aveiro,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 label.fontsize = 10,
                 label.hjust = 0.5,
                 con.size = 2,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
    # theme_void()+
  theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  # geom_label(aes(x = 521000, y = 4507794, label = &quot;C&quot;), size = 20)+
  scale_x_continuous(breaks = seq(-8.75, -8.6, by = 0.1))+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;) ,
        legend.position = &quot;none&quot;,
        axis.title = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20))+
  theme_void()
##### ZOOM and masking #####

Boat_rgb&lt;-imglist %&gt;% 
  filter(str_detect(path,&quot;Boat_high_RGB_merged.tif&quot;)) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Boat_rgb)&lt;-c(&quot;B1&quot;,&quot;B3&quot;,&quot;B5&quot;)
values(Boat_rgb)[values(Boat_rgb) == 0] = NA

mask_boat&lt;-&quot;Data/shp/Aveiro&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;boat&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

background_Boat&lt;-&quot;Data/shp/Aveiro&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;background_Boat&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

zoom_boat_high_sf&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom_extent_map_Boat_comparison&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

zoom_boat_high_sf_2&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom_extent_map_Boat_2_comparison&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

rgb_Boat_zoomed&lt;-Boat_rgb %&gt;% 
  crop(zoom_boat_high_sf)

rgb_Boat_zoomed_2&lt;-Boat_rgb %&gt;% 
  crop(zoom_boat_high_sf_2)

Boat_rgb_mask&lt;-Boat_rgb %&gt;% 
  mask(mask_boat, inverse = T)

 
rgb_Boat_zoomed_map&lt;- ggplot()+
  geom_spatraster_rgb(data = rgb_Boat_zoomed,
                      r = 3,
                      g = 2,
                      b = 1,
                      max_col_value = 4000)+
  geom_sf(data = zoom_boat_high_sf, fill = &quot;transparent&quot;, linetype = &quot;dashed&quot;,colour = &quot;black&quot;, linewidth = 1)+

  theme_void()

rgb_Boat_zoomed_map_2
ggplot()+
  geom_spatraster_rgb(data = rgb_Boat_zoomed_2,
                      r = 3,
                      g = 2,
                      b = 1,
                      interpolate = F,
                      max_col_value = 4000)+
  geom_sf(data = zoom_boat_high_sf_2, fill = &quot;transparent&quot;, linetype = &quot;dashed&quot;,colour = &quot;black&quot;, linewidth = 1)+

  theme_void()

####### RGB ############

RGB_Boat_map&lt;-
ggplot()+
  scale_fill_manual(&quot;&quot;,  
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  geom_sf(data = background_Boat,
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.93,
          colour=&quot;transparent&quot;)+
  geom_sf(data = background_Boat,
          fill = &quot;white&quot;,
          show.legend = F, 
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;transparent&quot;)+
  tidyterra::geom_spatraster_rgb(data = Boat_rgb_mask,
                      r = 3,
                      g = 2,
                      b = 1,
                      # maxcell = 5000,
                      maxcell = 500832*8,
                      max_col_value = 5000)+
  geom_sf(data = zoom_boat_high_sf,
          fill = &quot;transparent&quot;,
          colour = &quot;black&quot;, 
          linewidth = 1)+
  geom_sf(data = zoom_boat_high_sf_2,
          fill = &quot;transparent&quot;,
          colour = &quot;black&quot;, 
          linewidth = 1)+
  annotation_custom(ggplotGrob(rgb_Boat_zoomed_map),
                    xmin = -8.6975,
                    xmax = -8.69,
                    ymin = 40.6666,
                    ymax = 40.6711) +
  annotation_custom(ggplotGrob(rgb_Boat_zoomed_map_2),
                    xmin = -8.6975+0.007,
                    xmax = -8.69+0.007,
                    ymin = 40.6666,
                    ymax = 40.6711) +
  annotation_custom(ggplotGrob(p1),
                    xmin = -8.6795,
                    xmax = -8.6736,
                    ymin = 40.6585,
                    ymax = 40.6625) +
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.69452127,-8.6965,-8.69440039,-8.69105), 
                              y=c(40.66244282,40.66673,40.66244282,40.66673),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, 
            linewidth = 1)+
    geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.6819877,-8.69645+0.007,-8.6818696,-8.6911+0.007), 
                              y=c(40.6652874,40.66675,40.6652874,40.66673),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, 
            linewidth = 1)+
  ggspatial::annotation_scale(location = &quot;bl&quot;,
                              text_cex=2)+
  scale_x_continuous(limits = c(-8.6965,-8.675),
                     breaks =  -8.685)+
  scale_y_continuous(limits = c(40.659,40.6704),
                     breaks =  40.664)+
  theme_Bede_Map()+
  theme(axis.title = element_blank(),
        # axis.text.x = element_text(size = 20, angle = 20 , hjust = 1),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 20))+
   coord_sf(crs = 4326)


####### Pred ######## 
Boat1_pred&lt;-imglist %&gt;% 
  filter(str_detect(path,&quot;AveiroBoat1_highPrediction_nnNewStanRawMetrics_Preds_NoXantho_7.tif&quot;)) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Boat1_pred)&lt;-&quot;layer&quot;

Boat2_pred&lt;-imglist %&gt;% 
  filter(str_detect(path,&quot;AveiroBoat2_highPrediction_nnNewStanRawMetrics_Preds_NoXantho_7.tif&quot;)) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Boat2_pred)&lt;-&quot;layer&quot;

values(Boat1_pred)[values(Boat1_pred) == 0] = NA
values(Boat2_pred)[values(Boat2_pred) == 0] = NA


B1_overextent&lt;-ext(Boat1_pred)
B1_overextent[2]&lt;-ext(Boat2_pred)[2]
B1_overextent[4]&lt;-ext(Boat2_pred)[4]
B1_overextent &lt;- rast(B1_overextent)
res(B1_overextent)&lt;-res(Boat1_pred)
# terra::writeRaster(B1$B1,&quot;B1.tif&quot;)
# terra::writeRaster(B2$B2,&quot;B2.tif&quot;)

B2_resampled &lt;- terra::resample(Boat2_pred,B1_overextent, method = &quot;near&quot;,threads = T)
# terra::writeRaster(B2_resampled$B1,&quot;B2_resampled.tif&quot;, overwrite = T)

Boat_pred&lt;-merge(Boat1_pred,B2_resampled)

Boat_pred_aggregate&lt;-terra::aggregate(Boat_pred,fact = 6, fun =&quot;modal&quot;) 

masked_pred&lt;-Boat_pred_aggregate %&gt;% 
  mask(mask_boat,inverse=TRUE)%&gt;% 
  as.factor()

Boat_pred_zoom&lt;-Boat1_pred %&gt;% 
  crop(zoom_boat_high_sf) %&gt;% 
  as.factor()

Boat_pred_zoom_2&lt;-Boat2_pred %&gt;% 
  crop(zoom_boat_high_sf_2) %&gt;% 
  as.factor()

Boat_Pred_zoomed_map&lt;- ggplot()+
  tidyterra::geom_spatraster(data = Boat_pred_zoom, 
                             mapping = aes(fill = layer), 
                             show.legend = F,
                             maxcell = 5010420)+
  scale_fill_manual(values=c(&quot;#70543e&quot;,&quot;#b3ff1a&quot;,&quot;#389318&quot;,&quot;#873e23&quot;),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorphyceae&quot;,
                               &quot;Magnoliopsida&quot;))+
  geom_sf(data = zoom_boat_high_sf, 
          fill = &quot;transparent&quot;, 
          linetype = &quot;dashed&quot;,
          colour = &quot;black&quot;, 
          linewidth = 1)+
  theme_void()

Boat_Pred_zoomed_map_2&lt;- ggplot()+
  tidyterra::geom_spatraster(data = Boat_pred_zoom_2, 
                             mapping = aes(fill = layer), 
                             show.legend = F,
                             maxcell = 5010420)+
  scale_fill_manual(values=c(&quot;#70543e&quot;,&quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;))+
  geom_sf(data = zoom_boat_high_sf_2, 
          fill = &quot;transparent&quot;, 
          linetype = &quot;dashed&quot;,
          colour = &quot;black&quot;, 
          linewidth = 1)+
  theme_void()


Boat_pred_map&lt;-ggplot()+
  geom_sf(data = background_Boat, 
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.93,
          colour=&quot;transparent&quot;)+
  geom_sf(data = background_Boat,
          fill = &quot;white&quot;,
          show.legend = F, 
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;transparent&quot;)+
    scale_fill_manual(&quot;&quot;, 
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  ggnewscale::new_scale(&quot;fill&quot;)+
  tidyterra::geom_spatraster(data = masked_pred, 
                             mapping = aes(fill = layer),
                             # show.legend = F,
                             maxcell = 5010420,
                             )+
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA,NA,NA),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorophyceae&quot;,
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
  ggnewscale::new_scale(&quot;fill&quot;)+
  geom_sf(data = zoom_boat_high_sf, 
               fill = &quot;transparent&quot;, 
               colour = &quot;black&quot;,
               linetype = &quot;dashed&quot;, 
               linewidth = 1)+
  geom_sf(data = zoom_boat_high_sf_2, 
               fill = &quot;transparent&quot;, 
               colour = &quot;black&quot;,
               linetype = &quot;dashed&quot;, 
               linewidth = 1)+
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.69452127,-8.6965,-8.69440039,-8.69105), 
                              y=c(40.66244282,40.66673,40.66244282,40.66673),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, 
            linewidth = 1)+
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-8.6819877,-8.69645+0.007,-8.6818696,-8.6911+0.007), 
                              y=c(40.6652874,40.66675,40.6652874,40.66673),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, 
            linewidth = 1)+
  annotation_custom(ggplotGrob(Boat_Pred_zoomed_map),
                    xmin = -8.6975,
                    xmax = -8.69,
                    ymin = 40.6666,
                    ymax = 40.6711) +
  annotation_custom(ggplotGrob(Boat_Pred_zoomed_map_2),
                    xmin = -8.6975+0.007,
                    xmax = -8.69+0.007,
                    ymin = 40.6666,
                    ymax = 40.6711) +
  coord_sf(crs = 4326)+
  theme_Bede_Map()+
   theme(
     # axis.text.x = element_text(size = 20, angle = 20,hjust = 1),
     axis.text.x = element_blank(),
         axis.title = element_blank(),
        axis.text.y = element_text(size = 20),
         legend.background = element_blank(),
         legend.position = c(0.98,0.38),
         legend.text = element_text(size = 18),
         legend.key.size = unit(0.8,&quot;cm&quot;))+
  scale_x_continuous(limits = c(-8.6965,-8.675),
                     breaks =  -8.685)+
  scale_y_continuous(limits = c(40.659,40.6704),
                     breaks =  40.664)
################# PLOT AND SAVING ###########
plot_Boat&lt;-RGB_Boat_map/
  Boat_pred_map

ggsave(&quot;Figures/Maps Pred/FigX-Boat_Pred.png&quot;,plot_Boat , width = 1000*4, height = 1120*4, units = &quot;px&quot;)</code>
    </sec>
    <sec id="cell-fig-Boat-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Maps Pred/FigX-Boat_Pred.png&quot;)</code>
    <fig id="fig-Boat-nb-article">
      <caption><p>Figure 6: RGB orthomosaic (Top) and Prediction
      (Bottom) of the flight made in the inner part of Ria de Aveiro
      Lagoon, Portugal. The total extent of this flight is about 1.5 km²
      with a resolution of 80 mm per pixel. Background colors means
      intertidal area (Light Green), land area (Light Grey) and water
      (Light Blue). The zoom covers an area equivalent to a 10-meter
      Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Boat_Pred.png" />
    </fig>
    </sec>
    <p>The flight over L’Epine in Noirmoutier Island, France
    (<xref alt="Figure 7" rid="fig-Dike-nb-article">Figure 7</xref>) was conducted
    near a dike crossing the northern part of the flight from west to
    east. Alongside this dike, brown algae attached to rocks and
    stranded green algae could be found. Despite the high mixture
    between Chlorophyceae and Magnoliopsida in this flight, these two
    classes are well discriminated by the classifier.</p>
    <sec id="nb-code-cell-22-nb-article" specific-use="notebook-code">
    <code language="r script">imglist&lt;-
  data.frame(path = list.files(pattern = &quot;.tif&quot;, recursive = T, full.names = T)) %&gt;% 
  mutate(folder = case_when(str_detect(path, &quot;Data&quot;) ~ &quot;Input&quot;,
                            TRUE ~ &quot;Output&quot;),
         alt = case_when(str_detect(path, &quot;high&quot;) ~ &quot;high&quot;,
                         str_detect(path, &quot;High&quot;) ~ &quot;high&quot;,
                         TRUE ~ &quot;low&quot;),
         site = case_when(str_detect(path, &quot;Gafanha&quot;) ~ &quot;Gafanha&quot;,
                          str_detect(path, &quot;AveiroHigh&quot;) ~ &quot;Gafanha&quot;,
                          TRUE ~ &quot;Duer&quot;),
         type = case_when(str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;Preds&quot;) ~ &quot;Pred&quot;,
                          str_detect(path, &quot;NDVI&quot;) ~ &quot;NDVI&quot;,
                          TRUE ~ &quot;ortho&quot;),
         resampled = case_when(str_detect(path, &quot;resampled&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         new = case_when(str_detect(path, &quot;no_Xantho&quot;) ~ &quot;TRUE&quot;,
                         str_detect(path, &quot;NewPreds&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         col = case_when(str_detect(path, &quot;colored&quot;) ~ &quot;TRUE&quot;,
                          TRUE ~ &quot;FALSE&quot;),
         correction = case_when(str_detect(path, &quot;corrected_per_bands&quot;) ~ &quot;Bands&quot;,
                          str_detect(path, &quot;corrected.tif&quot;) ~ &quot;lm_all&quot;,
                          TRUE ~ &quot;NA&quot;)) %&gt;% 
  dplyr::filter(alt != &quot;NA&quot;,
                !str_detect(path,&quot;.aux.xml&quot;))

##### Preview #####

filelist&lt;-list.files(&quot;Data/shp/&quot;, pattern = &quot;.shp&quot;, recursive = T,full.names = T)
mask_BB &lt;- filelist[str_detect(filelist,&quot;mask_land_intertidal_BB&quot;)] %&gt;% 
  read_sf()

Flight_BB&lt;-data.frame(
  Name=c(
  &quot;L'Epine&quot;
  ) ,
  Description = c(
                  &quot;120m Flight&quot;),
  Long=c(
         -2.228239) ,
  Lat=c( 
        46.989515) 
  )  %&gt;% 
  st_as_sf(coords=c(&quot;Long&quot;,&quot;Lat&quot;) )  %&gt;% 
  st_set_crs(&quot;EPSG:4326&quot;)  %&gt;% 
  st_transform(crs(mask_BB))  %&gt;% 
  dplyr::mutate(lon = sf::st_coordinates(.) [,1],
                lat = sf::st_coordinates(.) [,2]) %&gt;% 
  sf::st_set_geometry(NULL)

p1 &lt;- ggplot() +
  scale_fill_manual(&quot;&quot;, labels = c(&quot;Intertidal area&quot;, &quot;Land mask&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#BDBDBD&quot;))+
  geom_sf(data = mask_BB, mapping = aes(fill = Type), linewidth=0.05,alpha=0.93, show.legend = F,colour=&quot;grey30&quot;)+
      coord_sf(xlim=c(550609,579539) ,
          ylim=c(5189447,5218377) )+
  ggforce::geom_mark_ellipse(data=Flight_BB,
                 aes(x=lon,
                     y=lat,
                     label = Name,
                     group = Name),
                     # description=Description),
                 size=0.3,
                 fill = &quot;goldenrod&quot;,
                 con.colour = &quot;goldenrod4&quot;,
                 show.legend=F,
                 con.size = 2,
                 label.fontsize = 10,
                 label.hjust = 0.5,
                 alpha=0.8,
  expand = unit(2, &quot;mm&quot;) , 
  radius = unit(2, &quot;mm&quot;) ,
  label.fill = &quot;grey90&quot;,
  label.buffer = unit(5, &quot;mm&quot;)) +
  # theme_Bede_Map()+
  labs(x=&quot;Longitude&quot;,
       y=&quot;Latitude&quot;)+
  # geom_label(aes(x = 553460, y = 5216442, label = &quot;B&quot;), size = 20)+
  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), &quot;cm&quot;) ,
        legend.position = c(0.95,0.2),
        legend.key.size =  unit(1, &quot;cm&quot;),
        legend.text = element_text(size = 20),
        legend.title=element_blank(),
        legend.background = element_rect(linewidth = 0.5, 
                                         fill = &quot;white&quot;,
                                         linetype=&quot;solid&quot;, 
                                  colour =&quot;black&quot;),
        # panel.background = element_rect(fill = &quot;#FFFFFF90&quot;),
        axis.title = element_blank(),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank())+
  theme_void()

##### RGB ######

Dike_rgb&lt;-imglist %&gt;% 
  filter(str_detect(path,&quot;NorthDike_high_multi_4326_colored.tif&quot;)) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Dike_rgb)&lt;-c(&quot;B1&quot;,&quot;B3&quot;,&quot;B5&quot;,&quot;alpha&quot;)
values(Dike_rgb)[values(Dike_rgb$alpha) == 0] = NA

mask_Dike&lt;-&quot;Data/shp/Bourgneuf&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;mask_NorthDike&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

background_Dike&lt;-&quot;Data/shp/Bourgneuf&quot; %&gt;% 
  list.files(&quot;.shp&quot;, full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path, &quot;background&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

zoom_Dike_high_sf&lt;-&quot;Data/shp&quot; %&gt;% 
  list.files(&quot;.shp&quot;,recursive = T,full.names = T) %&gt;% 
  as.data.frame() %&gt;% 
  rename(path = &quot;.&quot;) %&gt;% 
  dplyr::filter(str_detect(path,&quot;zoom_extent_map_Dike_comparison&quot;)) %&gt;% 
  pull(path) %&gt;% 
  read_sf()

Dike_rgb_masked&lt;-Dike_rgb %&gt;% 
  crop(mask_Dike) %&gt;%
  mask(mask_Dike)


zoom_rgb_dike&lt;-Dike_rgb_masked %&gt;% 
  crop(zoom_Dike_high_sf)

zoom_rgb_dike_map&lt;-ggplot()+
  geom_spatraster_rgb(data = zoom_rgb_dike,
                      r = 3,
                      g = 2,
                      b = 1)+
  geom_sf(data = zoom_Dike_high_sf, fill = &quot;transparent&quot;, linetype = &quot;dashed&quot;,colour = &quot;black&quot;, linewidth = 1)+
  coord_sf(crs = 32630)+
  theme_void()


RGB_Dike_map &lt;- ggplot()+
  scale_fill_manual(&quot;&quot;,  
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  geom_sf(data = background_Dike,
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.93,
          colour=&quot;transparent&quot;)+
  geom_sf(data = background_Dike,
          fill = &quot;white&quot;,
          show.legend = F, 
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;transparent&quot;)+
  tidyterra::geom_spatraster_rgb(data = Dike_rgb_masked,
                      r = 3,
                      g = 2,
                      b = 1,
                      # maxcell = 500,
                      maxcell = 500832*8
                      )+
  geom_sf(data = zoom_Dike_high_sf, 
          fill = &quot;transparent&quot;, 
          linetype = &quot;dashed&quot;,
          colour = &quot;black&quot;, 
          linewidth = 1)+
  annotation_custom(ggplotGrob(zoom_rgb_dike_map), 
                    xmin = -2.226, 
                    ymin = 46.9888,
                    ymax = 46.9893) +
  annotation_custom(ggplotGrob(p1),
                    xmin = -2.226,
                    ymin = 46.9875) +
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-2.226834,-2.225905,-2.226834,-2.225905),
                              y=c(46.9886439,46.9892105,46.9885538,46.988805),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, linewidth = 1)+
  ggspatial::annotation_scale(location = &quot;tl&quot;,text_cex=2)+
  scale_x_continuous(limits = c(-2.2293,-2.2253),
                     breaks =  -2.228)+
  scale_y_continuous(limits = c(46.9882,46.98935),
                     breaks =  46.9890)+
  theme_Bede_Map()+
  theme(
    # axis.text.x =element_text(size = 20, angle = 20, hjust = 1),
    axis.text.x =element_blank(),
        axis.title = element_blank(),
        axis.text.y = element_text(size = 20))+
   coord_sf(crs = 4326)


##### Pred ######

Dike_Pred&lt;-imglist %&gt;% 
  filter(str_detect(path,&quot;Noirmoutier_highPrediction_nnNewStanRawMetrics_Preds_NoXantho_7_4326.tif&quot;)) %&gt;% 
  pull(path) %&gt;% 
  rast()
names(Dike_Pred)&lt;-c(&quot;layer&quot;)
values(Dike_Pred)[values(Dike_Pred) == 0] = NA

Dike_Pred_masked&lt;-Dike_Pred %&gt;% 
  crop(mask_Dike) %&gt;% 
  mask(mask_Dike) %&gt;% 
  as.factor()

zoom_Pred_dike&lt;-Dike_Pred_masked %&gt;% 
  crop(zoom_Dike_high_sf)

zoom_Pred_dike_map&lt;-ggplot()+
  tidyterra::geom_spatraster(data = zoom_Pred_dike, mapping = aes(fill = layer), show.legend = F)+
  scale_fill_manual(values=c(&quot;#70543e&quot;,&quot;#b3ff1a&quot;,&quot;#389318&quot;,&quot;#873e23&quot;,&quot;#42c9bc&quot;),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorphyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Water&quot;))+
  geom_sf(data = zoom_Dike_high_sf, fill = &quot;transparent&quot;, linetype = &quot;dashed&quot;,colour = &quot;black&quot;, linewidth = 1)+
  theme_void()


Dike_pred_map&lt;-ggplot()+
  geom_sf(data = background_Dike, 
          mapping = aes(fill = Type),
          show.legend = F, 
          linewidth=0.05,
          alpha=0.93,
          colour=&quot;grey30&quot;)+
  geom_sf(data = background_Dike,
          fill = &quot;white&quot;,
          show.legend = F, 
          linewidth=0.05,
          alpha=0.4,
          colour=&quot;white&quot;)+
    scale_fill_manual(&quot;&quot;,  
                    labels = c(&quot;Intertidal area&quot;, &quot;Land area&quot;, &quot;water&quot;),
                    values = c(&quot;#7DC27D&quot;, &quot;#CFCFCF&quot;,&quot;#42c9bc&quot;))+
  ggnewscale::new_scale(&quot;fill&quot;)+
  tidyterra::geom_spatraster(data = Dike_Pred_masked, 
                             mapping = aes(fill = layer),
                             maxcell = 5010420,
                             )+
  scale_fill_manual(breaks = c(1,2,5,6,7,8,10),
                    values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;, &quot;#42c9bc&quot;,NA,NA,NA,NA),
                    na.value = NA,
                    name = &quot;&quot;,
                    labels = c(&quot;Sediment&quot;,
                               &quot;Chlorophyceae&quot;,
                               &quot;Bacillariophyceae&quot;,
                               &quot;Magnoliopsida&quot;,
                               &quot;Phaeophyceae&quot;,
                               &quot;Rhodophyceae&quot;,
                               &quot;Water&quot;))+
  ggnewscale::new_scale(&quot;fill&quot;)+
  geom_sf(data = zoom_Dike_high_sf, 
          fill = &quot;transparent&quot;, 
          colour = &quot;black&quot;,
          linetype = &quot;dashed&quot;, 
          linewidth = 1)+
  annotation_custom(ggplotGrob(zoom_Pred_dike_map), 
                    xmin = -2.226, 
                    ymin = 46.9888,
                    ymax = 46.9893) +
  geom_path(aes(x,y,group=grp),
            data = data.frame(x = c(-2.226834,-2.225905,-2.226834,-2.225905),
                              y=c(46.9886439,46.9892105,46.9885538,46.988805),
                              grp=c(1,1,2,2)),
            linetype = &quot;dashed&quot;, linewidth = 1)+
  # annotation_custom(ggplotGrob(Boat_Pred_zoomed_map), xmin = -8.697, xmax = -8.692, ymin = 40.667,ymax = 40.6705) +
  coord_sf(crs = 4326)+
  theme_Bede_Map()+
   theme(axis.text.x = element_text(size = 20, angle = 20,hjust = 1),
         axis.title = element_blank(),
        axis.text.y = element_text(size = 20),
         legend.background = element_blank(),
         legend.position = c(1,0.50),
         legend.text = element_text(size = 18),
         legend.key.size = unit(0.8,&quot;cm&quot;))+
  scale_x_continuous(limits = c(-2.2293,-2.2253),
                     breaks =  -2.228)+
  scale_y_continuous(limits = c(46.9882,46.98935),
                     breaks =  46.9890)

################# PLOT AND SAVING ###########

plot_Dike&lt;-RGB_Dike_map/
  Dike_pred_map
  
ggsave(&quot;Figures/Maps Pred/FigX-Dike_Pred.png&quot;,plot_Dike , width = 1200*4, height = 900*4, units = &quot;px&quot;)</code>
    </sec>
    <sec id="cell-fig-Dike-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Maps Pred/FigX-Dike_Pred.png&quot;)</code>
    <fig id="fig-Dike-nb-article">
      <caption><p>Figure 7: RGB orthomosaic (Top) and Prediction
      (Bottom) of Northern part of Noirmoutier Island, France. The total
      extent of this flight is about 28 000 m² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green) and land area (Light Grey). The zoom covers an area
      equivalent to a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Dike_Pred.png" />
    </fig>
    </sec>
  </sec>
  <sec id="validation-1-nb-article">
    <title>3.2 Validation</title>
    <sec id="nb-code-cell-23-nb-article" specific-use="notebook-code">
    <code language="r script">df&lt;-&quot;Output/Validation_data&quot; %&gt;% 
  list.files(&quot;ResultsNewNN_NoXanthowithNDVIWithOldandBoat.csv&quot;,recursive = T, full.names = T) %&gt;% 
  read.csv() %&gt;% 
  as_tibble() %&gt;% 
  rename(Truth_ID = &quot;Truth&quot;) %&gt;% 
  mutate(Truth =  case_when(Truth_ID == 1 ~ &quot;Sediment&quot;,
                          Truth_ID == 2 ~ &quot;Chlorophyceae&quot;,
                          Truth_ID == 3 ~ &quot;Sediment&quot;,
                          Truth_ID == 4 ~ &quot;Magnoliopsida&quot;,
                          Truth_ID == 5 ~ &quot;Bacillariophyceae&quot;,
                          Truth_ID == 6 ~ &quot;Magnoliopsida&quot;,
                          Truth_ID == 7 ~ &quot;Phaeophyceae&quot;,
                          Truth_ID == 8 ~ &quot;Rhodophyceae&quot;,
                          Truth_ID == 9 ~ &quot;SunGlint&quot;,
                          Truth_ID == 10 ~ &quot;Water&quot;,
                          Truth_ID == 11 ~ &quot;Xanthophyceae&quot;,
                          Truth_ID == 12 ~ &quot;Spartina&quot;,
                          Truth_ID == 41 ~ &quot;Bleached seagrasses&quot;,
                          TRUE ~ &quot;NA&quot;),
         Pred_Class = case_when(Pred_Class == &quot;Clorophyta&quot; ~ &quot;Chlorophyceae&quot;,
                                Pred_Class == &quot;Phaeophyta&quot; ~ &quot;Phaeophyceae&quot;,
                                Pred_Class == &quot;Rhodphyta&quot; ~ &quot;Rhodophyceae&quot;,
                                Pred_Class == &quot;Deep_Sediment&quot; ~ &quot;Sediment&quot;,
                                Pred_Class == &quot;MPB&quot; ~ &quot;Bacillariophyceae&quot;,
                                Pred_Class == &quot;Bare_Sediment&quot; ~ &quot;Sediment&quot;,
                                 Pred_Class == &quot;Magnoliosida&quot; ~ &quot;Magnoliopsida&quot;,
                                (Pred_Class == &quot;Low_SPC&quot; &amp; NDVI &gt; 0.2) ~ &quot;Magnoliopsida&quot;,
                                (Pred_Class == &quot;Low_SPC&quot; &amp; NDVI &lt;= 0.2 )~ &quot;Sediment&quot;,
                          TRUE ~ Pred_Class)) %&gt;% 
  dplyr::filter(Truth != &quot;Water&quot;,
                Truth  != &quot;Spartina&quot;,
                Truth != &quot;SunGlint&quot;,
                Truth != &quot;Bleached seagrasses&quot;,
                Truth != &quot;Xanthophyceae&quot;,
                # Pred_Class != &quot;Low_SPC&quot;,
                Pred_Class != &quot;Xanthophyceae&quot;,
                 Pred_Class != &quot;Water&quot;,
                 Pred_Class != &quot;SunGlint&quot;,
                !Flight == &quot;Handfisher_1_old&quot;,
                !Flight == &quot;Handfisher_2_old&quot;,
                !Flight == &quot;Handfisher_2&quot;) %&gt;%
  dplyr::select(-NDVI)


a&lt;-as.character(unique(df$Truth))
b&lt;-as.character(unique(df$Pred_Class))
ab&lt;-setdiff(a,b)
ba&lt;-setdiff(b,a)

if (!(length(ab) == 0 &amp; length(ba) == 0)) {
  

lines_to_add&lt;-data.frame(Pred_Class = c(ab,ba),
                         Pred_ID = NA,
                         Flight = NA,
                         Truth_ID = NA,
                         Truth = c(ab,ba))

df&lt;-df %&gt;% 
  rbind(lines_to_add)
  rm(lines_to_add)

  
}


  df&lt;- df %&gt;%
  mutate(Pred_Class = as_factor(Pred_Class),
         Truth = as_factor(Truth),
         Truth = fct_relevel(Truth, c(&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;)),
         Pred_Class = fct_relevel(Pred_Class, c(&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;)),
         Flight = case_when(str_detect(Flight, &quot;Boat&quot;) ~ &quot;Boat&quot;,
                            TRUE ~ Flight))
  
####### GafanahaLow #######
df_GafanhaLow&lt;-df %&gt;% 
  filter(Flight == &quot;GafanhaLow&quot;)

validation_metrics_GafanhaLow&lt;-confusionMatrix(df_GafanhaLow$Pred_Class,df_GafanhaLow$Truth)

conf_mat_GafanhaLow&lt;-validation_metrics_GafanhaLow[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_GafanhaLow[6,]&lt;-NA
conf_mat_GafanhaLow[,6]&lt;-NA

for(i in 1:(nrow(conf_mat_GafanhaLow))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_GafanhaLow[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_GafanhaLow[,i],na.rm = T)
}
conf_mat_std_GafanhaLow&lt;-conf_mat_GafanhaLow

for(row in 1:nrow(conf_mat_std_GafanhaLow)){
  for(col in 1:ncol(conf_mat_std_GafanhaLow)){
    conf_mat_std_GafanhaLow[row,col]&lt;-conf_mat_std_GafanhaLow[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_GafanhaLow[row,col])
    }
}

confmat_rast_GafanhaLow&lt;-conf_mat_std_GafanhaLow %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_GafanhaLow&lt;-subst(confmat_rast_GafanhaLow, NA, -99)
names(confmat_rast_GafanhaLow)&lt;-&quot;layer&quot;
ext(confmat_rast_GafanhaLow)&lt;-c(18.1,21.9,8.2,11.8)
confmat_rast_GafanhaLow_sf&lt;-as.polygons(confmat_rast_GafanhaLow,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_GafanhaLow_centroid&lt;-st_centroid(confmat_rast_GafanhaLow_sf)</code>
    <code language="r script">values(confmat_rast_GafanhaLow)[values(confmat_rast_GafanhaLow) == 0] = NA
values(confmat_rast_GafanhaLow)[values(confmat_rast_GafanhaLow) == -99] = NA

####### GafanhaHigh #######

df_GafanhaHigh&lt;-df %&gt;% 
  filter(Flight == &quot;GafanhaHigh&quot;)

validation_metrics_GafanhaHigh&lt;-confusionMatrix(df_GafanhaHigh$Pred_Class,df_GafanhaHigh$Truth)

conf_mat_GafanhaHigh&lt;-validation_metrics_GafanhaHigh[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_GafanhaHigh[6,]&lt;-NA
conf_mat_GafanhaHigh[,6]&lt;-NA

for(i in 1:(nrow(conf_mat_GafanhaHigh))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_GafanhaHigh[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_GafanhaHigh[,i],na.rm = T)
}
conf_mat_std_GafanhaHigh&lt;-conf_mat_GafanhaHigh

for(row in 1:nrow(conf_mat_std_GafanhaHigh)){
  for(col in 1:ncol(conf_mat_std_GafanhaHigh)){
    conf_mat_std_GafanhaHigh[row,col]&lt;-conf_mat_std_GafanhaHigh[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_GafanhaHigh[row,col])
    }
}

confmat_rast_GafanhaHigh&lt;-conf_mat_std_GafanhaHigh %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_GafanhaHigh&lt;-subst(confmat_rast_GafanhaHigh, NA, -99)
names(confmat_rast_GafanhaHigh)&lt;-&quot;layer&quot;
ext(confmat_rast_GafanhaHigh)&lt;-c(14.1,17.9,8.2,11.8)
confmat_rast_GafanhaHigh_sf&lt;-as.polygons(confmat_rast_GafanhaHigh,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_GafanhaHigh_centroid&lt;-st_centroid(confmat_rast_GafanhaHigh_sf)</code>
    <code language="r script">values(confmat_rast_GafanhaHigh)[values(confmat_rast_GafanhaHigh) == 0] = NA
values(confmat_rast_GafanhaHigh)[values(confmat_rast_GafanhaHigh) == -99] = NA


# plot_matrix_GafanhaHigh &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_GafanhaHigh),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;Gafanha Low&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))
# 
# 




####### DuerLow #######

df_DuerLow&lt;-df %&gt;% 
  filter(Flight == &quot;DuerLow&quot;)

validation_metrics_DuerLow&lt;-confusionMatrix(df_DuerLow$Pred_Class,df_DuerLow$Truth)

conf_mat_DuerLow&lt;-validation_metrics_DuerLow[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_DuerLow[5,]&lt;-NA
conf_mat_DuerLow[,5]&lt;-NA

for(i in 1:(nrow(conf_mat_DuerLow))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_DuerLow[i,], na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_DuerLow[,i], na.rm = T)
}
conf_mat_std_DuerLow&lt;-conf_mat_DuerLow

# for(row in 1:nrow(conf_mat_std_DuerLow)){
#   for(col in 1:ncol(conf_mat_std_DuerLow)){
#     conf_mat_std_DuerLow[row,col]&lt;-conf_mat_std_DuerLow[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_DuerLow[row,col])
#     }
# }

for(row in 1:nrow(conf_mat_std_DuerLow)){
  for(col in 1:ncol(conf_mat_std_DuerLow)){
    conf_mat_std_DuerLow[row,col]&lt;-conf_mat_std_DuerLow[row,col]/((df_sum$col[col]))
    }
}

confmat_rast_DuerLow&lt;-conf_mat_std_DuerLow %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_DuerLow&lt;-subst(confmat_rast_DuerLow, NA, -99)
names(confmat_rast_DuerLow)&lt;-&quot;layer&quot;
ext(confmat_rast_DuerLow)&lt;-c(18.1,21.9,0,3.8)
confmat_rast_DuerLow_sf&lt;-as.polygons(confmat_rast_DuerLow,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_DuerLow_centroid&lt;-st_centroid(confmat_rast_DuerLow_sf)</code>
    <code language="r script">values(confmat_rast_DuerLow)[values(confmat_rast_DuerLow) == 0] = NA
values(confmat_rast_DuerLow)[values(confmat_rast_DuerLow) == -99] = NA


# plot_matrix_DuerLow &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_DuerLow),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;Duer Low&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))

####### Horse_rooster #######

df_Horse_rooster&lt;-df %&gt;% 
  filter(Flight == &quot;Horse_rooster&quot;)

validation_metrics_Horse_rooster&lt;-confusionMatrix(df_Horse_rooster$Pred_Class,df_Horse_rooster$Truth)

conf_mat_Horse_rooster&lt;-validation_metrics_Horse_rooster[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_Horse_rooster[6,]&lt;-NA
conf_mat_Horse_rooster[,6]&lt;-NA
conf_mat_Horse_rooster[2,]&lt;-NA
conf_mat_Horse_rooster[,2]&lt;-NA

for(i in 1:(nrow(conf_mat_Horse_rooster))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_Horse_rooster[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_Horse_rooster[,i],na.rm = T)
}
conf_mat_std_Horse_rooster&lt;-conf_mat_Horse_rooster

for(row in 1:nrow(conf_mat_std_Horse_rooster)){
  for(col in 1:ncol(conf_mat_std_Horse_rooster)){
    conf_mat_std_Horse_rooster[row,col]&lt;-conf_mat_std_Horse_rooster[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_Horse_rooster[row,col])
    }
}

confmat_rast_Horse_rooster&lt;-conf_mat_std_Horse_rooster %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_Horse_rooster&lt;-subst(confmat_rast_Horse_rooster, NA, -99)
names(confmat_rast_Horse_rooster)&lt;-&quot;layer&quot;
ext(confmat_rast_Horse_rooster)&lt;-c(14.1,17.9,4.2,7.8)
confmat_rast_Horse_rooster_sf&lt;-as.polygons(confmat_rast_Horse_rooster,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_Horse_rooster_centroid&lt;-st_centroid(confmat_rast_Horse_rooster_sf)</code>
    <code language="r script">values(confmat_rast_Horse_rooster)[values(confmat_rast_Horse_rooster) == 0] = NA
values(confmat_rast_Horse_rooster)[values(confmat_rast_Horse_rooster) == -99] = NA



# plot_matrix_Horse_rooster &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_Horse_rooster),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;,
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;Mataducos&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))

####### Handfisher_1 #######

df_Handfisher_1&lt;-df %&gt;% 
  filter(Flight == &quot;Handfisher_1&quot;)

validation_metrics_Handfisher_1&lt;-confusionMatrix(df_Handfisher_1$Pred_Class,df_Handfisher_1$Truth)

conf_mat_Handfisher_1&lt;-validation_metrics_Handfisher_1[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_Handfisher_1[5,]&lt;-NA
conf_mat_Handfisher_1[6,]&lt;-NA
conf_mat_Handfisher_1[2,]&lt;-NA
conf_mat_Handfisher_1[3,]&lt;-NA
conf_mat_Handfisher_1[,5]&lt;-NA
conf_mat_Handfisher_1[,6]&lt;-NA
conf_mat_Handfisher_1[,2]&lt;-NA
conf_mat_Handfisher_1[,3]&lt;-NA

for(i in 1:(nrow(conf_mat_Handfisher_1))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_Handfisher_1[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_Handfisher_1[,i],na.rm = T)
}
conf_mat_std_Handfisher_1&lt;-conf_mat_Handfisher_1

for(row in 1:nrow(conf_mat_std_Handfisher_1)){
  for(col in 1:ncol(conf_mat_std_Handfisher_1)){
    conf_mat_std_Handfisher_1[row,col]&lt;-conf_mat_std_Handfisher_1[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_Handfisher_1[row,col])
    }
}

confmat_rast_Handfisher_1&lt;-conf_mat_std_Handfisher_1 %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_Handfisher_1&lt;-subst(confmat_rast_Handfisher_1, NA, -99)
names(confmat_rast_Handfisher_1)&lt;-&quot;layer&quot;
ext(confmat_rast_Handfisher_1)&lt;-c(22.1,25.9,4.2,7.8)
confmat_rast_Handfisher_1_sf&lt;-as.polygons(confmat_rast_Handfisher_1,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_Handfisher_1_centroid&lt;-st_centroid(confmat_rast_Handfisher_1_sf)</code>
    <code language="r script">values(confmat_rast_Handfisher_1)[values(confmat_rast_Handfisher_1) == 0] = NA
values(confmat_rast_Handfisher_1)[values(confmat_rast_Handfisher_1) == -99] = NA


# plot_matrix_Handfisher_1 &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_Handfisher_1),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;Barbatre&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))


####### Boat #######

df_Boat&lt;-df %&gt;% 
  filter(Flight == &quot;Boat&quot;)

validation_metrics_Boat&lt;-confusionMatrix(df_Boat$Pred_Class,df_Boat$Truth)

conf_mat_Boat&lt;-validation_metrics_Boat[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()

conf_mat_Boat[6,]&lt;-NA
conf_mat_Boat[,6]&lt;-NA
conf_mat_Boat[2,]&lt;-NA
conf_mat_Boat[,2]&lt;-NA

for(i in 1:(nrow(conf_mat_Boat))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_Boat[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_Boat[,i],na.rm = T)
}
conf_mat_std_Boat&lt;-conf_mat_Boat

for(row in 1:nrow(conf_mat_std_Boat)){
  for(col in 1:ncol(conf_mat_std_Boat)){
    conf_mat_std_Boat[row,col]&lt;-conf_mat_std_Boat[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_Boat[row,col])
    }
}

confmat_rast_Boat&lt;-conf_mat_std_Boat %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_Boat&lt;-subst(confmat_rast_Boat, NA, -99)
names(confmat_rast_Boat)&lt;-&quot;layer&quot;
ext(confmat_rast_Boat)&lt;-c(22.1,25.9,8.2,11.8)
confmat_rast_Boat_sf&lt;-as.polygons(confmat_rast_Boat,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_Boat_centroid&lt;-st_centroid(confmat_rast_Boat_sf)</code>
    <code language="r script">values(confmat_rast_Boat)[values(confmat_rast_Boat) == 0] = NA
values(confmat_rast_Boat)[values(confmat_rast_Boat) == -99] = NA



# plot_matrix_Boat &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_Boat),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;Inner Lagoon&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))


####### Arz #######

df_Arz&lt;-df %&gt;% 
  filter(Flight == &quot;Arz&quot;)

validation_metrics_Arz&lt;-confusionMatrix(df_Arz$Pred_Class,df_Arz$Truth)

conf_mat_Arz&lt;-validation_metrics_Arz[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_Arz[3,]&lt;-NA
conf_mat_Arz[,3]&lt;-NA
conf_mat_Arz[2,]&lt;-NA
conf_mat_Arz[,2]&lt;-NA
conf_mat_Arz[5,]&lt;-NA
conf_mat_Arz[,5]&lt;-NA

for(i in 1:(nrow(conf_mat_Arz))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_Arz[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_Arz[,i],na.rm = T)
}
conf_mat_std_Arz&lt;-conf_mat_Arz

for(row in 1:nrow(conf_mat_std_Arz)){
  for(col in 1:ncol(conf_mat_std_Arz)){
    conf_mat_std_Arz[row,col]&lt;-conf_mat_std_Arz[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_Arz[row,col])
    }
}

confmat_rast_Arz&lt;-conf_mat_std_Arz %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_Arz&lt;-subst(confmat_rast_Arz, NA, -99)
names(confmat_rast_Arz)&lt;-&quot;layer&quot;
ext(confmat_rast_Arz)&lt;-c(14.1,17.9,0,3.8)
confmat_rast_Arz_sf&lt;-as.polygons(confmat_rast_Arz,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_Arz_centroid&lt;-st_centroid(confmat_rast_Arz_sf)</code>
    <code language="r script">values(confmat_rast_Arz)[values(confmat_rast_Arz) == 0] = NA
values(confmat_rast_Arz)[values(confmat_rast_Arz) == -99] = NA



# plot_matrix_Arz &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_Arz),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;Arz Island&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))

####### NorthDike #######

df_NorthDike&lt;-df %&gt;% 
  filter(Flight == &quot;NorthDike&quot;)

validation_metrics_NorthDike&lt;-confusionMatrix(df_NorthDike$Pred_Class,df_NorthDike$Truth)

conf_mat_NorthDike&lt;-validation_metrics_NorthDike[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_NorthDike[5,]&lt;-NA
conf_mat_NorthDike[,5]&lt;-NA
conf_mat_NorthDike[2,]&lt;-NA
conf_mat_NorthDike[,2]&lt;-NA

for(i in 1:(nrow(conf_mat_NorthDike))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_NorthDike[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_NorthDike[,i],na.rm = T)
}
conf_mat_std_NorthDike&lt;-conf_mat_NorthDike

for(row in 1:nrow(conf_mat_std_NorthDike)){
  for(col in 1:ncol(conf_mat_std_NorthDike)){
    conf_mat_std_NorthDike[row,col]&lt;-conf_mat_std_NorthDike[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_NorthDike[row,col])
    }
}

confmat_rast_NorthDike&lt;-conf_mat_std_NorthDike %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_NorthDike&lt;-subst(confmat_rast_NorthDike, NA, -99)
names(confmat_rast_NorthDike)&lt;-&quot;layer&quot;
ext(confmat_rast_NorthDike)&lt;-c(18.1,21.9,4.2,7.8)
confmat_rast_NorthDike_sf&lt;-as.polygons(confmat_rast_NorthDike,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_NorthDike_centroid&lt;-st_centroid(confmat_rast_NorthDike_sf)</code>
    <code language="r script">values(confmat_rast_NorthDike)[values(confmat_rast_NorthDike) == 0] = NA
values(confmat_rast_NorthDike)[values(confmat_rast_NorthDike) == -99] = NA


# plot_matrix_NorthDike &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_NorthDike),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;L'Epine&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))

####### Kerdrean #######

df_Kerdrean&lt;-df %&gt;% 
  filter(Flight == &quot;Kerdrean&quot;)

validation_metrics_Kerdrean&lt;-confusionMatrix(df_Kerdrean$Pred_Class,df_Kerdrean$Truth)

conf_mat_Kerdrean&lt;-validation_metrics_Kerdrean[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()
conf_mat_Kerdrean[c(2,3,4,5,6),]&lt;-NA
conf_mat_Kerdrean[,c(2,3,4,5,6)]&lt;-NA

for(i in 1:(nrow(conf_mat_Kerdrean))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat_Kerdrean[i,],na.rm = T)
  df_sum[i,2] &lt;- sum(conf_mat_Kerdrean[,i],na.rm = T)
}
conf_mat_std_Kerdrean&lt;-conf_mat_Kerdrean

for(row in 1:nrow(conf_mat_std_Kerdrean)){
  for(col in 1:ncol(conf_mat_std_Kerdrean)){
    conf_mat_std_Kerdrean[row,col]&lt;-conf_mat_std_Kerdrean[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_Kerdrean[row,col])
    }
}

confmat_rast_Kerdrean&lt;-conf_mat_std_Kerdrean %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

confmat_rast_Kerdrean&lt;-subst(confmat_rast_Kerdrean, NA, -99)
names(confmat_rast_Kerdrean)&lt;-&quot;layer&quot;
ext(confmat_rast_Kerdrean)&lt;-c(22.1,25.9,0,3.8)
confmat_rast_Kerdrean_sf&lt;-as.polygons(confmat_rast_Kerdrean,aggregate=F) %&gt;% 
  sf::st_as_sf()
confmat_rast_Kerdrean_centroid&lt;-st_centroid(confmat_rast_Kerdrean_sf)</code>
    <code language="r script">values(confmat_rast_Kerdrean)[values(confmat_rast_Kerdrean) == 0] = NA
values(confmat_rast_Kerdrean)[values(confmat_rast_Kerdrean) == -99] = NA


# plot_matrix_Kerdrean &lt;-
# ggplot()+
#   geom_spatraster(data = (confmat_rast_Kerdrean),
#                   show.legend = F,
#                   na.rm = TRUE
#                   )+
#   scale_fill_Bede(&quot;mixed&quot;, 
#                   discrete = F,
#                   na.value = &quot;white&quot;,
#                   trans = &quot;sqrt&quot;,
#                   labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+
#   labs(fill = &quot;Proportion \n of pixels (%)&quot;)+
#   scale_x_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Sediment&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#                      expand = c(0, 0),
#                      position = &quot;top&quot;,
#                      limits = c(0,10))+
#   scale_y_continuous(breaks = seq(1,9, by = 2),
#                      labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Sediment&quot;),
#                      expand = c(0, 0.1),
#                      limits = c(0,10))+
#   geom_path(
#     data = data.frame(
#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),
#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),
#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)
#       ),
#     aes(x,y,group= group),
#     linewidth = 1
#     )+
#   theme_void()+
#   ggtitle(&quot;L'Epine&quot;)+
#   theme(plot.title = element_text(hjust = 0.5),
#         plot.margin = unit(c(0,30,0,30), &quot;pt&quot;))
# 

confmat_rast_Arz_centroid&lt;-confmat_rast_Arz_centroid %&gt;% 
  mutate(site = &quot;Arz&quot;)
confmat_rast_Boat_centroid&lt;-confmat_rast_Boat_centroid %&gt;% 
  mutate(site = &quot;Boat&quot;)
confmat_rast_DuerLow_centroid&lt;-confmat_rast_DuerLow_centroid %&gt;% 
  mutate(site = &quot;DuerLow&quot;)
confmat_rast_GafanhaHigh_centroid&lt;-confmat_rast_GafanhaHigh_centroid %&gt;% 
  mutate(site = &quot;Gaf_High&quot;)
confmat_rast_GafanhaLow_centroid&lt;-confmat_rast_GafanhaLow_centroid %&gt;% 
  mutate(site = &quot;Gaf_Low&quot;)
confmat_rast_Handfisher_1_centroid&lt;-confmat_rast_Handfisher_1_centroid %&gt;% 
  mutate(site = &quot;Handfisher&quot;)
confmat_rast_Horse_rooster_centroid&lt;-confmat_rast_Horse_rooster_centroid %&gt;% 
  mutate(site = &quot;Rooster&quot;)
confmat_rast_Kerdrean_centroid&lt;-confmat_rast_Kerdrean_centroid %&gt;% 
  mutate(site = &quot;kerdrean&quot;)
confmat_rast_NorthDike_centroid&lt;-confmat_rast_NorthDike_centroid %&gt;% 
  mutate(site = &quot;Dike&quot;)




centroid_cells&lt;-rbind(confmat_rast_Arz_centroid,confmat_rast_Boat_centroid,confmat_rast_DuerLow_centroid,confmat_rast_GafanhaHigh_centroid,confmat_rast_GafanhaLow_centroid,confmat_rast_Handfisher_1_centroid,confmat_rast_Horse_rooster_centroid,confmat_rast_Kerdrean_centroid,confmat_rast_NorthDike_centroid) %&gt;% 
  filter(layer == -99)


##### Global #####

validation_metrics&lt;-confusionMatrix(df$Pred_Class,df$Truth)

metrics_by_class&lt;-validation_metrics$byClass %&gt;% 
    as.data.frame()

conf_mat&lt;-validation_metrics[[2]] %&gt;% 
  as.numeric() %&gt;%
  base::matrix(ncol = 6) %&gt;%
  as.data.frame()

for(i in 1:(nrow(conf_mat))){
  if(i == 1 ){
    df_sum&lt;-data.frame(row = NA,
                       col = NA)
  }
  df_sum[i,1] &lt;- sum(conf_mat[i,])
  df_sum[i,2] &lt;- sum(conf_mat[,i])
}

conf_mat_std&lt;-conf_mat
for(row in 1:nrow(conf_mat_std)){
  for(col in 1:ncol(conf_mat_std)){
    conf_mat_std[row,col]&lt;-conf_mat_std[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std[row,col])
    }
  
}

confmat_rast&lt;-conf_mat_std %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

names(confmat_rast)&lt;-&quot;layer&quot;
ext(confmat_rast)&lt;-c(0,12,0,12)
# crs(confmat_rast)&lt;-&quot;4326&quot;

 values(confmat_rast)[values(confmat_rast) == 0] = NA
 
 
df_summarize&lt;-df %&gt;% 
  group_by(Flight) %&gt;% 
  summarize(n = length(Flight)) %&gt;% 
  ungroup() %&gt;% 
  mutate(prop = n / sum(n),
         Site = case_when(Flight == &quot;GafanhaHigh&quot; ~ &quot;Gafanha High&quot;,
                   Flight == &quot;GafanhaLow&quot; ~ &quot;Gafanha Low&quot;,
                   Flight == &quot;Boat&quot; ~ &quot;Marinha Lanzarote&quot;,
                   Flight == &quot;Horse_rooster&quot; ~ &quot;Mataducos&quot;,
                   Flight == &quot;NorthDike&quot; ~ &quot;L'Epine&quot;,
                   Flight == &quot;Handfisher_1&quot; ~ &quot;Barbâtre&quot;,
                   Flight == &quot;Arz&quot; ~ &quot;Arz Island&quot;,
                   Flight == &quot;DuerLow&quot; ~ &quot;Duer&quot;,
                   TRUE ~ Flight))

df_corrected_accuracy&lt;-data.frame(
      x = c(1,3,5,7,9,11),
      y = c(11,9,7,5,3,1),
      lab = c(metrics_by_class[1,11],metrics_by_class[2,11], metrics_by_class[3,11], metrics_by_class[4,11],metrics_by_class[5,11],metrics_by_class[6,11]))
 
df_Sens_Spec&lt;-data.frame(
    x = c(1,3,5,7,9, 11, 12.9, 12.9, 12.9, 12.9, 12.9,12.9),
    y = c(-0.3,-0.3,-0.3,-0.3,-0.3,-0.3,11,9,7,5,3,1),
    lab = c(metrics_by_class$Recall[c(1:6)],metrics_by_class$Precision[c(1:6)])
)



df_Label_Sites&lt;-data.frame(
    x = c(16,20,24,16,20,24,16,20,24),
    y = c(12,12,12,8,8,8,4,4,4),
    lab = c(paste0(&quot;Gafanha High, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;GafanhaHigh&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Gafanha Low, &quot;,df_summarize %&gt;% 
                     filter(Flight == &quot;GafanhaLow&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Inner Lagoon, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;Boat&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Mataducos, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;Horse_rooster&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;L'Epine, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;NorthDike&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Barbâtre, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;Handfisher_1&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Arz Island, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;Arz&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Duer, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;DuerLow&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)),
            paste0(&quot;Kerdrean, &quot;, df_summarize %&gt;% 
                     filter(Flight == &quot;Kerdrean&quot;) %&gt;% 
                     pull(prop) %&gt;% 
                     round(2)))
)

x_axis_text&lt;-data.frame(
    x = c(1,3,5,7,9,11),
    y = c(12.5,12.5,12.5,12.5,12.5,12.5),
    lab = c(&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;)
)

y_axis_text&lt;-data.frame(
    x = c(-0.4,-0.4,-0.4,-0.4,-0.4,-0.4),
    y = c(11,9,7,5,3,1),
    lab = c(&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;)
)


centroid_cells_df&lt;-data.frame(st_coordinates(st_cast(centroid_cells$geometry,&quot;MULTIPOINT&quot;)),centroid_cells$site)

centroid_cells_df$col &lt;-NA
centroid_cells_df$row &lt;-NA



for(i in 1:length(unique(centroid_cells_df$centroid_cells.site))){
  
  df_temp&lt;-centroid_cells_df %&gt;% 
    filter(centroid_cells_df$centroid_cells.site == unique(centroid_cells_df$centroid_cells.site)[i])
  
  #### Column 
  
  for( ii in 1:length(unique(as.character(df_temp$X)))){
    if(nrow(df_temp %&gt;% 
            filter(X == unique(as.character(df_temp$X))[ii])) == 6){
      
      centroid_cells_df&lt;-centroid_cells_df %&gt;% 
        mutate(col = case_when(centroid_cells.site == unique(centroid_cells_df$centroid_cells.site)[i] ~
                         case_when(as.character(X) == unique(as.character(df_temp$X))[ii] ~ 
                                   paste0(&quot;col&quot;,ii),
                                   TRUE ~ col),
                         TRUE ~ col))
    }
  }
  
  #### ROW
  for( iii in 1:length(unique(as.character(df_temp$Y)))){
    if(nrow(df_temp %&gt;% 
            filter(Y == unique(as.character(df_temp$Y))[iii])) == 6){
      
      centroid_cells_df&lt;-centroid_cells_df %&gt;% 
        mutate(row = case_when(centroid_cells.site == unique(centroid_cells_df$centroid_cells.site)[i] ~
                         case_when(as.character(Y) == unique(as.character(df_temp$Y))[iii] ~ 
                                   paste0(&quot;row&quot;,iii),
                                   TRUE ~ row),
                         TRUE ~ row))
    }
  }
  
}

# other_table_path&lt;-data.frame(
#   x = c(1,25,1,25,1,25,1,25,
#         1,1,5,5,9,9,13,13,17,17,21,21,25,25
#         ),
#   y= c(-2,-2,-3,-3,-4,-4,-5,-5,
#        -2,-5,-2,-5,-2,-5,-2,-5,-2,-5,-2,-5,-2,-5
#        ),
#   group=c(1,1,9,9,10,10,11,11,
#           2,2,3,3,4,4,5,5,6,6,7,7,8,8
#           )
# )
# 
# other_table_title &lt;- data.frame(
#   x = c(-1,3,7,11,15,19,23),
#   y = c(-1.5,-1.5,-1.5,-1.5,-1.5,-1.5,-1.5),
#   label = c(&quot;Metrics&quot;,&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
#   group = c(1,2,3,4,5,6,7)
# )
# 
# accuracy_by_class&lt;-validation_metrics$byClass %&gt;% 
#   as.data.frame()
# 
# other_table_values &lt;- data.frame(
#   x = c(3,7,11,15,19,23,
#         3,7,11,15,19,23,
#         3,7,11,15,19,23),
#   y = c(-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,
#         -3.5,-3.5,-3.5,-3.5,-3.5,-3.5,
#         -4.5,-4.5,-4.5,-4.5,-4.5,-4.5),
#   label = round(c(accuracy_by_class$Sensitivity[c(1:6)],
#             accuracy_by_class$Specificity[c(1:6)],
#             accuracy_by_class<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>Discriminating Seagrasses From Green Macroalgae in
European Intertidal areas using high resolution multispectral drone
imagery.</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0001-7161-5246</contrib-id>
<name>
<surname>Oiry</surname>
<given-names>Simon</given-names>
</name>
<string-name>Simon Oiry</string-name>

<email>oirysimon@gmail.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">Writing</role>
<role>Data acquisition</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Davies</surname>
<given-names>Bede Ffinian Rowe</given-names>
</name>
<string-name>Bede Ffinian Rowe Davies</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gernez</surname>
<given-names>Pierre</given-names>
</name>
<string-name>Pierre Gernez</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sousa</surname>
<given-names>Ana I.</given-names>
</name>
<string-name>Ana I. Sousa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rosa</surname>
<given-names>Philippe</given-names>
</name>
<string-name>Philippe Rosa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zoffoli</surname>
<given-names>Maria Laura</given-names>
</name>
<string-name>Maria Laura Zoffoli</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-3">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brunier</surname>
<given-names>Guillaume</given-names>
</name>
<string-name>Guillaume Brunier</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-4">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Barillé</surname>
<given-names>Laurent</given-names>
</name>
<string-name>Laurent Barillé</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Nantes University</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Aveiro University</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>CNR ISMAR</institution>
</institution-wrap>







</aff>
<aff id="aff-4">
<institution-wrap>
<institution>JeSaisPas</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">oirysimon@gmail.com</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-02-27">
<year>2024</year>
<month>2</month>
<day>27</day>
</pub-date>







<history></history>


<abstract>
<p>Coastal areas host seagrass meadows, which offer crucial ecosystem
services including erosion control and carbon sequestration. However,
these areas are increasingly impacted by human activities, leading to
seagrass decline and habitat fragmentation. In situ surveys,
traditionally performed to monitor these ecosystems face limitations on
temporal and spatial coverage, particularly in intertidal zones,
prompting the use of satellite data within monitoring programs. Yet,
satellite remote sensing struggles with spatial and spectral resolution,
making it difficult to discriminate seagrass from other macrophytes in
highly heterogenous meadows. To address these challenges, drone images
acquired with multi-spectral sensors offer a promising solution. This
study focuses on using drones acquisitions for mapping intertidal
macrophytes, effectively discriminating between seagrass and green
macroalgae. Ten drone flights were conducted at two different altitudes
(12m and 120m) across diverse European habitats in France and Portugal.
Low altitude flights were used to train a Deep Learning classifier based
on Neural Networks to discrimintate among 5 intertidal vegetation
classes. Drone mapping demonstrated an overall accuracy of 94% across
all the sites and images, covering a total area of 467 000 m². The model
exhibited an accuracy of 96.4% in identifying seagrass.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Drone</kwd>
<kwd>Remote Sensing</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1. Introduction</title>
  <p>Coastal areas are vital hotshots for marine biodiversity, with
  intertidal seagrass meadows playing a crucial role at the interface
  between land and ocean
  (<xref alt="Unsworth et al. 2022" rid="ref-unsworth2022" ref-type="bibr">Unsworth
  et al. 2022</xref>). These meadows offer a myriad of ecosystem
  services to humanity, including limitation of coastline erosion,
  reducing the risk of eutrophication, carbon sequestration, and oxygen
  production. They serve as vital habitats for a diverse array of marine
  and terrestrial species, providing living, breeding, and feeding
  grounds
  (<xref alt="Gardner and Finlayson 2018" rid="ref-gardner2018" ref-type="bibr">Gardner
  and Finlayson 2018</xref> ;
  <xref alt="Zoffoli et al. 2022" rid="ref-Zoffoli2022" ref-type="bibr">Zoffoli
  et al. 2022</xref> ;
  <xref alt="Jankowska et al. 2019" rid="ref-jankowska2019" ref-type="bibr">Jankowska
  et al. 2019</xref>). Due to their proximity to human activities,
  seagrass meadows are directly exposed to and impacted by anthropogenic
  pressures. Global regression and fragmentation are currently observed
  due to diseases, disasters, coastal urbanization, sea reclamation, as
  well as fishing activities, dredging, sea level rise, coastal erosion,
  competition with alien species, and reduction in water quality
  (<xref alt="Nguyen et al. 2021" rid="ref-nguyen2021" ref-type="bibr">Nguyen
  et al. 2021</xref> ;
  <xref alt="Soissons et al. 2018" rid="ref-soissons2018" ref-type="bibr">Soissons
  et al. 2018</xref> ;
  <xref alt="Orth et al. 2006" rid="ref-orth2006" ref-type="bibr">Orth
  et al. 2006</xref> ;
  <xref alt="Lin et al. 2018" rid="ref-lin2018" ref-type="bibr">Lin et
  al. 2018</xref> ;
  <xref alt="Duffy et al. 2019" rid="ref-duffy2019" ref-type="bibr">Duffy
  et al. 2019</xref>). While improvements in water quality have been
  recently reported in European sites, allowing an overall recovery of
  seagrass ecosystems at the local scale, many other coastal waters
  worldwide are still subjected to strong eutrophication processes
  (<xref alt="Los Santos et al. 2019" rid="ref-deSantos2019" ref-type="bibr">Los
  Santos et al. 2019</xref> ;
  <xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021" ref-type="bibr">Zoffoli
  et al. 2021</xref>). Coastal eutrophication has been associated to
  anomalous accumulation of green macroalgae, the so-called green tides.
  Green tides produce shade and suffication over seagrass individuals,
  thus threatening the health of seagrass ecosystems
  (<xref alt="Duarte2002?" rid="ref-Duarte2002" ref-type="bibr"><bold>Duarte2002?</bold></xref>
  ; <xref alt="Wang et al. 2022" rid="ref-wang2022" ref-type="bibr">Wang
  et al. 2022</xref>).</p>
  <p>The importance of seagrass meadows and the variety of ecosystem
  services they provide have led to the enhancement of global and
  regional monitoring programs for systematically surveying different
  Essential Oceanic Variable
  (<xref alt="Miloslavich et al. 2018" rid="ref-Miloslavich2018" ref-type="bibr">Miloslavich
  et al. 2018</xref>) as seagrass coverage and composition; as well as
  Essential Biodiversity Variable
  (<xref alt="Pereira et al. 2013" rid="ref-Pereira2013" ref-type="bibr">Pereira
  et al. 2013</xref>) such as seagrass taxonomic diversity; species
  distribution, population abundance, and phenology. Monitoring programs
  also prioritize the identification of threats to these ecosystems,
  particularly during early stages, to facilitate effective mitigation
  actions. Traditionally, these ecological parameters have been
  quantified through in situ measurements, although this approach faces
  several constraints over intertidal zones. Intertidal meadows are only
  partially exposed during low tide and can be situated in
  difficult-to-reach mudflats, potentially leading to inaccurate and
  limited estimations with conventional sampling techniques
  (<xref alt="Nijland, Reshitnyk, and Rubidge 2019" rid="ref-nijland2019" ref-type="bibr">Nijland,
  Reshitnyk, and Rubidge 2019</xref>). However, satellite data have been
  proven effective in complenmenting in situ surveys, allowing for the
  rapid and consitent retrieval of EOV’s over extensive seagrass
  meadows.
  (<xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021" ref-type="bibr">Zoffoli
  et al. 2021</xref> ;
  <xref alt="Xu et al. 2021" rid="ref-xu2021" ref-type="bibr">Xu et al.
  2021</xref> ;
  <xref alt="Traganos and Reinartz 2018" rid="ref-Traganos2018" ref-type="bibr">Traganos
  and Reinartz 2018</xref> ;
  <xref alt="Coffer et al. 2023" rid="ref-coffer2023" ref-type="bibr">Coffer
  et al. 2023</xref>)</p>
  <p>Satellite remote sensing offers the advantage of acquiring
  large-scale data in real-time but presents its inherent challenges.
  Free access satellite data (e.g., Sentinel-2 and Landsat8/9) provide
  relatively low spatial resolution data (10 - 30 m) across a limited
  number of spectral bands. These characteristics can be a limitation to
  accurately discriminating seagrass from others co-existing macrophytes
  over the meadow. Chlorophyceae (Green Algae) and marine Magnoliopsida
  (Seagrass) share the same pigment composition
  (<xref alt="Ralph et al. 2002" rid="ref-ralph2002" ref-type="bibr">Ralph
  et al. 2002</xref> ;
  <xref alt="Douay et al. 2022" rid="ref-Douay2022" ref-type="bibr">Douay
  et al. 2022</xref>). As a result, their respective spectral signatures
  can be considered similar by a non-expert observer
  (<xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023" ref-type="bibr">Davies,
  Gernez, et al. 2023</xref> ;
  <xref alt="Bannari, Ali, and Abahussain 2022" rid="ref-bannari2022" ref-type="bibr">Bannari,
  Ali, and Abahussain 2022</xref>). Recently, using a hyperspectral
  library, Davies, Gernez, et al.
  (<xref alt="2023" rid="ref-Davies2023" ref-type="bibr">2023</xref>)
  demonstrated that the spectral resolution of Sentinel-2, might be
  enough for the discrimination between Magnoliopsida and Chlorophyceae.
  However, green tide events occur at small spatial scales that are not
  observable using satellite imagery
  (<xref alt="Tuya et al. 2013" rid="ref-tuya2013" ref-type="bibr">Tuya
  et al. 2013</xref>), especially during the initial stage of the
  event.</p>
  <p>Remote sensing drone acquisitions are presented as a tool that can
  potentially fill gaps left by satellite and in situ data. Drone can
  cover large expanses while recording imagery at significantly higher
  spatial resolutions than satellite (pixel size from cm to mm) and
  still capturing data at multi-spectral resolution
  (<xref alt="Fairley et al. 2022" rid="ref-fairley2022drone" ref-type="bibr">Fairley
  et al. 2022</xref> ;
  <xref alt="Oh, Kim, and Lee 2017" rid="ref-oh2017use" ref-type="bibr">Oh,
  Kim, and Lee 2017</xref>). The versatility of drones allows for their
  application across a diverse thematic range , from coastal zone
  management
  (<xref alt="Adade et al. 2021" rid="ref-adade2021" ref-type="bibr">Adade
  et al. 2021</xref> ;
  <xref alt="Casella et al. 2020" rid="ref-casella2020" ref-type="bibr">Casella
  et al. 2020</xref> ;
  <xref alt="Angnuureng et al. 2022" rid="ref-angnuureng2022" ref-type="bibr">Angnuureng
  et al. 2022</xref>) to mapping the spatial distribution of species
  (<xref alt="Joyce, Fickas, and Kalamandeen 2023" rid="ref-joyce2023" ref-type="bibr">Joyce,
  Fickas, and Kalamandeen 2023</xref> ;
  <xref alt="Tallam et al. 2023" rid="ref-tallam2023" ref-type="bibr">Tallam
  et al. 2023</xref> ;
  <xref alt="Roca et al. 2022" rid="ref-Roca2022" ref-type="bibr">Roca
  et al. 2022</xref> ;
  <xref alt="Román et al. 2021" rid="ref-Roman2021" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic" ref-type="bibr">Brunier
  et al. 2022</xref>). However, when applied to coastal habitat mapping,
  many studies showcase their findings with study case limited to a
  single flight, restricting the generalizability of their application
  to other sites
  (<xref alt="Román et al. 2021" rid="ref-Roman2021" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Collin et al. 2019" rid="ref-collin2019improving" ref-type="bibr">Collin
  et al. 2019</xref> ;
  <xref alt="Rossiter et al. 2020" rid="ref-rossiter2020uav" ref-type="bibr">Rossiter
  et al. 2020</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic" ref-type="bibr">Brunier
  et al. 2022</xref>). This study aimed to analyze the potential of a
  drone equipped with a multispectral sensor for maping intertidal
  macrophytes, with a particular focus on discriminating Magnoliopsida
  and Chlorophyceae. Ten drone flights were performed over soft-bottom
  intertidal areas along two European countries (France and Portugal),
  covering a wide range of habitats, from monospecific seagrass meadows
  to meadows mixed with green or red algae. A deep learning algorithm
  was trained and validated for macrophyte discrimination, emphasizing
  applicability across diverse sites without a loss of accuracy in
  predictions.</p>
</sec>
<sec id="material-methods">
  <title>2. Material &amp; Methods</title>
  <sec id="study-sites">
    <title>2.1 Study sites</title>
    <p>Seven study sites distributed between France and Portugal were
    selected for their relatively extensive intertidal seagrass beds.
    Two sites are located in Gulf of Morbihan
    (<xref alt="Figure 1" rid="fig-map">Figure 1</xref> A), France
    (47.5791°N, 2.8018°W). This gulf covers an area of 115 km² and is
    only connect to the sea through a 900m wide channel. A total of 53
    small islands are scattered across the gulf leading to 250 km of
    shorelines. Patchy seagrass meadows can be found on a lot of these
    islands. Within the Gulf of Morbihan we have chosen two sites : One
    is located in one of these island (Arz island). The other one is
    located in the sourthern part of the Gulf (Duer). Two others sites
    are located in Bourgneuf Bay, France (46.9849°N, 2.1488°W). This bay
    is a semi-enclosed macrotidal bay, protected from waves by
    Noirmoutier Island. With up to 6m in tidal range during spring tide,
    a 6 km² seagrass meadow can uncover at low tide. The sites we
    surveyed (L’Epine and Barbatre,
    <xref alt="Figure 1" rid="fig-map">Figure 1</xref> B) are located in
    the southernmost part of the bay, along the Noirmoutier Island, and
    host a monospecific <italic>Zostera noltei</italic> seagrass bed
    with very little mixing with other macrophytes. Three sites have
    been survey in the Ria de Aveiro Lagoon in Portugal (40.6887°N,
    8.6810°W). The extent of this lagoon is about 80 km² with many
    narrow channels, large salt marshes and many mudflats that uncovers
    at low tide. It is connected to the open sea through a single
    channel, with a tidal lag between the North and the South of the
    lagoon. The southernmost site (Gafanha) is a mudflat located in an
    affluent of the lagoon whereas the two other sites are situated in
    the middle of the lagoon and are only accessible by boat
    (<xref alt="Figure 1" rid="fig-map">Figure 1</xref> C). These
    Portuguese sites were characterized by a more diverse intertidal
    area, where the seagrass meadow could intermingle with red algae
    (Rhodophyceae), brown algae (Phaeophyceae), or green algae
    (Chlorophyceae).</p>
    <fig id="fig-map">
      <caption><p>Figure 1: Sites where the different drone flights were
      made. A: Gulf of Morbihan, B: Bourngeuf Bay, C: Ria de Aveiro
      Lagoon. Light green represent terrestrial areas whereas darkgreen
      represent intertidal areas.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Fig1_Map_Drone_Sites.png" />
    </fig>
  </sec>
  <sec id="drone-data">
    <title>2.2 Drone Data</title>
    <p>At each location, a DJI Matrice 200 quadcopter drone equipped
    with a Micasense RedEdge Dual MX multispectral camera was flown to
    take 1.2 million pixel reflectance photographs in 10 spectral bands,
    from blue (444 nm) to near infrared (840 nm). An angle of 90° has
    been maintained between the sun and the drone’s route to guarantee
    uniform lighting conditions between flight lines. A side overlap of
    70% and a front overlap of 80% between each image has been set.
    Images have been calibrated in reflectance using a calibration panel
    reflective at ~50% provided by the camera’s manufaturer and a
    Downwelling Light Sensor (DLS2) that was utilized to acquire
    irradiance data during the flight. A Structure-from-Motion
    photogrammetry software (Agisoft Metashape) has been used to process
    images to obtain multispectral orthomosaics of each flight. The
    workflow for orthomosaicking has remained consistent for every
    flight. First, tying key points were detected inside of each image
    and between overlapping images in order to obtain a sparse point
    cloud. This cloud was cleaned using reprojection accuracy metric in
    order to remove noisy points. A dense point cloud has been then
    produced using a structure from motion algorithm. A surface
    interpolation of this dense point cloud has been made to obtain a
    Digital Surface Model (DSM), used to reconstruct the multispectral
    ortho-image. Across all the sites, flights were made at two
    different altitudes : 12 m or/and 120 m. Low altitude drone flights
    produce ortho-images with a very high spatial resolution (8 mm per
    pixel), making it simple to visually distinguish between the various
    types of vegetation. High altitude fights on the other hand allow to
    cover large areas and produced images with a pixel size of 80 mm
    (Table 1).</p>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table1-1.png" />
  </sec>
  <sec id="field-sampling">
    <title>2.3 Field sampling</title>
    <p>Before each flight, targets used as Ground Control Points (GCPs)
    were dispersed and georeferenced with a Trimble © Geo XH 6000
    differential GPS (dGPS). GCPs were used to correct georeferencing
    imprecision of orthomosaics with an horizontal and vertical accuracy
    of 10cm. dGPS was also used to georeference quardrats of 0.25cm²
    used to assess the presence or absence of 5 key classes of
    vegetation : Bacillariophyceae (Diatoms forming large biofilm over
    the sediment during low tide), Phaeophyceae (Brown algae),
    Magnoliopsida (Seagrass), Chlorophyceae (Green algae) and
    Rhodophyceae (Red algae)
    (<xref alt="Figure 2" rid="fig-vegetation">Figure 2</xref>). Picture
    of each quadrat were taken and uploaded on the online on the Global
    Biodiversity Information Facility (GBIF) platform
    (<xref alt="Davies, Sousa, et al. 2023" rid="ref-BedeGbif" ref-type="bibr">Davies,
    Sousa, et al. 2023</xref>). Each photograph was also processed to
    estimate the percent cover of each type of vegetation. Georeferenced
    hyperspectral reflectance signatures of each vegetation class were
    also sampled using an ASD FieldSpec HandHeld 2 spectroradiomete,
    which acquires reflectance between 325 and 1075 nm, with 1 nm of
    spectral resolution. The methodological scheme followed in this
    study is presented in
    <xref alt="Figure 3" rid="fig-workflow">Figure 3</xref>.</p>
    <fig id="fig-vegetation">
      <caption><p>Figure 2: Class of vegetation used to train the CNN
      model and their standardised spectral signature</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Spectral_shapes_total.png" />
    </fig>
  </sec>
  <sec id="intertidal-vegetation-mapping">
    <title>2.4 Intertidal vegetation mapping</title>
    <fig id="fig-workflow">
      <caption><p>Figure 3: Schematic representation of the workflow.
      Diamonds represent input or output data, and rectangles represent
      Python processing algorithms. The overall workflow of this study
      is divided into two distinct parts based on the spatial resolution
      of the drone flights: high-resolution flights were utilized for
      training and prediction of the CNN model, whereas low-resolution
      flights were solely employed for prediction
      purposes.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Figure3_workflow.png" />
    </fig>
    <p>The spectral similarities of reflectance signatures between
    intertidal green macrophytes (Magnoliopsida and Chlorophyceae) make
    their discrimination challenging using simple classification
    algorithms
    (<xref alt="Figure 2" rid="fig-vegetation">Figure 2</xref> F). To
    overcome this challenge, a deep learning classification method was
    developed, trained, validated, and applied to each drone flight
    (<xref alt="Figure 3" rid="fig-workflow">Figure 3</xref>).</p>
    <sec id="neural-network-model-building">
      <title>2.4.1 Neural Network model building</title>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table2-1.png" />
      <p>A dataset containing photo-interpreted drone reflectance pixels
      was built to train a Convolutional Neural Network (CNN) model with
      2 hidden layers. The training pixels were categorized into 7
      different classes, representing the various habitats encountered
      at the different study sites: Sediment, Water, Chlorophyceae,
      Magnoliopsida, Bacillariophyceae, Phaeophyceae and Rhodophyceae.
      Only low-altitude flights (Table 1) were used for training
      purposes because of their 8 mm spatial resolution allowing to
      avoid spectral sub-pixel mixing and to accurately visually
      differentiate various vegetation classes. More than 418,000 pixels
      at 8 mm resolution from the 3 training flights have been used to
      train the model (Table 2). Twenty one variables were used by the
      model as predictors: 10 raw spectral bands of the Micasense
      RedEdge Dual MX multispectral camera (ranging from 444 nm to 840
      nm), the same 10 spectral bands standardized using a min/max
      transformation
      (<xref alt="Equation 1" rid="eq-std">Equation 1</xref> ;
      (<xref alt="cao2017?" rid="ref-cao2017" ref-type="bibr"><bold>cao2017?</bold></xref>))
      and the NDVI
      (<xref alt="Equation 2" rid="eq-ndvi">Equation 2</xref>).
      Standardisation of spectral bands is used to eliminate the scaling
      differences between spectra and to limit the effect of biomass on
      the shape of the spectra
      (<xref alt="Douay et al. 2022" rid="ref-Douay2022" ref-type="bibr">Douay
      et al. 2022</xref> ;
      <xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023" ref-type="bibr">Davies,
      Gernez, et al. 2023</xref>).</p>
      <p><styled-content id="eq-std"><disp-formula><alternatives>
      <tex-math><![CDATA[
      R_{i}^{*}(\lambda) = \frac{R_{i}(\lambda) - min(R_{i})}{max(R_{i})- min(R_{i})}
       \qquad(1)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R_{i}(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at the wavelength
      <inline-formula><alternatives>
      <tex-math><![CDATA[(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      of each individual spectra <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives>
      <tex-math><![CDATA[min(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives>
      <tex-math><![CDATA[max(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      are the minimum and maximum value of the spectra
      <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p><styled-content id="eq-ndvi"><disp-formula><alternatives>
      <tex-math><![CDATA[
      NDVI = \frac{R(840nm)-R(668nm)}{R(840nm)+R(668nm)}
       \qquad(2)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R(840nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 840 nm and <inline-formula><alternatives>
      <tex-math><![CDATA[R(668nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 668 nm.</p>
    </sec>
    <sec id="validation">
      <title>2.4.2 Validation</title>
      <p>The CNN model was applied to all the 9 flights at both 12 and
      120 m of altitude. In situ information on georeferenced class type
      and percent cover collected during each flight has been used to
      assess the CNN accuracy. These images were used to construct a
      validation dataset indicating the presence or absence of each
      class. Additionally to the quadrat-based validation dataset,
      polygons of each class were photo interpreted in order to increase
      the number of pixels of the validation dataset. A confusion
      matrix, along with precision metrics such as the global accuracy,
      the sensitivity, the specificity, and the Kappa coefficient, was
      generated for each of the study sites. Finally each validation
      matrix has been merge to create a unique matrix of the model. A
      total of 536,000 pixels has been used to globally validate the CNN
      model.</p>
    </sec>
  </sec>
</sec>
<sec id="results">
  <title>3. Results</title>
  <sec id="classification">
    <title>3.1 Classification</title>
    <p>A total of 9 prediction maps corresponding to the 9 drone flights
    were obtained. Each prediction map is associated with a probability
    map, indicating the probability of the selected class for every
    pixel. The low-altitude flight conducted in Gafanaha, Portugal,
    represents the site with the highest complexity
    (<xref alt="Figure 4" rid="fig-GafLow">Figure 4</xref>). Among the 5
    vegetation classes on which the CNN model was trained, 4 were
    present on this site. On this site, there is a mixture of
    Chlorophyceae and Rhodophyceae over the seagrass meadow. This is
    also where Bacillariophyceae is most abundant. Although the seagrass
    bed is solely composed of <italic>Zostera noltei</italic>, various
    colors can be observed: dark green (indicating healthy beds with
    100% coverage) and whitish/brown (indicating beds where leaves are
    dying). Regardless of the color, the meadow is predicted as
    Magnoliopsida by the CNN model.</p>
    <fig id="fig-GafLow">
      <caption><p>Figure 4: RGB orthomosaic (Left) and Prediction
      (Right) of the low altitude flight of Gafanaha, Portugal. The
      total extent of this flight is 3000m² with a resolution of 8 mm
      per pixel. Background colors means intertidal area (Light Green)
      and land area (Light Grey). The zoom covers an area equivalent to
      a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_Low_Pred.png" />
    </fig>
    <p>The high-altitude flight over Gafanha covered nearly 1 km² in
    total (<xref alt="Figure 5" rid="fig-GafHigh">Figure 5</xref>). A
    channel delineating a small island was present in the flight, but it
    has been masked in the prediction map due to glinting and
    misclassification caused by the turbid shallow water. Most of the
    intertidal area has been classified as Magnoliopsida by the model,
    even though there is discoloration of seagrass blades. Only a few
    pixels have been classified as Chlorophyceae at this scale.
    Furthermore, the area that was classified as Bacillariophyceae in
    the low-altitude flight remains mostly classified as such in the
    high-altitude flight, but some pixels of it are now classified as
    Magnoliopsida. The patches of Rhodophyceae are still well
    classified. <italic>Spartina sp.</italic> was present in the
    northern part of the flight, near the land, and has been classified
    either as Magnoliopsida or as Phaeophyceae.</p>
    <fig id="fig-GafHigh">
      <caption><p>Figure 5: RGB orthomosaic (Left) and Prediction
      (Right) of the high altitude flight of Gafanaha, Portugal. The
      total extent of this flight is about 1 km² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green), land area (Light Grey) and water (Light Blue). The red
      triangle shows the extent of the low altitude flight of Gafanha.
      The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel
      size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_High_Pred.png" />
    </fig>
    <p>The High altitude flight made in the inner lagoon of the Ria de
    Aveiro is the largest of all flights, covering almost 1.5 km²
    (<xref alt="Figure 6" rid="fig-Boat">Figure 6</xref>). On this site,
    only seagrass and red algae where seen on the field. The
    classification follows the same pattern, with a patchy Magnoliopsida
    meadow mixed on the eastern part of the flight with Rhodophyceae. As
    shown in the zoom
    (<xref alt="Figure 6" rid="fig-Boat">Figure 6</xref>), the edges of
    the meadow can be colonised by Chlorophyceae.</p>
    <fig id="fig-Boat">
      <caption><p>Figure 6: RGB orthomosaic (Top) and Prediction
      (Bottom) of the flight made in the inner part of Ria de Aveiro
      Lagoon, Portugal. The total extent of this flight is about 1.5 km²
      with a resolution of 80 mm per pixel. Background colors means
      intertidal area (Light Green), land area (Light Grey) and water
      (Light Blue). The zoom covers an area equivalent to a 10-meter
      Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Boat_Pred.png" />
    </fig>
    <p>The flight over L’Epine in Noirmoutier Island, France
    (<xref alt="Figure 7" rid="fig-Dike">Figure 7</xref>) was conducted
    near a dike crossing the northern part of the flight from west to
    east. Alongside this dike, brown algae attached to rocks and
    stranded green algae could be found. Despite the high mixture
    between Chlorophyceae and Magnoliopsida in this flight, these two
    classes are well discriminated by the classifier.</p>
    <fig id="fig-Dike">
      <caption><p>Figure 7: RGB orthomosaic (Top) and Prediction
      (Bottom) of Northern part of Noirmoutier Island, France. The total
      extent of this flight is about 28 000 m² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green) and land area (Light Grey). The zoom covers an area
      equivalent to a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Dike_Pred.png" />
    </fig>
  </sec>
  <sec id="validation-1">
    <title>3.2 Validation</title>
    <fig id="fig-Validation">
      <caption><p>Figure 8: A global confusion matrix on the left is
      derived from validation data across each flight, while a mosaic of
      confusion matrices from individual flights is presented on the
      right. The labels inside the matrices indicate the balanced
      accuracy for each class. The labels at the bottom of the matrices
      indicate the User’s accuracy for each class, and those on the
      right indicate the Producer’s Accuracy. The values adjacent to the
      names of each site represent the proportion of total pixels from
      that site contributing to the overall matrix. Grey lines within
      the mosaic indicate the absence of validation data for the class
      at that site. The table at the bottom summarizes the Sensitivity,
      Specificity, and Accuracy for each class and for the overall
      model.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Validation/ConfusionMatrixGlobal.png" />
    </fig>
    <p>A total amount of 536,000 pixels have been used to validate the
    Neural Network classifier. The site with the least amount of
    validation data is Kerdrean with a total of 5557 pixels whereas
    Marinha Lanzarote is the site with the most amount of validation
    data with 159713 pixels. The global accuracy of the model is 94.26%
    and a Kappa coefficient of 0.92
    (<xref alt="Figure 8" rid="fig-Validation">Figure 8</xref>). The
    least performing site is Gafanha High with an accuracy of 75.45%
    whereas Mataducos is the site with most accurate prediction, with a
    global accuracy of 98.05%. Overall Phaeophyceae, Magnoliopsida,
    Sediment and Rhodophyceae are well classified with a balanced
    accuracy of 1, 0.96, 0.96 and 0.91 respectively. Bacillariophyceae
    is the least performing class with an accuracy of 0.72 mainly due to
    a confusion with Magnoliopsida and Sediment.</p>
  </sec>
  <sec id="variable-importance">
    <title>3.3 Variable importance</title>
    <fig id="fig-VIP">
      <caption><p>Figure 9: Variable Importance of the Neural Network
      Classifier for each vegetation class. The bigger the slice, the
      more important is the variable to predict accuratly this class.
      The bottom right plot shows the drone standardised reflectance
      spectra of each class.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/VIP/Fig_VIP.png" />
    </fig>
    <p>The computation of the importance variable of each class indicate
    which wavelength is mandatory to accurately predict the class
    (<xref alt="Figure 9" rid="fig-VIP">Figure 9</xref>). Bands at 444
    nm, 717 nm and 842 nm of the Micasense camera are important for none
    of the vegetation classes. The band at 531 nm is the only important
    predictor for the classifier to accuratly predict chlorophyceae. In
    fact, at this wavelength, the Chlorophyceae spectra has the maximum
    reflectance value of all the classes. 531 nm and 740 nm are the most
    important predictors to predict Phaeophyceae, corresponding to the
    minimum reflectance value among all the classes. Bands at 475 and
    560 nm are the most important predictors for Bacillariophyceae and
    Rhodophyceae, respectively. 4 predictors, ranging from the Green
    (560 nm) to the RedEdge (705 nm) are important to predict accurately
    magnoliopsida.</p>
  </sec>
  <sec id="effect-of-the-flight-height-on-the-prediction">
    <title>3.4 Effect of the flight height on the prediction</title>
    <fig id="fig-upscaling">
      <caption><p>Figure 10: Kernel density plot showing the proportion
      of pixel well classified based on the percent cover of the class
      in high altitude flight pixels of Gafanha, Portugal. Each subplot
      shows all the pixels of the same classes on the hight altitude
      flight. Percent cover of classes is retrieve using the result of
      the classification of the low altitude flight of Gafanha,
      Portugal. The vertical dashed line shows the 0.85 probability of
      the model. Everything on the right of this line has a probability
      higher then 0.85 and everuthing on the left of this line has a
      probability lower.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Upscaling/density_vs_Proportion.png" />
    </fig>
    <p><xref alt="Figure 10" rid="fig-upscaling">Figure 10</xref> is
    showing the percent cover of a class required to classify correctly
    the high altitude flight. When the percent cover of the class is 100
    %, big pixels are well classified for all the classes excepted for
    Bare Sediment, where it’s well classified 80% of the time. A
    vegetative percent cover of at least 80% is need to have all the big
    pixels well classified, at the exception of Magnoliopsida that needs
    an higher percent cover (&gt;90 %) to be well classified. Concerning
    the probability of each class, a really high Percent cover is needed
    to confidently predict Bacillariophyceae. To predict Chlorophyceae
    with a confidence of 0.85, a percent cover of 93 % is needed, 90 %
    for magnoliopsida, 92 % for Rhodophyceae and 97 % for
    Bacillariophyceae.</p>
  </sec>
</sec>
<sec id="discussion">
  <title>4. Discussion</title>
  <sec id="seagrass-discrimination">
    <title>4.1 Seagrass Discrimination</title>
  </sec>
  <sec id="spatial-and-spectral-resolution-impact-on-the-prediction">
    <title>4.2 Spatial and Spectral Resolution impact on the
    prediction</title>
    <fig id="fig-Pigm">
      <caption><p>Figure 11: Photosynthetic and carotenoid pigments
      present (Green) or absent (Red) in each taxonomic class present in
      the Neural Network Classifier, along with their absorption
      wavelength measured with spectroradiometer. Chl b: chlorophyll b,
      Chl c: chlorophyll c, Fuco: fucoxanthin, Zea: zeaxanthin, Diato:
      diatoxanthin, Diadino: diadinoxanthin, Neo:
      neoxanthin.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Disc_Pigment_Table.png" />
    </fig>
    <fig id="fig-CompareRef">
      <caption><p>Figure 12: Comparison of reflectance retrieved from
      both low-altitude and high-altitude flights over a common area.
      The red dashed line represents a 1 to 1
      relationship.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Compare_reflectance.png" />
    </fig>
  </sec>
  <sec id="big-picture">
    <title>4.3 Big picture</title>
  </sec>
</sec>
<sec id="conclusion">
  <title>5. Conclusion</title>
</sec>
</body>

<back>
<ref-list>
  <title>6. Bibliography</title>
  <ref id="ref-unsworth2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Unsworth</surname><given-names>Richard KF</given-names></name>
        <name><surname>Cullen-Unsworth</surname><given-names>Leanne C</given-names></name>
        <name><surname>Jones</surname><given-names>Benjamin LH</given-names></name>
        <name><surname>Lilley</surname><given-names>Richard J</given-names></name>
      </person-group>
      <article-title>The planetary role of seagrass conservation</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>377</volume>
      <issue>6606</issue>
      <fpage>609</fpage>
      <lpage>613</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gardner2018">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Gardner</surname><given-names>Royal C</given-names></name>
        <name><surname>Finlayson</surname><given-names>C</given-names></name>
      </person-group>
      <source>Global wetland outlook: State of the world’s wetlands and their services to people</source>
      <year iso-8601-date="2018">2018</year>
      <fpage>2020</fpage>
      <lpage>5</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Dalloyau</surname><given-names>Sébastien</given-names></name>
        <name><surname>Davies</surname><given-names>Bede Ffinian Rowe</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Remote sensing in seagrass ecology: Coupled dynamics between migratory herbivorous birds and intertidal meadows observed by satellite during four decades</article-title>
      <source>Remote Sensing in Ecology and Conservation</source>
      <year iso-8601-date="2022-12">2022</year><month>12</month>
      <issn>2056-3485</issn>
      <pub-id pub-id-type="doi">10.1002/rse2.319</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-jankowska2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jankowska</surname><given-names>Emilia</given-names></name>
        <name><surname>Michel</surname><given-names>Loı̈c N</given-names></name>
        <name><surname>Lepoint</surname><given-names>Gilles</given-names></name>
        <name><surname>Włodarska-Kowalczuk</surname><given-names>Maria</given-names></name>
      </person-group>
      <article-title>Stabilizing effects of seagrass meadows on coastal water benthic food webs</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>510</volume>
      <fpage>54</fpage>
      <lpage>63</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nguyen2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nguyen</surname><given-names>Hung Manh</given-names></name>
        <name><surname>Ralph</surname><given-names>Peter J</given-names></name>
        <name><surname>Marı́n-Guirao</surname><given-names>Lázaro</given-names></name>
        <name><surname>Pernice</surname><given-names>Mathieu</given-names></name>
        <name><surname>Procaccini</surname><given-names>Gabriele</given-names></name>
      </person-group>
      <article-title>Seagrasses in an era of ocean warming: A review</article-title>
      <source>Biological Reviews</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>96</volume>
      <issue>5</issue>
      <fpage>2009</fpage>
      <lpage>2030</lpage>
    </element-citation>
  </ref>
  <ref id="ref-soissons2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Soissons</surname><given-names>Laura M</given-names></name>
        <name><surname>Haanstra</surname><given-names>Eeke P</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Asmus</surname><given-names>Ragnhild</given-names></name>
        <name><surname>Auby</surname><given-names>Isabelle</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
        <name><surname>Brun</surname><given-names>Fernando G</given-names></name>
        <name><surname>Cardoso</surname><given-names>Patricia G</given-names></name>
        <name><surname>Desroy</surname><given-names>Nicolas</given-names></name>
        <name><surname>Fournier</surname><given-names>Jerome</given-names></name>
        <etal/>
      </person-group>
      <article-title>Latitudinal patterns in european seagrass carbon reserves: Influence of seasonal fluctuations versus short-term stress and disturbance events</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>88</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-orth2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Orth</surname><given-names>Robert J</given-names></name>
        <name><surname>Carruthers</surname><given-names>Tim JB</given-names></name>
        <name><surname>Dennison</surname><given-names>William C</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Fourqurean</surname><given-names>James W</given-names></name>
        <name><surname>Heck</surname><given-names>Kenneth L</given-names></name>
        <name><surname>Hughes</surname><given-names>A Randall</given-names></name>
        <name><surname>Kendrick</surname><given-names>Gary A</given-names></name>
        <name><surname>Kenworthy</surname><given-names>W Judson</given-names></name>
        <name><surname>Olyarnik</surname><given-names>Suzanne</given-names></name>
        <etal/>
      </person-group>
      <article-title>A global crisis for seagrass ecosystems</article-title>
      <source>Bioscience</source>
      <publisher-name>American Institute of Biological Sciences</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>56</volume>
      <issue>12</issue>
      <fpage>987</fpage>
      <lpage>996</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lin2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lin</surname><given-names>Haiying</given-names></name>
        <name><surname>Sun</surname><given-names>Tao</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Yang</surname><given-names>Wei</given-names></name>
      </person-group>
      <article-title>Which genes in a typical intertidal seagrass (zostera japonica) indicate copper-, lead-, and cadmium pollution?</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>1545</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-duffy2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Duffy</surname><given-names>J Emmett</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Trinanes</surname><given-names>Joaquin</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E</given-names></name>
        <name><surname>Ambo-Rappe</surname><given-names>Rohani</given-names></name>
        <name><surname>Boström</surname><given-names>Christoffer</given-names></name>
        <name><surname>Buschmann</surname><given-names>Alejandro H</given-names></name>
        <name><surname>Byrnes</surname><given-names>Jarrett</given-names></name>
        <name><surname>Coles</surname><given-names>Robert G</given-names></name>
        <name><surname>Creed</surname><given-names>Joel</given-names></name>
        <etal/>
      </person-group>
      <article-title>Toward a coordinated global observing system for seagrasses and marine macroalgae</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>6</volume>
      <fpage>317</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deSantos2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Los Santos</surname><given-names>Carmen B de</given-names></name>
        <name><surname>Krause-Jensen</surname><given-names>Dorte</given-names></name>
        <name><surname>Alcoverro</surname><given-names>Teresa</given-names></name>
        <name><surname>Marbà</surname><given-names>Núria</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Pérez</surname><given-names>Marta</given-names></name>
        <name><surname>Romero</surname><given-names>Javier</given-names></name>
        <name><surname>Sánchez-Lizaso</surname><given-names>José L</given-names></name>
        <name><surname>Roca</surname><given-names>Guillem</given-names></name>
        <etal/>
      </person-group>
      <article-title>Recent trend reversal for declining european seagrass meadows</article-title>
      <source>Nature communications</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>10</volume>
      <issue>1</issue>
      <fpage>3356</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Peters</surname><given-names>Steef</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series</article-title>
      <source>Ecological Indicators</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>130</volume>
      <issn>1470160X</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S1470160X21006981</uri>
      <pub-id pub-id-type="doi">10.1016/j.ecolind.2021.108033</pub-id>
      <fpage>108033</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Zhongyuan</given-names></name>
        <name><surname>Fang</surname><given-names>Zhixiang</given-names></name>
        <name><surname>Liang</surname><given-names>Jianfeng</given-names></name>
        <name><surname>Song</surname><given-names>Xiao</given-names></name>
      </person-group>
      <article-title>Assessment of global habitat suitability and risk of ocean green tides</article-title>
      <source>Harmful Algae</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>119</volume>
      <fpage>102324</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Miloslavich2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Miloslavich</surname><given-names>Patricia</given-names></name>
        <name><surname>Bax</surname><given-names>Nicholas J.</given-names></name>
        <name><surname>Simmons</surname><given-names>Samantha E.</given-names></name>
        <name><surname>Klein</surname><given-names>Eduardo</given-names></name>
        <name><surname>Appeltans</surname><given-names>Ward</given-names></name>
        <name><surname>Aburto-Oropeza</surname><given-names>Octavio</given-names></name>
        <name><surname>Garcia</surname><given-names>Melissa Andersen</given-names></name>
        <name><surname>Batten</surname><given-names>Sonia D.</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Checkley</surname><given-names>David M.</given-names></name>
        <name><surname>Chiba</surname><given-names>Sanae</given-names></name>
        <name><surname>Duffy</surname><given-names>J. Emmett</given-names></name>
        <name><surname>Dunn</surname><given-names>Daniel C.</given-names></name>
        <name><surname>Fischer</surname><given-names>Albert</given-names></name>
        <name><surname>Gunn</surname><given-names>John</given-names></name>
        <name><surname>Kudela</surname><given-names>Raphael</given-names></name>
        <name><surname>Marsac</surname><given-names>Francis</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E.</given-names></name>
        <name><surname>Obura</surname><given-names>David</given-names></name>
        <name><surname>Shin</surname><given-names>Yunne Jai</given-names></name>
      </person-group>
      <article-title>Essential ocean variables for global sustained observations of biodiversity and ecosystem changes</article-title>
      <source>Global Change Biology</source>
      <publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>
      <year iso-8601-date="2018-06">2018</year><month>06</month>
      <volume>24</volume>
      <issn>1365-2486</issn>
      <uri>https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/10.1111/gcb.14108</uri>
      <pub-id pub-id-type="doi">10.1111/GCB.14108</pub-id>
      <fpage>2416</fpage>
      <lpage>2433</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nijland2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nijland</surname><given-names>Wiebe</given-names></name>
        <name><surname>Reshitnyk</surname><given-names>Luba</given-names></name>
        <name><surname>Rubidge</surname><given-names>Emily</given-names></name>
      </person-group>
      <article-title>Satellite remote sensing of canopy-forming kelp on a complex coastline: A novel procedure using the landsat image archive</article-title>
      <source>Remote Sensing of Environment</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>220</volume>
      <fpage>41</fpage>
      <lpage>50</lpage>
    </element-citation>
  </ref>
  <ref id="ref-xu2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Xu</surname><given-names>Shaochun</given-names></name>
        <name><surname>Xu</surname><given-names>Shuai</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Yue</surname><given-names>Shidong</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Yu</given-names></name>
        <name><surname>Qiao</surname><given-names>Yongliang</given-names></name>
        <name><surname>Liu</surname><given-names>Mingjie</given-names></name>
      </person-group>
      <article-title>Long-term changes in the unique and largest seagrass meadows in the bohai sea (china) using satellite (1974–2019) and sonar data: Implication for conservation and restoration</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>13</volume>
      <issue>5</issue>
      <fpage>856</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Traganos2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Traganos</surname><given-names>Dimosthenis</given-names></name>
        <name><surname>Reinartz</surname><given-names>Peter</given-names></name>
      </person-group>
      <article-title>Mapping mediterranean seagrasses with sentinel-2 imagery</article-title>
      <source>Marine Pollution Bulletin</source>
      <publisher-name>Elsevier Ltd</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>134</volume>
      <issn>18793363</issn>
      <pub-id pub-id-type="doi">10.1016/j.marpolbul.2017.06.075</pub-id>
      <fpage>197</fpage>
      <lpage>209</lpage>
    </element-citation>
  </ref>
  <ref id="ref-coffer2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coffer</surname><given-names>Megan M</given-names></name>
        <name><surname>Graybill</surname><given-names>David D</given-names></name>
        <name><surname>Whitman</surname><given-names>Peter J</given-names></name>
        <name><surname>Schaeffer</surname><given-names>Blake A</given-names></name>
        <name><surname>Salls</surname><given-names>Wilson B</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Richard C</given-names></name>
        <name><surname>Hill</surname><given-names>Victoria</given-names></name>
        <name><surname>Lebrasse</surname><given-names>Marie Cindy</given-names></name>
        <name><surname>Li</surname><given-names>Jiang</given-names></name>
        <name><surname>Keith</surname><given-names>Darryl J</given-names></name>
        <etal/>
      </person-group>
      <article-title>Providing a framework for seagrass mapping in united states coastal ecosystems using high spatial resolution satellite imagery</article-title>
      <source>Journal of Environmental Management</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>337</volume>
      <fpage>117669</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ralph2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ralph</surname><given-names>PJ</given-names></name>
        <name><surname>Polk</surname><given-names>SM</given-names></name>
        <name><surname>Moore</surname><given-names>KA</given-names></name>
        <name><surname>Orth</surname><given-names>RJ</given-names></name>
        <name><surname>Smith Jr</surname><given-names>WO</given-names></name>
      </person-group>
      <article-title>Operation of the xanthophyll cycle in the seagrass zostera marina in response to variable irradiance</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <volume>271</volume>
      <issue>2</issue>
      <fpage>189</fpage>
      <lpage>207</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Douay2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Douay</surname><given-names>Florian</given-names></name>
        <name><surname>Verpoorter</surname><given-names>Charles</given-names></name>
        <name><surname>Duong</surname><given-names>Gwendoline</given-names></name>
        <name><surname>Spilmont</surname><given-names>Nicolas</given-names></name>
        <name><surname>Gevaert</surname><given-names>François</given-names></name>
      </person-group>
      <article-title>New hyperspectral procedure to discriminate intertidal macroalgae</article-title>
      <source>Remote Sensing</source>
      <year iso-8601-date="2022">2022</year>
      <volume>14</volume>
      <issue>2</issue>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/346</uri>
      <pub-id pub-id-type="doi">10.3390/rs14020346</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Davies2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Geraud</surname><given-names>Andréa</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Rosa</surname><given-names>Philippe</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Multi- and hyperspectral classification of soft-bottom intertidal vegetation using a spectral library for coastal biodiversity remote sensing</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2023">2023</year>
      <volume>290</volume>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425723001050</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2023.113554</pub-id>
      <fpage>113554</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bannari2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bannari</surname><given-names>Abderrazak</given-names></name>
        <name><surname>Ali</surname><given-names>Thamer Salim</given-names></name>
        <name><surname>Abahussain</surname><given-names>Asma</given-names></name>
      </person-group>
      <article-title>The capabilities of sentinel-MSI (2A/2B) and landsat-OLI (8/9) in seagrass and algae species differentiation using spectral reflectance</article-title>
      <source>Ocean Science</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>18</volume>
      <issue>2</issue>
      <fpage>361</fpage>
      <lpage>388</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tuya2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tuya</surname><given-names>Fernando</given-names></name>
        <name><surname>Hernandez-Zerpa</surname><given-names>Harue</given-names></name>
        <name><surname>Espino</surname><given-names>Fernando</given-names></name>
        <name><surname>Haroun</surname><given-names>Ricardo</given-names></name>
      </person-group>
      <article-title>Drastic decadal decline of the seagrass cymodocea nodosa at gran canaria (eastern atlantic): Interactions with the green algae caulerpa prolifera</article-title>
      <source>Aquatic Botany</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>105</volume>
      <fpage>1</fpage>
      <lpage>6</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fairley2022drone">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fairley</surname><given-names>Iain</given-names></name>
        <name><surname>Williamson</surname><given-names>Benjamin J</given-names></name>
        <name><surname>McIlvenny</surname><given-names>Jason</given-names></name>
        <name><surname>King</surname><given-names>Nicholas</given-names></name>
        <name><surname>Masters</surname><given-names>Ian</given-names></name>
        <name><surname>Lewis</surname><given-names>Matthew</given-names></name>
        <name><surname>Neill</surname><given-names>Simon</given-names></name>
        <name><surname>Glasby</surname><given-names>David</given-names></name>
        <name><surname>Coles</surname><given-names>Daniel</given-names></name>
        <name><surname>Powell</surname><given-names>Ben</given-names></name>
        <etal/>
      </person-group>
      <article-title>Drone-based large-scale particle image velocimetry applied to tidal stream energy resource assessment</article-title>
      <source>Renewable Energy</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>196</volume>
      <fpage>839</fpage>
      <lpage>855</lpage>
    </element-citation>
  </ref>
  <ref id="ref-oh2017use">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Oh</surname><given-names>Jaehong</given-names></name>
        <name><surname>Kim</surname><given-names>Duk-jin</given-names></name>
        <name><surname>Lee</surname><given-names>Hyoseong</given-names></name>
      </person-group>
      <article-title>Use of a drone for mapping and time series image acquisition of tidal zones</article-title>
      <source>Journal of the Korean Institute of Intelligent Systems</source>
      <publisher-name>Korean Institute of Intelligent Systems</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>27</volume>
      <issue>2</issue>
      <fpage>119</fpage>
      <lpage>125</lpage>
    </element-citation>
  </ref>
  <ref id="ref-adade2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Adade</surname><given-names>Richard</given-names></name>
        <name><surname>Aibinu</surname><given-names>Abiodun Musa</given-names></name>
        <name><surname>Ekumah</surname><given-names>Bernard</given-names></name>
        <name><surname>Asaana</surname><given-names>Jerry</given-names></name>
      </person-group>
      <article-title>Unmanned aerial vehicle (UAV) applications in coastal zone management—a review</article-title>
      <source>Environmental Monitoring and Assessment</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>193</volume>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-casella2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Casella</surname><given-names>Elisa</given-names></name>
        <name><surname>Drechsel</surname><given-names>Jan</given-names></name>
        <name><surname>Winter</surname><given-names>Christian</given-names></name>
        <name><surname>Benninghoff</surname><given-names>Markus</given-names></name>
        <name><surname>Rovere</surname><given-names>Alessio</given-names></name>
      </person-group>
      <article-title>Accuracy of sand beach topography surveying by drones and photogrammetry</article-title>
      <source>Geo-Marine Letters</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>40</volume>
      <fpage>255</fpage>
      <lpage>268</lpage>
    </element-citation>
  </ref>
  <ref id="ref-angnuureng2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Angnuureng</surname><given-names>Donatus B</given-names></name>
        <name><surname>Brempong</surname><given-names>KE</given-names></name>
        <name><surname>Jayson-Quashigah</surname><given-names>PN</given-names></name>
        <name><surname>Dada</surname><given-names>OA</given-names></name>
        <name><surname>Akuoko</surname><given-names>SGI</given-names></name>
        <name><surname>Frimpomaa</surname><given-names>J</given-names></name>
        <name><surname>Mattah</surname><given-names>PA</given-names></name>
        <name><surname>Almar</surname><given-names>Rafaël</given-names></name>
      </person-group>
      <article-title>Satellite, drone and video camera multi-platform monitoring of coastal erosion at an engineered pocket beach: A showcase for coastal management at elmina bay, ghana (west africa)</article-title>
      <source>Regional Studies in Marine Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>53</volume>
      <fpage>102437</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-joyce2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Joyce</surname><given-names>Karen E</given-names></name>
        <name><surname>Fickas</surname><given-names>Kate C</given-names></name>
        <name><surname>Kalamandeen</surname><given-names>Michelle</given-names></name>
      </person-group>
      <article-title>The unique value proposition for using drones to map coastal ecosystems</article-title>
      <source>Cambridge Prisms: Coastal Futures</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>1</volume>
      <fpage>e6</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-tallam2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tallam</surname><given-names>Krti</given-names></name>
        <name><surname>Nguyen</surname><given-names>Nam</given-names></name>
        <name><surname>Ventura</surname><given-names>Jonathan</given-names></name>
        <name><surname>Fricker</surname><given-names>Andrew</given-names></name>
        <name><surname>Calhoun</surname><given-names>Sadie</given-names></name>
        <name><surname>O’Leary</surname><given-names>Jennifer</given-names></name>
        <name><surname>Fitzgibbons</surname><given-names>Mauriça</given-names></name>
        <name><surname>Robbins</surname><given-names>Ian</given-names></name>
        <name><surname>Walter</surname><given-names>Ryan K</given-names></name>
      </person-group>
      <article-title>Application of deep learning for classification of intertidal eelgrass from drone-acquired imagery</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>15</volume>
      <issue>9</issue>
      <fpage>2321</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Roca2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Roca</surname><given-names>Mar</given-names></name>
        <name><surname>Dunbar</surname><given-names>Martha Bonnet</given-names></name>
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Caballero</surname><given-names>Isabel</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Monitoring the marine invasive alien species rugulopteryx okamurae using unmanned aerial vehicles and satellites</article-title>
      <source>Frontiers in Marine Science</source>
      <year iso-8601-date="2022-10">2022</year><month>10</month>
      <volume>9</volume>
      <issn>2296-7745</issn>
      <pub-id pub-id-type="doi">10.3389/fmars.2022.1004012</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Roman2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Tovar-Sánchez</surname><given-names>Antonio</given-names></name>
        <name><surname>Olivé</surname><given-names>Irene</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <fpage>1225</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brunier2022Topographic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brunier</surname><given-names>Guillaume</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Gruet</surname><given-names>Yves</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas F.</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Topographic analysis of intertidal polychaete reefs (sabellaria alveolata) at a very high spatial resolution</article-title>
      <source>Remote Sensing 2022, Vol. 14, Page 307</source>
      <publisher-name>Multidisciplinary Digital Publishing Institute</publisher-name>
      <year iso-8601-date="2022-01">2022</year><month>01</month>
      <volume>14</volume>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/307</uri>
      <pub-id pub-id-type="doi">10.3390/RS14020307</pub-id>
      <fpage>307</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-collin2019improving">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Collin</surname><given-names>Antoine</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas</given-names></name>
        <name><surname>James</surname><given-names>Dorothée</given-names></name>
        <name><surname>Houet</surname><given-names>Thomas</given-names></name>
      </person-group>
      <article-title>Improving intertidal reef mapping using UAV surface, red edge, and near-infrared data</article-title>
      <source>Drones</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>3</volume>
      <issue>3</issue>
      <fpage>67</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-rossiter2020uav">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rossiter</surname><given-names>Thomas</given-names></name>
        <name><surname>Furey</surname><given-names>Thomas</given-names></name>
        <name><surname>McCarthy</surname><given-names>Tim</given-names></name>
        <name><surname>Stengel</surname><given-names>Dagmar B</given-names></name>
      </person-group>
      <article-title>UAV-mounted hyperspectral mapping of intertidal macroalgae</article-title>
      <source>Estuarine, Coastal and Shelf Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>242</volume>
      <fpage>106789</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-BedeGbif">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Sousa</surname><given-names>A I.</given-names></name>
        <name><surname>Figueira</surname><given-names>R</given-names></name>
        <name><surname>Oiry</surname><given-names>S</given-names></name>
        <name><surname>Gernez</surname><given-names>P</given-names></name>
        <name><surname>Barillé</surname><given-names>L</given-names></name>
      </person-group>
      <article-title>Benthic intertidal vegetation from the tagus estuary and aveiro lagoon</article-title>
      <publisher-name>Université de Nantes via GBIF.org</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.15468/n4ak6x</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Pereira2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pereira</surname><given-names>Henrique Miguel</given-names></name>
        <name><surname>Ferrier</surname><given-names>Simon</given-names></name>
        <name><surname>Walters</surname><given-names>Michele</given-names></name>
        <name><surname>Geller</surname><given-names>Gary N</given-names></name>
        <name><surname>Jongman</surname><given-names>Rob HG</given-names></name>
        <name><surname>Scholes</surname><given-names>Robert J</given-names></name>
        <name><surname>Bruford</surname><given-names>Michael William</given-names></name>
        <name><surname>Brummitt</surname><given-names>Neil</given-names></name>
        <name><surname>Butchart</surname><given-names>Stuart HM</given-names></name>
        <name><surname>Cardoso</surname><given-names>AC</given-names></name>
        <etal/>
      </person-group>
      <article-title>Essential biodiversity variables</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>339</volume>
      <issue>6117</issue>
      <fpage>277</fpage>
      <lpage>278</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

Balanced Accuracy`[c(1:6)]),2)
# )

other_table_path&lt;-data.frame(
  x = c(-3,26,-3,26,-3,26,-3,26,-3,26,
        -3,-3,0,0,3.857,3.857,7.714,7.714,11.571,11.571,15.429,15.429,19.286,19.286,23.142,23.142,26,26
        ),
  y= c(-2,-2,-3,-3,-4,-4,-5,-5,-1,-1,
       -1,-5,-1,-5,-1,-5,-1,-5,-1,-5,-1,-5,-1,-5,-1,-5,-1,-5
       ),
  group=c(1,1,9,9,10,10,11,11,12,12,13,13,14,14,
          2,2,3,3,4,4,5,5,6,6,7,7,8,8
          )
)

other_table_title &lt;- data.frame(
  x = c(-1.529,1.929,5.786,9.643,13.5,17.359,21.215,24.571),
  y = c(-1.5,-1.5,-1.5,-1.5,-1.5,-1.5,-1.5,-1.5),
  label = c(&quot;Metrics&quot;,&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;, &quot;Overall&quot;)
)

other_table_y_axis&lt;-data.frame(
  x=c(-0.4,-0.4,-0.4),
  y=c(-2.5,-3.5,-4.5),
  label = c(&quot;Sensitivity&quot;,&quot;Specificity&quot;, &quot;Accuracy&quot;)
)

accuracy_by_class&lt;-validation_metrics$byClass %&gt;% 
  as.data.frame()

other_table_values &lt;- data.frame(
  x = c(1.929,5.786,9.643,13.5,17.359,21.215,24.571,
        1.929,5.786,9.643,13.5,17.359,21.215,24.571,
        1.929,5.786,9.643,13.5,17.359,21.215),
  y = c(-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,
        -3.5,-3.5,-3.5,-3.5,-3.5,-3.5,-3.5,
        -4.5,-4.5,-4.5,-4.5,-4.5,-4.5),
  label = round(c(accuracy_by_class$Sensitivity[c(1:6)],mean(accuracy_by_class$Sensitivity),
            accuracy_by_class$Specificity[c(1:6)],mean(accuracy_by_class$Specificity),
            accuracy_by_class<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>Discriminating Seagrasses From Green Macroalgae in
European Intertidal areas using high resolution multispectral drone
imagery.</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0001-7161-5246</contrib-id>
<name>
<surname>Oiry</surname>
<given-names>Simon</given-names>
</name>
<string-name>Simon Oiry</string-name>

<email>oirysimon@gmail.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">Writing</role>
<role>Data acquisition</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Davies</surname>
<given-names>Bede Ffinian Rowe</given-names>
</name>
<string-name>Bede Ffinian Rowe Davies</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gernez</surname>
<given-names>Pierre</given-names>
</name>
<string-name>Pierre Gernez</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sousa</surname>
<given-names>Ana I.</given-names>
</name>
<string-name>Ana I. Sousa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rosa</surname>
<given-names>Philippe</given-names>
</name>
<string-name>Philippe Rosa</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zoffoli</surname>
<given-names>Maria Laura</given-names>
</name>
<string-name>Maria Laura Zoffoli</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-3">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brunier</surname>
<given-names>Guillaume</given-names>
</name>
<string-name>Guillaume Brunier</string-name>

<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-4">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Barillé</surname>
<given-names>Laurent</given-names>
</name>
<string-name>Laurent Barillé</string-name>

<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role>Data acquisition</role>
<role>Revision</role>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Nantes University</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Aveiro University</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>CNR ISMAR</institution>
</institution-wrap>







</aff>
<aff id="aff-4">
<institution-wrap>
<institution>JeSaisPas</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">oirysimon@gmail.com</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-02-27">
<year>2024</year>
<month>2</month>
<day>27</day>
</pub-date>







<history></history>


<abstract>
<p>Coastal areas host seagrass meadows, which offer crucial ecosystem
services including erosion control and carbon sequestration. However,
these areas are increasingly impacted by human activities, leading to
seagrass decline and habitat fragmentation. In situ surveys,
traditionally performed to monitor these ecosystems face limitations on
temporal and spatial coverage, particularly in intertidal zones,
prompting the use of satellite data within monitoring programs. Yet,
satellite remote sensing struggles with spatial and spectral resolution,
making it difficult to discriminate seagrass from other macrophytes in
highly heterogenous meadows. To address these challenges, drone images
acquired with multi-spectral sensors offer a promising solution. This
study focuses on using drones acquisitions for mapping intertidal
macrophytes, effectively discriminating between seagrass and green
macroalgae. Ten drone flights were conducted at two different altitudes
(12m and 120m) across diverse European habitats in France and Portugal.
Low altitude flights were used to train a Deep Learning classifier based
on Neural Networks to discrimintate among 5 intertidal vegetation
classes. Drone mapping demonstrated an overall accuracy of 94% across
all the sites and images, covering a total area of 467 000 m². The model
exhibited an accuracy of 96.4% in identifying seagrass.</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>Drone</kwd>
<kwd>Remote Sensing</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1. Introduction</title>
  <p>Coastal areas are vital hotshots for marine biodiversity, with
  intertidal seagrass meadows playing a crucial role at the interface
  between land and ocean
  (<xref alt="Unsworth et al. 2022" rid="ref-unsworth2022" ref-type="bibr">Unsworth
  et al. 2022</xref>). These meadows offer a myriad of ecosystem
  services to humanity, including limitation of coastline erosion,
  reducing the risk of eutrophication, carbon sequestration, and oxygen
  production. They serve as vital habitats for a diverse array of marine
  and terrestrial species, providing living, breeding, and feeding
  grounds
  (<xref alt="Gardner and Finlayson 2018" rid="ref-gardner2018" ref-type="bibr">Gardner
  and Finlayson 2018</xref> ;
  <xref alt="Zoffoli et al. 2022" rid="ref-Zoffoli2022" ref-type="bibr">Zoffoli
  et al. 2022</xref> ;
  <xref alt="Jankowska et al. 2019" rid="ref-jankowska2019" ref-type="bibr">Jankowska
  et al. 2019</xref>). Due to their proximity to human activities,
  seagrass meadows are directly exposed to and impacted by anthropogenic
  pressures. Global regression and fragmentation are currently observed
  due to diseases, disasters, coastal urbanization, sea reclamation, as
  well as fishing activities, dredging, sea level rise, coastal erosion,
  competition with alien species, and reduction in water quality
  (<xref alt="Nguyen et al. 2021" rid="ref-nguyen2021" ref-type="bibr">Nguyen
  et al. 2021</xref> ;
  <xref alt="Soissons et al. 2018" rid="ref-soissons2018" ref-type="bibr">Soissons
  et al. 2018</xref> ;
  <xref alt="Orth et al. 2006" rid="ref-orth2006" ref-type="bibr">Orth
  et al. 2006</xref> ;
  <xref alt="Lin et al. 2018" rid="ref-lin2018" ref-type="bibr">Lin et
  al. 2018</xref> ;
  <xref alt="Duffy et al. 2019" rid="ref-duffy2019" ref-type="bibr">Duffy
  et al. 2019</xref>). While improvements in water quality have been
  recently reported in European sites, allowing an overall recovery of
  seagrass ecosystems at the local scale, many other coastal waters
  worldwide are still subjected to strong eutrophication processes
  (<xref alt="Los Santos et al. 2019" rid="ref-deSantos2019" ref-type="bibr">Los
  Santos et al. 2019</xref> ;
  <xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021" ref-type="bibr">Zoffoli
  et al. 2021</xref>). Coastal eutrophication has been associated to
  anomalous accumulation of green macroalgae, the so-called green tides.
  Green tides produce shade and suffication over seagrass individuals,
  thus threatening the health of seagrass ecosystems
  (<xref alt="Duarte2002?" rid="ref-Duarte2002" ref-type="bibr"><bold>Duarte2002?</bold></xref>
  ; <xref alt="Wang et al. 2022" rid="ref-wang2022" ref-type="bibr">Wang
  et al. 2022</xref>).</p>
  <p>The importance of seagrass meadows and the variety of ecosystem
  services they provide have led to the enhancement of global and
  regional monitoring programs for systematically surveying different
  Essential Oceanic Variable
  (<xref alt="Miloslavich et al. 2018" rid="ref-Miloslavich2018" ref-type="bibr">Miloslavich
  et al. 2018</xref>) as seagrass coverage and composition; as well as
  Essential Biodiversity Variable
  (<xref alt="Pereira et al. 2013" rid="ref-Pereira2013" ref-type="bibr">Pereira
  et al. 2013</xref>) such as seagrass taxonomic diversity; species
  distribution, population abundance, and phenology. Monitoring programs
  also prioritize the identification of threats to these ecosystems,
  particularly during early stages, to facilitate effective mitigation
  actions. Traditionally, these ecological parameters have been
  quantified through in situ measurements, although this approach faces
  several constraints over intertidal zones. Intertidal meadows are only
  partially exposed during low tide and can be situated in
  difficult-to-reach mudflats, potentially leading to inaccurate and
  limited estimations with conventional sampling techniques
  (<xref alt="Nijland, Reshitnyk, and Rubidge 2019" rid="ref-nijland2019" ref-type="bibr">Nijland,
  Reshitnyk, and Rubidge 2019</xref>). However, satellite data have been
  proven effective in complenmenting in situ surveys, allowing for the
  rapid and consitent retrieval of EOV’s over extensive seagrass
  meadows.
  (<xref alt="Zoffoli et al. 2021" rid="ref-Zoffoli2021" ref-type="bibr">Zoffoli
  et al. 2021</xref> ;
  <xref alt="Xu et al. 2021" rid="ref-xu2021" ref-type="bibr">Xu et al.
  2021</xref> ;
  <xref alt="Traganos and Reinartz 2018" rid="ref-Traganos2018" ref-type="bibr">Traganos
  and Reinartz 2018</xref> ;
  <xref alt="Coffer et al. 2023" rid="ref-coffer2023" ref-type="bibr">Coffer
  et al. 2023</xref>)</p>
  <p>Satellite remote sensing offers the advantage of acquiring
  large-scale data in real-time but presents its inherent challenges.
  Free access satellite data (e.g., Sentinel-2 and Landsat8/9) provide
  relatively low spatial resolution data (10 - 30 m) across a limited
  number of spectral bands. These characteristics can be a limitation to
  accurately discriminating seagrass from others co-existing macrophytes
  over the meadow. Chlorophyceae (Green Algae) and marine Magnoliopsida
  (Seagrass) share the same pigment composition
  (<xref alt="Ralph et al. 2002" rid="ref-ralph2002" ref-type="bibr">Ralph
  et al. 2002</xref> ;
  <xref alt="Douay et al. 2022" rid="ref-Douay2022" ref-type="bibr">Douay
  et al. 2022</xref>). As a result, their respective spectral signatures
  can be considered similar by a non-expert observer
  (<xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023" ref-type="bibr">Davies,
  Gernez, et al. 2023</xref> ;
  <xref alt="Bannari, Ali, and Abahussain 2022" rid="ref-bannari2022" ref-type="bibr">Bannari,
  Ali, and Abahussain 2022</xref>). Recently, using a hyperspectral
  library, Davies, Gernez, et al.
  (<xref alt="2023" rid="ref-Davies2023" ref-type="bibr">2023</xref>)
  demonstrated that the spectral resolution of Sentinel-2, might be
  enough for the discrimination between Magnoliopsida and Chlorophyceae.
  However, green tide events occur at small spatial scales that are not
  observable using satellite imagery
  (<xref alt="Tuya et al. 2013" rid="ref-tuya2013" ref-type="bibr">Tuya
  et al. 2013</xref>), especially during the initial stage of the
  event.</p>
  <p>Remote sensing drone acquisitions are presented as a tool that can
  potentially fill gaps left by satellite and in situ data. Drone can
  cover large expanses while recording imagery at significantly higher
  spatial resolutions than satellite (pixel size from cm to mm) and
  still capturing data at multi-spectral resolution
  (<xref alt="Fairley et al. 2022" rid="ref-fairley2022drone" ref-type="bibr">Fairley
  et al. 2022</xref> ;
  <xref alt="Oh, Kim, and Lee 2017" rid="ref-oh2017use" ref-type="bibr">Oh,
  Kim, and Lee 2017</xref>). The versatility of drones allows for their
  application across a diverse thematic range , from coastal zone
  management
  (<xref alt="Adade et al. 2021" rid="ref-adade2021" ref-type="bibr">Adade
  et al. 2021</xref> ;
  <xref alt="Casella et al. 2020" rid="ref-casella2020" ref-type="bibr">Casella
  et al. 2020</xref> ;
  <xref alt="Angnuureng et al. 2022" rid="ref-angnuureng2022" ref-type="bibr">Angnuureng
  et al. 2022</xref>) to mapping the spatial distribution of species
  (<xref alt="Joyce, Fickas, and Kalamandeen 2023" rid="ref-joyce2023" ref-type="bibr">Joyce,
  Fickas, and Kalamandeen 2023</xref> ;
  <xref alt="Tallam et al. 2023" rid="ref-tallam2023" ref-type="bibr">Tallam
  et al. 2023</xref> ;
  <xref alt="Roca et al. 2022" rid="ref-Roca2022" ref-type="bibr">Roca
  et al. 2022</xref> ;
  <xref alt="Román et al. 2021" rid="ref-Roman2021" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic" ref-type="bibr">Brunier
  et al. 2022</xref>). However, when applied to coastal habitat mapping,
  many studies showcase their findings with study case limited to a
  single flight, restricting the generalizability of their application
  to other sites
  (<xref alt="Román et al. 2021" rid="ref-Roman2021" ref-type="bibr">Román
  et al. 2021</xref> ;
  <xref alt="Collin et al. 2019" rid="ref-collin2019improving" ref-type="bibr">Collin
  et al. 2019</xref> ;
  <xref alt="Rossiter et al. 2020" rid="ref-rossiter2020uav" ref-type="bibr">Rossiter
  et al. 2020</xref> ;
  <xref alt="Brunier et al. 2022" rid="ref-Brunier2022Topographic" ref-type="bibr">Brunier
  et al. 2022</xref>). This study aimed to analyze the potential of a
  drone equipped with a multispectral sensor for maping intertidal
  macrophytes, with a particular focus on discriminating Magnoliopsida
  and Chlorophyceae. Ten drone flights were performed over soft-bottom
  intertidal areas along two European countries (France and Portugal),
  covering a wide range of habitats, from monospecific seagrass meadows
  to meadows mixed with green or red algae. A deep learning algorithm
  was trained and validated for macrophyte discrimination, emphasizing
  applicability across diverse sites without a loss of accuracy in
  predictions.</p>
</sec>
<sec id="material-methods">
  <title>2. Material &amp; Methods</title>
  <sec id="study-sites">
    <title>2.1 Study sites</title>
    <p>Seven study sites distributed between France and Portugal were
    selected for their relatively extensive intertidal seagrass beds.
    Two sites are located in Gulf of Morbihan
    (<xref alt="Figure 1" rid="fig-map">Figure 1</xref> A), France
    (47.5791°N, 2.8018°W). This gulf covers an area of 115 km² and is
    only connect to the sea through a 900m wide channel. A total of 53
    small islands are scattered across the gulf leading to 250 km of
    shorelines. Patchy seagrass meadows can be found on a lot of these
    islands. Within the Gulf of Morbihan we have chosen two sites : One
    is located in one of these island (Arz island). The other one is
    located in the sourthern part of the Gulf (Duer). Two others sites
    are located in Bourgneuf Bay, France (46.9849°N, 2.1488°W). This bay
    is a semi-enclosed macrotidal bay, protected from waves by
    Noirmoutier Island. With up to 6m in tidal range during spring tide,
    a 6 km² seagrass meadow can uncover at low tide. The sites we
    surveyed (L’Epine and Barbatre,
    <xref alt="Figure 1" rid="fig-map">Figure 1</xref> B) are located in
    the southernmost part of the bay, along the Noirmoutier Island, and
    host a monospecific <italic>Zostera noltei</italic> seagrass bed
    with very little mixing with other macrophytes. Three sites have
    been survey in the Ria de Aveiro Lagoon in Portugal (40.6887°N,
    8.6810°W). The extent of this lagoon is about 80 km² with many
    narrow channels, large salt marshes and many mudflats that uncovers
    at low tide. It is connected to the open sea through a single
    channel, with a tidal lag between the North and the South of the
    lagoon. The southernmost site (Gafanha) is a mudflat located in an
    affluent of the lagoon whereas the two other sites are situated in
    the middle of the lagoon and are only accessible by boat
    (<xref alt="Figure 1" rid="fig-map">Figure 1</xref> C). These
    Portuguese sites were characterized by a more diverse intertidal
    area, where the seagrass meadow could intermingle with red algae
    (Rhodophyceae), brown algae (Phaeophyceae), or green algae
    (Chlorophyceae).</p>
    <fig id="fig-map">
      <caption><p>Figure 1: Sites where the different drone flights were
      made. A: Gulf of Morbihan, B: Bourngeuf Bay, C: Ria de Aveiro
      Lagoon. Light green represent terrestrial areas whereas darkgreen
      represent intertidal areas.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Fig1_Map_Drone_Sites.png" />
    </fig>
  </sec>
  <sec id="drone-data">
    <title>2.2 Drone Data</title>
    <p>At each location, a DJI Matrice 200 quadcopter drone equipped
    with a Micasense RedEdge Dual MX multispectral camera was flown to
    take 1.2 million pixel reflectance photographs in 10 spectral bands,
    from blue (444 nm) to near infrared (840 nm). An angle of 90° has
    been maintained between the sun and the drone’s route to guarantee
    uniform lighting conditions between flight lines. A side overlap of
    70% and a front overlap of 80% between each image has been set.
    Images have been calibrated in reflectance using a calibration panel
    reflective at ~50% provided by the camera’s manufaturer and a
    Downwelling Light Sensor (DLS2) that was utilized to acquire
    irradiance data during the flight. A Structure-from-Motion
    photogrammetry software (Agisoft Metashape) has been used to process
    images to obtain multispectral orthomosaics of each flight. The
    workflow for orthomosaicking has remained consistent for every
    flight. First, tying key points were detected inside of each image
    and between overlapping images in order to obtain a sparse point
    cloud. This cloud was cleaned using reprojection accuracy metric in
    order to remove noisy points. A dense point cloud has been then
    produced using a structure from motion algorithm. A surface
    interpolation of this dense point cloud has been made to obtain a
    Digital Surface Model (DSM), used to reconstruct the multispectral
    ortho-image. Across all the sites, flights were made at two
    different altitudes : 12 m or/and 120 m. Low altitude drone flights
    produce ortho-images with a very high spatial resolution (8 mm per
    pixel), making it simple to visually distinguish between the various
    types of vegetation. High altitude fights on the other hand allow to
    cover large areas and produced images with a pixel size of 80 mm
    (Table 1).</p>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table1-1.png" />
  </sec>
  <sec id="field-sampling">
    <title>2.3 Field sampling</title>
    <p>Before each flight, targets used as Ground Control Points (GCPs)
    were dispersed and georeferenced with a Trimble © Geo XH 6000
    differential GPS (dGPS). GCPs were used to correct georeferencing
    imprecision of orthomosaics with an horizontal and vertical accuracy
    of 10cm. dGPS was also used to georeference quardrats of 0.25cm²
    used to assess the presence or absence of 5 key classes of
    vegetation : Bacillariophyceae (Diatoms forming large biofilm over
    the sediment during low tide), Phaeophyceae (Brown algae),
    Magnoliopsida (Seagrass), Chlorophyceae (Green algae) and
    Rhodophyceae (Red algae)
    (<xref alt="Figure 2" rid="fig-vegetation">Figure 2</xref>). Picture
    of each quadrat were taken and uploaded on the online on the Global
    Biodiversity Information Facility (GBIF) platform
    (<xref alt="Davies, Sousa, et al. 2023" rid="ref-BedeGbif" ref-type="bibr">Davies,
    Sousa, et al. 2023</xref>). Each photograph was also processed to
    estimate the percent cover of each type of vegetation. Georeferenced
    hyperspectral reflectance signatures of each vegetation class were
    also sampled using an ASD FieldSpec HandHeld 2 spectroradiomete,
    which acquires reflectance between 325 and 1075 nm, with 1 nm of
    spectral resolution. The methodological scheme followed in this
    study is presented in
    <xref alt="Figure 3" rid="fig-workflow">Figure 3</xref>.</p>
    <fig id="fig-vegetation">
      <caption><p>Figure 2: Class of vegetation used to train the CNN
      model and their standardised spectral signature</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Spectral_shapes_total.png" />
    </fig>
  </sec>
  <sec id="intertidal-vegetation-mapping">
    <title>2.4 Intertidal vegetation mapping</title>
    <fig id="fig-workflow">
      <caption><p>Figure 3: Schematic representation of the workflow.
      Diamonds represent input or output data, and rectangles represent
      Python processing algorithms. The overall workflow of this study
      is divided into two distinct parts based on the spatial resolution
      of the drone flights: high-resolution flights were utilized for
      training and prediction of the CNN model, whereas low-resolution
      flights were solely employed for prediction
      purposes.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Figure3_workflow.png" />
    </fig>
    <p>The spectral similarities of reflectance signatures between
    intertidal green macrophytes (Magnoliopsida and Chlorophyceae) make
    their discrimination challenging using simple classification
    algorithms
    (<xref alt="Figure 2" rid="fig-vegetation">Figure 2</xref> F). To
    overcome this challenge, a deep learning classification method was
    developed, trained, validated, and applied to each drone flight
    (<xref alt="Figure 3" rid="fig-workflow">Figure 3</xref>).</p>
    <sec id="neural-network-model-building">
      <title>2.4.1 Neural Network model building</title>
      <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/Table2-1.png" />
      <p>A dataset containing photo-interpreted drone reflectance pixels
      was built to train a Convolutional Neural Network (CNN) model with
      2 hidden layers. The training pixels were categorized into 7
      different classes, representing the various habitats encountered
      at the different study sites: Sediment, Water, Chlorophyceae,
      Magnoliopsida, Bacillariophyceae, Phaeophyceae and Rhodophyceae.
      Only low-altitude flights (Table 1) were used for training
      purposes because of their 8 mm spatial resolution allowing to
      avoid spectral sub-pixel mixing and to accurately visually
      differentiate various vegetation classes. More than 418,000 pixels
      at 8 mm resolution from the 3 training flights have been used to
      train the model (Table 2). Twenty one variables were used by the
      model as predictors: 10 raw spectral bands of the Micasense
      RedEdge Dual MX multispectral camera (ranging from 444 nm to 840
      nm), the same 10 spectral bands standardized using a min/max
      transformation
      (<xref alt="Equation 1" rid="eq-std">Equation 1</xref> ;
      (<xref alt="cao2017?" rid="ref-cao2017" ref-type="bibr"><bold>cao2017?</bold></xref>))
      and the NDVI
      (<xref alt="Equation 2" rid="eq-ndvi">Equation 2</xref>).
      Standardisation of spectral bands is used to eliminate the scaling
      differences between spectra and to limit the effect of biomass on
      the shape of the spectra
      (<xref alt="Douay et al. 2022" rid="ref-Douay2022" ref-type="bibr">Douay
      et al. 2022</xref> ;
      <xref alt="Davies, Gernez, et al. 2023" rid="ref-Davies2023" ref-type="bibr">Davies,
      Gernez, et al. 2023</xref>).</p>
      <p><styled-content id="eq-std"><disp-formula><alternatives>
      <tex-math><![CDATA[
      R_{i}^{*}(\lambda) = \frac{R_{i}(\lambda) - min(R_{i})}{max(R_{i})- min(R_{i})}
       \qquad(1)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R_{i}(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at the wavelength
      <inline-formula><alternatives>
      <tex-math><![CDATA[(\lambda)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      of each individual spectra <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives>
      <tex-math><![CDATA[min(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives>
      <tex-math><![CDATA[max(R_{i})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      are the minimum and maximum value of the spectra
      <inline-formula><alternatives>
      <tex-math><![CDATA[(i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
      <p><styled-content id="eq-ndvi"><disp-formula><alternatives>
      <tex-math><![CDATA[
      NDVI = \frac{R(840nm)-R(668nm)}{R(840nm)+R(668nm)}
       \qquad(2)]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mi>D</mml:mi><mml:mi>V</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[R(840nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>840</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 840 nm and <inline-formula><alternatives>
      <tex-math><![CDATA[R(668nm)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>668</mml:mn><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      is the reflectance at 668 nm.</p>
    </sec>
    <sec id="validation">
      <title>2.4.2 Validation</title>
      <p>The CNN model was applied to all the 9 flights at both 12 and
      120 m of altitude. In situ information on georeferenced class type
      and percent cover collected during each flight has been used to
      assess the CNN accuracy. These images were used to construct a
      validation dataset indicating the presence or absence of each
      class. Additionally to the quadrat-based validation dataset,
      polygons of each class were photo interpreted in order to increase
      the number of pixels of the validation dataset. A confusion
      matrix, along with precision metrics such as the global accuracy,
      the sensitivity, the specificity, and the Kappa coefficient, was
      generated for each of the study sites. Finally each validation
      matrix has been merge to create a unique matrix of the model. A
      total of 536,000 pixels has been used to globally validate the CNN
      model.</p>
    </sec>
  </sec>
</sec>
<sec id="results">
  <title>3. Results</title>
  <sec id="classification">
    <title>3.1 Classification</title>
    <p>A total of 9 prediction maps corresponding to the 9 drone flights
    were obtained. Each prediction map is associated with a probability
    map, indicating the probability of the selected class for every
    pixel. The low-altitude flight conducted in Gafanaha, Portugal,
    represents the site with the highest complexity
    (<xref alt="Figure 4" rid="fig-GafLow">Figure 4</xref>). Among the 5
    vegetation classes on which the CNN model was trained, 4 were
    present on this site. On this site, there is a mixture of
    Chlorophyceae and Rhodophyceae over the seagrass meadow. This is
    also where Bacillariophyceae is most abundant. Although the seagrass
    bed is solely composed of <italic>Zostera noltei</italic>, various
    colors can be observed: dark green (indicating healthy beds with
    100% coverage) and whitish/brown (indicating beds where leaves are
    dying). Regardless of the color, the meadow is predicted as
    Magnoliopsida by the CNN model.</p>
    <fig id="fig-GafLow">
      <caption><p>Figure 4: RGB orthomosaic (Left) and Prediction
      (Right) of the low altitude flight of Gafanaha, Portugal. The
      total extent of this flight is 3000m² with a resolution of 8 mm
      per pixel. Background colors means intertidal area (Light Green)
      and land area (Light Grey). The zoom covers an area equivalent to
      a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_Low_Pred.png" />
    </fig>
    <p>The high-altitude flight over Gafanha covered nearly 1 km² in
    total (<xref alt="Figure 5" rid="fig-GafHigh">Figure 5</xref>). A
    channel delineating a small island was present in the flight, but it
    has been masked in the prediction map due to glinting and
    misclassification caused by the turbid shallow water. Most of the
    intertidal area has been classified as Magnoliopsida by the model,
    even though there is discoloration of seagrass blades. Only a few
    pixels have been classified as Chlorophyceae at this scale.
    Furthermore, the area that was classified as Bacillariophyceae in
    the low-altitude flight remains mostly classified as such in the
    high-altitude flight, but some pixels of it are now classified as
    Magnoliopsida. The patches of Rhodophyceae are still well
    classified. <italic>Spartina sp.</italic> was present in the
    northern part of the flight, near the land, and has been classified
    either as Magnoliopsida or as Phaeophyceae.</p>
    <fig id="fig-GafHigh">
      <caption><p>Figure 5: RGB orthomosaic (Left) and Prediction
      (Right) of the high altitude flight of Gafanaha, Portugal. The
      total extent of this flight is about 1 km² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green), land area (Light Grey) and water (Light Blue). The red
      triangle shows the extent of the low altitude flight of Gafanha.
      The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel
      size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Gaf_High_Pred.png" />
    </fig>
    <p>The High altitude flight made in the inner lagoon of the Ria de
    Aveiro is the largest of all flights, covering almost 1.5 km²
    (<xref alt="Figure 6" rid="fig-Boat">Figure 6</xref>). On this site,
    only seagrass and red algae where seen on the field. The
    classification follows the same pattern, with a patchy Magnoliopsida
    meadow mixed on the eastern part of the flight with Rhodophyceae. As
    shown in the zoom
    (<xref alt="Figure 6" rid="fig-Boat">Figure 6</xref>), the edges of
    the meadow can be colonised by Chlorophyceae.</p>
    <fig id="fig-Boat">
      <caption><p>Figure 6: RGB orthomosaic (Top) and Prediction
      (Bottom) of the flight made in the inner part of Ria de Aveiro
      Lagoon, Portugal. The total extent of this flight is about 1.5 km²
      with a resolution of 80 mm per pixel. Background colors means
      intertidal area (Light Green), land area (Light Grey) and water
      (Light Blue). The zoom covers an area equivalent to a 10-meter
      Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Boat_Pred.png" />
    </fig>
    <p>The flight over L’Epine in Noirmoutier Island, France
    (<xref alt="Figure 7" rid="fig-Dike">Figure 7</xref>) was conducted
    near a dike crossing the northern part of the flight from west to
    east. Alongside this dike, brown algae attached to rocks and
    stranded green algae could be found. Despite the high mixture
    between Chlorophyceae and Magnoliopsida in this flight, these two
    classes are well discriminated by the classifier.</p>
    <fig id="fig-Dike">
      <caption><p>Figure 7: RGB orthomosaic (Top) and Prediction
      (Bottom) of Northern part of Noirmoutier Island, France. The total
      extent of this flight is about 28 000 m² with a resolution of 80
      mm per pixel. Background colors means intertidal area (Light
      Green) and land area (Light Grey). The zoom covers an area
      equivalent to a 10-meter Sentinel-2 pixel size.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Maps%20Pred/FigX-Dike_Pred.png" />
    </fig>
  </sec>
  <sec id="validation-1">
    <title>3.2 Validation</title>
    <fig id="fig-Validation">
      <caption><p>Figure 8: A global confusion matrix on the left is
      derived from validation data across each flight, while a mosaic of
      confusion matrices from individual flights is presented on the
      right. The labels inside the matrices indicate the balanced
      accuracy for each class. The labels at the bottom of the matrices
      indicate the User’s accuracy for each class, and those on the
      right indicate the Producer’s Accuracy. The values adjacent to the
      names of each site represent the proportion of total pixels from
      that site contributing to the overall matrix. Grey lines within
      the mosaic indicate the absence of validation data for the class
      at that site. The table at the bottom summarizes the Sensitivity,
      Specificity, and Accuracy for each class and for the overall
      model.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Validation/ConfusionMatrixGlobal.png" />
    </fig>
    <p>A total amount of 536,000 pixels have been used to validate the
    Neural Network classifier. The site with the least amount of
    validation data is Kerdrean with a total of 5557 pixels whereas
    Marinha Lanzarote is the site with the most amount of validation
    data with 159713 pixels. The global accuracy of the model is 94.26%
    and a Kappa coefficient of 0.92
    (<xref alt="Figure 8" rid="fig-Validation">Figure 8</xref>). The
    least performing site is Gafanha High with an accuracy of 75.45%
    whereas Mataducos is the site with most accurate prediction, with a
    global accuracy of 98.05%. Overall Phaeophyceae, Magnoliopsida,
    Sediment and Rhodophyceae are well classified with a balanced
    accuracy of 1, 0.96, 0.96 and 0.91 respectively. Bacillariophyceae
    is the least performing class with an accuracy of 0.72 mainly due to
    a confusion with Magnoliopsida and Sediment.</p>
  </sec>
  <sec id="variable-importance">
    <title>3.3 Variable importance</title>
    <fig id="fig-VIP">
      <caption><p>Figure 9: Variable Importance of the Neural Network
      Classifier for each vegetation class. The bigger the slice, the
      more important is the variable to predict accuratly this class.
      The bottom right plot shows the drone standardised reflectance
      spectra of each class.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/VIP/Fig_VIP.png" />
    </fig>
    <p>The computation of the importance variable of each class indicate
    which wavelength is mandatory to accurately predict the class
    (<xref alt="Figure 9" rid="fig-VIP">Figure 9</xref>). Bands at 444
    nm, 717 nm and 842 nm of the Micasense camera are important for none
    of the vegetation classes. The band at 531 nm is the only important
    predictor for the classifier to accuratly predict chlorophyceae. In
    fact, at this wavelength, the Chlorophyceae spectra has the maximum
    reflectance value of all the classes. 531 nm and 740 nm are the most
    important predictors to predict Phaeophyceae, corresponding to the
    minimum reflectance value among all the classes. Bands at 475 and
    560 nm are the most important predictors for Bacillariophyceae and
    Rhodophyceae, respectively. 4 predictors, ranging from the Green
    (560 nm) to the RedEdge (705 nm) are important to predict accurately
    magnoliopsida.</p>
  </sec>
  <sec id="effect-of-the-flight-height-on-the-prediction">
    <title>3.4 Effect of the flight height on the prediction</title>
    <fig id="fig-upscaling">
      <caption><p>Figure 10: Kernel density plot showing the proportion
      of pixel well classified based on the percent cover of the class
      in high altitude flight pixels of Gafanha, Portugal. Each subplot
      shows all the pixels of the same classes on the hight altitude
      flight. Percent cover of classes is retrieve using the result of
      the classification of the low altitude flight of Gafanha,
      Portugal. The vertical dashed line shows the 0.85 probability of
      the model. Everything on the right of this line has a probability
      higher then 0.85 and everuthing on the left of this line has a
      probability lower.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Upscaling/density_vs_Proportion.png" />
    </fig>
    <p><xref alt="Figure 10" rid="fig-upscaling">Figure 10</xref> is
    showing the percent cover of a class required to classify correctly
    the high altitude flight. When the percent cover of the class is 100
    %, big pixels are well classified for all the classes excepted for
    Bare Sediment, where it’s well classified 80% of the time. A
    vegetative percent cover of at least 80% is need to have all the big
    pixels well classified, at the exception of Magnoliopsida that needs
    an higher percent cover (&gt;90 %) to be well classified. Concerning
    the probability of each class, a really high Percent cover is needed
    to confidently predict Bacillariophyceae. To predict Chlorophyceae
    with a confidence of 0.85, a percent cover of 93 % is needed, 90 %
    for magnoliopsida, 92 % for Rhodophyceae and 97 % for
    Bacillariophyceae.</p>
  </sec>
</sec>
<sec id="discussion">
  <title>4. Discussion</title>
  <sec id="seagrass-discrimination">
    <title>4.1 Seagrass Discrimination</title>
  </sec>
  <sec id="spatial-and-spectral-resolution-impact-on-the-prediction">
    <title>4.2 Spatial and Spectral Resolution impact on the
    prediction</title>
    <fig id="fig-Pigm">
      <caption><p>Figure 11: Photosynthetic and carotenoid pigments
      present (Green) or absent (Red) in each taxonomic class present in
      the Neural Network Classifier, along with their absorption
      wavelength measured with spectroradiometer. Chl b: chlorophyll b,
      Chl c: chlorophyll c, Fuco: fucoxanthin, Zea: zeaxanthin, Diato:
      diatoxanthin, Diadino: diadinoxanthin, Neo:
      neoxanthin.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Disc_Pigment_Table.png" />
    </fig>
    <fig id="fig-CompareRef">
      <caption><p>Figure 12: Comparison of reflectance retrieved from
      both low-altitude and high-altitude flights over a common area.
      The red dashed line represents a 1 to 1
      relationship.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Compare_reflectance.png" />
    </fig>
  </sec>
  <sec id="big-picture">
    <title>4.3 Big picture</title>
  </sec>
</sec>
<sec id="conclusion">
  <title>5. Conclusion</title>
</sec>
</body>

<back>
<ref-list>
  <title>6. Bibliography</title>
  <ref id="ref-unsworth2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Unsworth</surname><given-names>Richard KF</given-names></name>
        <name><surname>Cullen-Unsworth</surname><given-names>Leanne C</given-names></name>
        <name><surname>Jones</surname><given-names>Benjamin LH</given-names></name>
        <name><surname>Lilley</surname><given-names>Richard J</given-names></name>
      </person-group>
      <article-title>The planetary role of seagrass conservation</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>377</volume>
      <issue>6606</issue>
      <fpage>609</fpage>
      <lpage>613</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gardner2018">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Gardner</surname><given-names>Royal C</given-names></name>
        <name><surname>Finlayson</surname><given-names>C</given-names></name>
      </person-group>
      <source>Global wetland outlook: State of the world’s wetlands and their services to people</source>
      <year iso-8601-date="2018">2018</year>
      <fpage>2020</fpage>
      <lpage>5</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Dalloyau</surname><given-names>Sébastien</given-names></name>
        <name><surname>Davies</surname><given-names>Bede Ffinian Rowe</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Remote sensing in seagrass ecology: Coupled dynamics between migratory herbivorous birds and intertidal meadows observed by satellite during four decades</article-title>
      <source>Remote Sensing in Ecology and Conservation</source>
      <year iso-8601-date="2022-12">2022</year><month>12</month>
      <issn>2056-3485</issn>
      <pub-id pub-id-type="doi">10.1002/rse2.319</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-jankowska2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jankowska</surname><given-names>Emilia</given-names></name>
        <name><surname>Michel</surname><given-names>Loı̈c N</given-names></name>
        <name><surname>Lepoint</surname><given-names>Gilles</given-names></name>
        <name><surname>Włodarska-Kowalczuk</surname><given-names>Maria</given-names></name>
      </person-group>
      <article-title>Stabilizing effects of seagrass meadows on coastal water benthic food webs</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>510</volume>
      <fpage>54</fpage>
      <lpage>63</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nguyen2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nguyen</surname><given-names>Hung Manh</given-names></name>
        <name><surname>Ralph</surname><given-names>Peter J</given-names></name>
        <name><surname>Marı́n-Guirao</surname><given-names>Lázaro</given-names></name>
        <name><surname>Pernice</surname><given-names>Mathieu</given-names></name>
        <name><surname>Procaccini</surname><given-names>Gabriele</given-names></name>
      </person-group>
      <article-title>Seagrasses in an era of ocean warming: A review</article-title>
      <source>Biological Reviews</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>96</volume>
      <issue>5</issue>
      <fpage>2009</fpage>
      <lpage>2030</lpage>
    </element-citation>
  </ref>
  <ref id="ref-soissons2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Soissons</surname><given-names>Laura M</given-names></name>
        <name><surname>Haanstra</surname><given-names>Eeke P</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Asmus</surname><given-names>Ragnhild</given-names></name>
        <name><surname>Auby</surname><given-names>Isabelle</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
        <name><surname>Brun</surname><given-names>Fernando G</given-names></name>
        <name><surname>Cardoso</surname><given-names>Patricia G</given-names></name>
        <name><surname>Desroy</surname><given-names>Nicolas</given-names></name>
        <name><surname>Fournier</surname><given-names>Jerome</given-names></name>
        <etal/>
      </person-group>
      <article-title>Latitudinal patterns in european seagrass carbon reserves: Influence of seasonal fluctuations versus short-term stress and disturbance events</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>88</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-orth2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Orth</surname><given-names>Robert J</given-names></name>
        <name><surname>Carruthers</surname><given-names>Tim JB</given-names></name>
        <name><surname>Dennison</surname><given-names>William C</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Fourqurean</surname><given-names>James W</given-names></name>
        <name><surname>Heck</surname><given-names>Kenneth L</given-names></name>
        <name><surname>Hughes</surname><given-names>A Randall</given-names></name>
        <name><surname>Kendrick</surname><given-names>Gary A</given-names></name>
        <name><surname>Kenworthy</surname><given-names>W Judson</given-names></name>
        <name><surname>Olyarnik</surname><given-names>Suzanne</given-names></name>
        <etal/>
      </person-group>
      <article-title>A global crisis for seagrass ecosystems</article-title>
      <source>Bioscience</source>
      <publisher-name>American Institute of Biological Sciences</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>56</volume>
      <issue>12</issue>
      <fpage>987</fpage>
      <lpage>996</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lin2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lin</surname><given-names>Haiying</given-names></name>
        <name><surname>Sun</surname><given-names>Tao</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Yang</surname><given-names>Wei</given-names></name>
      </person-group>
      <article-title>Which genes in a typical intertidal seagrass (zostera japonica) indicate copper-, lead-, and cadmium pollution?</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>1545</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-duffy2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Duffy</surname><given-names>J Emmett</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Trinanes</surname><given-names>Joaquin</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E</given-names></name>
        <name><surname>Ambo-Rappe</surname><given-names>Rohani</given-names></name>
        <name><surname>Boström</surname><given-names>Christoffer</given-names></name>
        <name><surname>Buschmann</surname><given-names>Alejandro H</given-names></name>
        <name><surname>Byrnes</surname><given-names>Jarrett</given-names></name>
        <name><surname>Coles</surname><given-names>Robert G</given-names></name>
        <name><surname>Creed</surname><given-names>Joel</given-names></name>
        <etal/>
      </person-group>
      <article-title>Toward a coordinated global observing system for seagrasses and marine macroalgae</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>6</volume>
      <fpage>317</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deSantos2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Los Santos</surname><given-names>Carmen B de</given-names></name>
        <name><surname>Krause-Jensen</surname><given-names>Dorte</given-names></name>
        <name><surname>Alcoverro</surname><given-names>Teresa</given-names></name>
        <name><surname>Marbà</surname><given-names>Núria</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Pérez</surname><given-names>Marta</given-names></name>
        <name><surname>Romero</surname><given-names>Javier</given-names></name>
        <name><surname>Sánchez-Lizaso</surname><given-names>José L</given-names></name>
        <name><surname>Roca</surname><given-names>Guillem</given-names></name>
        <etal/>
      </person-group>
      <article-title>Recent trend reversal for declining european seagrass meadows</article-title>
      <source>Nature communications</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>10</volume>
      <issue>1</issue>
      <fpage>3356</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Peters</surname><given-names>Steef</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series</article-title>
      <source>Ecological Indicators</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>130</volume>
      <issn>1470160X</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S1470160X21006981</uri>
      <pub-id pub-id-type="doi">10.1016/j.ecolind.2021.108033</pub-id>
      <fpage>108033</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Zhongyuan</given-names></name>
        <name><surname>Fang</surname><given-names>Zhixiang</given-names></name>
        <name><surname>Liang</surname><given-names>Jianfeng</given-names></name>
        <name><surname>Song</surname><given-names>Xiao</given-names></name>
      </person-group>
      <article-title>Assessment of global habitat suitability and risk of ocean green tides</article-title>
      <source>Harmful Algae</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>119</volume>
      <fpage>102324</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Miloslavich2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Miloslavich</surname><given-names>Patricia</given-names></name>
        <name><surname>Bax</surname><given-names>Nicholas J.</given-names></name>
        <name><surname>Simmons</surname><given-names>Samantha E.</given-names></name>
        <name><surname>Klein</surname><given-names>Eduardo</given-names></name>
        <name><surname>Appeltans</surname><given-names>Ward</given-names></name>
        <name><surname>Aburto-Oropeza</surname><given-names>Octavio</given-names></name>
        <name><surname>Garcia</surname><given-names>Melissa Andersen</given-names></name>
        <name><surname>Batten</surname><given-names>Sonia D.</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Checkley</surname><given-names>David M.</given-names></name>
        <name><surname>Chiba</surname><given-names>Sanae</given-names></name>
        <name><surname>Duffy</surname><given-names>J. Emmett</given-names></name>
        <name><surname>Dunn</surname><given-names>Daniel C.</given-names></name>
        <name><surname>Fischer</surname><given-names>Albert</given-names></name>
        <name><surname>Gunn</surname><given-names>John</given-names></name>
        <name><surname>Kudela</surname><given-names>Raphael</given-names></name>
        <name><surname>Marsac</surname><given-names>Francis</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E.</given-names></name>
        <name><surname>Obura</surname><given-names>David</given-names></name>
        <name><surname>Shin</surname><given-names>Yunne Jai</given-names></name>
      </person-group>
      <article-title>Essential ocean variables for global sustained observations of biodiversity and ecosystem changes</article-title>
      <source>Global Change Biology</source>
      <publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>
      <year iso-8601-date="2018-06">2018</year><month>06</month>
      <volume>24</volume>
      <issn>1365-2486</issn>
      <uri>https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/10.1111/gcb.14108</uri>
      <pub-id pub-id-type="doi">10.1111/GCB.14108</pub-id>
      <fpage>2416</fpage>
      <lpage>2433</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nijland2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nijland</surname><given-names>Wiebe</given-names></name>
        <name><surname>Reshitnyk</surname><given-names>Luba</given-names></name>
        <name><surname>Rubidge</surname><given-names>Emily</given-names></name>
      </person-group>
      <article-title>Satellite remote sensing of canopy-forming kelp on a complex coastline: A novel procedure using the landsat image archive</article-title>
      <source>Remote Sensing of Environment</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>220</volume>
      <fpage>41</fpage>
      <lpage>50</lpage>
    </element-citation>
  </ref>
  <ref id="ref-xu2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Xu</surname><given-names>Shaochun</given-names></name>
        <name><surname>Xu</surname><given-names>Shuai</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Yue</surname><given-names>Shidong</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Yu</given-names></name>
        <name><surname>Qiao</surname><given-names>Yongliang</given-names></name>
        <name><surname>Liu</surname><given-names>Mingjie</given-names></name>
      </person-group>
      <article-title>Long-term changes in the unique and largest seagrass meadows in the bohai sea (china) using satellite (1974–2019) and sonar data: Implication for conservation and restoration</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>13</volume>
      <issue>5</issue>
      <fpage>856</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Traganos2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Traganos</surname><given-names>Dimosthenis</given-names></name>
        <name><surname>Reinartz</surname><given-names>Peter</given-names></name>
      </person-group>
      <article-title>Mapping mediterranean seagrasses with sentinel-2 imagery</article-title>
      <source>Marine Pollution Bulletin</source>
      <publisher-name>Elsevier Ltd</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>134</volume>
      <issn>18793363</issn>
      <pub-id pub-id-type="doi">10.1016/j.marpolbul.2017.06.075</pub-id>
      <fpage>197</fpage>
      <lpage>209</lpage>
    </element-citation>
  </ref>
  <ref id="ref-coffer2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coffer</surname><given-names>Megan M</given-names></name>
        <name><surname>Graybill</surname><given-names>David D</given-names></name>
        <name><surname>Whitman</surname><given-names>Peter J</given-names></name>
        <name><surname>Schaeffer</surname><given-names>Blake A</given-names></name>
        <name><surname>Salls</surname><given-names>Wilson B</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Richard C</given-names></name>
        <name><surname>Hill</surname><given-names>Victoria</given-names></name>
        <name><surname>Lebrasse</surname><given-names>Marie Cindy</given-names></name>
        <name><surname>Li</surname><given-names>Jiang</given-names></name>
        <name><surname>Keith</surname><given-names>Darryl J</given-names></name>
        <etal/>
      </person-group>
      <article-title>Providing a framework for seagrass mapping in united states coastal ecosystems using high spatial resolution satellite imagery</article-title>
      <source>Journal of Environmental Management</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>337</volume>
      <fpage>117669</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ralph2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ralph</surname><given-names>PJ</given-names></name>
        <name><surname>Polk</surname><given-names>SM</given-names></name>
        <name><surname>Moore</surname><given-names>KA</given-names></name>
        <name><surname>Orth</surname><given-names>RJ</given-names></name>
        <name><surname>Smith Jr</surname><given-names>WO</given-names></name>
      </person-group>
      <article-title>Operation of the xanthophyll cycle in the seagrass zostera marina in response to variable irradiance</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <volume>271</volume>
      <issue>2</issue>
      <fpage>189</fpage>
      <lpage>207</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Douay2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Douay</surname><given-names>Florian</given-names></name>
        <name><surname>Verpoorter</surname><given-names>Charles</given-names></name>
        <name><surname>Duong</surname><given-names>Gwendoline</given-names></name>
        <name><surname>Spilmont</surname><given-names>Nicolas</given-names></name>
        <name><surname>Gevaert</surname><given-names>François</given-names></name>
      </person-group>
      <article-title>New hyperspectral procedure to discriminate intertidal macroalgae</article-title>
      <source>Remote Sensing</source>
      <year iso-8601-date="2022">2022</year>
      <volume>14</volume>
      <issue>2</issue>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/346</uri>
      <pub-id pub-id-type="doi">10.3390/rs14020346</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Davies2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Geraud</surname><given-names>Andréa</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Rosa</surname><given-names>Philippe</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Multi- and hyperspectral classification of soft-bottom intertidal vegetation using a spectral library for coastal biodiversity remote sensing</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2023">2023</year>
      <volume>290</volume>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425723001050</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2023.113554</pub-id>
      <fpage>113554</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bannari2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bannari</surname><given-names>Abderrazak</given-names></name>
        <name><surname>Ali</surname><given-names>Thamer Salim</given-names></name>
        <name><surname>Abahussain</surname><given-names>Asma</given-names></name>
      </person-group>
      <article-title>The capabilities of sentinel-MSI (2A/2B) and landsat-OLI (8/9) in seagrass and algae species differentiation using spectral reflectance</article-title>
      <source>Ocean Science</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>18</volume>
      <issue>2</issue>
      <fpage>361</fpage>
      <lpage>388</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tuya2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tuya</surname><given-names>Fernando</given-names></name>
        <name><surname>Hernandez-Zerpa</surname><given-names>Harue</given-names></name>
        <name><surname>Espino</surname><given-names>Fernando</given-names></name>
        <name><surname>Haroun</surname><given-names>Ricardo</given-names></name>
      </person-group>
      <article-title>Drastic decadal decline of the seagrass cymodocea nodosa at gran canaria (eastern atlantic): Interactions with the green algae caulerpa prolifera</article-title>
      <source>Aquatic Botany</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>105</volume>
      <fpage>1</fpage>
      <lpage>6</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fairley2022drone">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fairley</surname><given-names>Iain</given-names></name>
        <name><surname>Williamson</surname><given-names>Benjamin J</given-names></name>
        <name><surname>McIlvenny</surname><given-names>Jason</given-names></name>
        <name><surname>King</surname><given-names>Nicholas</given-names></name>
        <name><surname>Masters</surname><given-names>Ian</given-names></name>
        <name><surname>Lewis</surname><given-names>Matthew</given-names></name>
        <name><surname>Neill</surname><given-names>Simon</given-names></name>
        <name><surname>Glasby</surname><given-names>David</given-names></name>
        <name><surname>Coles</surname><given-names>Daniel</given-names></name>
        <name><surname>Powell</surname><given-names>Ben</given-names></name>
        <etal/>
      </person-group>
      <article-title>Drone-based large-scale particle image velocimetry applied to tidal stream energy resource assessment</article-title>
      <source>Renewable Energy</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>196</volume>
      <fpage>839</fpage>
      <lpage>855</lpage>
    </element-citation>
  </ref>
  <ref id="ref-oh2017use">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Oh</surname><given-names>Jaehong</given-names></name>
        <name><surname>Kim</surname><given-names>Duk-jin</given-names></name>
        <name><surname>Lee</surname><given-names>Hyoseong</given-names></name>
      </person-group>
      <article-title>Use of a drone for mapping and time series image acquisition of tidal zones</article-title>
      <source>Journal of the Korean Institute of Intelligent Systems</source>
      <publisher-name>Korean Institute of Intelligent Systems</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>27</volume>
      <issue>2</issue>
      <fpage>119</fpage>
      <lpage>125</lpage>
    </element-citation>
  </ref>
  <ref id="ref-adade2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Adade</surname><given-names>Richard</given-names></name>
        <name><surname>Aibinu</surname><given-names>Abiodun Musa</given-names></name>
        <name><surname>Ekumah</surname><given-names>Bernard</given-names></name>
        <name><surname>Asaana</surname><given-names>Jerry</given-names></name>
      </person-group>
      <article-title>Unmanned aerial vehicle (UAV) applications in coastal zone management—a review</article-title>
      <source>Environmental Monitoring and Assessment</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>193</volume>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-casella2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Casella</surname><given-names>Elisa</given-names></name>
        <name><surname>Drechsel</surname><given-names>Jan</given-names></name>
        <name><surname>Winter</surname><given-names>Christian</given-names></name>
        <name><surname>Benninghoff</surname><given-names>Markus</given-names></name>
        <name><surname>Rovere</surname><given-names>Alessio</given-names></name>
      </person-group>
      <article-title>Accuracy of sand beach topography surveying by drones and photogrammetry</article-title>
      <source>Geo-Marine Letters</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>40</volume>
      <fpage>255</fpage>
      <lpage>268</lpage>
    </element-citation>
  </ref>
  <ref id="ref-angnuureng2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Angnuureng</surname><given-names>Donatus B</given-names></name>
        <name><surname>Brempong</surname><given-names>KE</given-names></name>
        <name><surname>Jayson-Quashigah</surname><given-names>PN</given-names></name>
        <name><surname>Dada</surname><given-names>OA</given-names></name>
        <name><surname>Akuoko</surname><given-names>SGI</given-names></name>
        <name><surname>Frimpomaa</surname><given-names>J</given-names></name>
        <name><surname>Mattah</surname><given-names>PA</given-names></name>
        <name><surname>Almar</surname><given-names>Rafaël</given-names></name>
      </person-group>
      <article-title>Satellite, drone and video camera multi-platform monitoring of coastal erosion at an engineered pocket beach: A showcase for coastal management at elmina bay, ghana (west africa)</article-title>
      <source>Regional Studies in Marine Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>53</volume>
      <fpage>102437</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-joyce2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Joyce</surname><given-names>Karen E</given-names></name>
        <name><surname>Fickas</surname><given-names>Kate C</given-names></name>
        <name><surname>Kalamandeen</surname><given-names>Michelle</given-names></name>
      </person-group>
      <article-title>The unique value proposition for using drones to map coastal ecosystems</article-title>
      <source>Cambridge Prisms: Coastal Futures</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>1</volume>
      <fpage>e6</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-tallam2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tallam</surname><given-names>Krti</given-names></name>
        <name><surname>Nguyen</surname><given-names>Nam</given-names></name>
        <name><surname>Ventura</surname><given-names>Jonathan</given-names></name>
        <name><surname>Fricker</surname><given-names>Andrew</given-names></name>
        <name><surname>Calhoun</surname><given-names>Sadie</given-names></name>
        <name><surname>O’Leary</surname><given-names>Jennifer</given-names></name>
        <name><surname>Fitzgibbons</surname><given-names>Mauriça</given-names></name>
        <name><surname>Robbins</surname><given-names>Ian</given-names></name>
        <name><surname>Walter</surname><given-names>Ryan K</given-names></name>
      </person-group>
      <article-title>Application of deep learning for classification of intertidal eelgrass from drone-acquired imagery</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>15</volume>
      <issue>9</issue>
      <fpage>2321</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Roca2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Roca</surname><given-names>Mar</given-names></name>
        <name><surname>Dunbar</surname><given-names>Martha Bonnet</given-names></name>
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Caballero</surname><given-names>Isabel</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Monitoring the marine invasive alien species rugulopteryx okamurae using unmanned aerial vehicles and satellites</article-title>
      <source>Frontiers in Marine Science</source>
      <year iso-8601-date="2022-10">2022</year><month>10</month>
      <volume>9</volume>
      <issn>2296-7745</issn>
      <pub-id pub-id-type="doi">10.3389/fmars.2022.1004012</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Roman2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Tovar-Sánchez</surname><given-names>Antonio</given-names></name>
        <name><surname>Olivé</surname><given-names>Irene</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <fpage>1225</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brunier2022Topographic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brunier</surname><given-names>Guillaume</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Gruet</surname><given-names>Yves</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas F.</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Topographic analysis of intertidal polychaete reefs (sabellaria alveolata) at a very high spatial resolution</article-title>
      <source>Remote Sensing 2022, Vol. 14, Page 307</source>
      <publisher-name>Multidisciplinary Digital Publishing Institute</publisher-name>
      <year iso-8601-date="2022-01">2022</year><month>01</month>
      <volume>14</volume>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/307</uri>
      <pub-id pub-id-type="doi">10.3390/RS14020307</pub-id>
      <fpage>307</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-collin2019improving">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Collin</surname><given-names>Antoine</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas</given-names></name>
        <name><surname>James</surname><given-names>Dorothée</given-names></name>
        <name><surname>Houet</surname><given-names>Thomas</given-names></name>
      </person-group>
      <article-title>Improving intertidal reef mapping using UAV surface, red edge, and near-infrared data</article-title>
      <source>Drones</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>3</volume>
      <issue>3</issue>
      <fpage>67</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-rossiter2020uav">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rossiter</surname><given-names>Thomas</given-names></name>
        <name><surname>Furey</surname><given-names>Thomas</given-names></name>
        <name><surname>McCarthy</surname><given-names>Tim</given-names></name>
        <name><surname>Stengel</surname><given-names>Dagmar B</given-names></name>
      </person-group>
      <article-title>UAV-mounted hyperspectral mapping of intertidal macroalgae</article-title>
      <source>Estuarine, Coastal and Shelf Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>242</volume>
      <fpage>106789</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-BedeGbif">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Sousa</surname><given-names>A I.</given-names></name>
        <name><surname>Figueira</surname><given-names>R</given-names></name>
        <name><surname>Oiry</surname><given-names>S</given-names></name>
        <name><surname>Gernez</surname><given-names>P</given-names></name>
        <name><surname>Barillé</surname><given-names>L</given-names></name>
      </person-group>
      <article-title>Benthic intertidal vegetation from the tagus estuary and aveiro lagoon</article-title>
      <publisher-name>Université de Nantes via GBIF.org</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.15468/n4ak6x</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Pereira2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pereira</surname><given-names>Henrique Miguel</given-names></name>
        <name><surname>Ferrier</surname><given-names>Simon</given-names></name>
        <name><surname>Walters</surname><given-names>Michele</given-names></name>
        <name><surname>Geller</surname><given-names>Gary N</given-names></name>
        <name><surname>Jongman</surname><given-names>Rob HG</given-names></name>
        <name><surname>Scholes</surname><given-names>Robert J</given-names></name>
        <name><surname>Bruford</surname><given-names>Michael William</given-names></name>
        <name><surname>Brummitt</surname><given-names>Neil</given-names></name>
        <name><surname>Butchart</surname><given-names>Stuart HM</given-names></name>
        <name><surname>Cardoso</surname><given-names>AC</given-names></name>
        <etal/>
      </person-group>
      <article-title>Essential biodiversity variables</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>339</volume>
      <issue>6117</issue>
      <fpage>277</fpage>
      <lpage>278</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

Balanced Accuracy`[c(1:6)]),2)
)

global_accuracy_coord&lt;-data.frame(x = 24.571,
                                  y = -4.5,
                                  label = round(as.numeric(validation_metrics$overall[1]),2))  

centroid_cells_df_rows&lt;-centroid_cells_df %&gt;% 
  filter(!is.na(row)) %&gt;% 
  mutate(Row = paste0(centroid_cells.site,&quot;_&quot;,row))

centroid_cells_df_cols&lt;-centroid_cells_df %&gt;% 
  filter(!is.na(col)) %&gt;% 
  mutate(cols = paste0(centroid_cells.site,&quot;_&quot;,col))

plot_matrix_global &lt;-
ggplot()+
  geom_spatraster(data = (confmat_rast),
                  # show.legend = F,
                  na.rm = TRUE
                  )+
  geom_spatraster(data = confmat_rast_GafanhaLow,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_GafanhaLow_sf,
          fill = &quot;transparent&quot;)+
  geom_spatraster(data = confmat_rast_GafanhaHigh,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_GafanhaHigh_sf,
          fill = &quot;transparent&quot;)+
  geom_spatraster(data = confmat_rast_Boat,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_Boat_sf,
          fill = &quot;transparent&quot;)+
    geom_spatraster(data = confmat_rast_Horse_rooster,
                  na.rm = TRUE
                  )+
    geom_sf(data = confmat_rast_Horse_rooster_sf,
          fill = &quot;transparent&quot;)+
    geom_spatraster(data = confmat_rast_NorthDike,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_NorthDike_sf,
          fill = &quot;transparent&quot;)+
    geom_spatraster(data = confmat_rast_Handfisher_1,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_Handfisher_1_sf,
          fill = &quot;transparent&quot;)+
    geom_spatraster(data = confmat_rast_Arz,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_Arz_sf,
          fill = &quot;transparent&quot;)+
    geom_spatraster(data = confmat_rast_DuerLow,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_DuerLow_sf,
          fill = &quot;transparent&quot;)+
    geom_spatraster(data = confmat_rast_Kerdrean,
                  na.rm = TRUE
                  )+
  geom_sf(data = confmat_rast_Kerdrean_sf,
          fill = &quot;transparent&quot;)+
  # geom_sf(data = centroid_cells,
  #         fill = &quot;transparent&quot;)+
  
  geom_path(data = centroid_cells_df_rows, 
            aes(x = X, y = Y, group = Row),
            linewidth = 2,
            linejoin = &quot;round&quot;,
            lineend = &quot;round&quot;,
            colour = &quot;grey&quot;)+
  geom_path(data = centroid_cells_df_cols, 
            aes(x = X, y = Y, group = cols),
            linewidth = 2,
            linejoin = &quot;round&quot;,
            lineend = &quot;round&quot;,
            colour = &quot;grey&quot;)+
  scale_fill_gradientn(
    # colours = c(&quot;black&quot;,&quot;firebrick4&quot;,&quot;goldenrod&quot;,&quot;yellow&quot;,&quot;chartreuse3&quot;),
    # colours = c(&quot;khaki1&quot;,&quot;goldenrod&quot;,&quot;firebrick3&quot;,&quot;chartreuse4&quot;),
    colours = c(&quot;khaki1&quot;,&quot;firebrick4&quot;,&quot;firebrick4&quot;,&quot;firebrick4&quot;,&quot;#3e0b0b&quot;),
    # colours = c(&quot;#7d0000&quot;,&quot;#00b300&quot;,&quot;#00b300&quot;,&quot;#00b300&quot;,&quot;#007d00&quot;),
    na.value = &quot;white&quot;, 
    trans = &quot;sqrt&quot;,
    labels = c(&quot;0.05&quot;,&quot;0.25&quot;, &quot;0.50&quot;, &quot;0.75&quot;, &quot;1&quot;),
    breaks = c(0.05,0.25,0.50,0.75,0.9999))+
  # scale_fill_Bede(&quot;mixed&quot;, 
  #                 discrete = F,
  #                 reverse = TRUE,
  #                 na.value = &quot;white&quot;,
  #                 trans = &quot;sqrt&quot;,
  #                 labels = c(&quot;5&quot;,&quot;25&quot;, &quot;50&quot;, &quot;75&quot;, &quot;100&quot;),
  #                 breaks = c(0.05,0.25,0.50,0.75,0.9999))+
  labs(fill = &quot;Proportion \n of pixels&quot;)+
  scale_x_continuous(breaks = seq(1,11, by = 2),
                     labels = c(&quot;Sediment&quot;,&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Rhodophyceae&quot;,&quot;Phaeophyceae&quot;),
                     expand = c(0, 0),
                     position = &quot;top&quot;,
                     limits = c(-4.6,29))+
  scale_y_continuous(breaks = seq(1,11, by = 2),
                     labels = c(&quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;,&quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Bacillariophyceae&quot;,&quot;Sediment&quot;),
                     expand = c(0, 0.1),
                     limits = c(-5,15.5))+
  geom_polygon(aes(x = c(-3,26,26,-3),
                   y = c(-4,-4,-5,-5)),
               fill = &quot;lightgrey&quot;,
               color = &quot;transparent&quot;)+
  geom_polygon(aes(x = c(23.142,26,26,23.142),
                   y = c(-1,-1,-4,-4)),
               fill = &quot;lightgrey&quot;,
               color = &quot;transparent&quot;)+
  geom_path(
    data = data.frame(
      x = c(0,12,0,12,0,12,0,12,0,12,0,12,0,12,0,0,2,2,4,4,6,6,8,8,10,10,12,12),
      y = c(0,0,2,2,4,4,6,6,8,8,10,10,12,12,0,12,0,12,0,12,0,12,0,12,0,12,0,12),
      group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14)
      ),
    aes(x,y,group= group),
    linewidth = 1
    )+
  geom_path(data = other_table_path,
            aes(x = x,
                y = y,
                group = group),
            linewidth = 1)+
  geom_label(
    data = df_corrected_accuracy,
    aes(x = x, y = y, label = paste0(round(lab,3)*100,&quot;%&quot;)),
    fill = &quot;#ffffff99&quot;,
    size = 9
    )+
  geom_text(
    data = df_Sens_Spec,
    aes(x = x, y = y, label = paste0(round(lab,4)*100,&quot;%&quot;)),
    # fill = &quot;#ffffff99&quot;,
    size = 8
    )+
  geom_text(
    data = other_table_title,
    aes(x = x, y = y, label = label),
    # fill = &quot;#ffffff99&quot;,
    size = 8
    )+
  geom_text(
    data = other_table_y_axis,
    aes(x = x, y = y, label = label),
    size = 8,
    hjust = 1,
    size = 8
  )+
  geom_text(
    data = other_table_values,
    aes(x = x, y = y, label = label),
    # fill = &quot;#ffffff99&quot;,
    size = 8
    )+
  geom_text(
    data = global_accuracy_coord,
    aes(x = x, y = y, label = label),
    # fill = &quot;#ffffff99&quot;,
    size = 12,
    color = &quot;firebrick4&quot;
    
    )+
  geom_label(
    data = df_Label_Sites,
    aes(x = x, y = y, label = lab),
    fill = &quot;#ffffff99&quot;,
    size = 6.8
    )+
  geom_text(
    data = x_axis_text,
    aes(x = x, y = y, label = lab),
    # fill = &quot;#ffffff99&quot;,
    # vjust = 1,
    hjust = 0,
    size = 9,
    angle = 40
    )+
  geom_text(
    data = y_axis_text,
    aes(x = x, y = y, label = lab),
    # fill = &quot;#ffffff99&quot;,
    hjust = 1,
    size = 9,
    # angle = 20
    )+
  
  # geom_text(
  #   aes(x = 13.8, y = 12.72, label = &quot;Producer's Accuracy&quot;),
  #   # fill = &quot;#ffffff99&quot;,
  #   size = 9,
  #   angle = 20
  #   )+
  # geom_text(
  #   aes(x = 0, y = 0, label = &quot;User's Accuracy&quot;),
  #   # fill = &quot;#ffffff99&quot;,
  #   size = 9
  #   )+
  xlab(&quot;References&quot;)+
  ylab(&quot;Prediction&quot;)+
  # ggplot2::annotation_custom(ggplotGrob(small_validation_matrices), xmin = 12, ymin = 0)+
  theme_Bede()+
  theme(
  # axis.title.x = element_text(size = 35),
        # axis.title.y = element_text(size = 35),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),

        # axis.text.x = element_text(size = 30),
        axis.text.x = element_blank(),
        # axis.text.y = element_text(size = 25),
         axis.text.y = element_blank(),
        
        axis.ticks.x = element_blank(),
        axis.ticks.y = element_blank(), 
        panel.border = element_blank(),
        axis.line=element_blank(),
        # legend.position = &quot;top&quot;,
        legend.position = c(0.73, 0.9),
        legend.direction=&quot;horizontal&quot;,
        legend.key.width = unit(2,&quot;cm&quot;),
        legend.text = element_text(size = 20),
        legend.title = element_text(size = 20, vjust = 2),
        legend.title.align = 0.5,
        legend.justification = &quot;center&quot;)</code>
    <code language="r script"># plot_matrix_global
############ Metrics of each sites ###################

Arz_metrics_ByClass&lt;-validation_metrics_Arz$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Arz Island&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

Arz_metrics_overall&lt;-validation_metrics_Arz$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Arz Island&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

Arz_metrics&lt;-rbind(Arz_metrics_ByClass,Arz_metrics_overall)

Boat_metrics_ByClass&lt;-validation_metrics_Boat$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Marinha Lanzarote&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

Boat_metrics_overall&lt;-validation_metrics_Boat$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Marinha Lanzarote&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

Boat_metrics&lt;-rbind(Boat_metrics_ByClass,Boat_metrics_overall)

DuerLow_metrics_ByClass&lt;-validation_metrics_DuerLow$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Duer&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

DuerLow_metrics_overall&lt;-validation_metrics_DuerLow$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Duer&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

DuerLow_metrics&lt;-rbind(DuerLow_metrics_ByClass,DuerLow_metrics_overall)

GafanhaHigh_metrics_ByClass&lt;-validation_metrics_GafanhaHigh$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Gafanha High&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

GafanhaHigh_metrics_overall&lt;-validation_metrics_GafanhaHigh$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Gafanha High&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

GafanhaHigh_metrics&lt;-rbind(GafanhaHigh_metrics_ByClass,GafanhaHigh_metrics_overall)

GafanhaLow_metrics_ByClass&lt;-validation_metrics_GafanhaLow$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Gafanha Low&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

GafanhaLow_metrics_overall&lt;-validation_metrics_GafanhaLow$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Gafanha Low&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

GafanhaLow_metrics&lt;-rbind(GafanhaLow_metrics_ByClass,GafanhaLow_metrics_overall)

Handfisher_1_metrics_ByClass&lt;-validation_metrics_Handfisher_1$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Barbâtre&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

Handfisher_1_metrics_overall&lt;-validation_metrics_Handfisher_1$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Barbâtre&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

Handfisher_1_metrics&lt;-rbind(Handfisher_1_metrics_ByClass,Handfisher_1_metrics_overall)

Horse_rooster_metrics_ByClass&lt;-validation_metrics_Horse_rooster$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Mataducos&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

Horse_rooster_metrics_overall&lt;-validation_metrics_Horse_rooster$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Mataducos&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

Horse_rooster_metrics&lt;-rbind(Horse_rooster_metrics_ByClass,Horse_rooster_metrics_overall)


Kerdrean_metrics_ByClass&lt;-validation_metrics_Kerdrean$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;Kerdrean&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

Kerdrean_metrics_overall&lt;-validation_metrics_Kerdrean$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;Kerdrean&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

Kerdrean_metrics&lt;-rbind(Kerdrean_metrics_ByClass,Kerdrean_metrics_overall)

NorthDike_metrics_ByClass&lt;-validation_metrics_NorthDike$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.),
         Site = &quot;L'Epine&quot;) %&gt;% 
  pivot_longer(-c(Class,Site),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)

NorthDike_metrics_overall&lt;-validation_metrics_NorthDike$overall %&gt;% 
  as.data.frame() %&gt;% 
  rename(value = &quot;.&quot;) %&gt;% 
  mutate(Class = &quot;All&quot;,
         Site = &quot;L'Epine&quot;,
         metric = rownames(.)) %&gt;% 
  reframe(Class,Site,metric,value)

NorthDike_metrics&lt;-rbind(NorthDike_metrics_ByClass,NorthDike_metrics_overall)


BySite_Metrics&lt;-rbind(NorthDike_metrics,Kerdrean_metrics,Horse_rooster_metrics,Handfisher_1_metrics,GafanhaLow_metrics,GafanhaHigh_metrics,DuerLow_metrics,Boat_metrics,Arz_metrics)


Overall_metrics_ByClass&lt;-validation_metrics$byClass %&gt;% 
  as.data.frame() %&gt;% 
  mutate(Class = rownames(.) %&gt;% 
           gsub(&quot;Class: &quot;,&quot;&quot;,.)) %&gt;% 
  pivot_longer(-c(Class),names_to = &quot;metric&quot;, values_to = &quot;value&quot;)
################

ggsave(&quot;Figures/Validation/ConfusionMatrixGlobal.png&quot;,plot_matrix_global , width = 1920*4, height = 1032*4, units = &quot;px&quot;)</code>
    <sec id="nb-code-cell-23-output-0-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-1-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-2-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-3-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-4-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-5-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-6-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-7-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-8-nb-article" specific-use="notebook-output">
    <preformat>Warning: st_centroid assumes attributes are constant over geometries</preformat>
    </sec>
    <sec id="nb-code-cell-23-output-9-nb-article" specific-use="notebook-output">
    <preformat>Warning: Duplicated aesthetics after name standardisation: size</preformat>
    </sec>
    </sec>
    <sec id="cell-fig-Validation-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;./Figures/Validation/ConfusionMatrixGlobal.png&quot;)</code>
    <fig id="fig-Validation-nb-article">
      <caption><p>Figure 8: A global confusion matrix on the left is
      derived from validation data across each flight, while a mosaic of
      confusion matrices from individual flights is presented on the
      right. The labels inside the matrices indicate the balanced
      accuracy for each class. The labels at the bottom of the matrices
      indicate the User’s accuracy for each class, and those on the
      right indicate the Producer’s Accuracy. The values adjacent to the
      names of each site represent the proportion of total pixels from
      that site contributing to the overall matrix. Grey lines within
      the mosaic indicate the absence of validation data for the class
      at that site. The table at the bottom summarizes the Sensitivity,
      Specificity, and Accuracy for each class and for the overall
      model.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Validation/ConfusionMatrixGlobal.png" />
    </fig>
    </sec>
    <p>A total amount of 536,000 pixels have been used to validate the
    Neural Network classifier. The site with the least amount of
    validation data is Kerdrean with a total of 5557 pixels whereas
    Marinha Lanzarote is the site with the most amount of validation
    data with 159713 pixels. The global accuracy of the model is 94.26%
    and a Kappa coefficient of 0.92
    (<xref alt="Figure 8" rid="fig-Validation-nb-article">Figure 8</xref>). The
    least performing site is Gafanha High with an accuracy of 75.45%
    whereas Mataducos is the site with most accurate prediction, with a
    global accuracy of 98.05%. Overall Phaeophyceae, Magnoliopsida,
    Sediment and Rhodophyceae are well classified with a balanced
    accuracy of 1, 0.96, 0.96 and 0.91 respectively. Bacillariophyceae
    is the least performing class with an accuracy of 0.72 mainly due to
    a confusion with Magnoliopsida and Sediment.</p>
  </sec>
  <sec id="variable-importance-nb-article">
    <title>3.3 Variable importance</title>
    <sec id="nb-code-cell-24-nb-article" specific-use="notebook-code">
    <code language="r script">################# SPECTRA ########### 
SP1&lt;-read.csv(&quot;Output/Spectra_VIP.csv&quot;) %&gt;% 
  dplyr::select(-X) %&gt;% 
  mutate(type = &quot;Min/Max Standardised Spectra&quot;) %&gt;% 
  dplyr::filter(Class != &quot;Bare Sediment&quot;,
                Class != &quot;Sun Glint&quot;,
                Class != &quot;Water&quot;,
                Class != &quot;Xanthophyceae&quot;,
                Class != &quot;A - MagnoliopsidaL&quot;) %&gt;% 
  as_tibble()%&gt;% 
  rename(value = &quot;STD&quot;)

SP2&lt;-read.csv(&quot;Output/Spectra_VIP2.csv&quot;) %&gt;% 
  dplyr::select(-X) %&gt;% 
  mutate(type = &quot;Raw Spectra&quot;,
         mean = mean / 10000)%&gt;% 
  dplyr::filter(Class != &quot;Bare Sediment&quot;,
                Class != &quot;Sun Glint&quot;,
                Class != &quot;Water&quot;,
                Class != &quot;Xanthophyceae&quot;,
                Class != &quot;A - MagnoliopsidaL&quot;) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::reframe(Class,Wavelength, mean, type) %&gt;% 
  rename(value = &quot;mean&quot;)

SP&lt;-SP1 %&gt;% 
  rbind(SP2)


SP_plot&lt;-ggplot(SP, aes( x = Wavelength, y = value, color = Class))+
  geom_line(linewidth = 1.5, show.legend = F)+
  facet_wrap(~ type, scale = &quot;free&quot;,ncol =1) +
  scale_color_manual(values=c(&quot;#389318&quot;, &quot;#873e23&quot;, &quot;#b3002d&quot;, &quot;#b3ff1a&quot;, &quot;#DAA520&quot;))+
  ylab(&quot;Reflectance&quot;)+
  xlab(&quot;Wavelength (nm)&quot;)+
  theme_Bede()+
  theme(axis.text.x = element_text(size = 20),
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 25),
        axis.title.y = element_text(size = 25),
        strip.text = element_text(size=25),
        legend.position = c(0.2, 0.7),
        plot.background = element_rect(fill = rgb(1,1,1, alpha=0), colour = NA),
        legend.title=element_blank(),
        legend.text = element_text(size = 5),
        legend.key.size = unit(0.25, &quot;cm&quot;),
        legend.text.align = 0,
        panel.border = element_blank(), 
        panel.background = element_blank(),
        axis.line = element_line(color=&quot;black&quot;))

############## VIP ##############

filelist&lt;-&quot;Data&quot; %&gt;% 
  list.files(pattern = &quot;NN_VIP_byClass_NoXanth.csv&quot;, recursive = T,full.names = T)

VIP&lt;-filelist[which(str_detect(filelist,&quot;VIP&quot;))] %&gt;% 
  read.csv() %&gt;% 
  mutate(Magnoliopsida = (Magnoliosida + Low_SPC)/2) %&gt;% 
  dplyr::select(-c(Magnoliosida ,Low_SPC))

VIP1&lt;-VIP %&gt;%
  dplyr::select(-c(Water,
                   SunGlint,
                   Deep_Sediment,
                   Bare_Sediment)) %&gt;%
  # dplyr::filter(!str_detect(X,&quot;NDVI&quot;)) %&gt;% 
  mutate(isSTD = case_when(str_detect(X,&quot;Stan&quot;) ~ &quot;Standardised&quot;, 
                         TRUE ~ &quot;RAW&quot;)) %&gt;%
  pivot_longer(-c(X,isSTD), names_to = &quot;Class&quot;,values_to = &quot;value&quot;) %&gt;% 
  dplyr::filter(X != &quot;NDVI&quot;,
                X != &quot;NDVI_Stan&quot;) %&gt;% 
  group_by(Class) %&gt;%
  mutate(STD = (value-min(value))/(max(value)-min(value))) %&gt;% 
  ungroup() %&gt;% 
  mutate(Class = case_when(Class == &quot;Magnoliosida&quot; ~ &quot;Magnoliopsida&quot;,
                           Class == &quot;Low_SPC&quot; ~ &quot;Magnoliopsida&quot;,
                           Class == &quot;Clorophyta&quot; ~ &quot;Chlorophyceae&quot;,
                           Class == &quot;Rhodphyta&quot; ~ &quot;Rhodophyceae&quot;,
                           Class == &quot;MPB&quot; ~ &quot;Bacillariophyceae&quot;,
                           Class == &quot;Phaeophyta&quot; ~ &quot;Phaeophyceae&quot;,
                           TRUE ~ Class),
         Variable = str_replace_all(str_replace_all(str_replace_all(X,&quot;Reflectance&quot;,&quot;&quot;),&quot;Stan&quot;,&quot;&quot;),&quot;_&quot;,&quot;&quot;)) %&gt;% 
  dplyr::filter(Class != &quot;Total&quot;) 

VIP_summarised&lt;-VIP1 %&gt;% 
  group_by(Variable, Class) %&gt;% 
  dplyr::summarise(sumVIP = sum(STD)) %&gt;% 
  ungroup() %&gt;% 
  group_by(Class) %&gt;% 
  mutate(STD = (sumVIP-min(sumVIP))/(max(sumVIP)-min(sumVIP)))

VIP_subPLOT&lt;-VIP_summarised %&gt;% 
  ggplot(aes(x = Variable, y = STD, fill = Class)) +
  geom_col(color = &quot;black&quot;,position =  &quot;dodge&quot;) +
  coord_polar()+
  scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
  facet_wrap(~Class)+
  scale_fill_manual(&quot;Class&quot;, labels = c(&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;, &quot;Magnoliopsida&quot;, &quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;),
                    values = c(&quot;#DAA520&quot;,&quot;#b3ff1a&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;))+
  theme_Bede()+
  theme(panel.grid.major.y = element_line(linetype = &quot;dotted&quot;,color = c(&quot;grey9&quot;,&quot;grey9&quot;,&quot;grey9&quot;,&quot;grey9&quot;,NA)))+
  ylab(&quot;Importance&quot;)+
  theme(legend.position=&quot;top&quot;,
        strip.text = element_text(size = 25),
        axis.text.y = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.ticks.y =element_blank(),
        axis.title.x =element_blank(),
        axis.title.y =element_text(size = 20),
        legend.key.size = unit(1, 'cm'),
        legend.title = element_text(size=20),
        legend.text = element_text(size=20))+
  guides(fill = guide_legend(nrow = 1))

VIP_PLOT&lt;-VIP_subPLOT+
  # geom_text(aes(label = &quot;Standardised Reflectance Spectra&quot;), color = &quot;black&quot;, size = 8)+
  inset_element(SP_plot,left = 0.6341, top = 0.47, bottom = -0.01, right = 0.90,  align_to = &quot;full&quot;)
VIP_PLOT
ggsave(&quot;Figures/VIP/Fig_VIP.png&quot;, VIP_PLOT, width = 1920*4, height = 1129*4, units = &quot;px&quot;)


################# VIP NDVI ######################

VIP_NDVI&lt;-
  VIP %&gt;%
  dplyr::select(-c(Water,
                   SunGlint,
                   Deep_Sediment,
                   Bare_Sediment)) %&gt;%
  # dplyr::filter(!str_detect(X,&quot;NDVI&quot;)) %&gt;% 
  mutate(isSTD = case_when(str_detect(X,&quot;Stan&quot;) ~ &quot;Standardised&quot;, 
                         TRUE ~ &quot;RAW&quot;)) %&gt;%
  pivot_longer(-c(X,isSTD), names_to = &quot;Class&quot;,values_to = &quot;value&quot;) %&gt;% 
  dplyr::filter(X == &quot;NDVI&quot;) %&gt;% 
  group_by(Class) %&gt;%
  mutate(STD = (value-min(value))/(max(value)-min(value))) %&gt;% 
  ungroup() %&gt;% 
  mutate(Class = case_when(Class == &quot;Magnoliosida&quot; ~ &quot;Magnoliopsida&quot;,
                           Class == &quot;Low_SPC&quot; ~ &quot;Magnoliopsida&quot;,
                           Class == &quot;Clorophyta&quot; ~ &quot;Chlorophyceae&quot;,
                           Class == &quot;Rhodphyta&quot; ~ &quot;Rhodophyceae&quot;,
                           Class == &quot;MPB&quot; ~ &quot;Bacillariophyceae&quot;,
                           Class == &quot;Phaeophyta&quot; ~ &quot;Phaeophyceae&quot;,
                           TRUE ~ Class),
         Variable = str_replace_all(str_replace_all(str_replace_all(X,&quot;Reflectance&quot;,&quot;&quot;),&quot;Stan&quot;,&quot;&quot;),&quot;_&quot;,&quot;&quot;)) %&gt;% 
  dplyr::filter(Class != &quot;Total&quot;) %&gt;% 
  group_by(Class) %&gt;% 
  summarise(sum = sum(value)) %&gt;% 
  mutate(STD = (sum-min(sum))/(max(sum)-min(sum))) %&gt;% 
  ggplot(aes(x = Class, y = STD, fill = Class)) +
  geom_col(color = &quot;black&quot;,position =  &quot;dodge&quot;) +
  # coord_polar()+
  scale_y_continuous(limits = c(0,1), breaks = c(0.25,0.5,0.75,1))+
  # facet_wrap(~Class)+
  scale_fill_manual(&quot;Class&quot;, labels = c(&quot;Bacillariophyceae&quot;,&quot;Chlorophyceae&quot;, &quot;Magnoliopsida&quot;, &quot;Phaeophyceae&quot;,&quot;Rhodophyceae&quot;),
                    values = c(&quot;#DAA520&quot;,&quot;#b3ff1a&quot;, &quot;#389318&quot;,&quot;#873e23&quot;,&quot;#b3002d&quot;))+  theme_Bede()+
  theme(panel.grid.major.y = element_line(linetype = &quot;dotted&quot;,color = c(&quot;grey9&quot;,&quot;grey9&quot;,&quot;grey9&quot;,&quot;grey9&quot;,NA)))+
  ylab(&quot;Importance&quot;)+
  theme(legend.position=&quot;top&quot;,
        strip.text = element_text(size = 25),
        axis.text.y = element_blank(),
        axis.text.x = element_text(size = 20),
        axis.ticks.y =element_blank(),
        axis.title.x =element_blank(),
        axis.title.y =element_text(size = 20),
        legend.key.size = unit(1, 'cm'),
        legend.title = element_text(size=20),
        legend.text = element_text(size=20))+
  guides(fill = guide_legend(nrow = 1))</code>
    </sec>
    <sec id="cell-fig-VIP-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;Figures/VIP/Fig_VIP.png&quot;)</code>
    <fig id="fig-VIP-nb-article">
      <caption><p>Figure 9: Variable Importance of the Neural Network
      Classifier for each vegetation class. The bigger the slice, the
      more important is the variable to predict accuratly this class.
      The bottom right plot shows the drone standardised reflectance
      spectra of each class.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/VIP/Fig_VIP.png" />
    </fig>
    </sec>
    <p>The computation of the importance variable of each class indicate
    which wavelength is mandatory to accurately predict the class
    (<xref alt="Figure 9" rid="fig-VIP-nb-article">Figure 9</xref>). Bands at 444
    nm, 717 nm and 842 nm of the Micasense camera are important for none
    of the vegetation classes. The band at 531 nm is the only important
    predictor for the classifier to accuratly predict chlorophyceae. In
    fact, at this wavelength, the Chlorophyceae spectra has the maximum
    reflectance value of all the classes. 531 nm and 740 nm are the most
    important predictors to predict Phaeophyceae, corresponding to the
    minimum reflectance value among all the classes. Bands at 475 and
    560 nm are the most important predictors for Bacillariophyceae and
    Rhodophyceae, respectively. 4 predictors, ranging from the Green
    (560 nm) to the RedEdge (705 nm) are important to predict accurately
    magnoliopsida.</p>
  </sec>
  <sec id="effect-of-the-flight-height-on-the-prediction-nb-article">
    <title>3.4 Effect of the flight height on the prediction</title>
    <sec id="nb-code-cell-25-nb-article" specific-use="notebook-code">
    <code language="r script">if(length(list.files(&quot;./Output&quot;,pattern = &quot;output_80_filtered_Upscaling.csv&quot;)) == 0 ){
 imglist&lt;-&quot;Output/High_Flights_correction/Low_flight_spatial_resampling/&quot; %&gt;%
   list.files(&quot;.tif&quot;,full.names = T) %&gt;%
   as.data.frame() %&gt;%
   rename(path = &quot;.&quot;) %&gt;%
   mutate(size = case_when(str_detect(path,&quot;_8_7x7.tif&quot;) ~ 8,
                           str_detect(path,&quot;16.tif&quot;) ~ 16,
                           str_detect(path,&quot;32.tif&quot;) ~ 32,
                           str_detect(path,&quot;48.tif&quot;) ~ 48,
                           str_detect(path,&quot;64.tif&quot;) ~ 64,
                           str_detect(path,&quot;80.tif&quot;) ~ 80),
          type = case_when(str_detect(path, &quot;ortho&quot;) ~ &quot;ortho&quot;,
                           str_detect(path, &quot;pred&quot;) ~ &quot;Pred&quot;,
                           TRUE ~ &quot;Prob&quot;))

pred_8&lt;-imglist %&gt;%
   filter(size == 8,
          type == &quot;Pred&quot;) %&gt;%
   pull(path) %&gt;%
   terra::rast()
 names(pred_8)&lt;-&quot;Pred_8&quot;

 pred_80&lt;-imglist %&gt;%
   filter(size == 80,
          type == &quot;Pred&quot;) %&gt;%
   pull(path) %&gt;%
   terra::rast()
 names(pred_80)&lt;-&quot;Pred_80&quot;
 
prob_80&lt;-imglist %&gt;%
   filter(size == 80,
          type == &quot;Prob&quot;) %&gt;%
   pull(path) %&gt;%
   terra::rast()
 names(prob_80)&lt;-&quot;Prob_80&quot;


 model_80&lt;-imglist %&gt;%
   filter(size == 80,
          type == &quot;Pred&quot;) %&gt;%
   pull(path) %&gt;%
   terra::rast()
 values(model_80)&lt;-c(1:ncell(model_80))
 names(model_80)&lt;-&quot;ID_80&quot;


 model_80_rs_to_8&lt;-terra::resample(model_80,pred_8,method = &quot;near&quot;)
 names(model_80_rs_to_8)&lt;-&quot;ID_80&quot;

 df_80_8&lt;-terra::rast(list(model_80_rs_to_8,pred_8)) %&gt;%
   as.data.frame(xy=F) %&gt;%
   filter(!Pred_8 == 0)

 df_80&lt;-terra::rast(list(model_80,pred_80,prob_80)) %&gt;%
   as.data.frame(xy=F) %&gt;%
   filter(!Pred_80 == 0)

#############
output_80&lt;-df_80 %&gt;% 
  left_join(df_80_8, by = &quot;ID_80&quot;) %&gt;% 
  filter(!is.na(Pred_8)) %&gt;% 
  mutate(Class_80 = case_when(Pred_80 == 1 ~ &quot;Bare Sediment&quot;,
                              Pred_80 == 2 ~ &quot;Green Algae&quot;,
                              Pred_80 == 3 ~ &quot;Bare Sediment&quot;,
                              Pred_80 == 4 ~ &quot;Magnoliopsida&quot;,
                              Pred_80 == 5 ~ &quot;Microphytobenthos&quot;,
                              Pred_80 == 6 ~ &quot;Magnoliopsida&quot;,
                              Pred_80 == 7 ~ &quot;Phaeophyceae&quot;,
                              Pred_80 == 8 ~ &quot;Rhodophyceae&quot;,
                              Pred_80 == 9 ~ &quot;Sun Glint&quot;,
                              Pred_80 == 10 ~ &quot;Water&quot;,
                              Pred_80 == 11 ~ &quot;Xanthophyceae&quot;,
                              TRUE ~ as.character(Pred_80)),
         Class_8 = case_when(Pred_8 == 1 ~ &quot;Bare Sediment&quot;,
                              Pred_8 == 2 ~ &quot;Green Algae&quot;,
                              Pred_8 == 3 ~ &quot;Bare Sediment&quot;,
                              Pred_8 == 4 ~ &quot;Magnoliopsida&quot;,
                              Pred_8 == 5 ~ &quot;Microphytobenthos&quot;,
                              Pred_8 == 6 ~ &quot;Magnoliopsida&quot;,
                              Pred_8 == 7 ~ &quot;Phaeophyceae&quot;,
                              Pred_8 == 8 ~ &quot;Rhodophyceae&quot;,
                              Pred_8 == 9 ~ &quot;Sun Glint&quot;,
                              Pred_8 == 10 ~ &quot;Water&quot;,
                              Pred_8 == 11 ~ &quot;Xanthophyceae&quot;,
                              TRUE ~ as.character(Pred_8))
         ) %&gt;% 
   dplyr::filter(Class_80 != &quot;Water&quot;,
                 Class_80 != &quot;Phaeophyceae&quot;,
                 Class_80 != &quot;Sun Glint&quot;,
                 Class_8 != &quot;Water&quot;,
                 Class_8 != &quot;Phaeophyceae&quot;,
                 Class_8 != &quot;Sun Glint&quot;) %&gt;% 
           group_by(ID_80, Prob_80) %&gt;% 
           summarise(prop_Sed = sum((Pred_8 == 1)|(Pred_8 == 3))/n(),
                     prop_Green = sum(Pred_8 == 2)/n(),
                     prop_Magno = sum((Pred_8 == 4)|(Pred_8 == 6))/n(),
                     prop_MPB = sum(Pred_8 == 5)/n(),
                     prop_Rodo = sum(Pred_8 == 8)/n(),
                     prop_Xantho = sum(Pred_8 == 11)/n(),
                     True = unique(Class_80)) %&gt;%
  pivot_longer(-c(ID_80,True,Prob_80), names_to = &quot;Class&quot;, values_to = &quot;Proportion&quot;) %&gt;% 
  mutate(Class = case_when(Class == &quot;prop_Sed&quot; ~ &quot;Bare Sediment&quot;,
                           Class == &quot;prop_Green&quot; ~ &quot;Green Algae&quot;,
                           Class == &quot;prop_Magno&quot; ~ &quot;Magnoliopsida&quot;,
                           Class == &quot;prop_MPB&quot; ~ &quot;Microphytobenthos&quot;,
                           Class == &quot;prop_Pheo&quot; ~ &quot;Phaeophyceae&quot;,
                           Class == &quot;prop_Rodo&quot; ~ &quot;Rhodophyceae&quot;,
                           Class == &quot;prop_Glint&quot; ~ &quot;Sun Glint&quot;,
                           Class == &quot;prop_Water&quot; ~ &quot;Water&quot;,
                           Class == &quot;prop_Xantho&quot; ~ &quot;Xanthophyceae&quot;),
         same = case_when(True == Class ~ 1,
                          TRUE ~ 0)) %&gt;% 
  dplyr::filter(!Proportion == 0)
 
  list&lt;-output_80 %&gt;% 
  dplyr::filter(Proportion == 1,
                Class == True) %&gt;% 
  pull(ID_80)

output_80_filtered&lt;-output_80 %&gt;% 
  dplyr::filter(!ID_80 %in% list )



output_80_filtered_same&lt;-output_80_filtered %&gt;% 
  dplyr::filter(same == 1)

write.csv(output_80_filtered, &quot;./Output/output_80_filtered_Upscaling.csv&quot;)
write.csv(output_80_filtered_same, &quot;./Output/output_80_filtered_same_Upscaling.csv&quot;)

}else{
  
  output_80_filtered&lt;-read.csv(&quot;./Output/output_80_filtered_Upscaling.csv&quot;) %&gt;% 
    dplyr::mutate(Proportion = Proportion *100) %&gt;% 
    dplyr::select(-X) %&gt;% 
    as_tibble()
  output_80_filtered_same&lt;-read.csv(&quot;./Output/output_80_filtered_same_Upscaling.csv&quot;)%&gt;% 
    dplyr::mutate(Proportion = Proportion *100) %&gt;% 
    dplyr::select(-X) %&gt;% 
    as_tibble()
}

################# LM ####################
lm_sediment&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Bare Sediment&quot;) 

 lm_sediment&lt;- lm(lm_sediment$Prob_80 ~ lm_sediment$Proportion)
 
 lm_green&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Green Algae&quot;) 
  lm_green&lt;- lm(lm_green$Prob_80 ~ lm_green$Proportion)
 
 lm_magno&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Magnoliopsida&quot;) 
   lm_magno&lt;- lm(lm_magno$Prob_80 ~ lm_magno$Proportion)

 
 lm_MPB&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Microphytobenthos&quot;)
    lm_MPB&lt;- lm(lm_MPB$Prob_80 ~ lm_MPB$Proportion)
    
lm_Rodo&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Rodophyceae&quot;)
    lm_Rodo&lt;- lm(lm_Rodo$Prob_80 ~ lm_Rodo$Proportion)
 
 ########### ALPHA ###############
alpha_sed&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% 
  mutate(alpha = lm_sediment$coefficients[[2]]*prop+lm_sediment$coefficients[[1]],
         ID = c(1:nrow(.)),
         xmin = seq(0,1,  0.01),
         xmax = seq(0.01,1.01,0.01),
         ymin = rep(0,nrow(.)),
         ymax = rep(1,nrow(.))) %&gt;% 
  pivot_longer(c(xmin,xmax),names_to = &quot;name_x&quot;, values_to = &quot;x&quot;) %&gt;% 
  pivot_longer(c(ymax,ymin), names_to = &quot;name_y&quot;,values_to = &quot;y&quot;) %&gt;% 
  mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% 
  dplyr::select(-c(name_x,name_y)) %&gt;% 
  mutate(alpha = case_when(alpha &gt; 1 ~ 1,
                           TRUE ~ alpha),
         alpha = 1-alpha)%&gt;% 
  mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))

alpha_green&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% 
  mutate(alpha = lm_green$coefficients[[2]]*prop+lm_green$coefficients[[1]],
         ID = c(1:nrow(.)),
         xmin = seq(0,1,  0.01),
         xmax = seq(0.01,1.01,0.01),
         ymin = rep(0,nrow(.)),
         ymax = rep(1,nrow(.))) %&gt;% 
  pivot_longer(c(xmin,xmax),names_to = &quot;name_x&quot;, values_to = &quot;x&quot;) %&gt;% 
  pivot_longer(c(ymax,ymin), names_to = &quot;name_y&quot;,values_to = &quot;y&quot;) %&gt;% 
  mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% 
  dplyr::select(-c(name_x,name_y)) %&gt;% 
  mutate(alpha = case_when(alpha &gt; 1 ~ 1,
                           TRUE ~ alpha),
         alpha = 1-alpha)%&gt;% 
  mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))

alpha_magno&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% 
  mutate(alpha = lm_magno$coefficients[[2]]*prop+lm_magno$coefficients[[1]],
         ID = c(1:nrow(.)),
         xmin = seq(0,1,  0.01),
         xmax = seq(0.01,1.01,0.01),
         ymin = rep(0,nrow(.)),
         ymax = rep(1,nrow(.))) %&gt;% 
  pivot_longer(c(xmin,xmax),names_to = &quot;name_x&quot;, values_to = &quot;x&quot;) %&gt;% 
  pivot_longer(c(ymax,ymin), names_to = &quot;name_y&quot;,values_to = &quot;y&quot;) %&gt;% 
  mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% 
  dplyr::select(-c(name_x,name_y)) %&gt;% 
  mutate(alpha = case_when(alpha &gt; 1 ~ 1,
                           TRUE ~ alpha),
         alpha = 1-alpha)%&gt;% 
  mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))

alpha_MPB&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% 
  mutate(alpha = lm_MPB$coefficients[[2]]*prop+lm_MPB$coefficients[[1]],
         ID = c(1:nrow(.)),
         xmin = seq(0,1,  0.01),
         xmax = seq(0.01,1.01,0.01),
         ymin = rep(0,nrow(.)),
         ymax = rep(1,nrow(.))) %&gt;% 
  pivot_longer(c(xmin,xmax),names_to = &quot;name_x&quot;, values_to = &quot;x&quot;) %&gt;% 
  pivot_longer(c(ymax,ymin), names_to = &quot;name_y&quot;,values_to = &quot;y&quot;) %&gt;% 
  mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% 
  dplyr::select(-c(name_x,name_y)) %&gt;% 
  mutate(alpha = case_when(alpha &gt; 1 ~ 1,
                           TRUE ~ alpha),
         alpha = 1-alpha)%&gt;% 
  mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))

alpha_Rodo&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% 
  mutate(alpha = lm_Rodo$coefficients[[2]]*prop+lm_Rodo$coefficients[[1]],
         ID = c(1:nrow(.)),
         xmin = seq(0,1,  0.01),
         xmax = seq(0.01,1.01,0.01),
         ymin = rep(0,nrow(.)),
         ymax = rep(1,nrow(.))) %&gt;% 
  pivot_longer(c(xmin,xmax),names_to = &quot;name_x&quot;, values_to = &quot;x&quot;) %&gt;% 
  pivot_longer(c(ymax,ymin), names_to = &quot;name_y&quot;,values_to = &quot;y&quot;) %&gt;% 
  mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% 
  dplyr::select(-c(name_x,name_y)) %&gt;% 
  mutate(alpha = case_when(alpha &gt; 1 ~ 1,
                           TRUE ~ alpha),
         alpha = 1-alpha)%&gt;% 
  mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))

# alpha_xantho&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% 
#   mutate(alpha = lm_xantho$coefficients[[2]]*prop+lm_xantho$coefficients[[1]],
#          ID = c(1:nrow(.)),
#          xmin = seq(0,1,  0.01),
#          xmax = seq(0.01,1.01,0.01),
#          ymin = rep(0,nrow(.)),
#          ymax = rep(1,nrow(.))) %&gt;% 
#   pivot_longer(c(xmin,xmax),names_to = &quot;name_x&quot;, values_to = &quot;x&quot;) %&gt;% 
#   pivot_longer(c(ymax,ymin), names_to = &quot;name_y&quot;,values_to = &quot;y&quot;) %&gt;% 
#   mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% 
#   dplyr::select(-c(name_x,name_y)) %&gt;% 
#   mutate(alpha = case_when(alpha &gt; 1 ~ 1,
#                            TRUE ~ alpha),
#          alpha = 1-alpha) %&gt;% 
#   mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))

#################

sediment&lt;-output_80_filtered %&gt;% 
  dplyr::filter(True == &quot;Bare Sediment&quot;) %&gt;% 
  mutate(Class = case_when(Class != True ~ &quot;Other&quot;,
                            TRUE ~ Class)) %&gt;% 
  group_by(ID_80,Class) %&gt;% 
  reframe(Prob_80 = unique(Prob_80),
          True = unique(True),
          Class = unique(Class),
          Proportion = sum(Proportion)) %&gt;% 
  mutate(Class = as.factor(Class),
         Class = forcats::fct_relevel(Class,&quot;Bare Sediment&quot;, after = Inf)) %&gt;% 
  ggplot()+
  geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),alpha = 0.8,show.legend = F,position = &quot;fill&quot;,adjust = 3)+
  # facet_wrap(~ True)+
  scale_fill_manual(values=c(&quot;gray85&quot;,&quot;#70543e&quot;))+
  # scale_alpha_manual(values = c(0.5,1))+
  theme_Bede()+
  # geom_polygon(data = alpha_sed, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_sed$alpha,color=NA, fill = &quot;white&quot;)+
  geom_vline(xintercept = (lm_sediment$coefficients[[2]]*85+lm_sediment$coefficients[[1]])*100, linetype = &quot;dashed&quot;,linewidth = 2)+
  ggtitle(&quot;Bare Sediment&quot;)+
  # annotate(geom=&quot;text&quot;,x = lm_sediment$coefficients[[2]]*0.85+lm_sediment$coefficients[[1]]+0.05, y = 0.85, label = &quot;p = 0.85&quot;, angle = - 90, size = 7)+
  theme(axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15)
        # axis.title.y = element_blank(),
        # axis.title.x = element_text(size = 20)
        )

green&lt;-output_80_filtered %&gt;% 
  dplyr::filter(True == &quot;Green Algae&quot;) %&gt;% 
  mutate(Class = case_when(Class != True ~ &quot;Other&quot;,
                            TRUE ~ Class)) %&gt;% 
  group_by(ID_80,Class) %&gt;% 
  reframe(Prob_80 = unique(Prob_80),
          True = unique(True),
          Class = unique(Class),
          Proportion = sum(Proportion)) %&gt;%
  mutate(Class = as.factor(Class),
         Class = forcats::fct_relevel(Class,&quot;Green Algae&quot;, after = Inf)) %&gt;% 
  ggplot()+
  geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),alpha = 0.8,show.legend = F,position = &quot;fill&quot;,adjust = 3)+
  # facet_wrap(~ True)+
  scale_fill_manual(values=c(&quot;gray85&quot;, &quot;#b3ff1a&quot;))+
  # scale_alpha_manual(values = c(0.5,1))+
  theme_Bede()+
  # geom_polygon(data = alpha_green, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_green$alpha,color=NA, fill = &quot;white&quot;)+
  geom_vline(xintercept = (lm_green$coefficients[[2]]*85+lm_green$coefficients[[1]])*100, linetype = &quot;dashed&quot;,linewidth = 2)+
  ggtitle(&quot;Green Algae&quot;)+
  # annotate(geom=&quot;text&quot;,x = lm_green$coefficients[[2]]*0.85+lm_green$coefficients[[1]]+0.05, y = 0.85, label = &quot;p = 0.85&quot;, angle = - 90, size = 7)+
  theme(axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15)
        # axis.title.y = element_blank(),
        # axis.title.x = element_text(size = 20)
        )

magno&lt;-output_80_filtered %&gt;% 
  dplyr::filter(True == &quot;Magnoliopsida&quot;) %&gt;% 
  mutate(Class = case_when(Class != True ~ &quot;Other&quot;,
                            TRUE ~ Class)) %&gt;% 
  group_by(ID_80,Class) %&gt;% 
  reframe(Prob_80 = unique(Prob_80),
          True = unique(True),
          Class = unique(Class),
          Proportion = sum(Proportion)) %&gt;%
  mutate(Class = as.factor(Class),
         Class = forcats::fct_relevel(Class,&quot;Magnoliopsida&quot;, after = Inf)) %&gt;%
  ggplot()+
  geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),alpha = 0.8,show.legend = F, position = &quot;fill&quot;,adjust = 3)+
  # facet_wrap(~ True)+
  scale_fill_manual(values=c(&quot;gray85&quot;,&quot;#389350&quot;))+
  # scale_alpha_manual(values = c(0.5,1))+
  theme_Bede()+
  # geom_polygon(data = alpha_magno, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_magno$alpha,color=NA, fill = &quot;white&quot;)+
  geom_vline(xintercept = (lm_magno$coefficients[[2]]*85+lm_magno$coefficients[[1]])*100, linetype = &quot;dashed&quot;,linewidth = 2)+
  ggtitle(&quot;Magnoliopsida&quot;)+
  # annotate(geom=&quot;text&quot;,x = lm_magno$coefficients[[2]]*0.85+lm_magno$coefficients[[1]]+0.05, y = 0.85, label = &quot;p = 0.85&quot;, angle = - 90, size = 7)+
  theme(axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15)
        # axis.title.y = element_blank(),
        # axis.title.x = element_text(size = 20)
        )


MPB&lt;-output_80_filtered %&gt;% 
  dplyr::filter(True == &quot;Microphytobenthos&quot;) %&gt;% 
  mutate(Class = case_when(Class != True ~ &quot;Other&quot;,
                            TRUE ~ Class)) %&gt;% 
  group_by(ID_80,Class) %&gt;% 
  reframe(Prob_80 = unique(Prob_80),
          True = unique(True),
          Class = unique(Class),
          Proportion = sum(Proportion)) %&gt;%
  mutate(Class = as.factor(Class),
         Class = forcats::fct_relevel(Class,&quot;Microphytobenthos&quot;, after = Inf)) %&gt;%
  ggplot()+
  geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),alpha = 0.8,show.legend = F,position = &quot;fill&quot;,adjust = 3)+
  # facet_wrap(~ True)+
  scale_fill_manual(values=c(&quot;gray85&quot;,&quot;#DAA520&quot;))+
  # scale_alpha_manual(values = c(0.5,1))+
  theme_Bede()+
  # geom_polygon(data = alpha_MPB, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_MPB$alpha,color=NA, fill = &quot;white&quot;)+
  geom_vline(xintercept = (lm_MPB$coefficients[[2]]*85+lm_MPB$coefficients[[1]])*100, linetype = &quot;dashed&quot;,linewidth = 2)+
  ggtitle(&quot;Microphytobenthos&quot;)+
  # annotate(geom=&quot;text&quot;,x = lm_MPB$coefficients[[2]]*0.85+lm_MPB$coefficients[[1]]+0.05, y = 0.85, label = &quot;p = 0.85&quot;, angle = - 90, size = 7)+
  theme(axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15)
        # axis.title.y = element_blank(),
        # axis.title.x = element_text(size = 20)
        )

rodo&lt;-output_80_filtered %&gt;% 
  dplyr::filter(True == &quot;Rodophyceae&quot;) %&gt;% 
  mutate(Class = case_when(Class != True ~ &quot;Others Classes&quot;,
                           Class == &quot;Rodophyceae&quot; ~ &quot;Rhodophyceae&quot;,
                            TRUE ~ Class),
         True = case_when(True == &quot;Rodophyceae&quot; ~ &quot;Rhodophyceae&quot;,
                          TRUE ~ True)) %&gt;% 
  group_by(ID_80,Class) %&gt;% 
  reframe(Prob_80 = unique(Prob_80),
          True = unique(True),
          Class = unique(Class),
          Proportion = sum(Proportion)) %&gt;%
  mutate(Class = factor(Class, c(&quot;Others Classes&quot;,&quot;Rhodophyceae&quot;,&quot;Bacillariophyceae&quot;, &quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Phaeophyceae&quot;))) %&gt;% 
         # Class = forcats::fct_relevel(Class,&quot;Rodophyceae&quot;, after = Inf)) %&gt;%
  ggplot()+
  geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),alpha = 0.8,position = &quot;fill&quot;,adjust = 3)+
  # facet_wrap(~ True)+
  scale_fill_manual(&quot;Class&quot;,
                    labels = c(&quot;Others Classes&quot;,&quot;Rhodophyceae&quot;,&quot;Bacillariophyceae&quot;, &quot;Magnoliopsida&quot;,&quot;Chlorophyceae&quot;,&quot;Phaeophyceae&quot;),
                    values=c(&quot;gray85&quot;,&quot;#b3002d&quot;,&quot;#DAA520&quot;,&quot;#389350&quot;,&quot;#b3ff1a&quot;,&quot;#70543e&quot;),
                    drop = F)+
  # scale_alpha_manual(values = c(0.5,1))+
  theme_Bede()+
  # geom_polygon(data = alpha_Rodo, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_Rodo$alpha,color=NA, fill = &quot;white&quot;)+
  geom_vline(xintercept = (lm_Rodo$coefficients[[2]]*85+lm_Rodo$coefficients[[1]])*100, linetype = &quot;dashed&quot;,linewidth = 2)+
  ggtitle(&quot;Rhodophyceae&quot;)+
  # annotate(geom=&quot;text&quot;,x = lm_Rodo$coefficients[[2]]*0.85+lm_Rodo$coefficients[[1]]+0.05, y = 0.85, label = &quot;p = 0.85&quot;, angle = - 90, size = 7)+
  theme(axis.text.x = element_text(size = 15),
        axis.text.y = element_text(size = 15),
        # axis.title.y = element_blank(),
        # axis.title.x = element_text(size = 20),
        legend.text = element_text(size = 15),
        legend.key.size = unit(1,&quot;cm&quot;),
        legend.title = element_blank())

# xantho&lt;-output_80_filtered %&gt;% 
#   dplyr::filter(True == &quot;Xanthophyceae&quot;) %&gt;% 
#   ggplot()+
#   geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),position = &quot;fill&quot;,adjust = 3)+
#   # facet_wrap(~ True)+
#   scale_fill_manual(values=c(&quot;#70543e&quot;, &quot;#b3ff1a&quot;, &quot;#389350&quot;, &quot;#DAA520&quot;,&quot;#b3002d&quot;, &quot;#cccc00&quot;))+
#   # scale_alpha_manual(values = c(0.5,1))+
#   theme_Bede()+
#   geom_polygon(data = alpha_xantho, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_xantho$alpha,color=NA, fill = &quot;white&quot;)+
#   geom_vline(xintercept = lm_xantho$coefficients[[2]]*0.85+lm_xantho$coefficients[[1]])+
#   ggtitle(&quot;Xanthophyceae&quot;)+
#   annotate(geom=&quot;text&quot;,x = lm_xantho$coefficients[[2]]*0.85+lm_xantho$coefficients[[1]]+0.05, y = 0.85, label = &quot;p = 0.85&quot;, angle = - 90, size = 7)+
#   theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 0.7),
#         axis.text.y = element_text(size = 15),
#         axis.title.y = element_blank(),
#         axis.title.x = element_text(size = 20))

plot&lt;-(sediment + green) /
(MPB + rodo)+
magno+
  patchwork::plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;,
        plot.title = element_text(size=25, hjust = 0.55),
        axis.text.x = element_text(size = 15, hjust = 0.8),
        axis.title = element_text(size=20),
        axis.text.y = element_text(size = 15),
        panel.grid=element_blank())&amp;
  scale_x_continuous(breaks = c(25,50,75,100),limits= c(0,100.01),expand = c(0, 0)) &amp;
  scale_y_continuous(expand = c(0, 0)) &amp;
  xlab(&quot;Percent Cover (%)&quot;) &amp; 
  ylab(&quot;Density&quot;)
  
ggsave(&quot;Figures/Upscaling/density_vs_Proportion.png&quot;,plot , width = 833*4, height = 1118*4, units = &quot;px&quot;)</code>
    </sec>
    <sec id="nb-code-cell-26-nb-article" specific-use="notebook-code">
    <code language="r script">output_80_filtered_same&lt;-read.csv(&quot;./Output/output_80_filtered_same_Upscaling.csv&quot;)%&gt;% 
    dplyr::mutate(Proportion = Proportion *100) %&gt;% 
    dplyr::select(-X) %&gt;% 
    as_tibble()

################# LM ####################
lm_sediment&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Bare Sediment&quot;) 

 lm_sediment&lt;- lm(lm_sediment$Prob_80 ~ lm_sediment$Proportion)
 
 lm_green&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Green Algae&quot;) 
  lm_green&lt;- lm(lm_green$Prob_80 ~ lm_green$Proportion)
 
 lm_magno&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Magnoliopsida&quot;) 
   lm_magno&lt;- lm(lm_magno$Prob_80 ~ lm_magno$Proportion)

 
 lm_MPB&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Microphytobenthos&quot;)
    lm_MPB&lt;- lm(lm_MPB$Prob_80 ~ lm_MPB$Proportion)
    
lm_Rodo&lt;-output_80_filtered_same %&gt;%
  dplyr::filter(Class == &quot;Rodophyceae&quot;)
    lm_Rodo&lt;- lm(lm_Rodo$Prob_80 ~ lm_Rodo$Proportion)</code>
    </sec>
    <sec id="cell-fig-upscaling-nb-article" specific-use="notebook-code">
    <code language="r script">knitr::include_graphics(&quot;Figures/Upscaling/density_vs_Proportion.png&quot;)</code>
    <fig id="fig-upscaling-nb-article">
      <caption><p>Figure 10: Kernel density plot showing the proportion
      of pixel well classified based on the percent cover of the class
      in high altitude flight pixels of Gafanha, Portugal. Each subplot
      shows all the pixels of the same classes on the hight altitude
      flight. Percent cover of classes is retrieve using the result of
      the classification of the low altitude flight of Gafanha,
      Portugal. The vertical dashed line shows the 0.85 probability of
      the model. Everything on the right of this line has a probability
      higher then 0.85 and everuthing on the left of this line has a
      probability lower.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="Figures/Upscaling/density_vs_Proportion.png" />
    </fig>
    </sec>
    <p><xref alt="Figure 10" rid="fig-upscaling-nb-article">Figure 10</xref> is
    showing the percent cover of a class required to classify correctly
    the high altitude flight. When the percent cover of the class is 100
    %, big pixels are well classified for all the classes excepted for
    Bare Sediment, where it’s well classified 80% of the time. A
    vegetative percent cover of at least 80% is need to have all the big
    pixels well classified, at the exception of Magnoliopsida that needs
    an higher percent cover (&gt;90 %) to be well classified. Concerning
    the probability of each class, a really high Percent cover is needed
    to confidently predict Bacillariophyceae. To predict Chlorophyceae
    with a confidence of 0.85, a percent cover of 93 % is needed, 90 %
    for magnoliopsida, 92 % for Rhodophyceae and 97 % for
    Bacillariophyceae.</p>
  </sec>
</sec>
<sec id="discussion-nb-article">
  <title>4. Discussion</title>
  <sec id="seagrass-discrimination-nb-article">
    <title>4.1 Seagrass Discrimination</title>
  </sec>
  <sec id="spatial-and-spectral-resolution-impact-on-the-prediction-nb-article">
    <title>4.2 Spatial and Spectral Resolution impact on the
    prediction</title>
    <sec id="nb-code-cell-27-nb-article" specific-use="notebook-code">
    <code language="r script">df_pigment&lt;-
  data.frame(
    Classes=c(&quot;Magnoliopsida&quot;,
           &quot;Chlorophyceae&quot;,
           &quot;Bacillariophyceae&quot;,
           &quot;Phaeophyceae&quot;,
           &quot;Rhodophyceae&quot;),
    chlb=c(1,1,0,0,0),
    chlc=c(0,0,1,1,0),
    fuco=c(0,0,1,1,0),
    zea=c(1,1,0,1,0),
    diad=c(0,0,1,0,0),
    lutein=c(1,1,0,0,0),
    Neox=c(1,1,0,0,0),
    PE=c(0,0,0,0,1),
    PC=c(0,0,0,0,1))%&gt;%
  select(-Classes) %&gt;% 
  as.matrix() %&gt;% 
  as.array() %&gt;% 
  rast()

ext(df_pigment)&lt;-c(0,9,0,5)


y_axis_text_pigment&lt;-data.frame(x = rep(-0.05,5),
                                y = c(0.5,1.5,2.5,3.5,4.5), 
                                lab = c(&quot;Rhodophyceae&quot;,
                                    &quot;Phaeophyceae&quot;,
                                    &quot;Bacillariophy.&quot;,
                                    &quot;Chlorophyceae&quot;,
                                    &quot;Magnoliopsida&quot;)
                                )
x_axis_text_pigment&lt;-data.frame(y = rep(5.5,9),
                                x = c(0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5),
                                lab = c(&quot;Chlb&quot;,&quot;Chlc&quot;,&quot;Fuco&quot;,&quot;Zea&quot;,&quot;Diad&quot;,&quot;Lut&quot;,&quot;Neo&quot;,&quot;PE&quot;,&quot;PC&quot;)
                                )




min_x_line = -1.5
max_y_line = 6

line_grid&lt;-data.frame(xmin=NA,
                      xmax=NA,
                      ymin=NA,
                      ymax=NA,
                      group=NA)

for(i in 0:max_y_line){
  line_grid[i+1,1]=min_x_line
  line_grid[i+1,2]=9
  line_grid[i+1,3]=i
  line_grid[i+1,4]=i
  line_grid[i+1,5]=i+1
}
nrowgrid=nrow(line_grid)
for(i in 0:9){
  line_grid[i+1+nrowgrid,1]=i
  line_grid[i+1+nrowgrid,2]=i
  line_grid[i+1+nrowgrid,3]=0
  line_grid[i+1+nrowgrid,4]=max_y_line
  line_grid[i+1+nrowgrid,5]=i+1+nrowgrid
  
}

 line_grid[nrow(line_grid)+1,1] = min_x_line
 line_grid[nrow(line_grid),2] = min_x_line
 line_grid[nrow(line_grid),3] = 0
 line_grid[nrow(line_grid),4] = max_y_line
 line_grid[nrow(line_grid),5] = nrow(line_grid)

 
 line_grid&lt;- line_grid %&gt;% 
   rbind(c(-1.5,9,-0.6,-0.6,19))%&gt;% 
   rbind(c(-1.5,-1.5,-0.6,0,20))%&gt;% 
   rbind(c(0,0,-0.6,0,21))%&gt;% 
   rbind(c(1,1,-0.6,0,22))%&gt;% 
   rbind(c(2,2,-0.6,0,23))%&gt;% 
   rbind(c(3,3,-0.6,0,24))%&gt;% 
   rbind(c(4,4,-0.6,0,25))%&gt;% 
   rbind(c(5,5,-0.6,0,26))%&gt;% 
   rbind(c(6,6,-0.6,0,27))%&gt;% 
   rbind(c(7,7,-0.6,0,28))%&gt;% 
   rbind(c(8,8,-0.6,0,29))%&gt;% 
   rbind(c(9,9,-0.6,0,30))
 
 
 Absorption_wv&lt;- data.frame(x = c(0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5),
                            y = rep(-0.3,9),
                            lab = c(&quot;650&quot;,&quot;636&quot;,&quot;550&quot;,&quot;489&quot;,&quot;496&quot;,&quot;490&quot;,&quot;450&quot;,&quot;566&quot;,&quot;615&quot;))
 
 
rast_pigment&lt;-ggplot()+
  geom_spatraster(data = (df_pigment),
                  # show.legend = F,
                  na.rm = TRUE
                  )+
  coord_fixed(ratio = 0.7)+
  scale_fill_gradientn(
    # colours = c(&quot;black&quot;,&quot;firebrick4&quot;,&quot;goldenrod&quot;,&quot;yellow&quot;,&quot;chartreuse3&quot;),
    # colours = c(&quot;khaki1&quot;,&quot;goldenrod&quot;,&quot;firebrick3&quot;,&quot;chartreuse4&quot;),
    colours = c(&quot;firebrick4&quot;,&quot;orange&quot;,&quot;#007d00&quot;),
    # colours = c(&quot;#7d0000&quot;,&quot;#00b300&quot;,&quot;#00b300&quot;,&quot;#00b300&quot;,&quot;#007d00&quot;),
    na.value = &quot;white&quot;,
    labels = c(&quot;Absence&quot;,&quot;no se&quot;,&quot;Presence&quot;),
    breaks = c(0,0.5,1))+
  geom_text(
    data = y_axis_text_pigment,
    aes(x = x, y = y, label = lab),
    # fill = &quot;#ffffff99&quot;,
    hjust = 1,
    size = 6,
    # angle = 20
    )+
  geom_text(
    data = data.frame(x = -0.05, y = -0.3, lab = &quot;Absorption (nm)&quot;),
    aes(x = x, y = y, label = lab),
    # fill = &quot;#ffffff99&quot;,
    hjust = 1,
    size = 5,
    # angle = 20
    )+
  geom_text(
    data = Absorption_wv,
    aes(x = x, y = y, label = lab),
    # fill = &quot;#ffffff99&quot;,
    hjust = 0.5,
    size = 6,
    # angle = 20
    )+
  geom_text(
    data = x_axis_text_pigment,
    aes(x = x, y = y, label = lab),
    # fill = &quot;#ffffff99&quot;,
    hjust = 0.5,
    size = 7,
    # angle = 20
    )+
  geom_segment(data = line_grid, 
               aes(x = xmin, xend = xmax, y = ymin, yend = ymax, group = group),
               linewidth = 1)+
  xlim(c(-2,9))+
  ylim(c(-1,6.1))+
  theme_Bede()+
  theme(
  # axis.title.x = element_text(size = 35),
        # axis.title.y = element_text(size = 35),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),

        # axis.text.x = element_text(size = 30),
        axis.text.x = element_blank(),
        # axis.text.y = element_text(size = 25),
         axis.text.y = element_blank(),

        axis.ticks.x = element_blank(),
        axis.ticks.y = element_blank(),
        panel.border = element_blank(),
        axis.line=element_blank(),
        # legend.position = &quot;top&quot;,
        legend.position = &quot;none&quot;,
        legend.direction=&quot;horizontal&quot;,
        legend.key.width = unit(2,&quot;cm&quot;),
        legend.text = element_text(size = 20),
        legend.title = element_text(size = 20, vjust = 2),
        legend.title.align = 0.5,
        legend.justification = &quot;center&quot;)

# rast_pigment

ggsave(&quot;./Figures/Disc_Pigment_Table.png&quot;,rast_pigment, width= 1066*4, height=516*4, units = &quot;px&quot;)</code>
    </sec>
    <sec id="cell-fig-Pigm-nb-article" specific-use="notebook-code">
    <code language="r script"># Pigment composition of the different vegetation classes. Green indicate the presence of the pigment in the class while red indicate the abscence. Chlb : Chlorophyll-b ; Chlc : Chlorophyll-c ; Fuco : Fucoxanthin ; Zea : Zeaxanthin ; Diad : Diadinoxanthin ; Lut : Lutein ; Neo : Neoxanthin ; PE : Phycoerythrin ; PC : Phycocyanin.

knitr::include_graphics(&quot;./Figures/Disc_Pigment_Table.png&quot;)</code>
    <fig id="fig-Pigm-nb-article">
      <caption><p>Figure 11: Photosynthetic and carotenoid pigments
      present (Green) or absent (Red) in each taxonomic class present in
      the Neural Network Classifier, along with their absorption
      wavelength measured with spectroradiometer. Chl b: chlorophyll b,
      Chl c: chlorophyll c, Fuco: fucoxanthin, Zea: zeaxanthin, Diato:
      diatoxanthin, Diadino: diadinoxanthin, Neo:
      neoxanthin.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Disc_Pigment_Table.png" />
    </fig>
    </sec>
    <sec id="nb-code-cell-28-nb-article" specific-use="notebook-code">
    <code language="r script">high_alt&lt;- &quot;Data/image/micasense/Gafanha_high_multi.tif&quot; %&gt;% 
  rast()

# low_alt&lt;- &quot;Data/image/micasense/Gafanha_Low_Multi_rsp.tif&quot; %&gt;% 
#   rast() 

low_alt&lt;- &quot;Data/image/micasense/Gafanha_low_multi.tif&quot; %&gt;% 
  rast() %&gt;% 
  resample(high_alt, method = &quot;med&quot;)


low_alt_pred&lt;- &quot;Data/image/prediction/NewPreds/Gafanha_Low_Pred_rsp.tif&quot; %&gt;% 
  rast() 

mask&lt;-&quot;Data/shp/Mask_Alt_Compare_All.shp&quot; %&gt;% 
  vect()
  
high_alt_masked&lt;-crop(high_alt,mask)
high_alt_masked&lt;-mask(high_alt_masked,mask)

low_alt_masked&lt;-crop(low_alt,mask)
low_alt_masked&lt;-mask(low_alt_masked,mask)

low_alt_pred_masked&lt;-crop(low_alt_pred,mask)
low_alt_pred_masked&lt;-mask(low_alt_pred_masked,mask)


stk&lt;-rast(list(c(high_alt_masked,low_alt_masked,low_alt_pred_masked)))%&gt;% 
  as.data.frame()

names(stk)&lt;-c(&quot;B1_high&quot;,&quot;B2_high&quot;,&quot;B3_high&quot;,&quot;B4_high&quot;,&quot;B5_high&quot;,&quot;B6_high&quot;,&quot;B7_high&quot;,&quot;B8_high&quot;,&quot;B9_high&quot;,&quot;B10_high&quot;,
              &quot;B1_low&quot;,&quot;B2_low&quot;,&quot;B3_low&quot;,&quot;B4_low&quot;,&quot;B5_low&quot;,&quot;B6_low&quot;,&quot;B7_low&quot;,&quot;B8_low&quot;,&quot;B9_low&quot;,&quot;B10_low&quot;,
              &quot;pred&quot;)

stk_long&lt;-stk %&gt;% 
  mutate(px_ID = c(1:nrow(stk))) %&gt;% 
  pivot_longer(-c(px_ID,pred),values_to = &quot;Value&quot;,names_to = &quot;Bands&quot;) %&gt;% 
  mutate(alt = case_when(str_detect(Bands, &quot;low&quot;) ~ &quot;Low&quot;,
                         str_detect(Bands, &quot;high&quot;) ~ &quot;High&quot;,
                         TRUE ~ &quot;NA&quot;),
         Bands = gsub(&quot;_high&quot;,&quot;&quot;,Bands),
         Bands = gsub(&quot;_low&quot;,&quot;&quot;,Bands))


stk_summarized&lt;-stk_long %&gt;% 
  # group_by(px_ID,alt) %&gt;% 
  # reframe(Value = mean(Value),
  #         pred = unique(pred)) %&gt;% 
  pivot_wider(names_from = &quot;alt&quot;, values_from = &quot;Value&quot;)

df&lt;-stk_summarized %&gt;% 
  ungroup() %&gt;% 
  group_by(Bands) %&gt;% 
  filter(Low&lt;10000,
         High &lt; 10000,
         Low &lt; quantile(Low,probs = 0.99),
         High &lt; quantile(High,probs = 0.99),
         Low &gt; quantile(Low,probs = 0.01),
         High &gt; quantile(High,probs = 0.01),
         !pred %in% c(7,9,3,10)) %&gt;%
  ungroup()
 
plot &lt;- df %&gt;% 
  group_by(pred) %&gt;% 
  sample_n(10000) %&gt;% 
  rearrr::rotate_2d(x_col = &quot;Low&quot;, y_col = &quot;High&quot;,degrees = 9, origin = c(0,0)) %&gt;% select(Low_rotated,High_rotated) %&gt;% 
  rename(Low = Low_rotated, High = High_rotated) %&gt;% 
  mutate(Low = Low /10000, 
         High = High/10000) %&gt;% 
  ggplot(aes(x=Low, y=High))+
  # geom_point(aes(color = as.factor(pred)))
  ggpointdensity::geom_pointdensity(adjust = .03)+
  viridis::scale_color_viridis(limits = c(0,6000),
                               breaks = c(0,2000,4000,6000),
                               labels = c(&quot;1&quot;,&quot;2000&quot;,&quot;4000&quot;,&quot;6000&quot;))+
  # geom_smooth(method = &quot;loess&quot;)+
  geom_abline(intercept = 0, slope = 1, linewidth = 1, linetype = &quot;dashed&quot;, color = &quot;red&quot; )+
  theme_Bede()+
  ylim(c(0.05,0.6))+
  xlim(c(0.05,0.6))+
  ylab(&quot;Reflectance of the 120m flight&quot;)+
  xlab(&quot;Reflectance of the 12m flight&quot;)+
  labs(color = &quot;Pixel density&quot;)+
  theme(
    legend.position = &quot;top&quot;,
        legend.key.width = unit(3,&quot;line&quot;))

ggsave(&quot;./Figures/Compare_reflectance.png&quot;,plot, width= 472*4, height=402*4, units = &quot;px&quot;)</code>
    </sec>
    <sec id="cell-fig-CompareRef-nb-article" specific-use="notebook-code">
    <code language="r script"># Pigment composition of the different vegetation classes. Green indicate the presence of the pigment in the class while red indicate the abscence. Chlb : Chlorophyll-b ; Chlc : Chlorophyll-c ; Fuco : Fucoxanthin ; Zea : Zeaxanthin ; Diad : Diadinoxanthin ; Lut : Lutein ; Neo : Neoxanthin ; PE : Phycoerythrin ; PC : Phycocyanin.

knitr::include_graphics(&quot;./Figures/Compare_reflectance.png&quot;)</code>
    <fig id="fig-CompareRef-nb-article">
      <caption><p>Figure 12: Comparison of reflectance retrieved from
      both low-altitude and high-altitude flights over a common area.
      The red dashed line represents a 1 to 1
      relationship.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Figures/Compare_reflectance.png" />
    </fig>
    </sec>
  </sec>
  <sec id="big-picture-nb-article">
    <title>4.3 Big picture</title>
  </sec>
</sec>
<sec id="conclusion-nb-article">
  <title>5. Conclusion</title>
</sec>
</body>



<back>
<ref-list>
  <title>6. Bibliography</title>
  <ref id="ref-unsworth2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Unsworth</surname><given-names>Richard KF</given-names></name>
        <name><surname>Cullen-Unsworth</surname><given-names>Leanne C</given-names></name>
        <name><surname>Jones</surname><given-names>Benjamin LH</given-names></name>
        <name><surname>Lilley</surname><given-names>Richard J</given-names></name>
      </person-group>
      <article-title>The planetary role of seagrass conservation</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>377</volume>
      <issue>6606</issue>
      <fpage>609</fpage>
      <lpage>613</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gardner2018-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Gardner</surname><given-names>Royal C</given-names></name>
        <name><surname>Finlayson</surname><given-names>C</given-names></name>
      </person-group>
      <source>Global wetland outlook: State of the world’s wetlands and their services to people</source>
      <year iso-8601-date="2018">2018</year>
      <fpage>2020</fpage>
      <lpage>5</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Dalloyau</surname><given-names>Sébastien</given-names></name>
        <name><surname>Davies</surname><given-names>Bede Ffinian Rowe</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Remote sensing in seagrass ecology: Coupled dynamics between migratory herbivorous birds and intertidal meadows observed by satellite during four decades</article-title>
      <source>Remote Sensing in Ecology and Conservation</source>
      <year iso-8601-date="2022-12">2022</year><month>12</month>
      <issn>2056-3485</issn>
      <pub-id pub-id-type="doi">10.1002/rse2.319</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-jankowska2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jankowska</surname><given-names>Emilia</given-names></name>
        <name><surname>Michel</surname><given-names>Loı̈c N</given-names></name>
        <name><surname>Lepoint</surname><given-names>Gilles</given-names></name>
        <name><surname>Włodarska-Kowalczuk</surname><given-names>Maria</given-names></name>
      </person-group>
      <article-title>Stabilizing effects of seagrass meadows on coastal water benthic food webs</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>510</volume>
      <fpage>54</fpage>
      <lpage>63</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nguyen2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nguyen</surname><given-names>Hung Manh</given-names></name>
        <name><surname>Ralph</surname><given-names>Peter J</given-names></name>
        <name><surname>Marı́n-Guirao</surname><given-names>Lázaro</given-names></name>
        <name><surname>Pernice</surname><given-names>Mathieu</given-names></name>
        <name><surname>Procaccini</surname><given-names>Gabriele</given-names></name>
      </person-group>
      <article-title>Seagrasses in an era of ocean warming: A review</article-title>
      <source>Biological Reviews</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>96</volume>
      <issue>5</issue>
      <fpage>2009</fpage>
      <lpage>2030</lpage>
    </element-citation>
  </ref>
  <ref id="ref-soissons2018-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Soissons</surname><given-names>Laura M</given-names></name>
        <name><surname>Haanstra</surname><given-names>Eeke P</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Asmus</surname><given-names>Ragnhild</given-names></name>
        <name><surname>Auby</surname><given-names>Isabelle</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
        <name><surname>Brun</surname><given-names>Fernando G</given-names></name>
        <name><surname>Cardoso</surname><given-names>Patricia G</given-names></name>
        <name><surname>Desroy</surname><given-names>Nicolas</given-names></name>
        <name><surname>Fournier</surname><given-names>Jerome</given-names></name>
        <etal/>
      </person-group>
      <article-title>Latitudinal patterns in european seagrass carbon reserves: Influence of seasonal fluctuations versus short-term stress and disturbance events</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>88</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-orth2006-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Orth</surname><given-names>Robert J</given-names></name>
        <name><surname>Carruthers</surname><given-names>Tim JB</given-names></name>
        <name><surname>Dennison</surname><given-names>William C</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Fourqurean</surname><given-names>James W</given-names></name>
        <name><surname>Heck</surname><given-names>Kenneth L</given-names></name>
        <name><surname>Hughes</surname><given-names>A Randall</given-names></name>
        <name><surname>Kendrick</surname><given-names>Gary A</given-names></name>
        <name><surname>Kenworthy</surname><given-names>W Judson</given-names></name>
        <name><surname>Olyarnik</surname><given-names>Suzanne</given-names></name>
        <etal/>
      </person-group>
      <article-title>A global crisis for seagrass ecosystems</article-title>
      <source>Bioscience</source>
      <publisher-name>American Institute of Biological Sciences</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>56</volume>
      <issue>12</issue>
      <fpage>987</fpage>
      <lpage>996</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lin2018-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lin</surname><given-names>Haiying</given-names></name>
        <name><surname>Sun</surname><given-names>Tao</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Yang</surname><given-names>Wei</given-names></name>
      </person-group>
      <article-title>Which genes in a typical intertidal seagrass (zostera japonica) indicate copper-, lead-, and cadmium pollution?</article-title>
      <source>Frontiers in Plant Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>9</volume>
      <fpage>1545</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-duffy2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Duffy</surname><given-names>J Emmett</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Trinanes</surname><given-names>Joaquin</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E</given-names></name>
        <name><surname>Ambo-Rappe</surname><given-names>Rohani</given-names></name>
        <name><surname>Boström</surname><given-names>Christoffer</given-names></name>
        <name><surname>Buschmann</surname><given-names>Alejandro H</given-names></name>
        <name><surname>Byrnes</surname><given-names>Jarrett</given-names></name>
        <name><surname>Coles</surname><given-names>Robert G</given-names></name>
        <name><surname>Creed</surname><given-names>Joel</given-names></name>
        <etal/>
      </person-group>
      <article-title>Toward a coordinated global observing system for seagrasses and marine macroalgae</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>6</volume>
      <fpage>317</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deSantos2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Los Santos</surname><given-names>Carmen B de</given-names></name>
        <name><surname>Krause-Jensen</surname><given-names>Dorte</given-names></name>
        <name><surname>Alcoverro</surname><given-names>Teresa</given-names></name>
        <name><surname>Marbà</surname><given-names>Núria</given-names></name>
        <name><surname>Duarte</surname><given-names>Carlos M</given-names></name>
        <name><surname>Van Katwijk</surname><given-names>Marieke M</given-names></name>
        <name><surname>Pérez</surname><given-names>Marta</given-names></name>
        <name><surname>Romero</surname><given-names>Javier</given-names></name>
        <name><surname>Sánchez-Lizaso</surname><given-names>José L</given-names></name>
        <name><surname>Roca</surname><given-names>Guillem</given-names></name>
        <etal/>
      </person-group>
      <article-title>Recent trend reversal for declining european seagrass meadows</article-title>
      <source>Nature communications</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>10</volume>
      <issue>1</issue>
      <fpage>3356</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zoffoli2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Godet</surname><given-names>Laurent</given-names></name>
        <name><surname>Peters</surname><given-names>Steef</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series</article-title>
      <source>Ecological Indicators</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>130</volume>
      <issn>1470160X</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S1470160X21006981</uri>
      <pub-id pub-id-type="doi">10.1016/j.ecolind.2021.108033</pub-id>
      <fpage>108033</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Zhongyuan</given-names></name>
        <name><surname>Fang</surname><given-names>Zhixiang</given-names></name>
        <name><surname>Liang</surname><given-names>Jianfeng</given-names></name>
        <name><surname>Song</surname><given-names>Xiao</given-names></name>
      </person-group>
      <article-title>Assessment of global habitat suitability and risk of ocean green tides</article-title>
      <source>Harmful Algae</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>119</volume>
      <fpage>102324</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Miloslavich2018-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Miloslavich</surname><given-names>Patricia</given-names></name>
        <name><surname>Bax</surname><given-names>Nicholas J.</given-names></name>
        <name><surname>Simmons</surname><given-names>Samantha E.</given-names></name>
        <name><surname>Klein</surname><given-names>Eduardo</given-names></name>
        <name><surname>Appeltans</surname><given-names>Ward</given-names></name>
        <name><surname>Aburto-Oropeza</surname><given-names>Octavio</given-names></name>
        <name><surname>Garcia</surname><given-names>Melissa Andersen</given-names></name>
        <name><surname>Batten</surname><given-names>Sonia D.</given-names></name>
        <name><surname>Benedetti-Cecchi</surname><given-names>Lisandro</given-names></name>
        <name><surname>Checkley</surname><given-names>David M.</given-names></name>
        <name><surname>Chiba</surname><given-names>Sanae</given-names></name>
        <name><surname>Duffy</surname><given-names>J. Emmett</given-names></name>
        <name><surname>Dunn</surname><given-names>Daniel C.</given-names></name>
        <name><surname>Fischer</surname><given-names>Albert</given-names></name>
        <name><surname>Gunn</surname><given-names>John</given-names></name>
        <name><surname>Kudela</surname><given-names>Raphael</given-names></name>
        <name><surname>Marsac</surname><given-names>Francis</given-names></name>
        <name><surname>Muller-Karger</surname><given-names>Frank E.</given-names></name>
        <name><surname>Obura</surname><given-names>David</given-names></name>
        <name><surname>Shin</surname><given-names>Yunne Jai</given-names></name>
      </person-group>
      <article-title>Essential ocean variables for global sustained observations of biodiversity and ecosystem changes</article-title>
      <source>Global Change Biology</source>
      <publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>
      <year iso-8601-date="2018-06">2018</year><month>06</month>
      <volume>24</volume>
      <issn>1365-2486</issn>
      <uri>https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/10.1111/gcb.14108</uri>
      <pub-id pub-id-type="doi">10.1111/GCB.14108</pub-id>
      <fpage>2416</fpage>
      <lpage>2433</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nijland2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nijland</surname><given-names>Wiebe</given-names></name>
        <name><surname>Reshitnyk</surname><given-names>Luba</given-names></name>
        <name><surname>Rubidge</surname><given-names>Emily</given-names></name>
      </person-group>
      <article-title>Satellite remote sensing of canopy-forming kelp on a complex coastline: A novel procedure using the landsat image archive</article-title>
      <source>Remote Sensing of Environment</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>220</volume>
      <fpage>41</fpage>
      <lpage>50</lpage>
    </element-citation>
  </ref>
  <ref id="ref-xu2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Xu</surname><given-names>Shaochun</given-names></name>
        <name><surname>Xu</surname><given-names>Shuai</given-names></name>
        <name><surname>Zhou</surname><given-names>Yi</given-names></name>
        <name><surname>Yue</surname><given-names>Shidong</given-names></name>
        <name><surname>Zhang</surname><given-names>Xiaomei</given-names></name>
        <name><surname>Gu</surname><given-names>Ruiting</given-names></name>
        <name><surname>Zhang</surname><given-names>Yu</given-names></name>
        <name><surname>Qiao</surname><given-names>Yongliang</given-names></name>
        <name><surname>Liu</surname><given-names>Mingjie</given-names></name>
      </person-group>
      <article-title>Long-term changes in the unique and largest seagrass meadows in the bohai sea (china) using satellite (1974–2019) and sonar data: Implication for conservation and restoration</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>13</volume>
      <issue>5</issue>
      <fpage>856</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Traganos2018-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Traganos</surname><given-names>Dimosthenis</given-names></name>
        <name><surname>Reinartz</surname><given-names>Peter</given-names></name>
      </person-group>
      <article-title>Mapping mediterranean seagrasses with sentinel-2 imagery</article-title>
      <source>Marine Pollution Bulletin</source>
      <publisher-name>Elsevier Ltd</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>134</volume>
      <issn>18793363</issn>
      <pub-id pub-id-type="doi">10.1016/j.marpolbul.2017.06.075</pub-id>
      <fpage>197</fpage>
      <lpage>209</lpage>
    </element-citation>
  </ref>
  <ref id="ref-coffer2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coffer</surname><given-names>Megan M</given-names></name>
        <name><surname>Graybill</surname><given-names>David D</given-names></name>
        <name><surname>Whitman</surname><given-names>Peter J</given-names></name>
        <name><surname>Schaeffer</surname><given-names>Blake A</given-names></name>
        <name><surname>Salls</surname><given-names>Wilson B</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Richard C</given-names></name>
        <name><surname>Hill</surname><given-names>Victoria</given-names></name>
        <name><surname>Lebrasse</surname><given-names>Marie Cindy</given-names></name>
        <name><surname>Li</surname><given-names>Jiang</given-names></name>
        <name><surname>Keith</surname><given-names>Darryl J</given-names></name>
        <etal/>
      </person-group>
      <article-title>Providing a framework for seagrass mapping in united states coastal ecosystems using high spatial resolution satellite imagery</article-title>
      <source>Journal of Environmental Management</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>337</volume>
      <fpage>117669</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ralph2002-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ralph</surname><given-names>PJ</given-names></name>
        <name><surname>Polk</surname><given-names>SM</given-names></name>
        <name><surname>Moore</surname><given-names>KA</given-names></name>
        <name><surname>Orth</surname><given-names>RJ</given-names></name>
        <name><surname>Smith Jr</surname><given-names>WO</given-names></name>
      </person-group>
      <article-title>Operation of the xanthophyll cycle in the seagrass zostera marina in response to variable irradiance</article-title>
      <source>Journal of Experimental Marine Biology and Ecology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <volume>271</volume>
      <issue>2</issue>
      <fpage>189</fpage>
      <lpage>207</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Douay2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Douay</surname><given-names>Florian</given-names></name>
        <name><surname>Verpoorter</surname><given-names>Charles</given-names></name>
        <name><surname>Duong</surname><given-names>Gwendoline</given-names></name>
        <name><surname>Spilmont</surname><given-names>Nicolas</given-names></name>
        <name><surname>Gevaert</surname><given-names>François</given-names></name>
      </person-group>
      <article-title>New hyperspectral procedure to discriminate intertidal macroalgae</article-title>
      <source>Remote Sensing</source>
      <year iso-8601-date="2022">2022</year>
      <volume>14</volume>
      <issue>2</issue>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/346</uri>
      <pub-id pub-id-type="doi">10.3390/rs14020346</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Davies2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Geraud</surname><given-names>Andréa</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Rosa</surname><given-names>Philippe</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Multi- and hyperspectral classification of soft-bottom intertidal vegetation using a spectral library for coastal biodiversity remote sensing</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2023">2023</year>
      <volume>290</volume>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425723001050</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2023.113554</pub-id>
      <fpage>113554</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bannari2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bannari</surname><given-names>Abderrazak</given-names></name>
        <name><surname>Ali</surname><given-names>Thamer Salim</given-names></name>
        <name><surname>Abahussain</surname><given-names>Asma</given-names></name>
      </person-group>
      <article-title>The capabilities of sentinel-MSI (2A/2B) and landsat-OLI (8/9) in seagrass and algae species differentiation using spectral reflectance</article-title>
      <source>Ocean Science</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>18</volume>
      <issue>2</issue>
      <fpage>361</fpage>
      <lpage>388</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tuya2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tuya</surname><given-names>Fernando</given-names></name>
        <name><surname>Hernandez-Zerpa</surname><given-names>Harue</given-names></name>
        <name><surname>Espino</surname><given-names>Fernando</given-names></name>
        <name><surname>Haroun</surname><given-names>Ricardo</given-names></name>
      </person-group>
      <article-title>Drastic decadal decline of the seagrass cymodocea nodosa at gran canaria (eastern atlantic): Interactions with the green algae caulerpa prolifera</article-title>
      <source>Aquatic Botany</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>105</volume>
      <fpage>1</fpage>
      <lpage>6</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fairley2022drone-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fairley</surname><given-names>Iain</given-names></name>
        <name><surname>Williamson</surname><given-names>Benjamin J</given-names></name>
        <name><surname>McIlvenny</surname><given-names>Jason</given-names></name>
        <name><surname>King</surname><given-names>Nicholas</given-names></name>
        <name><surname>Masters</surname><given-names>Ian</given-names></name>
        <name><surname>Lewis</surname><given-names>Matthew</given-names></name>
        <name><surname>Neill</surname><given-names>Simon</given-names></name>
        <name><surname>Glasby</surname><given-names>David</given-names></name>
        <name><surname>Coles</surname><given-names>Daniel</given-names></name>
        <name><surname>Powell</surname><given-names>Ben</given-names></name>
        <etal/>
      </person-group>
      <article-title>Drone-based large-scale particle image velocimetry applied to tidal stream energy resource assessment</article-title>
      <source>Renewable Energy</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>196</volume>
      <fpage>839</fpage>
      <lpage>855</lpage>
    </element-citation>
  </ref>
  <ref id="ref-oh2017use-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Oh</surname><given-names>Jaehong</given-names></name>
        <name><surname>Kim</surname><given-names>Duk-jin</given-names></name>
        <name><surname>Lee</surname><given-names>Hyoseong</given-names></name>
      </person-group>
      <article-title>Use of a drone for mapping and time series image acquisition of tidal zones</article-title>
      <source>Journal of the Korean Institute of Intelligent Systems</source>
      <publisher-name>Korean Institute of Intelligent Systems</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>27</volume>
      <issue>2</issue>
      <fpage>119</fpage>
      <lpage>125</lpage>
    </element-citation>
  </ref>
  <ref id="ref-adade2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Adade</surname><given-names>Richard</given-names></name>
        <name><surname>Aibinu</surname><given-names>Abiodun Musa</given-names></name>
        <name><surname>Ekumah</surname><given-names>Bernard</given-names></name>
        <name><surname>Asaana</surname><given-names>Jerry</given-names></name>
      </person-group>
      <article-title>Unmanned aerial vehicle (UAV) applications in coastal zone management—a review</article-title>
      <source>Environmental Monitoring and Assessment</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>193</volume>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-casella2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Casella</surname><given-names>Elisa</given-names></name>
        <name><surname>Drechsel</surname><given-names>Jan</given-names></name>
        <name><surname>Winter</surname><given-names>Christian</given-names></name>
        <name><surname>Benninghoff</surname><given-names>Markus</given-names></name>
        <name><surname>Rovere</surname><given-names>Alessio</given-names></name>
      </person-group>
      <article-title>Accuracy of sand beach topography surveying by drones and photogrammetry</article-title>
      <source>Geo-Marine Letters</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>40</volume>
      <fpage>255</fpage>
      <lpage>268</lpage>
    </element-citation>
  </ref>
  <ref id="ref-angnuureng2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Angnuureng</surname><given-names>Donatus B</given-names></name>
        <name><surname>Brempong</surname><given-names>KE</given-names></name>
        <name><surname>Jayson-Quashigah</surname><given-names>PN</given-names></name>
        <name><surname>Dada</surname><given-names>OA</given-names></name>
        <name><surname>Akuoko</surname><given-names>SGI</given-names></name>
        <name><surname>Frimpomaa</surname><given-names>J</given-names></name>
        <name><surname>Mattah</surname><given-names>PA</given-names></name>
        <name><surname>Almar</surname><given-names>Rafaël</given-names></name>
      </person-group>
      <article-title>Satellite, drone and video camera multi-platform monitoring of coastal erosion at an engineered pocket beach: A showcase for coastal management at elmina bay, ghana (west africa)</article-title>
      <source>Regional Studies in Marine Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>53</volume>
      <fpage>102437</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-joyce2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Joyce</surname><given-names>Karen E</given-names></name>
        <name><surname>Fickas</surname><given-names>Kate C</given-names></name>
        <name><surname>Kalamandeen</surname><given-names>Michelle</given-names></name>
      </person-group>
      <article-title>The unique value proposition for using drones to map coastal ecosystems</article-title>
      <source>Cambridge Prisms: Coastal Futures</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>1</volume>
      <fpage>e6</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-tallam2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tallam</surname><given-names>Krti</given-names></name>
        <name><surname>Nguyen</surname><given-names>Nam</given-names></name>
        <name><surname>Ventura</surname><given-names>Jonathan</given-names></name>
        <name><surname>Fricker</surname><given-names>Andrew</given-names></name>
        <name><surname>Calhoun</surname><given-names>Sadie</given-names></name>
        <name><surname>O’Leary</surname><given-names>Jennifer</given-names></name>
        <name><surname>Fitzgibbons</surname><given-names>Mauriça</given-names></name>
        <name><surname>Robbins</surname><given-names>Ian</given-names></name>
        <name><surname>Walter</surname><given-names>Ryan K</given-names></name>
      </person-group>
      <article-title>Application of deep learning for classification of intertidal eelgrass from drone-acquired imagery</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>15</volume>
      <issue>9</issue>
      <fpage>2321</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Roca2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Roca</surname><given-names>Mar</given-names></name>
        <name><surname>Dunbar</surname><given-names>Martha Bonnet</given-names></name>
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Caballero</surname><given-names>Isabel</given-names></name>
        <name><surname>Zoffoli</surname><given-names>Maria Laura</given-names></name>
        <name><surname>Gernez</surname><given-names>Pierre</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Monitoring the marine invasive alien species rugulopteryx okamurae using unmanned aerial vehicles and satellites</article-title>
      <source>Frontiers in Marine Science</source>
      <year iso-8601-date="2022-10">2022</year><month>10</month>
      <volume>9</volume>
      <issn>2296-7745</issn>
      <pub-id pub-id-type="doi">10.3389/fmars.2022.1004012</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Roman2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Román</surname><given-names>Alejandro</given-names></name>
        <name><surname>Tovar-Sánchez</surname><given-names>Antonio</given-names></name>
        <name><surname>Olivé</surname><given-names>Irene</given-names></name>
        <name><surname>Navarro</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes</article-title>
      <source>Frontiers in Marine Science</source>
      <publisher-name>Frontiers</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <fpage>1225</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brunier2022Topographic-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brunier</surname><given-names>Guillaume</given-names></name>
        <name><surname>Oiry</surname><given-names>Simon</given-names></name>
        <name><surname>Gruet</surname><given-names>Yves</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas F.</given-names></name>
        <name><surname>Barillé</surname><given-names>Laurent</given-names></name>
      </person-group>
      <article-title>Topographic analysis of intertidal polychaete reefs (sabellaria alveolata) at a very high spatial resolution</article-title>
      <source>Remote Sensing 2022, Vol. 14, Page 307</source>
      <publisher-name>Multidisciplinary Digital Publishing Institute</publisher-name>
      <year iso-8601-date="2022-01">2022</year><month>01</month>
      <volume>14</volume>
      <issn>2072-4292</issn>
      <uri>https://www.mdpi.com/2072-4292/14/2/307</uri>
      <pub-id pub-id-type="doi">10.3390/RS14020307</pub-id>
      <fpage>307</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-collin2019improving-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Collin</surname><given-names>Antoine</given-names></name>
        <name><surname>Dubois</surname><given-names>Stanislas</given-names></name>
        <name><surname>James</surname><given-names>Dorothée</given-names></name>
        <name><surname>Houet</surname><given-names>Thomas</given-names></name>
      </person-group>
      <article-title>Improving intertidal reef mapping using UAV surface, red edge, and near-infrared data</article-title>
      <source>Drones</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>3</volume>
      <issue>3</issue>
      <fpage>67</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-rossiter2020uav-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rossiter</surname><given-names>Thomas</given-names></name>
        <name><surname>Furey</surname><given-names>Thomas</given-names></name>
        <name><surname>McCarthy</surname><given-names>Tim</given-names></name>
        <name><surname>Stengel</surname><given-names>Dagmar B</given-names></name>
      </person-group>
      <article-title>UAV-mounted hyperspectral mapping of intertidal macroalgae</article-title>
      <source>Estuarine, Coastal and Shelf Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>242</volume>
      <fpage>106789</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-BedeGbif-nb-article">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Davies</surname><given-names>B F R</given-names></name>
        <name><surname>Sousa</surname><given-names>A I.</given-names></name>
        <name><surname>Figueira</surname><given-names>R</given-names></name>
        <name><surname>Oiry</surname><given-names>S</given-names></name>
        <name><surname>Gernez</surname><given-names>P</given-names></name>
        <name><surname>Barillé</surname><given-names>L</given-names></name>
      </person-group>
      <article-title>Benthic intertidal vegetation from the tagus estuary and aveiro lagoon</article-title>
      <publisher-name>Université de Nantes via GBIF.org</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.15468/n4ak6x</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Pereira2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pereira</surname><given-names>Henrique Miguel</given-names></name>
        <name><surname>Ferrier</surname><given-names>Simon</given-names></name>
        <name><surname>Walters</surname><given-names>Michele</given-names></name>
        <name><surname>Geller</surname><given-names>Gary N</given-names></name>
        <name><surname>Jongman</surname><given-names>Rob HG</given-names></name>
        <name><surname>Scholes</surname><given-names>Robert J</given-names></name>
        <name><surname>Bruford</surname><given-names>Michael William</given-names></name>
        <name><surname>Brummitt</surname><given-names>Neil</given-names></name>
        <name><surname>Butchart</surname><given-names>Stuart HM</given-names></name>
        <name><surname>Cardoso</surname><given-names>AC</given-names></name>
        <etal/>
      </person-group>
      <article-title>Essential biodiversity variables</article-title>
      <source>Science</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>339</volume>
      <issue>6117</issue>
      <fpage>277</fpage>
      <lpage>278</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>


</sub-article>

</article>