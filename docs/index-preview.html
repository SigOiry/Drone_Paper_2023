<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.550">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Simon Oiry">
    <meta name="author" content="Bede Ffinian Rowe Davies">
    <meta name="author" content="Ana I. Sousa">
    <meta name="author" content="Philippe Rosa">
    <meta name="author" content="Maria Laura Zoffoli">
    <meta name="author" content="Guillaume Brunier">
    <meta name="author" content="Pierre Gernez">
    <meta name="author" content="Laurent Barillé">
    <meta name="dcterms.date" content="2024-03-01">
    <meta name="keywords" content="Drone, Remote Sensing">

    <title>Discriminating Seagrasses From Green Macroalgae in European Intertidal areas using high resolution multispectral drone imagery.</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      <meta name="citation_title" content="Discriminating Seagrasses From Green Macroalgae in European Intertidal areas using high resolution multispectral drone imagery.">
<meta name="citation_abstract" content="Coastal areas host seagrass meadows, which offer crucial ecosystem services including erosion control and carbon sequestration. However, these areas are increasingly impacted by human activities, leading to seagrass decline and habitat fragmentation. In situ surveys, traditionally performed to monitor these ecosystems face limitations on temporal and spatial coverage, particularly in intertidal zones, prompting the use of satellite data within monitoring programs. Yet, satellite remote sensing struggles with spatial and spectral resolution, making it difficult to discriminate seagrass from other macrophytes in highly heterogenous meadows. To address these challenges, drone images acquired with multi-spectral sensors offer a promising solution. This study focuses on using drones acquisitions for mapping intertidal macrophytes, effectively discriminating between seagrass and green macroalgae. Ten drone flights were conducted at two different altitudes (12m and 120m) across diverse European habitats in France and Portugal. Low altitude flights were used to train a Deep Learning classifier based on Neural Networks to discrimintate among 5 intertidal vegetation classes. Drone mapping demonstrated an overall accuracy of 94% across all the sites and images, covering a total area of 467 000 m². The model exhibited an accuracy of 96.4% in identifying seagrass.
">
<meta name="citation_keywords" content="Drone,Remote Sensing">
<meta name="citation_author" content="Simon Oiry">
<meta name="citation_author" content="Bede Ffinian Rowe Davies">
<meta name="citation_author" content="Ana I. Sousa">
<meta name="citation_author" content="Philippe Rosa">
<meta name="citation_author" content="Maria Laura Zoffoli">
<meta name="citation_author" content="Guillaume Brunier">
<meta name="citation_author" content="Pierre Gernez">
<meta name="citation_author" content="Laurent Barillé">
<meta name="citation_publication_date" content="2024-03-01">
<meta name="citation_cover_date" content="2024-03-01">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-03-01">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Earth and Space Science">
<meta name="citation_reference" content="citation_title=The planetary role of seagrass conservation;,citation_author=Richard KF Unsworth;,citation_author=Leanne C Cullen-Unsworth;,citation_author=Benjamin LH Jones;,citation_author=Richard J Lilley;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_issue=6606;,citation_volume=377;,citation_journal_title=Science;,citation_publisher=American Association for the Advancement of Science;">
<meta name="citation_reference" content="citation_title=Global wetland outlook: State of the world’s wetlands and their services to people;,citation_author=Royal C Gardner;,citation_author=C Finlayson;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;">
<meta name="citation_reference" content="citation_title=Remote sensing in seagrass ecology: Coupled dynamics between migratory herbivorous birds and intertidal meadows observed by satellite during four decades;,citation_author=Maria Laura Zoffoli;,citation_author=Pierre Gernez;,citation_author=Simon Oiry;,citation_author=Laurent Godet;,citation_author=Sébastien Dalloyau;,citation_author=Bede Ffinian Rowe Davies;,citation_author=Laurent Barillé;,citation_publication_date=2022-12;,citation_cover_date=2022-12;,citation_year=2022;,citation_doi=10.1002/rse2.319;,citation_issn=2056-3485;,citation_journal_title=Remote Sensing in Ecology and Conservation;">
<meta name="citation_reference" content="citation_title=Stabilizing effects of seagrass meadows on coastal water benthic food webs;,citation_author=Emilia Jankowska;,citation_author=Loı̈c N Michel;,citation_author=Gilles Lepoint;,citation_author=Maria Włodarska-Kowalczuk;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=510;,citation_journal_title=Journal of Experimental Marine Biology and Ecology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Seagrasses in an era of ocean warming: A review;,citation_author=Hung Manh Nguyen;,citation_author=Peter J Ralph;,citation_author=Lázaro Marı́n-Guirao;,citation_author=Mathieu Pernice;,citation_author=Gabriele Procaccini;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=5;,citation_volume=96;,citation_journal_title=Biological Reviews;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Latitudinal patterns in european seagrass carbon reserves: Influence of seasonal fluctuations versus short-term stress and disturbance events;,citation_author=Laura M Soissons;,citation_author=Eeke P Haanstra;,citation_author=Marieke M Van Katwijk;,citation_author=Ragnhild Asmus;,citation_author=Isabelle Auby;,citation_author=Laurent Barillé;,citation_author=Fernando G Brun;,citation_author=Patricia G Cardoso;,citation_author=Nicolas Desroy;,citation_author=Jerome Fournier;,citation_author=others;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_volume=9;,citation_journal_title=Frontiers in Plant Science;,citation_publisher=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=A global crisis for seagrass ecosystems;,citation_author=Robert J Orth;,citation_author=Tim JB Carruthers;,citation_author=William C Dennison;,citation_author=Carlos M Duarte;,citation_author=James W Fourqurean;,citation_author=Kenneth L Heck;,citation_author=A Randall Hughes;,citation_author=Gary A Kendrick;,citation_author=W Judson Kenworthy;,citation_author=Suzanne Olyarnik;,citation_author=others;,citation_publication_date=2006;,citation_cover_date=2006;,citation_year=2006;,citation_issue=12;,citation_volume=56;,citation_journal_title=Bioscience;,citation_publisher=American Institute of Biological Sciences;">
<meta name="citation_reference" content="citation_title=Which genes in a typical intertidal seagrass (zostera japonica) indicate copper-, lead-, and cadmium pollution?;,citation_author=Haiying Lin;,citation_author=Tao Sun;,citation_author=Yi Zhou;,citation_author=Ruiting Gu;,citation_author=Xiaomei Zhang;,citation_author=Wei Yang;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_volume=9;,citation_journal_title=Frontiers in Plant Science;,citation_publisher=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=Toward a coordinated global observing system for seagrasses and marine macroalgae;,citation_author=J Emmett Duffy;,citation_author=Lisandro Benedetti-Cecchi;,citation_author=Joaquin Trinanes;,citation_author=Frank E Muller-Karger;,citation_author=Rohani Ambo-Rappe;,citation_author=Christoffer Boström;,citation_author=Alejandro H Buschmann;,citation_author=Jarrett Byrnes;,citation_author=Robert G Coles;,citation_author=Joel Creed;,citation_author=others;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=6;,citation_journal_title=Frontiers in Marine Science;,citation_publisher=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=Recent trend reversal for declining european seagrass meadows;,citation_author=Carmen B Los Santos;,citation_author=Dorte Krause-Jensen;,citation_author=Teresa Alcoverro;,citation_author=Núria Marbà;,citation_author=Carlos M Duarte;,citation_author=Marieke M Van Katwijk;,citation_author=Marta Pérez;,citation_author=Javier Romero;,citation_author=José L Sánchez-Lizaso;,citation_author=Guillem Roca;,citation_author=others;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=1;,citation_volume=10;,citation_journal_title=Nature communications;,citation_publisher=Nature Publishing Group UK London;">
<meta name="citation_reference" content="citation_title=Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series;,citation_abstract=Seagrass meadows are monitored in the frame of several environmental programs worldwide, including the Water Framework Directive (WFD), to evaluate the ecological status of European coastal and transitional water bodies. The large size, spatial complexity, and interannual variability of seagrass ecosystems significantly challenge field monitoring. In this study, a multi-mission satellite time-series was used to estimate long-term changes in seagrass status in a macrotidal system dominated by Zostera noltei, at Bourgneuf Bay (French Atlantic coast). Metrics of seagrass extent and density were obtained from Earth Observation (EO) using validated and inter-calibrated Landsat, SPOT and Sentinel2 data from 1985 to 2020. The information provided by satellite data made it possible to compute and compare several seagrass indicators currently in use in several European countries (France, Portugal and UK) within the WFD. Both the seagrass extent and meadow-averaged density displayed increasing trends since 1985. A time-series of merged observations from various satellites revealed a high degree of interannual variability in seagrass extent, with abrupt losses (up to 50;,citation_author=Maria Laura Zoffoli;,citation_author=Pierre Gernez;,citation_author=Laurent Godet;,citation_author=Steef Peters;,citation_author=Simon Oiry;,citation_author=Laurent Barillé;,citation_publication_date=2021-11;,citation_cover_date=2021-11;,citation_year=2021;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S1470160X21006981;,citation_doi=10.1016/j.ecolind.2021.108033;,citation_issn=1470160X;,citation_volume=130;,citation_journal_title=Ecological Indicators;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Assessment of global habitat suitability and risk of ocean green tides;,citation_author=Zhongyuan Wang;,citation_author=Zhixiang Fang;,citation_author=Jianfeng Liang;,citation_author=Xiao Song;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=119;,citation_journal_title=Harmful Algae;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Essential ocean variables for global sustained observations of biodiversity and ecosystem changes;,citation_abstract=Sustained observations of marine biodiversity and ecosystems focused on specific conservation and management problems are needed around the world to effectively mitigate or manage changes resulting from anthropogenic pressures. These observations, while complex and expensive, are required by the international scientific, governance and policy communities to provide baselines against which the effects of human pressures and climate change may be measured and reported, and resources allocated to implement solutions. To identify biological and ecological essential ocean variables (EOVs) for implementation within a global ocean observing system that is relevant for science, informs society, and technologically feasible, we used a driver-pressure-state-impact-response (DPSIR) model. We (1) examined relevant international agreements to identify societal drivers and pressures on marine resources and ecosystems, (2) evaluated the temporal and spatial scales of variables measured by 100+ observing programs, and (3) analysed the impact and scalability of these variables and how they contribute to address societal and scientific issues. EOVs were related to the status of ecosystem components (phytoplankton and zooplankton biomass and diversity, and abundance and distribution of fish, marine turtles, birds and mammals), and to the extent and health of ecosystems (cover and composition of hard coral, seagrass, mangrove and macroalgal canopy). Benthic invertebrate abundance and distribution and microbe diversity and biomass were identified as emerging EOVs to be developed based on emerging requirements and new technologies. The temporal scale at which any shifts in biological systems will be detected will vary across the EOVs, the properties being monitored and the length of the existing time-series. Global implementation to deliver useful products will require collaboration of the scientific and policy sectors and a significant commitment to improve human and infrastructure capacity across the globe, including the development of new, more automated observing technologies, and encouraging the application of international standards and best practices.;,citation_author=Patricia Miloslavich;,citation_author=Nicholas J. Bax;,citation_author=Samantha E. Simmons;,citation_author=Eduardo Klein;,citation_author=Ward Appeltans;,citation_author=Octavio Aburto-Oropeza;,citation_author=Melissa Andersen Garcia;,citation_author=Sonia D. Batten;,citation_author=Lisandro Benedetti-Cecchi;,citation_author=David M. Checkley;,citation_author=Sanae Chiba;,citation_author=J. Emmett Duffy;,citation_author=Daniel C. Dunn;,citation_author=Albert Fischer;,citation_author=John Gunn;,citation_author=Raphael Kudela;,citation_author=Francis Marsac;,citation_author=Frank E. Muller-Karger;,citation_author=David Obura;,citation_author=Yunne Jai Shin;,citation_publication_date=2018-06;,citation_cover_date=2018-06;,citation_year=2018;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/abs/10.1111/gcb.14108 https://onlinelibrary.wiley.com/doi/10.1111/gcb.14108;,citation_doi=10.1111/GCB.14108;,citation_issn=1365-2486;,citation_volume=24;,citation_journal_title=Global Change Biology;,citation_publisher=John Wiley &amp;amp;amp; Sons, Ltd;">
<meta name="citation_reference" content="citation_title=Essential biodiversity variables;,citation_author=Henrique Miguel Pereira;,citation_author=Simon Ferrier;,citation_author=Michele Walters;,citation_author=Gary N Geller;,citation_author=Rob HG Jongman;,citation_author=Robert J Scholes;,citation_author=Michael William Bruford;,citation_author=Neil Brummitt;,citation_author=Stuart HM Butchart;,citation_author=AC Cardoso;,citation_author=others;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_issue=6117;,citation_volume=339;,citation_journal_title=Science;,citation_publisher=American Association for the Advancement of Science;">
<meta name="citation_reference" content="citation_title=Satellite remote sensing of canopy-forming kelp on a complex coastline: A novel procedure using the landsat image archive;,citation_author=Wiebe Nijland;,citation_author=Luba Reshitnyk;,citation_author=Emily Rubidge;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_volume=220;,citation_journal_title=Remote Sensing of Environment;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Long-term changes in the unique and largest seagrass meadows in the bohai sea (china) using satellite (1974–2019) and sonar data: Implication for conservation and restoration;,citation_author=Shaochun Xu;,citation_author=Shuai Xu;,citation_author=Yi Zhou;,citation_author=Shidong Yue;,citation_author=Xiaomei Zhang;,citation_author=Ruiting Gu;,citation_author=Yu Zhang;,citation_author=Yongliang Qiao;,citation_author=Mingjie Liu;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=5;,citation_volume=13;,citation_journal_title=Remote Sensing;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Mapping mediterranean seagrasses with sentinel-2 imagery;,citation_abstract=Mediterranean seagrasses have been hailed for their numerous ecosystem services, yet they are undergoing a decline in their coverage. The major complication with resolving this tendency is the sparsity of data on their overall distribution. This study addresses the suitability of the recently launched Sentinel-2 satellite for mapping the distribution of Mediterranean seagrass meadows. A comprehensive methodology is presented which applies atmospheric and analytical water column corrections and compares the performance of three different supervised classifiers. Remote sensing of the Thermaikos Gulf, northwestern Aegean Sea (Greece, eastern Mediterranean Sea) reveals that the utilization of Support Vector Machines on water column corrected reflectances yields best accuracies. Two Mediterranean seagrasses, Posidonia oceanica and Cymodocea nodosa, cover a total submerged area of 1.48 km2 between depths of 1.4–16.5 m. With its 10-m spatial resolution and 5-day revisit frequency, Sentinel-2 imagery can mitigate the Mediterranean seagrass distribution data gap and allow better management and conservation in the future in a retrospective, time- and cost-effective fashion.;,citation_author=Dimosthenis Traganos;,citation_author=Peter Reinartz;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_doi=10.1016/j.marpolbul.2017.06.075;,citation_issn=18793363;,citation_volume=134;,citation_journal_title=Marine Pollution Bulletin;,citation_publisher=Elsevier Ltd;">
<meta name="citation_reference" content="citation_title=Providing a framework for seagrass mapping in united states coastal ecosystems using high spatial resolution satellite imagery;,citation_author=Megan M Coffer;,citation_author=David D Graybill;,citation_author=Peter J Whitman;,citation_author=Blake A Schaeffer;,citation_author=Wilson B Salls;,citation_author=Richard C Zimmerman;,citation_author=Victoria Hill;,citation_author=Marie Cindy Lebrasse;,citation_author=Jiang Li;,citation_author=Darryl J Keith;,citation_author=others;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_volume=337;,citation_journal_title=Journal of Environmental Management;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Operation of the xanthophyll cycle in the seagrass zostera marina in response to variable irradiance;,citation_author=PJ Ralph;,citation_author=SM Polk;,citation_author=KA Moore;,citation_author=RJ Orth;,citation_author=WO Smith Jr;,citation_publication_date=2002;,citation_cover_date=2002;,citation_year=2002;,citation_issue=2;,citation_volume=271;,citation_journal_title=Journal of Experimental Marine Biology and Ecology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=New hyperspectral procedure to discriminate intertidal macroalgae;,citation_abstract=The recent development and miniaturization of hyperspectral sensors embedded in drones has allowed the acquisition of hyperspectral images with high spectral and spatial resolution. The characteristics of both the embedded sensors and drones (viewing angle, flying altitude, resolution) create opportunities to consider the use of hyperspectral imagery to map and monitor macroalgae communities. In general, the overflight of the areas to be mapped is conconmittently associated accompanied with measurements carried out in the field to acquire the spectra of previously identified objects. An alternative to these simultaneous acquisitions is to use a hyperspectral library made up of pure spectra of the different species in place, that would spare field acquisition of spectra during each flight. However, the use of such a technique requires developed appropriate procedure for testing the level of species classification that can be achieved, as well as the reproducibility of the classification over time. This study presents a novel classification approach based on the use of reflectance spectra of macroalgae acquired in controlled conditions. This overall approach developed is based on both the use of the spectral angle mapper (SAM) algorithm applied on first derivative hyperspectral data. The efficiency of this approach has been tested on a hyperspectral library composed of 16 macroalgae species, and its temporal reproducibility has been tested on a monthly survey of the spectral response of different macro-algae species. In addition, the classification results obtained with this new approach were also compared to the results obtained through the use of the most recent and robust procedure published. The classification obtained shows that the developed approach allows to perfectly discriminate the different phyla, whatever the period. At the species level, the classification approach is less effective when the individuals studied belong to phylogenetically close species (i.e., Fucus spiralis and Fucus serratus).;,citation_author=Florian Douay;,citation_author=Charles Verpoorter;,citation_author=Gwendoline Duong;,citation_author=Nicolas Spilmont;,citation_author=François Gevaert;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.mdpi.com/2072-4292/14/2/346;,citation_issue=2;,citation_doi=10.3390/rs14020346;,citation_issn=2072-4292;,citation_volume=14;,citation_journal_title=Remote Sensing;">
<meta name="citation_reference" content="citation_title=Multi- and hyperspectral classification of soft-bottom intertidal vegetation using a spectral library for coastal biodiversity remote sensing;,citation_abstract=Monitoring biodiversity and how anthropogenic pressures impact this is critical, especially as anthropogenically driven climate change continues to affect all ecosystems. Intertidal areas are exposed to particularly high levels of pressures owing to increased population density in coastal areas. Traditional methods of monitoring intertidal areas do not provide datasets with full coverage in a cost-effective or timely manner, and so the use of remote sensing to monitor these areas is becoming more common. Monitoring of ecologically important monospecific habitats, such as seagrass beds, using remote sensing techniques is well documented. However, the ability for multispectral data to distinguish efficiently and accurately between classes of vegetation with similar pigment composition, such as seagrass and green algae, has proved difficult, often requiring hyperspectral data. A machine learning approach was used to differentiate between soft-bottom intertidal vegetation classes when exposed at low tide, comparing 6 different multi- and hyperspectral remote and in situ sensors. For the library of 366 spectra, collected across Northern Europe, high accuracy (&amp;amp;amp;gt;80;,citation_author=B F R Davies;,citation_author=Pierre Gernez;,citation_author=Andréa Geraud;,citation_author=Simon Oiry;,citation_author=Philippe Rosa;,citation_author=Maria Laura Zoffoli;,citation_author=Laurent Barillé;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0034425723001050;,citation_doi=10.1016/j.rse.2023.113554;,citation_issn=0034-4257;,citation_volume=290;,citation_journal_title=Remote Sensing of Environment;">
<meta name="citation_reference" content="citation_title=The capabilities of sentinel-MSI (2A/2B) and landsat-OLI (8/9) in seagrass and algae species differentiation using spectral reflectance;,citation_author=Abderrazak Bannari;,citation_author=Thamer Salim Ali;,citation_author=Asma Abahussain;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_issue=2;,citation_volume=18;,citation_journal_title=Ocean Science;,citation_publisher=Copernicus GmbH;">
<meta name="citation_reference" content="citation_title=Drastic decadal decline of the seagrass cymodocea nodosa at gran canaria (eastern atlantic): Interactions with the green algae caulerpa prolifera;,citation_author=Fernando Tuya;,citation_author=Harue Hernandez-Zerpa;,citation_author=Fernando Espino;,citation_author=Ricardo Haroun;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=105;,citation_journal_title=Aquatic Botany;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Drone-based large-scale particle image velocimetry applied to tidal stream energy resource assessment;,citation_author=Iain Fairley;,citation_author=Benjamin J Williamson;,citation_author=Jason McIlvenny;,citation_author=Nicholas King;,citation_author=Ian Masters;,citation_author=Matthew Lewis;,citation_author=Simon Neill;,citation_author=David Glasby;,citation_author=Daniel Coles;,citation_author=Ben Powell;,citation_author=others;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=196;,citation_journal_title=Renewable Energy;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Use of a drone for mapping and time series image acquisition of tidal zones;,citation_author=Jaehong Oh;,citation_author=Duk-jin Kim;,citation_author=Hyoseong Lee;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=2;,citation_volume=27;,citation_journal_title=Journal of the Korean Institute of Intelligent Systems;,citation_publisher=Korean Institute of Intelligent Systems;">
<meta name="citation_reference" content="citation_title=Unmanned aerial vehicle (UAV) applications in coastal zone management—a review;,citation_author=Richard Adade;,citation_author=Abiodun Musa Aibinu;,citation_author=Bernard Ekumah;,citation_author=Jerry Asaana;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_volume=193;,citation_journal_title=Environmental Monitoring and Assessment;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Accuracy of sand beach topography surveying by drones and photogrammetry;,citation_author=Elisa Casella;,citation_author=Jan Drechsel;,citation_author=Christian Winter;,citation_author=Markus Benninghoff;,citation_author=Alessio Rovere;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=40;,citation_journal_title=Geo-Marine Letters;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Satellite, drone and video camera multi-platform monitoring of coastal erosion at an engineered pocket beach: A showcase for coastal management at elmina bay, ghana (west africa);,citation_author=Donatus B Angnuureng;,citation_author=KE Brempong;,citation_author=PN Jayson-Quashigah;,citation_author=OA Dada;,citation_author=SGI Akuoko;,citation_author=J Frimpomaa;,citation_author=PA Mattah;,citation_author=Rafaël Almar;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=53;,citation_journal_title=Regional Studies in Marine Science;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=The unique value proposition for using drones to map coastal ecosystems;,citation_author=Karen E Joyce;,citation_author=Kate C Fickas;,citation_author=Michelle Kalamandeen;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_volume=1;,citation_journal_title=Cambridge Prisms: Coastal Futures;,citation_publisher=Cambridge University Press;">
<meta name="citation_reference" content="citation_title=Application of deep learning for classification of intertidal eelgrass from drone-acquired imagery;,citation_author=Krti Tallam;,citation_author=Nam Nguyen;,citation_author=Jonathan Ventura;,citation_author=Andrew Fricker;,citation_author=Sadie Calhoun;,citation_author=Jennifer O’Leary;,citation_author=Mauriça Fitzgibbons;,citation_author=Ian Robbins;,citation_author=Ryan K Walter;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_issue=9;,citation_volume=15;,citation_journal_title=Remote Sensing;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Monitoring the marine invasive alien species rugulopteryx okamurae using unmanned aerial vehicles and satellites;,citation_abstract=&amp;amp;amp;lt;p&amp;gt; &amp;lt;italic&amp;gt;Rugulopteryx okamurae</italic> is a species of brown macroalgae belonging to the <italic>Dictyotaceae</italic> family and native to the north-western Pacific. As an Invasive Alien Species (IAS), it was first detected in the Strait of Gibraltar in 2015. Since then, <italic>R. okamurae</italic> has been spreading rapidly through the submerged euphotic zone, colonizing from 0 to 50 m depth and generating substantial economic and environmental impacts on the Andalusian coasts (southern Spain). More than 40;,citation_author=Mar Roca;,citation_author=Martha Bonnet Dunbar;,citation_author=Alejandro Román;,citation_author=Isabel Caballero;,citation_author=Maria Laura Zoffoli;,citation_author=Pierre Gernez;,citation_author=Gabriel Navarro;,citation_publication_date=2022-10;,citation_cover_date=2022-10;,citation_year=2022;,citation_doi=10.3389/fmars.2022.1004012;,citation_issn=2296-7745;,citation_volume=9;,citation_journal_title=Frontiers in Marine Science;">
<meta name="citation_reference" content="citation_title=Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes;,citation_author=Alejandro Román;,citation_author=Antonio Tovar-Sánchez;,citation_author=Irene Olivé;,citation_author=Gabriel Navarro;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_journal_title=Frontiers in Marine Science;,citation_publisher=Frontiers;">
<meta name="citation_reference" content="citation_title=Topographic analysis of intertidal polychaete reefs (sabellaria alveolata) at a very high spatial resolution;,citation_abstract=In temperate coastal regions of Western Europe, the polychaete Sabellaria alveolata (Linn&amp;amp;amp;eacute;) builds large intertidal reefs of several hectares on soft-bottom substrates. These reefs are protected by the European Habitat Directive EEC/92/43 under the status of biogenic structures hosting a high biodiversity and providing ecological functions such as protection against coastal erosion. As an alternative to time-consuming field campaigns, a UAV-based Structure-from-Motion photogrammetric survey was carried out in October 2020 over Noirmoutier Island (France) where the second-largest known European reef is located in a tidal delta. A DJI Phantom 4 Multispectral UAV provided a topographic dataset at very high resolutions of 5 cm/pixel for the Digital Surface Model (DSM) and 2.63 cm/pixel for the multispectral orthomosaic images. The reef footprint was mapped using a combination of two topographic indices: the Topographic Openness Index and the Topographic Position Index. The reef structures covered an area of 8.15 ha, with 89;,citation_author=Guillaume Brunier;,citation_author=Simon Oiry;,citation_author=Yves Gruet;,citation_author=Stanislas F. Dubois;,citation_author=Laurent Barillé;,citation_publication_date=2022-01;,citation_cover_date=2022-01;,citation_year=2022;,citation_fulltext_html_url=https://www.mdpi.com/2072-4292/14/2/307;,citation_doi=10.3390/RS14020307;,citation_issn=2072-4292;,citation_volume=14;,citation_journal_title=Remote Sensing 2022, Vol. 14, Page 307;,citation_publisher=Multidisciplinary Digital Publishing Institute;">
<meta name="citation_reference" content="citation_title=Improving intertidal reef mapping using UAV surface, red edge, and near-infrared data;,citation_author=Antoine Collin;,citation_author=Stanislas Dubois;,citation_author=Dorothée James;,citation_author=Thomas Houet;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=3;,citation_volume=3;,citation_journal_title=Drones;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=UAV-mounted hyperspectral mapping of intertidal macroalgae;,citation_author=Thomas Rossiter;,citation_author=Thomas Furey;,citation_author=Tim McCarthy;,citation_author=Dagmar B Stengel;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=242;,citation_journal_title=Estuarine, Coastal and Shelf Science;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Benthic intertidal vegetation from the tagus estuary and aveiro lagoon;,citation_author=B F R Davies;,citation_author=A I. Sousa;,citation_author=R Figueira;,citation_author=S Oiry;,citation_author=P Gernez;,citation_author=L Barillé;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_doi=10.15468/n4ak6x;,citation_publisher=Université de Nantes via GBIF.org;">
<meta name="citation_reference" content="citation_title=Spatiotemporal index standardization improves the stock assessment of northern shrimp in the gulf of maine;,citation_abstract=&amp;amp;amp;lt;p&amp;gt;Estimated trends in relative stock abundance are a primary input to fish stock assessments. Accurate and precise estimates are essential for successful conservation and management. Scientifically designed data collection ensures that estimates of relative abundance are unbiased. However, the statistical efficiency of a design-based estimator may be low under certain circumstances. We apply a recently developed spatiotemporal model that incorporates habitat variables to estimate a model-based abundance index for northern shrimp (Pandalus borealis) in the Gulf of Maine. We contrast this spatiotemporal index with a classical design-based index and evaluate the impacts of differences between the two abundance indices on the stock assessment. We show that using the spatiotemporal index in the assessment model greatly alters the estimates of recruitment and spawning stock biomass and the determination of stock status. Also, incorporating the spatiotemporal index leads to less retrospective bias and outperforms the model with design-based index in terms of predictive performance through a retrospective cross-validation test. Our results suggest that temporal variability of population abundance could be exaggerated by the design-based estimator, and such imprecision may greatly affect the performance of a stock assessment and subsequent development of management decisions.&amp;lt;/p&amp;gt;;,citation_author=Jie Cao;,citation_author=James T. Thorson;,citation_author=R. Anne Richards;,citation_author=Yong Chen;,citation_publication_date=2017-11;,citation_cover_date=2017-11;,citation_year=2017;,citation_doi=10.1139/cjfas-2016-0137;,citation_issn=0706-652X;,citation_volume=74;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Seasonal spectral variation of zostera noltii and its influence on pigment-based vegetation indices;,citation_author=A Bargain;,citation_author=M Robin;,citation_author=V Méléder;,citation_author=P Rosa;,citation_author=E Le Menn;,citation_author=N Harin;,citation_author=L Barillé;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=446;,citation_journal_title=Journal of experimental marine biology and ecology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Light and photosynthesis in aquatic ecosystems;,citation_author=John TO Kirk;,citation_publication_date=1994;,citation_cover_date=1994;,citation_year=1994;">
<meta name="citation_reference" content="citation_title=Influence of three-dimensional coral structures on hyperspectral benthic reflectance and water-leaving reflectance;,citation_author=John D Hedley;,citation_author=Maryam Mirhakak;,citation_author=Adam Wentworth;,citation_author=Heidi M Dierssen;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=12;,citation_volume=8;,citation_journal_title=Applied Sciences;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=In vivo absorbance spectra and the ecophysiology of reef macroalgae;,citation_author=KS Beach;,citation_author=HB Borgeas;,citation_author=NJ Nishimura;,citation_author=CM Smith;,citation_publication_date=1997;,citation_cover_date=1997;,citation_year=1997;,citation_volume=16;,citation_journal_title=Coral Reefs;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Seagrass ecophysiological performance under ocean warming and acidification;,citation_author=Tiago Repolho;,citation_author=Bernardo Duarte;,citation_author=Gisela Dionı́sio;,citation_author=José Ricardo Paula;,citation_author=Ana R Lopes;,citation_author=Inês C Rosa;,citation_author=Tiago F Grilo;,citation_author=Isabel Caçador;,citation_author=Ricardo Calado;,citation_author=Rui Rosa;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=1;,citation_volume=7;,citation_journal_title=Scientific Reports;,citation_publisher=Nature Publishing Group UK London;">
<meta name="citation_reference" content="citation_title=Eutrophication and warming-driven green tides (ulva rigida) are predicted to increase under future climate change scenarios;,citation_author=Guang Gao;,citation_author=Anthony S Clare;,citation_author=Craig Rose;,citation_author=Gary S Caldwell;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=1;,citation_volume=114;,citation_journal_title=Marine Pollution Bulletin;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Nutrients and eutrophication;,citation_author=Michelle Devlin;,citation_author=Jon Brodie;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_inbook_title=Marine pollution–monitoring, management and mitigation;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./index.qmd" class="btn btn-primary quarto-download-embed" download="index.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Discriminating Seagrasses From Green Macroalgae in European Intertidal areas using high resolution multispectral drone imagery.</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Simon Oiry <a href="mailto:oirysimon@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-7161-5246" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Institut des Substances et Organismes de la Mer, ISOMer, Nantes Université, UR 2160, F-44000 Nantes, France
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Bede Ffinian Rowe Davies </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Institut des Substances et Organismes de la Mer, ISOMer, Nantes Université, UR 2160, F-44000 Nantes, France
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Ana I. Sousa </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        CESAM – Centre for Environmental and Marine Studies, Department of Biology, University of Aveiro, Aveiro, Portugal
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Philippe Rosa </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Institut des Substances et Organismes de la Mer, ISOMer, Nantes Université, UR 2160, F-44000 Nantes, France
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Maria Laura Zoffoli </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Consiglio Nazionale delle Ricerche, Istituto di Scienze Marine (CNR-ISMAR), 00133 Rome, Italy
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Guillaume Brunier </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        BRGM French Geological Survey, Cayenne 97300, French Guiana
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Pierre Gernez </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Institut des Substances et Organismes de la Mer, ISOMer, Nantes Université, UR 2160, F-44000 Nantes, France
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Laurent Barillé </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Institut des Substances et Organismes de la Mer, ISOMer, Nantes Université, UR 2160, F-44000 Nantes, France
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">March 1, 2024</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>Coastal areas host seagrass meadows, which offer crucial ecosystem services including erosion control and carbon sequestration. However, these areas are increasingly impacted by human activities, leading to seagrass decline and habitat fragmentation. In situ surveys, traditionally performed to monitor these ecosystems face limitations on temporal and spatial coverage, particularly in intertidal zones, prompting the use of satellite data within monitoring programs. Yet, satellite remote sensing struggles with spatial and spectral resolution, making it difficult to discriminate seagrass from other macrophytes in highly heterogenous meadows. To address these challenges, drone images acquired with multi-spectral sensors offer a promising solution. This study focuses on using drones acquisitions for mapping intertidal macrophytes, effectively discriminating between seagrass and green macroalgae. Ten drone flights were conducted at two different altitudes (12m and 120m) across diverse European habitats in France and Portugal. Low altitude flights were used to train a Deep Learning classifier based on Neural Networks to discrimintate among 5 intertidal vegetation classes. Drone mapping demonstrated an overall accuracy of 94% across all the sites and images, covering a total area of 467 000 m². The model exhibited an accuracy of 96.4% in identifying seagrass.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Drone, Remote Sensing</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#material-methods" id="toc-material-methods" class="nav-link" data-scroll-target="#material-methods"><span class="header-section-number">2</span> Material &amp; Methods</a>
  <ul class="collapse">
  <li><a href="#study-sites" id="toc-study-sites" class="nav-link" data-scroll-target="#study-sites"><span class="header-section-number">2.1</span> Study sites</a></li>
  <li><a href="#drone-data" id="toc-drone-data" class="nav-link" data-scroll-target="#drone-data"><span class="header-section-number">2.2</span> Drone Data</a></li>
  <li><a href="#field-sampling" id="toc-field-sampling" class="nav-link" data-scroll-target="#field-sampling"><span class="header-section-number">2.3</span> Field sampling</a></li>
  <li><a href="#intertidal-vegetation-mapping" id="toc-intertidal-vegetation-mapping" class="nav-link" data-scroll-target="#intertidal-vegetation-mapping"><span class="header-section-number">2.4</span> Intertidal vegetation mapping</a>
  <ul class="collapse">
  <li><a href="#neural-network-model-building" id="toc-neural-network-model-building" class="nav-link" data-scroll-target="#neural-network-model-building"><span class="header-section-number">2.4.1</span> Neural Network model building</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation"><span class="header-section-number">2.4.2</span> Validation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a>
  <ul class="collapse">
  <li><a href="#classification" id="toc-classification" class="nav-link" data-scroll-target="#classification"><span class="header-section-number">3.1</span> Classification</a></li>
  <li><a href="#validation-1" id="toc-validation-1" class="nav-link" data-scroll-target="#validation-1"><span class="header-section-number">3.2</span> Validation</a></li>
  <li><a href="#variable-importance" id="toc-variable-importance" class="nav-link" data-scroll-target="#variable-importance"><span class="header-section-number">3.3</span> Variable importance</a></li>
  <li><a href="#effect-of-the-flight-height-on-the-prediction" id="toc-effect-of-the-flight-height-on-the-prediction" class="nav-link" data-scroll-target="#effect-of-the-flight-height-on-the-prediction"><span class="header-section-number">3.4</span> Effect of the flight height on the prediction</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">4</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#vegetation-discrimination" id="toc-vegetation-discrimination" class="nav-link" data-scroll-target="#vegetation-discrimination"><span class="header-section-number">4.1</span> Vegetation Discrimination</a></li>
  <li><a href="#spectral-spatial-temporal-resolution-impact-on-the-prediction" id="toc-spectral-spatial-temporal-resolution-impact-on-the-prediction" class="nav-link" data-scroll-target="#spectral-spatial-temporal-resolution-impact-on-the-prediction"><span class="header-section-number">4.2</span> Spectral Spatial Temporal Resolution impact on the prediction</a></li>
  <li><a href="#big-picture" id="toc-big-picture" class="nav-link" data-scroll-target="#big-picture"><span class="header-section-number">4.3</span> Big picture</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">5</span> Conclusion</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography"><span class="header-section-number">6</span> Bibliography</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'ggplot2' a été compilé avec la version R 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'stringr' a été compilé avec la version R 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::compose() masks flextable::compose()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyterra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'tidyterra'

L'objet suivant est masqué depuis 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──
✔ broom        1.0.5     ✔ rsample      1.1.1
✔ dials        1.2.0     ✔ tune         1.1.1
✔ infer        1.0.4     ✔ workflows    1.1.3
✔ modeldata    1.1.0     ✔ workflowsets 1.0.1
✔ parsnip      1.1.0     ✔ yardstick    1.2.0
✔ recipes      1.0.6     
── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ purrr::compose()    masks flextable::compose()
✖ scales::discard()   masks purrr::discard()
✖ tidyterra::filter() masks dplyr::filter(), stats::filter()
✖ recipes::fixed()    masks stringr::fixed()
✖ dplyr::lag()        masks stats::lag()
✖ yardstick::spec()   masks readr::spec()
✖ recipes::step()     masks stats::step()
• Use suppressPackageStartupMessages() to eliminate package startup messages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Utilities.Package) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Le chargement a nécessité le package : cowplot

Attachement du package : 'cowplot'

L'objet suivant est masqué depuis 'package:lubridate':

    stamp

Le chargement a nécessité le package : patchwork

Attachement du package : 'patchwork'

L'objet suivant est masqué depuis 'package:cowplot':

    align_plots

Le chargement a nécessité le package : magrittr

Attachement du package : 'magrittr'

L'objet suivant est masqué depuis 'package:purrr':

    set_names

L'objet suivant est masqué depuis 'package:tidyr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.2, GDAL 3.6.2, PROJ 9.2.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
which was just loaded, will retire in October 2023.
Please refer to R-spatial evolution reports for details, especially
https://r-spatial.org/r/2023/05/15/evolution4.html.
It may be desirable to make the sf package available;
package maintainers should consider adding sf to Suggests:.
The sp package is now running under evolution status 2
     (status 2 uses the sf package in place of rgdal)
Support for Spatial objects (`sp`) will be deprecated in {rnaturalearth} and will be removed in a future release of the package. Please use `sf` objects with {rnaturalearth}. For example: `ne_download(returnclass = 'sf')`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'rnaturalearthdata'

L'objet suivant est masqué depuis 'package:rnaturalearth':

    countries110</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthhires)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce) </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.7.39

Attachement du package : 'terra'

Les objets suivants sont masqués depuis 'package:magrittr':

    extract, inset

L'objet suivant est masqué depuis 'package:patchwork':

    area

L'objet suivant est masqué depuis 'package:scales':

    rescale

L'objet suivant est masqué depuis 'package:tidyr':

    extract

Les objets suivants sont masqués depuis 'package:flextable':

    align, colorize, rotate, width</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to ImageMagick 6.9.12.3
Enabled features: cairo, freetype, fftw, ghostscript, heic, lcms, pango, raw, rsvg, webp
Disabled features: fontconfig, x11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'grid'

L'objet suivant est masqué depuis 'package:terra':

    depth</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statebins)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terrainr)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpmisc)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Le chargement a nécessité le package : abind</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Le chargement a nécessité le package : lattice

Attachement du package : 'caret'

Les objets suivants sont masqués depuis 'package:yardstick':

    precision, recall, sensitivity, specificity

L'objet suivant est masqué depuis 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">100000000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>my_comma<span class="ot">&lt;-</span>scales<span class="sc">::</span><span class="fu">label_comma</span>(<span class="at">accuracy =</span> <span class="cn">NULL</span>, <span class="at">big.mark =</span> <span class="st">","</span>,<span class="at">decimal.mark =</span> <span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Coastal areas are vital hotshots for marine biodiversity, with intertidal seagrass meadows playing a crucial role at the interface between land and ocean <span class="citation" data-cites="unsworth2022">(<a href="#ref-unsworth2022" role="doc-biblioref">Unsworth et al., 2022</a>)</span>. Seagrass meadows provide a myriad of ecosystem services to humanity, including carbon sequestration, oxygen production,protection against sea-level rise and coastline erosion, and limitation of eutrophication. They serve as vital habitats for a diverse array of marine and terrestrial species, providing living, breeding, and feeding grounds <span class="citation" data-cites="gardner2018 Zoffoli2022 jankowska2019">(<a href="#ref-gardner2018" role="doc-biblioref">Gardner and Finlayson, 2018</a> ; <a href="#ref-Zoffoli2022" role="doc-biblioref">Zoffoli et al., 2022</a> ; <a href="#ref-jankowska2019" role="doc-biblioref">Jankowska et al., 2019</a>)</span>. Due to the concentration of human activities in coastal zones, seagrass meadows are directly exposed to and impacted by anthropogenic pressures. Global regression and fragmentation are currently observed due to climate change, diseases, urbanization, land reclamation, dredging, competition with alien species, and reduction in water quality <span class="citation" data-cites="nguyen2021 soissons2018 orth2006 lin2018 duffy2019">(<a href="#ref-nguyen2021" role="doc-biblioref">Nguyen et al., 2021</a> ; <a href="#ref-soissons2018" role="doc-biblioref">Soissons et al., 2018</a> ; <a href="#ref-orth2006" role="doc-biblioref">Orth et al., 2006</a> ; <a href="#ref-lin2018" role="doc-biblioref">Lin et al., 2018</a> ; <a href="#ref-duffy2019" role="doc-biblioref">Duffy et al., 2019</a>)</span>. While improvements in water quality have been recently reported in Europe, allowing an overall recovery of seagrass ecosystems at local scale, many coastal waters worldwide are still subjected to strong eutrophication processes <span class="citation" data-cites="deSantos2019 Zoffoli2021">(<a href="#ref-deSantos2019" role="doc-biblioref">Los Santos et al., 2019</a> ; <a href="#ref-Zoffoli2021" role="doc-biblioref">Zoffoli et al., 2021</a>)</span>. Coastal eutrophication has been associated to anomalous accumulation of green macroalgae, the so-called green tides (<span class="citation" data-cites="devlin2023nutrients">Devlin and Brodie (<a href="#ref-devlin2023nutrients" role="doc-biblioref">2023</a>)</span> ; <span class="citation" data-cites="devlin2023nutrients">Devlin and Brodie (<a href="#ref-devlin2023nutrients" role="doc-biblioref">2023</a>)</span>). Green tides produce shade and suffication over seagrass individuals, thus threatening the health of seagrass ecosystems <span class="citation" data-cites="wang2022">(<a href="#ref-wang2022" role="doc-biblioref">Wang et al., 2022</a>)</span>.</p>
<p>The importance of seagrass meadows and the variety of ecosystem services they provide have led to the enhancement of both global and regional programs monitoring Essential Oceanic Variable (EOVs) such as seagrass composition <span class="citation" data-cites="Miloslavich2018">(<a href="#ref-Miloslavich2018" role="doc-biblioref">Miloslavich et al., 2018</a>)</span>, as well as Essential Biodiversity Variable (EBVs) such as seagrass taxonomic diversity, species distribution, populuation abundance, and phenology <span class="citation" data-cites="Pereira2013">(<a href="#ref-Pereira2013" role="doc-biblioref">Pereira et al., 2013</a>)</span>. Seagrass monitoring is all the more important as it makes possible to identify which pressure should be addressed in priority to facilitate effective mitigation actions. Traditionally, indicators of seagrass status have been quantified using in situ measurements. The acquisition of field data in intertidal zones is however notoriously challenging. Intertidal seagrass meadows are only partially exposed during low tide and can be situated in difficult-to-reach mudflats, potentially leading to inaccurate and limited estimations with conventional sampling techniques <span class="citation" data-cites="nijland2019">(<a href="#ref-nijland2019" role="doc-biblioref">Nijland et al., 2019</a>)</span>. Satellite observations have been proven effective in complementing in situ sampling, allowing for the near real-time and consistent retrieval of seagrass EOVs and EBVs over extensive meadows. <span class="citation" data-cites="Zoffoli2021 xu2021 Traganos2018 coffer2023">(<a href="#ref-Zoffoli2021" role="doc-biblioref">Zoffoli et al., 2021</a> ; <a href="#ref-xu2021" role="doc-biblioref">Xu et al., 2021</a> ; <a href="#ref-Traganos2018" role="doc-biblioref">Traganos and Reinartz, 2018</a> ; <a href="#ref-coffer2023" role="doc-biblioref">Coffer et al., 2023</a>)</span></p>
<p>While satellite remote sensing provides temporally consistent observations over large spatial scales, it is limited by several constraints. Satellite missions with a high temporal resolution (e.g.&nbsp;daily MODIS observation) are limited by a coarse spatial resolution (&gt;100m). Mission with a high spatial resolution such as Sentinel-2 (10m) or Landsat8/9 (30m) can be limited by low spectral resolution. The limited number of spectral bands is indeed a challenge to accurately discriminate seagrass from others co-existing macrophytes. In particular Chlorophyceae (green algae) and marine Magnoliopsida (seagrass) share the same pigment composition <span class="citation" data-cites="ralph2002 Douay2022">(<a href="#ref-ralph2002" role="doc-biblioref">Ralph et al., 2002</a> ; <a href="#ref-Douay2022" role="doc-biblioref">Douay et al., 2022</a>)</span>. As a result, their respective spectral signatures can be considered similar by a non-expert observer <span class="citation" data-cites="Davies2023 bannari2022">(<a href="#ref-Davies2023" role="doc-biblioref">Davies et al., 2023a</a> ; <a href="#ref-bannari2022" role="doc-biblioref">Bannari et al., 2022</a>)</span>. Recently, using advanced machine-learning algorithms trained with a large hyperspectral library of more then 300 field reflectance measurements, <span class="citation" data-cites="Davies2023">Davies et al. (<a href="#ref-Davies2023" role="doc-biblioref">2023a</a>)</span> demonstrated that it was possible to discriminate Magnoliopsida from Chlorophyceae using radiometric data acquired at Sentinel-2 ’s spectral resolution. The application of this approach to satellite remote sensing remains however to be validated. Moreover patches of green algae can develop at small spatial scales that are not observable using non-commercial satellite imagery <span class="citation" data-cites="tuya2013">(<a href="#ref-tuya2013" role="doc-biblioref">Tuya et al., 2013</a>)</span>, especially during the initial stage of the event.</p>
<p>Drone can potentially fill the gaps left by satellite remote sensing and in situ measurments, due to their ability to provide spatially-explicit observations at very high spatial resolutions (pixel size from cm to mm) and still capturing data at multi-spectral resolution <span class="citation" data-cites="fairley2022drone oh2017use">(<a href="#ref-fairley2022drone" role="doc-biblioref">Fairley et al., 2022</a> ; <a href="#ref-oh2017use" role="doc-biblioref">Oh et al., 2017</a>)</span>. The versatility of drones allows for their application across a diverse thematic range , from coastal zone management <span class="citation" data-cites="adade2021 casella2020 angnuureng2022">(<a href="#ref-adade2021" role="doc-biblioref">Adade et al., 2021</a> ; <a href="#ref-casella2020" role="doc-biblioref">Casella et al., 2020</a> ; <a href="#ref-angnuureng2022" role="doc-biblioref">Angnuureng et al., 2022</a>)</span> to mapping species distribution <span class="citation" data-cites="joyce2023 tallam2023 Roca2022 Roman2021 Brunier2022Topographic">(<a href="#ref-joyce2023" role="doc-biblioref">Joyce et al., 2023</a> ; <a href="#ref-tallam2023" role="doc-biblioref">Tallam et al., 2023</a> ; <a href="#ref-Roca2022" role="doc-biblioref">Roca et al., 2022</a> ; <a href="#ref-Roman2021" role="doc-biblioref">Román et al., 2021</a> ; <a href="#ref-Brunier2022Topographic" role="doc-biblioref">Brunier et al., 2022</a>)</span>. However, when applied to coastal habitat mapping, most sutdy cases were limited to a single flight, restricting the generalizability of their application over wider geographical scales <span class="citation" data-cites="Roman2021 collin2019improving rossiter2020uav Brunier2022Topographic">(<a href="#ref-Roman2021" role="doc-biblioref">Román et al., 2021</a> ; <a href="#ref-collin2019improving" role="doc-biblioref">Collin et al., 2019</a> ; <a href="#ref-rossiter2020uav" role="doc-biblioref">Rossiter et al., 2020</a> ; <a href="#ref-Brunier2022Topographic" role="doc-biblioref">Brunier et al., 2022</a>)</span>. The present study aimed at analyzing the potential of multispectral drone remote sensing to map intertidal macrophytes, with a particular focus on discriminating Magnoliopsida and Chlorophyceae. Ten drone flights were performed over soft-bottom intertidal areas along two European countries (France and Portugal), covering a wide range of habitats, from monospecific seagrass meadows to meadows mixed with green or red algae. A deep learning algorithm was trained and validated for macrophyte discrimination, emphasizing applicability across diverse sites without a loss of prediction accuracy.</p>
</section>
<section id="material-methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Material &amp; Methods</h1>
<section id="study-sites" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="study-sites"><span class="header-section-number">2.1</span> Study sites</h2>
<p>Seven study sites distributed between France and Portugal were selected for their relatively extensive intertidal seagrass beds. Two sites are located in Gulf of Morbihan (<a href="#fig-map" class="quarto-xref">Figure&nbsp;1</a> A), France (47.5791°N, 2.8018°W). This gulf covers an area of 115 km² and is only connect to the sea through a 900m wide channel. A total of 53 small islands are scattered across the gulf leading to 250 km of shorelines. Patchy seagrass meadows can be found on a lot of these islands. Within the Gulf of Morbihan we have chosen two sites : one is located in one of these island (Arz island); the other one is located in the sourthern part of the gulf (Duer). Two others sites are located in Bourgneuf Bay, France (46.9849°N, 2.1488°W). This bay is a semi-enclosed macrotidal bay, protected from waves by Noirmoutier Island. Bougneuf bay hosts a large intertidal seagrass meadow of about 6 km². Within this meadow, the sites observed by drones (L’Epine and Barbatre, <a href="#fig-map" class="quarto-xref">Figure&nbsp;1</a> B) contain a monospecific bed of <em>Zostera noltei</em> with very little mixing with other macrophytes. Three sites have been surveyed in the Ria de Aveiro Lagoon in Portugal (40.6887°N, 8.6810°W). The extent of this lagoon is about 80 km² with many narrow channels, large salt marshes and many mudflats that uncovers at low tide. It is connected to the open sea through a single channel, with a tidal lag between the North and the South of the lagoon. The southernmost site (Gafanha) is a mudflat located in an affluent of the lagoon whereas the two other sites are situated in the middle of the lagoon and are only accessible by boat (<a href="#fig-map" class="quarto-xref">Figure&nbsp;1</a> C). These Portuguese sites are characterized by a more diverse intertidal vegetation, where patches of seagrass could intermingle with red algae (Rhodophyceae), brown algae (Phaeophyceae), and green algae (Chlorophyceae).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>world_map <span class="ot">&lt;-</span> sovereignty10 <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(SOVEREIGNT<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"Spain"</span>,<span class="st">"France"</span>,<span class="st">"Portugal"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Italy"</span>,<span class="st">"Andorra"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"United Kingdom"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Switzerland"</span>,<span class="st">"Belgium"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Germany"</span>,<span class="st">"Luxembourg"</span>) ) </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>bbox_europe <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">ymin =</span> <span class="dv">34</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymax =</span> <span class="dv">55</span>) ,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(world_map) ) </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>world_map<span class="ot">&lt;-</span><span class="fu">st_make_valid</span>(world_map) </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>european_union_map_cropped <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(world_map, bbox_europe)  <span class="sc">%&gt;%</span> </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>)  </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>UnitedKingdom<span class="ot">&lt;-</span>sovereignty10 <span class="sc">%&gt;%</span> </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(SOVEREIGNT<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"United Kingdom"</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>bbox_UK <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">ymin =</span> <span class="dv">45</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymax =</span> <span class="dv">55</span>) ,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(UnitedKingdom) ) </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>UnitedKingdom<span class="ot">&lt;-</span><span class="fu">st_make_valid</span>(UnitedKingdom) </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>UK_map_cropped <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(UnitedKingdom, bbox_UK)  <span class="sc">%&gt;%</span> </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>) </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>Europe_sf<span class="ot">&lt;-</span>european_union_map_cropped <span class="sc">%&gt;%</span> </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(UK_map_cropped) </span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>Projects<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Portugal - Aveiro Lagoon Flights</span><span class="sc">\n</span><span class="st">Lower-Resolution: 4</span><span class="sc">\n</span><span class="st">Higher-Resolution: 1"</span>,</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"France - Morbihan Gulf Flights</span><span class="sc">\n</span><span class="st">Lower-Resolution: 3</span><span class="sc">\n</span><span class="st">Higher-Resolution: 3"</span>,</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"France - Bourgneuf Bay Flights</span><span class="sc">\n</span><span class="st">Lower-Resolution: 4</span><span class="sc">\n</span><span class="st">Higher-Resolution: 0"</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.745730</span>,</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">2.840592</span>, </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">2.111868</span>) ,</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">40.617610</span>, </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>        <span class="fl">47.578736</span>,</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>        <span class="fl">47.024719</span>) </span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>)  </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>Projects_df<span class="ot">&lt;-</span>Projects <span class="sc">%&gt;%</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Name, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"Country"</span>,<span class="st">"Bay"</span>) ,<span class="at">sep=</span><span class="st">" - "</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Country=</span><span class="fu">as.factor</span>(Country) ,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">Bay=</span><span class="fu">as.factor</span>(Bay) ) </span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>Miniworld_map <span class="ot">&lt;-</span> sovereignty10 <span class="sc">%&gt;%</span> </span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>bbox_EU <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">30</span>, <span class="at">ymin =</span> <span class="dv">20</span>,</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmax =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">70</span>) ,</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(Miniworld_map) ) </span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>  MiniEU_map<span class="ot">&lt;-</span><span class="fu">st_crop</span>(Miniworld_map, bbox_EU)  <span class="sc">%&gt;%</span> </span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>)  </span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  df_P1<span class="ot">&lt;-</span>Projects_df <span class="sc">%&gt;%</span> </span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Site =</span> <span class="fu">case_when</span>(ID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Aveiro Lagoon"</span>,</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>                            ID <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Morbihan Gulf"</span>,</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>                            ID <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Bourgneuf Bay"</span>,</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>           <span class="at">ID =</span> <span class="fu">case_when</span>(ID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"C"</span>,</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>                          ID <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"A"</span>,</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"B"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(lon,lat,ID,Site))</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    scaleFUN <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x),<span class="st">"°N"</span>)</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>p1  <span class="ot">&lt;-</span></span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(MiniEU_map) <span class="sc">+</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">linewidth=</span><span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill=</span><span class="st">"#CFCFCF"</span>,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>    ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>df_P1,</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> ID,</span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>                     <span class="at">description=</span>Site) ,</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth=</span><span class="fl">0.3</span>,</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"goldenrod"</span>,</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">20</span>),</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>)<span class="sc">+</span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2600000</span>,<span class="dv">4100000</span>) ,</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">1600000</span>,<span class="dv">3100000</span>))<span class="sc">+</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scaleFUN)<span class="sc">+</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>),</span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>) )</span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure1/Map_Drone_Sites.png"</span>,p1,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mask_aveiro <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_Aveiro"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>Flight_aveiro<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gafanha"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mataducos"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Marinha Lanzarote"</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(<span class="st">"12m and 120m Flights"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"120m Flight"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"120m Flight"</span>),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.742485</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">8.646980</span>, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">8.690677</span>) ,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">40.597599</span>, </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">40.666634</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">40.665120</span>) </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_aveiro))  <span class="sc">%&gt;%</span> </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>aveiro_plot <span class="ot">&lt;-</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>),</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>))<span class="sc">+</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_aveiro, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),<span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">519749</span>,<span class="dv">535233</span>) ,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">4493310</span>,<span class="dv">4508794</span>) )<span class="sc">+</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_aveiro,</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">25</span>,</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_void()+</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">521000</span>, <span class="at">y =</span> <span class="dv">4507794</span>, <span class="at">label =</span> <span class="st">"C"</span>), <span class="at">size =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.70</span>, <span class="sc">-</span><span class="fl">8.60</span>, <span class="at">by =</span> <span class="fl">0.10</span>))<span class="sc">+</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>) ,</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure1/Map_Aveiro.png"</span>,aveiro_plot,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mask_BB <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_BB"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Flight_BB<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Barbâtre"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"L'Epine"</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(<span class="st">"120m Flight"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"120m Flight"</span>),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.166313</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">2.228239</span>) ,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">46.956420</span>, </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">46.989515</span>) </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_BB))  <span class="sc">%&gt;%</span> </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>BB_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>))<span class="sc">+</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_BB, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),<span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">550609</span>,<span class="dv">579539</span>) ,</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">5189447</span>,<span class="dv">5218377</span>) )<span class="sc">+</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_BB,</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">25</span>,</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">553460</span>, <span class="at">y =</span> <span class="dv">5216442</span>, <span class="at">label =</span> <span class="st">"B"</span>), <span class="at">size =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>) ,</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.2</span>),</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span>  <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, </span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linetype=</span><span class="st">"solid"</span>, </span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">colour =</span><span class="st">"black"</span>),</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Figure1/Map_BB.png"</span>,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mask_Morb <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_Morbihan"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>Flight_Morbihan<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Arz"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Duer"</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(<span class="st">"12m Flight"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"12m and 120m Flight"</span>),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.795961</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">2.746186</span>) ,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">47.603260</span>, </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">47.543877</span>) </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_Morb))  <span class="sc">%&gt;%</span> </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>Morbihan_plot<span class="ot">&lt;-</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land mask"</span>),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>))<span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_Morb, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),<span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">503019</span>,<span class="dv">526177</span>) ,</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">5257824</span>,<span class="dv">5280982</span>))<span class="sc">+</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_Morbihan,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">25</span>,</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">505000</span>, <span class="at">y =</span> <span class="dv">5280982-1981</span>, <span class="at">label =</span> <span class="st">"A"</span>), <span class="at">size =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="fl">2.6</span>, <span class="at">by =</span> <span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>),</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Figure1/Map_Morbihan.png"</span>,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">20</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">11</span>, <span class="at">l =</span> <span class="dv">11</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(layout)</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Tot <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_ggplot</span>(magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">"Figures/Figure1/Map_Drone_Sites.png"</span>), <span class="at">interpolate =</span> T)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>BB <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_ggplot</span>(magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">"Figures/Figure1/Map_BB.png"</span>), <span class="at">interpolate =</span> T)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>Mor <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_ggplot</span>(magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">"Figures/Figure1/Map_Morbihan.png"</span>), <span class="at">interpolate =</span> T)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>Av <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_ggplot</span>(magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">"Figures/Figure1/Map_Aveiro.png"</span>), <span class="at">interpolate =</span> T)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span>Tot<span class="sc">+</span>Mor<span class="sc">+</span>BB<span class="sc">+</span>Av<span class="sc">+</span>patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">design=</span>layout)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"./Figures/Fig1_Map_Drone_Sites.png"</span>,a, <span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div id="cell-fig-map" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Fig1_Map_Drone_Sites.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-map" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Fig1_Map_Drone_Sites.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="./Figures/Fig1_Map_Drone_Sites.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Sites observed by drone. A: Gulf of Morbihan, B: Bourngeuf Bay, C: Ria de Aveiro Lagoon. Light green represent terrestrial areas whereas darkgreen represent intertidal areas.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="drone-data" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="drone-data"><span class="header-section-number">2.2</span> Drone Data</h2>
<p>At each location, a DJI Matrice 200 quadcopter drone equipped with a Micasense RedEdge Dual MX multispectral camera was flown to take 1.2 million pixel reflectance photographs in 10 spectral bands, from 444 nm (blue) to 840 nm (near infrared, NIR). An angle of 90° was maintained between the sun and the drone’s route to guarantee uniform lighting conditions between flight lines. A side overlap of 70% and a front overlap of 80% between each imagewas set for each flight. A downwelling light sensor (DLS2) was used to acquire irradiance data concomitantly with the camera measurements. Raw data were calibrated in reflectance using a calibration panel reflective at ~50% provided by the manufacturer. A structure-from-motion photogrammetry software (Agisoft Metashape) was used to process images to obtain multispectral orthomosaics of each flight. The workflow for orthomosaicking was the same for every flight. First, tying key points were detected inside of each image and between overlapping images in order to obtain a sparse point cloud. This cloud was cleaned using reprojection accuracy metric in order to remove noisy points. A dense point cloud was then produced using a structure from motion algorithm. A surface interpolation of this dense point cloud was made to obtain a digital surface model (DSM), used to reconstruct the multispectral ortho-image. Across all sites, flights were made at two different altitudes : 12 m or/and 120 m. Low altitude drone flights produce ortho-images with a very high spatial resolution (8 mm per pixel), making it simple to visually distinguish between the various types of vegetation. High altitude fights on the other hand allow to cover large areas and produced images with a pixel size of 80 mm (Table 1).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Country =</span> <span class="fu">c</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"France"</span>,<span class="dv">5</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Portugal"</span>,<span class="dv">4</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Site =</span> <span class="fu">c</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Morbihan"</span>,<span class="dv">3</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Bourgneuf Bay"</span>,<span class="dv">2</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Aveiro Lagoon"</span>,<span class="dv">4</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Arz Island"</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Duer"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Duer"</span>,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Barbâtre"</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L'Epine"</span>,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Inner Lagoon"</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mataducos"</span>,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gafanha"</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gafanha"</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Altitude =</span> <span class="fu">c</span>(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12m"</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12m"</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"120m"</span>,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"120m"</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"120m"</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"120m"</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"120m"</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"120m"</span>,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"12m"</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Utility =</span> <span class="fu">c</span>(</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Training"</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Training"</span>,</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Validation"</span>,</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Validation"</span>,</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Validation"</span>,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Validation"</span>,</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Validation"</span>,</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Validation"</span>,</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Training"</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>brdr1 <span class="ot">&lt;-</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">1.5</span>)</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>brdr2 <span class="ot">&lt;-</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">width =</span> <span class="fl">1.5</span>)</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>brdr3 <span class="ot">&lt;-</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"grey40"</span>, <span class="at">width =</span> <span class="fl">1.5</span>)</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(df)  <span class="sc">%&gt;%</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">j =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">j =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_top</span>(<span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">5</span>, <span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">1</span>,<span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">2</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">3</span>, <span class="at">j =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">border=</span>brdr3) <span class="sc">%&gt;%</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">4</span>, <span class="at">j =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">6</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">6</span>, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">7</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">8</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">9</span>, <span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vline</span>(<span class="at">j=</span><span class="dv">2</span>, <span class="at">border =</span> brdr1) <span class="sc">%&gt;%</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>,<span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>,<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set_caption(caption = "Table 1 List of drone Flight, summarising the date, the altitude and the purpose of each flight.") %&gt;%</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-020cc1b4{table-layout:auto;}.cl-020296b2{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0206926c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0206b058{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b059{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b062{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b06c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b06d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b076{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b077{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b080{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b081{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b08a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b08b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b094{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b09e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b09f{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0a8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0a9{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0aa{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0b2{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0b3{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0da{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0db{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0dc{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 1.5pt solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0e4{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0ee{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0ef{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(190, 190, 190, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0206b0f8{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(190, 190, 190, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1.5pt solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-020cc1b4"><caption><p>List of drone flight, summarising the date, the altitude and the
purpose of each flight.</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-0206b058"><p class="cl-0206926c"><span class="cl-020296b2">Country</span></p></th><th class="cl-0206b059"><p class="cl-0206926c"><span class="cl-020296b2">Site</span></p></th><th class="cl-0206b062"><p class="cl-0206926c"><span class="cl-020296b2">Name</span></p></th><th class="cl-0206b058"><p class="cl-0206926c"><span class="cl-020296b2">Altitude</span></p></th><th class="cl-0206b058"><p class="cl-0206926c"><span class="cl-020296b2">Utility</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td rowspan="5" class="cl-0206b06c"><p class="cl-0206926c"><span class="cl-020296b2">France</span></p></td><td rowspan="3" class="cl-0206b06d"><p class="cl-0206926c"><span class="cl-020296b2">Morbihan</span></p></td><td class="cl-0206b076"><p class="cl-0206926c"><span class="cl-020296b2">Arz Island</span></p></td><td class="cl-0206b077"><p class="cl-0206926c"><span class="cl-020296b2">12m</span></p></td><td class="cl-0206b077"><p class="cl-0206926c"><span class="cl-020296b2">Training</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0206b081"><p class="cl-0206926c"><span class="cl-020296b2">Duer</span></p></td><td class="cl-0206b08a"><p class="cl-0206926c"><span class="cl-020296b2">12m</span></p></td><td class="cl-0206b08a"><p class="cl-0206926c"><span class="cl-020296b2">Training</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0206b09e"><p class="cl-0206926c"><span class="cl-020296b2">Duer</span></p></td><td class="cl-0206b09f"><p class="cl-0206926c"><span class="cl-020296b2">120m</span></p></td><td class="cl-0206b09f"><p class="cl-0206926c"><span class="cl-020296b2">Validation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="2" class="cl-0206b0a8"><p class="cl-0206926c"><span class="cl-020296b2">Bourgneuf Bay</span></p></td><td class="cl-0206b0a9"><p class="cl-0206926c"><span class="cl-020296b2">Barbâtre</span></p></td><td class="cl-0206b0aa"><p class="cl-0206926c"><span class="cl-020296b2">120m</span></p></td><td class="cl-0206b0aa"><p class="cl-0206926c"><span class="cl-020296b2">Validation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0206b0b2"><p class="cl-0206926c"><span class="cl-020296b2">L'Epine</span></p></td><td class="cl-0206b0b3"><p class="cl-0206926c"><span class="cl-020296b2">120m</span></p></td><td class="cl-0206b0b3"><p class="cl-0206926c"><span class="cl-020296b2">Validation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td rowspan="4" class="cl-0206b0da"><p class="cl-0206926c"><span class="cl-020296b2">Portugal</span></p></td><td rowspan="4" class="cl-0206b0db"><p class="cl-0206926c"><span class="cl-020296b2">Aveiro Lagoon</span></p></td><td class="cl-0206b0dc"><p class="cl-0206926c"><span class="cl-020296b2">Inner Lagoon</span></p></td><td class="cl-0206b0e4"><p class="cl-0206926c"><span class="cl-020296b2">120m</span></p></td><td class="cl-0206b0e4"><p class="cl-0206926c"><span class="cl-020296b2">Validation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0206b081"><p class="cl-0206926c"><span class="cl-020296b2">Mataducos</span></p></td><td class="cl-0206b08a"><p class="cl-0206926c"><span class="cl-020296b2">120m</span></p></td><td class="cl-0206b08a"><p class="cl-0206926c"><span class="cl-020296b2">Validation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0206b081"><p class="cl-0206926c"><span class="cl-020296b2">Gafanha</span></p></td><td class="cl-0206b08a"><p class="cl-0206926c"><span class="cl-020296b2">120m</span></p></td><td class="cl-0206b08a"><p class="cl-0206926c"><span class="cl-020296b2">Validation</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0206b0b2"><p class="cl-0206926c"><span class="cl-020296b2">Gafanha</span></p></td><td class="cl-0206b0b3"><p class="cl-0206926c"><span class="cl-020296b2">12m</span></p></td><td class="cl-0206b0b3"><p class="cl-0206926c"><span class="cl-020296b2">Training</span></p></td></tr></tbody></table></div>
</div>
</div></div>
</section>
<section id="field-sampling" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="field-sampling"><span class="header-section-number">2.3</span> Field sampling</h2>
<p>Before each flight, targets used as Ground Control Points (GCPs) were distributed over the study site and georeferenced with a Trimble © Geo XH 6000 differential GPS (dGPS). GCPs were used to correct georeferencing imprecision of orthomosaics with an horizontal and vertical accuracy of 10cm. dGPS was also used to georeference quadrats of 0.25cm² used to assess the presence or absence of 5 key classes of vegetation : Bacillariophyceae (Benthic diatoms forming large biofilm over the sediment during low tide), Phaeophyceae (brown algae), Magnoliopsida (seagrass), Chlorophyceae (green algae) and Rhodophyceae (red algae) (<a href="#fig-vegetation" class="quarto-xref">Figure&nbsp;2</a>). Pictures of each quadrat were uploaded on the online on the Global Biodiversity Information Facility (GBIF) platform <span class="citation" data-cites="BedeGbif">(<a href="#ref-BedeGbif" role="doc-biblioref">Davies et al., 2023b</a>)</span>, a public open portal to store and share biodiversity data. Each photograph was also processed to estimate the percent cover of each type of vegetation using an image processing software (imageJ). For all quadrat, the hyperspectral reflectance signatures of each vegetation class was measured using an ASD FieldSpec HandHeld 2 spectroradiometer, which acquires reflectance between 325 and 1075 nm, with 1 nm of spectral resolution. The methodological scheme followed in this study is presented in <a href="#fig-workflow" class="quarto-xref">Figure&nbsp;3</a>.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>micasense<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">"Wavelength_Micasense_DualMX.csv"</span>,<span class="at">recursive =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.delim</span>(<span class="at">sep =</span> <span class="st">";"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>imglist<span class="ot">&lt;-</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">path =</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folder =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Data"</span>) <span class="sc">~</span> <span class="st">"Input"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Output"</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"High"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"low"</span>),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Gafanha"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"Arz"</span>) <span class="sc">~</span> <span class="st">"Arz"</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Duer"</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"NDVI"</span>) <span class="sc">~</span> <span class="st">"NDVI"</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"Pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"ortho"</span>),</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">resampled =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"resampled"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"corrected_per_bands"</span>) <span class="sc">~</span> <span class="st">"Bands"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"corrected.tif"</span>) <span class="sc">~</span> <span class="st">"lm_all"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(alt <span class="sc">!=</span> <span class="st">"NA"</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".xml"</span>),</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".enp"</span>))</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>gaf_low_multi<span class="ot">&lt;-</span> imglist <span class="sc">%&gt;%</span> </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>         alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>         type <span class="sc">==</span> <span class="st">"ortho"</span>,</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>         resampled <span class="sc">==</span> <span class="st">"FALSE"</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>         folder <span class="sc">==</span> <span class="st">"Input"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() </span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(gaf_low_multi)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"B"</span>,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)))</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a> Gafanha_low_pred<span class="ot">&lt;-</span><span class="st">"./Data/image/prediction/NewPreds/AveiroLowPrediction_nnNewStanRawMetrics_Preds_NoXantho_7.tif"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>     <span class="fu">rast</span>()</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(Gafanha_low_pred)<span class="ot">&lt;-</span><span class="st">"pred"</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="co"># arz_multi&lt;- imglist %&gt;% </span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(site == "Arz", </span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="co">#          type == "ortho") %&gt;% </span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1) %&gt;% </span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   pull(path) %&gt;% </span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   rast()</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  names(arz_multi)&lt;-c(paste0("B",c(1:10)))</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="co"># arz_pred&lt;- imglist %&gt;% </span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(site == "Arz", </span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a><span class="co">#          type == "Pred",</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a><span class="co">#          str_detect(path, "7by7")) %&gt;% </span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice(1) %&gt;% </span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   pull(path) %&gt;% </span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   rast()</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a><span class="co">#  names(arz_pred)&lt;-"pred"</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>gaf<span class="ot">&lt;-</span><span class="fu">rast</span>(<span class="fu">list</span>(gaf_low_multi,Gafanha_low_pred)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="at">xy =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  dtplyr<span class="sc">::</span><span class="fu">lazy_dt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(B1 <span class="sc">!=</span> <span class="dv">65535</span>,</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>                pred <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Class =</span> <span class="st">"pred"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pxl_ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,pxl_ID), <span class="at">names_to =</span> <span class="st">"band"</span>,<span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(micasense, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"band"</span> <span class="ot">=</span> <span class="st">"Band_ID"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Class, Wavelength) <span class="sc">%&gt;%</span> </span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> <span class="fu">sd</span>(value),</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>                   <span class="at">max =</span> <span class="fu">max</span>(value),</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>                   <span class="at">min =</span> <span class="fu">min</span>(value),</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>                   <span class="at">median =</span> <span class="fu">median</span>(value)) <span class="sc">%&gt;%</span>  </span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"D - Chloropyceae"</span>,</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"A - MagnoliopsidaL"</span>,</span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"E - Microphytobenthos"</span>,</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"A - Magnoliopsida"</span>,</span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"B - Phaeophyceae"</span>,</span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"C - Rhodophyceae"</span>,</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Water"</span>,</span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>                              Class <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>))</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a>spectra<span class="ot">&lt;-</span>gaf <span class="sc">%&gt;%</span> </span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">!=</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"A - MagnoliopsidaL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Wavelength, <span class="at">y =</span> mean<span class="sc">/</span><span class="dv">10000</span>, <span class="at">color =</span> Class))<span class="sc">+</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#389318"</span>, <span class="st">"#873e23"</span>, <span class="st">"#b3002d"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>))<span class="sc">+</span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Reflectance"</span>)<span class="sc">+</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wavelength (nm)"</span>)<span class="sc">+</span></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>),</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="at">alpha=</span><span class="dv">0</span>), <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"black"</span>))</span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Spectral_shapes.png"</span>,spectra, <span class="at">bg =</span> <span class="st">"transparent"</span>,  <span class="at">height =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">dpi =</span> <span class="dv">2000</span>)</span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">image_ggplot</span>(magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">"Figures/Spectral_shapes.png"</span>), <span class="at">interpolate =</span> T)</span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a><span class="co"># sp&lt;-ggplot()+</span></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster_rgb(data = rast("Figures/Spectral_shapes.png"),maxcell = 4009008)+</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_equal()+</span></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_void()+</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text = element_blank(), </span></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.title = element_blank(), </span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks = element_blank(),</span></span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.background = element_rect(fill='transparent'),</span></span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.background = element_rect(fill='transparent', color=NA),</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks.length = unit(0, "pt"),</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.grid.major=element_blank(), </span></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.grid.minor=element_blank(), </span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = margin(0, 0, 0, 0, "pt"))</span></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Magno &lt;- magick::image_read("Data/Pictures/Figure2/Magnoliopsida_cropped2.png")%&gt;%</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a><span class="co">#   # magick::image_rotate(90)%&gt;%</span></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a><span class="co">#   grid::rasterGrob()</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Brown &lt;- magick::image_read("Data/Pictures/Figure2/Phaeophyceae_cropped.png")%&gt;%</span></span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a><span class="co">#   grid::rasterGrob()</span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Red &lt;- magick::image_read("Data/Pictures/Figure2/Rhodophyceae_cropped.png")%&gt;% </span></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a><span class="co">#   grid::rasterGrob()</span></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a><span class="co"># green &lt;- magick::image_read("Data/Pictures/Figure2/Chlorophyceae_cropped.png")%&gt;% </span></span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a><span class="co">#   grid::rasterGrob()</span></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a><span class="co"># MPB &lt;- magick::image_read("Data/Pictures/Figure2/Bacillariophyceae_cropped.png")%&gt;% </span></span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a><span class="co">#   grid::rasterGrob()</span></span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Lines&lt;-data.frame(x=c(10,20,10),</span></span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a><span class="co">#                   y=c(-0.1,-0.1,10),</span></span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a><span class="co">#                   xend=c(10,20,30),</span></span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a><span class="co">#                   yend=c(20,20,10))</span></span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a><span class="co"># labels&lt;-data.frame(name = c("A","B","C","D","E"),</span></span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a><span class="co">#                    x= c(1,11,21,11,21),</span></span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a><span class="co">#                    y=c(19,19,19,1,1))</span></span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a><span class="co"># a&lt;-ggplot(expand_grid(x = 0:30,y=0:20),aes(x = x, y = y) ) +</span></span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(alpha=0) +</span></span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_fixed()+</span></span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(Magno, 0,10, 0, 20) +</span></span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(green, 10,20, 10, 20)+</span></span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(Red, 10,20, 0, 10)+</span></span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(Brown, 20,30, 10, 20)+</span></span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(MPB, 20,30, 0,10)+</span></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(data=Lines,aes(x=x,y=y,xend=xend,yend=yend),</span></span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a><span class="co">#                colour="white",linewidth=2)+</span></span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(ggplotGrob(spectra), 5,25, 5,15)+</span></span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_label(data=labels,aes(x=x,y=y,label=name), size = 10)+</span></span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.title.x = element_blank(),</span></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.title.y = element_blank(),</span></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.text.x = element_blank(),</span></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.text.y = element_blank(),</span></span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks.x = element_blank(),</span></span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks.y = element_blank(),</span></span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = grid::unit(c(0.01,0.01,0.01,0.01), "mm"),</span></span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a><span class="co">#         # rect = element_blank(),</span></span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.margin = grid::unit(c(0.01, 0.01, 0.01, 0.01), "mm"))</span></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Lines1&lt;-data.frame(x=c(0,10,20,30),</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a><span class="co">#                   y=c(10,0,0,0),</span></span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a><span class="co">#                   xend=c(40.1,10,20,30),</span></span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a><span class="co">#                   yend=c(10,10,10,10))</span></span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a><span class="co"># labels1&lt;-data.frame(name = c("A","B","C","D","E"),</span></span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a><span class="co">#                    x= c(1,1,11,21,31),</span></span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a><span class="co">#                    y=c(29,9,9,9,9))</span></span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(expand_grid(x = 0:40,y=0:30),aes(x = x, y = y) ) +</span></span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(alpha=0) +</span></span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_fixed()+</span></span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(Magno, 0,10, 10, 30) +</span></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(Brown, 0,10, 0, 10)+</span></span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(Red, 10,20, 0, 10)+</span></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(green, 20,30, 0, 10)+</span></span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(MPB, 30,40, 0,10)+</span></span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_segment(data=Lines1,aes(x=x,y=y,xend=xend,yend=yend),</span></span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a><span class="co">#                colour="white",linewidth=2)+</span></span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot2::annotation_custom(ggplotGrob(spectra), 10,40, 10,30)+</span></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_label(data=labels1,aes(x=x,y=y,label=name), size = 10)+</span></span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.title.x = element_blank(),</span></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.title.y = element_blank(),</span></span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.text.x = element_blank(),</span></span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.text.y = element_blank(),</span></span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks.x = element_blank(),</span></span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.ticks.y = element_blank(),</span></span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = grid::unit(c(0.01,0.01,0.01,0.01), "mm"),</span></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a><span class="co">#         # rect = element_blank(),</span></span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a><span class="co">#         panel.margin = grid::unit(c(0.01, 0.01, 0.01, 0.01), "mm"),</span></span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.text.align = 0)</span></span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a>Magno<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> <span class="fu">rast</span>(<span class="st">"Data/Pictures/Figure2/Magnoliopsida_cropped2.png"</span>))<span class="sc">+</span></span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()<span class="sc">+</span></span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">50</span>,<span class="at">y=</span> <span class="dv">950</span>, <span class="at">label =</span> <span class="st">"A"</span>))<span class="sc">+</span></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>),</span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a>Brown<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> <span class="fu">rast</span>(<span class="st">"Data/Pictures/Figure2/Pheophyceae_cropped.png"</span>))<span class="sc">+</span></span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()<span class="sc">+</span></span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">50</span>,<span class="at">y=</span><span class="dv">450</span>, <span class="at">label =</span> <span class="st">"B"</span>))<span class="sc">+</span></span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>),</span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(),</span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(),</span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a>Red <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> <span class="fu">rast</span>(<span class="st">"Data/Pictures/Figure2/Rodophyceae_cropped.png"</span>))<span class="sc">+</span></span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()<span class="sc">+</span></span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">50</span>,<span class="at">y=</span><span class="dv">450</span>, <span class="at">label =</span> <span class="st">"C"</span>))<span class="sc">+</span></span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>),</span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a>green <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> <span class="fu">rast</span>(<span class="st">"Data/Pictures/Figure2/Chlorophyceae_cropped.png"</span>))<span class="sc">+</span></span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()<span class="sc">+</span></span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">50</span>,<span class="at">y=</span><span class="dv">450</span>, <span class="at">label =</span> <span class="st">"D"</span>))<span class="sc">+</span></span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>),</span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a>MPB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> <span class="fu">rast</span>(<span class="st">"Data/Pictures/Figure2/Bacillariophyceae_cropped.png"</span>))<span class="sc">+</span></span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()<span class="sc">+</span></span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">50</span>,<span class="at">y=</span><span class="dv">450</span>, <span class="at">label =</span> <span class="st">"E"</span>))<span class="sc">+</span></span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"pt"</span>),</span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>(), </span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="st">"pt"</span>))</span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">30</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">20</span>),</span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">30</span>),</span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">30</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">40</span>),</span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">30</span>, <span class="at">r =</span> <span class="dv">40</span>)</span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb36-295"><a href="#cb36-295" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">29</span>, <span class="at">r =</span> <span class="dv">10</span>),</span>
<span id="cb36-296"><a href="#cb36-296" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">29</span>, <span class="at">r =</span> <span class="dv">18</span>),</span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">17</span>, <span class="at">b =</span> <span class="dv">29</span>, <span class="at">r =</span> <span class="dv">26</span>),</span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">l =</span> <span class="dv">25</span>, <span class="at">b =</span> <span class="dv">29</span>, <span class="at">r =</span> <span class="dv">34</span>),</span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a>    patchwork<span class="sc">::</span><span class="fu">area</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">9</span>, <span class="at">b =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">34</span>)</span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(layout1)</span></span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a>plot<span class="ot">&lt;-</span>Magno<span class="sc">+</span></span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a>  Brown<span class="sc">+</span></span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a>  Red<span class="sc">+</span></span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a>  green<span class="sc">+</span></span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a>  MPB<span class="sc">+</span></span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a>  sp<span class="sc">+</span></span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">design=</span>layout1)</span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Spectral_shapes_total.png"</span>,plot, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div id="cell-fig-vegetation" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"Figures/Spectral_shapes_total.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-vegetation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vegetation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="Figures/Spectral_shapes_total.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="Figures/Spectral_shapes_total.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vegetation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Class of vegetation used to train the Neural Network model and their standardised spectral signature
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="intertidal-vegetation-mapping" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="intertidal-vegetation-mapping"><span class="header-section-number">2.4</span> Intertidal vegetation mapping</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>layout<span class="ot">&lt;-</span><span class="st">"Data/Figure2_Workflow"</span> <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">"V4.txt"</span>,<span class="at">full.names =</span> T, <span class="at">recursive =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(<span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Evaluate <span class="sc">==</span> T)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>layout<span class="sc">$</span>Text<span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"alaligne"</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, layout<span class="sc">$</span>Text)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>boxes<span class="ot">&lt;-</span> layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Box"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                shape <span class="sc">==</span> <span class="st">"square"</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>text<span class="ot">&lt;-</span> layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Box"</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>diamonds<span class="ot">&lt;-</span> layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Box"</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                shape <span class="sc">==</span> <span class="st">"diamond"</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(diamonds)) {</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  diam_a<span class="ot">&lt;-</span>diamonds[i,]</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(  </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(diam_a<span class="sc">$</span>xmin <span class="sc">-</span> diff, diam_a<span class="sc">$</span>xmin <span class="sc">+</span> diff, diam_a<span class="sc">$</span>xmax <span class="sc">+</span> diff, diam_a<span class="sc">$</span>xmax <span class="sc">-</span> diff),</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(diam_a<span class="sc">$</span>ymin, diam_a<span class="sc">$</span>ymax, diam_a<span class="sc">$</span>ymax, diam_a<span class="sc">$</span>ymin),</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="fu">rep</span>(diam_a<span class="sc">$</span>Type,<span class="dv">4</span>),</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Text =</span> <span class="fu">rep</span>(diam_a<span class="sc">$</span>Text,<span class="dv">4</span>),</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">rep</span>(diam_a<span class="sc">$</span>color,<span class="dv">4</span>),</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Evaluate =</span> <span class="fu">rep</span>(diam_a<span class="sc">$</span>Evaluate,<span class="dv">4</span>),</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Resolution =</span>  <span class="fu">rep</span>(diam_a<span class="sc">$</span>Resolution,<span class="dv">4</span>),</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Evaluate_bigbox =</span> <span class="fu">rep</span>(diam_a<span class="sc">$</span>Evaluate_bigbox,<span class="dv">4</span>),</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">rep</span>(diam_a<span class="sc">$</span>alpha,<span class="dv">4</span>),</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span>  <span class="fu">rep</span>(diam_a<span class="sc">$</span>shape,<span class="dv">4</span>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    diamond_list<span class="ot">&lt;-</span><span class="fu">list</span>(df)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    diamond_list[[i]]<span class="ot">&lt;-</span>df</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>Arrows<span class="ot">&lt;-</span> layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Arrow"</span>,</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>                Evaluate <span class="sc">==</span> T)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>Group_box<span class="ot">&lt;-</span>layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Box"</span>,</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>                Evaluate_bigbox <span class="sc">==</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">%&gt;%</span> </span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">xmin =</span> <span class="fu">min</span>(xmin)<span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xmax =</span> <span class="fu">max</span>(xmax)<span class="sc">+</span><span class="fl">0.1</span>,</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymin =</span> <span class="fu">min</span>(ymin)<span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> <span class="fu">max</span>(ymax)<span class="sc">+</span><span class="fl">0.1</span>,</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> color)</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>resolution_box<span class="ot">&lt;-</span>layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Box"</span>,</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>                Resolution <span class="sc">!=</span> <span class="st">"NA"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Resolution) <span class="sc">%&gt;%</span> </span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">xmin =</span> <span class="fu">min</span>(xmin)<span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xmax =</span> <span class="fu">max</span>(xmax)<span class="sc">+</span><span class="fl">0.1</span>,</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymin =</span> <span class="fu">min</span>(ymin)<span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ymax =</span> <span class="fu">max</span>(ymax)<span class="sc">+</span><span class="fl">0.1</span>,</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> color)</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>legend <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">color =</span> <span class="fu">unique</span>(layout<span class="sc">$</span>color)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(color)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_when</span>(color <span class="sc">==</span> <span class="st">"#EA6155"</span> <span class="sc">~</span> <span class="st">"Input Data"</span>,</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>                           color <span class="sc">==</span> <span class="st">"#DC9614"</span> <span class="sc">~</span> <span class="st">"Pre-processing"</span>,</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>                           color <span class="sc">==</span> <span class="st">"#52A4DA"</span> <span class="sc">~</span> <span class="st">"Model Building"</span>,</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>                           color <span class="sc">==</span> <span class="st">"#79DA52"</span> <span class="sc">~</span> <span class="st">"Validation"</span>,</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>                           color <span class="sc">==</span> <span class="st">"#DA9652"</span> <span class="sc">~</span> <span class="st">"Output Data"</span>,</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>                           color <span class="sc">==</span> <span class="st">"darkcyan"</span> <span class="sc">~</span> <span class="st">"Final Product"</span>,</span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>                           color <span class="sc">==</span> <span class="st">"#DA5273"</span>  <span class="sc">~</span> <span class="st">"Prediction"</span>,</span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>  arrange</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>segment<span class="ot">&lt;-</span>layout <span class="sc">%&gt;%</span> </span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Segment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>building <span class="ot">&lt;-</span> F</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(building <span class="sc">==</span> T){</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>text_size <span class="ot">=</span> <span class="dv">6</span> <span class="do">#### 6 to plot it fullscreen in R,  1.8 for exporting with ggsave</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>line_size <span class="ot">=</span><span class="dv">1</span> <span class="do">####arrow_size 0.3 to export  1 to for R plotting</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>legend_size <span class="ot">=</span> <span class="dv">1</span> <span class="do">#### 0.3 to export, 1 for R ploting</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>legend_text <span class="ot">=</span> <span class="dv">10</span> <span class="do">#### 4 to export, 10 for R ploting</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>text_size <span class="ot">=</span> <span class="fl">1.85</span> <span class="do">#### 6 to plot it fullscreen in R,  1.8 for exporting with ggsave</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>line_size <span class="ot">=</span><span class="fl">0.3</span> <span class="do">####arrow_size 0.3 to export  1 to for R plotting</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>legend_size <span class="ot">=</span> <span class="fl">0.3</span> <span class="do">#### 0.3 to export, 1 for R ploting</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>legend_text <span class="ot">=</span> <span class="dv">5</span> <span class="do">#### 5 to export, 10 for R ploting</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  statebins<span class="sc">:::</span><span class="fu">geom_rrect</span>(<span class="at">data =</span> Group_box,</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xmin =</span> xmin,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xmax=</span> xmax,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymin =</span> ymin,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymax =</span> ymax),</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">show.legend =</span> F,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> Group_box<span class="sc">$</span>color,</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    statebins<span class="sc">:::</span><span class="fu">geom_rrect</span>(<span class="at">data =</span> resolution_box,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xmin =</span> xmin,</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xmax=</span> xmax,</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymin =</span> ymin,</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymax =</span> ymax,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                          <span class="at">alpha =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Input Data"</span>, <span class="st">"Pre-processing"</span>, <span class="st">"Model Building"</span>, <span class="st">"Prediction"</span>, <span class="st">"Validation"</span>, <span class="st">"Output Data"</span>, <span class="st">"Final Product"</span>),<span class="dv">2</span>)),</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"NA"</span>,</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.4</span>,</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Input Data"</span>, <span class="st">"Pre-Processing"</span>, <span class="st">"Model Building"</span>, <span class="st">"Prediction"</span>, <span class="st">"Validation"</span>, <span class="st">"Output Data"</span>, <span class="st">"Final Product"</span>),</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#f94144"</span>, <span class="st">"#f3722c"</span>, <span class="st">"#f8961e"</span>, <span class="st">"#f9c74f"</span>, <span class="st">"#90be6d"</span>, <span class="st">"#43aa8b"</span>, <span class="st">"#577590"</span>),</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">shape =</span> <span class="fu">c</span>(<span class="dv">22</span>),</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>                                                                        <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.5</span>)</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>                                                                        )</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>                                          )</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>                     )<span class="sc">+</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>  statebins<span class="sc">:::</span><span class="fu">geom_rrect</span>(<span class="at">data =</span> boxes,</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xmin =</span> xmin,</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xmax=</span> xmax,</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymin =</span> ymin,</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymax =</span> ymax</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>                          ),</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fu">as.numeric</span>(boxes<span class="sc">$</span>alpha),</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> boxes<span class="sc">$</span>color,</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(diamond_list)){</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>    poly_i<span class="ot">&lt;-</span>diamond_list[[i]]</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>a<span class="sc">+</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>(<span class="at">data =</span> poly_i, </span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> y</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>                                 ),</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> poly_i<span class="sc">$</span>alpha,</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> poly_i<span class="sc">$</span>Color,</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(building <span class="sc">==</span> T){</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>a<span class="sc">+</span></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> (xmax<span class="sc">+</span>xmin)<span class="sc">/</span><span class="dv">2</span>, <span class="at">y =</span> (ymax <span class="sc">+</span> ymin)<span class="sc">/</span><span class="dv">2</span>, <span class="at">label =</span> (ID)), <span class="at">size =</span> text_size)</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>a<span class="sc">+</span></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> (xmax<span class="sc">+</span>xmin)<span class="sc">/</span><span class="dv">2</span>, <span class="at">y =</span> (ymax <span class="sc">+</span> ymin)<span class="sc">/</span><span class="dv">2</span>, <span class="at">label =</span> (Text)), <span class="at">size =</span> text_size)</span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span>a<span class="sc">+</span></span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> Arrows, <span class="fu">aes</span>( <span class="at">x =</span> xmin, <span class="at">xend =</span> xmax, <span class="at">y =</span> ymin, <span class="at">yend =</span> ymax),</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>line_size, <span class="at">linejoin =</span> <span class="st">"mitre"</span>, <span class="at">lineend =</span> <span class="st">"butt"</span>,</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"mm"</span>), <span class="at">type=</span> <span class="st">"closed"</span>)</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> segment, <span class="fu">aes</span>( <span class="at">x =</span> xmin, <span class="at">xend =</span> xmax, <span class="at">y =</span> ymin, <span class="at">yend =</span> ymax),</span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">size=</span>line_size, <span class="at">linejoin =</span> <span class="st">"mitre"</span>, <span class="at">lineend =</span> <span class="st">"square"</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">5.4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">label =</span> <span class="st">"Flight height: 12 m </span><span class="sc">\n</span><span class="st"> Pixel size : 8 mm"</span>, <span class="at">angle =</span> <span class="dv">90</span>), <span class="at">size =</span> text_size<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">5.4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">6.8</span>, <span class="at">label =</span> <span class="st">"Flight height: 120 m </span><span class="sc">\n</span><span class="st"> Pixel size : 80 mm"</span>, <span class="at">angle =</span> <span class="dv">90</span>), <span class="at">size =</span> text_size<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">1.75</span>, <span class="at">label =</span> <span class="st">"Pre Processing"</span>), <span class="at">size =</span> text_size)</span>
<span id="cb39-107"><a href="#cb39-107" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-108"><a href="#cb39-108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(building <span class="sc">==</span> F){</span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span> a<span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span>a<span class="sc">+</span></span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.88</span>,<span class="fl">0.3</span>),</span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> legend_text),</span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(legend_size, <span class="st">'cm'</span>)</span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="fl">0.5</span>))</span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(building <span class="sc">==</span> T){</span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a>a</span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">"Figures/Figure3_workflow.png"</span>,a, <span class="at">width =</span> <span class="dv">1920</span>, <span class="at">height =</span> <span class="dv">1129</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb39-124"><a href="#cb39-124" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div id="cell-fig-workflow" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Figure3_workflow.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-workflow" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Figure3_workflow.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="./Figures/Figure3_workflow.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-workflow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Schematic representation of the workflow. Diamonds represent input or output data, and rectangles represent Python processing algorithms. The overall workflow of this study is divided into two distinct parts based on the spatial resolution of the drone flights: high-resolution flights were utilized for training and prediction of the Neural Network model, whereas low-resolution flights were solely employed for prediction purposes.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>The spectral similarities of the reflectance signatures between intertidal green macrophytes (Magnoliopsida and Chlorophyceae) make their discrimination challenging using simple classification algorithms (<a href="#fig-vegetation" class="quarto-xref">Figure&nbsp;2</a> F). To overcome this challenge, a deep learning classification method was developed, trained, validated, and applied to each drone flight (<a href="#fig-workflow" class="quarto-xref">Figure&nbsp;3</a>).</p>
<section id="neural-network-model-building" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="neural-network-model-building"><span class="header-section-number">2.4.1</span> Neural Network model building</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_training<span class="ot">&lt;-</span><span class="st">"Data/training/TrainandValid_NewStanRawMetrics.csv"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(<span class="at">delim =</span> <span class="st">";"</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True_Class <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                True_Class <span class="sc">!=</span> <span class="st">"Deep_Sediment"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                True_Class <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                True_Class <span class="sc">!=</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                True_Class <span class="sc">!=</span> <span class="st">"Bare_Sediment"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">True_Class =</span> <span class="fu">case_when</span>(True_Class <span class="sc">==</span> <span class="st">"Clorophyta"</span> <span class="sc">~</span> <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                               True_Class <span class="sc">==</span> <span class="st">"Rhodphyta"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                               True_Class <span class="sc">==</span> <span class="st">"MPB"</span> <span class="sc">~</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                               True_Class <span class="sc">==</span> <span class="st">"Magnoliosida"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                               True_Class <span class="sc">==</span> <span class="st">"Phaeophyta"</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                               True_Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                               )) <span class="sc">%&gt;%</span> </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(True_Class) <span class="sc">%&gt;%</span> </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">True =</span> <span class="st">"True_Class"</span>, </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">Training_Pixels =</span> <span class="st">"n"</span>)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_training,<span class="st">"Data/training/TrainandValid_NewStanRawMetrics_Processed.csv"</span>,<span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_training<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Data/training/TrainandValid_NewStanRawMetrics_Processed.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df_validation<span class="ot">&lt;-</span><span class="st">"Data/accuracy_assesment_low&amp;high_flights.csv"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_delim</span>(<span class="at">delim =</span> <span class="st">","</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True <span class="sc">!=</span> <span class="st">"Sediment"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                True <span class="sc">!=</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                True <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                True <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">True =</span> <span class="fu">case_when</span>(True <span class="sc">==</span> <span class="st">"Green Algae"</span> <span class="sc">~</span> <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                          True <span class="sc">==</span> <span class="st">"Microphytobenthos"</span> <span class="sc">~</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                          True <span class="sc">==</span> <span class="st">"Rhodophyceae"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                          True <span class="sc">==</span> <span class="st">"Pheophyceae"</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> True)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(True) <span class="sc">%&gt;%</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df_validation,<span class="st">"Data/training/TrainandValid_NewStanRawMetrics_Processed_valid.csv"</span>,<span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df_validation<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Data/training/TrainandValid_NewStanRawMetrics_Processed_valid.csv"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df_training <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_validation, <span class="at">by =</span> <span class="st">"True"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Validation Pixels</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"n"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Class =</span> <span class="st">"True"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Training Pixels</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Training_Pixels"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># border_remove() %&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>,<span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>,<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f9bdd568{table-layout:auto;}.cl-f9b67dc2{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9b948d6{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f9b95998{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9b959a2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9b959a3{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f9bdd568"><caption><p>Vegetation Classes of the model and the number of pixels used to
train and validate each class</p></caption><thead><tr style="overflow-wrap:break-word;"><th class="cl-f9b95998"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Class</span></p></th><th class="cl-f9b95998"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Training Pixels</span></p></th><th class="cl-f9b95998"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Validation Pixels</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Bacillariophyceae</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">4,475</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">3,371,920</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Chlorophyceae</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">17,140</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">6,258,737</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Magnoliopsida</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">221,065</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">69,079,189</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Phaeophyceae</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">169,936</span></p></td><td class="cl-f9b959a2"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">18,481,141</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9b959a3"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">Rhodophyceae</span></p></td><td class="cl-f9b959a3"><p class="cl-f9b948d6"><span class="cl-f9b67dc2">5,771</span></p></td><td class="cl-f9b959a3"><p class="cl-f9b948d6"><span class="cl-f9b67dc2"></span></p></td></tr></tbody></table></div>
</div>
</div></div>
<p>A dataset containing photo-interpreted drone reflectance pixels was built to train a Neural Network model with 2 hidden layers. The training pixels were categorized into 7 different classes, representing the various habitats encountered at the different study sites: Sediment, Water, Chlorophyceae, Magnoliopsida, Bacillariophyceae, Phaeophyceae and Rhodophyceae. Only low-altitude flights (Table 1) were used for training purposes because their 8 mm spatial resolution allowied to avoid spectral sub-pixel mixing and to accurately differentiate various vegetation classes. More than 418,000 pixels at 8 mm resolution from the 3 training flights were used to train the model (Table 2). Twenty one variables were used by the model as predictors: 10 raw spectral bands of the Micasense RedEdge Dual MX multispectral camera (ranging from 444 nm to 840 nm), the same 10 spectral bands standardized using a min/max transformation (<a href="#eq-std" class="quarto-xref">Equation&nbsp;1</a> ; <span class="citation" data-cites="Cao2017">Cao et al. (<a href="#ref-Cao2017" role="doc-biblioref">2017</a>)</span>) and the Normalized difference vegetation index (NDVI, <a href="#eq-ndvi" class="quarto-xref">Equation&nbsp;2</a>). Standardisation of spectral bands is used to eliminate the scaling differences between spectra and to limit the effect of biomass on the shape of the spectra <span class="citation" data-cites="Douay2022 Davies2023">(<a href="#ref-Douay2022" role="doc-biblioref">Douay et al., 2022</a> ; <a href="#ref-Davies2023" role="doc-biblioref">Davies et al., 2023a</a>)</span>.</p>
<p><span id="eq-std"><span class="math display">\[
R_{i}^{*}(\lambda) = \frac{R_{i}(\lambda) - min(R_{i})}{max(R_{i})- min(R_{i})}
\tag{1}\]</span></span></p>
<p>where <span class="math inline">\(R_{i}(\lambda)\)</span> is the reflectance at the wavelength <span class="math inline">\((\lambda)\)</span> of each individual spectra <span class="math inline">\((i)\)</span>, <span class="math inline">\(min(R_{i})\)</span>, and <span class="math inline">\(max(R_{i})\)</span> are the minimum and maximum value of the spectra <span class="math inline">\((i)\)</span></p>
<p><span id="eq-ndvi"><span class="math display">\[
NDVI = \frac{R(840nm)-R(668nm)}{R(840nm)+R(668nm)}
\tag{2}\]</span></span></p>
<p>where <span class="math inline">\(R(840nm)\)</span> is the reflectance at 840 nm and <span class="math inline">\(R(668nm)\)</span> is the reflectance at 668 nm.</p>
</section>
<section id="validation" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="validation"><span class="header-section-number">2.4.2</span> Validation</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="st">"Output/Validation_data"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">"ResultsNewNN_NoXanthowithNDVIWithOldandBoat.csv"</span>,<span class="at">recursive =</span> T, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Truth_ID =</span> <span class="st">"Truth"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Truth =</span>  <span class="fu">case_when</span>(Truth_ID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Bare_Sediment"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Chlorophyta"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Bare_Sediment"</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Magnoliosida"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Bare_Sediment"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Magnoliosida"</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Phaeophyta"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"Rhodphyta"</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Water"</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"Spartina"</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">41</span> <span class="sc">~</span> <span class="st">"Bleached seagrasses"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred_Class =</span> <span class="fu">case_when</span>(Pred_Class <span class="sc">==</span> <span class="st">"Clorophyta"</span> <span class="sc">~</span> <span class="st">"Chlorophyta"</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"Rhodphyta"</span> <span class="sc">~</span> <span class="st">"Rhodphyta"</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"Deep_Sediment"</span> <span class="sc">~</span> <span class="st">"Bare_Sediment"</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"MPB"</span> <span class="sc">~</span> <span class="st">"Bare_Sediment"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                                (Pred_Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">&amp;</span> NDVI <span class="sc">&gt;</span> <span class="fl">0.2</span>) <span class="sc">~</span> <span class="st">"Magnoliosida"</span>,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                                (Pred_Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">&amp;</span> NDVI <span class="sc">&lt;=</span> <span class="fl">0.2</span> )<span class="sc">~</span> <span class="st">"Bare_Sediment"</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Pred_Class)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Truth <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>                Truth  <span class="sc">!=</span> <span class="st">"Spartina"</span>,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>                Truth <span class="sc">!=</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>                Truth <span class="sc">!=</span> <span class="st">"Bleached seagrasses"</span>,</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>                Truth <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Pred_Class != "Low_SPC",</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>                Pred_Class <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>                 Pred_Class <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>                 Pred_Class <span class="sc">!=</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>Flight <span class="sc">==</span> <span class="st">"Handfisher_1_old"</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>Flight <span class="sc">==</span> <span class="st">"Handfisher_2_old"</span>,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>Flight <span class="sc">==</span> <span class="st">"Handfisher_2"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>NDVI)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>count_validation_pixel<span class="ot">&lt;-</span><span class="fu">nrow</span>(df)</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(count_validation_pixel,<span class="st">"Output/count_validation_pixel.csv"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>count_validation_pixel<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Output/count_validation_pixel.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>The model was applied to all flights at both 12 and 120 m of altitude. In situ information on georeferenced class type and percent cover collected during each flight was used to assess the model accuracy. These images were used to construct a validation dataset indicating the presence or absence of each class. Additionally to the quadrat-based validation dataset, polygons of each class were photo interpreted in order to increase the number of pixels of the validation dataset. A confusion matrix, along with precision metrics such as global accuracy, sensitivity, specificity, and Kappa coefficient, was generated for each sites. All validation matrices were then merged to create a unique matrix . Altogether, a total of 536,000 pixels was used to validate the model, thus providing a geographically robust validation dataset.</p>
</section>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
<section id="classification" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="classification"><span class="header-section-number">3.1</span> Classification</h2>
<p>A total of 9 prediction maps corresponding to the 9 drone flights were obtained. Each prediction map is associated with a probability map, indicating the probability of the selected class for every pixel. The low-altitude flight conducted in Gafanaha, Portugal, represents the site with the highest complexity (<a href="#fig-GafLow" class="quarto-xref">Figure&nbsp;4</a>). Among the 5 vegetation classes on which the model was trained, 4 were present on this site. On this site, there is a mixture of Chlorophyceae and Rhodophyceae over the seagrass meadow. This is also where Bacillariophyceae is most abundant. Although the seagrass bed is solely composed of <em>Zostera noltei</em>, various colors can be observed: dark green (indicating healthy beds with 100% coverage) and whitish/brown (indicating beds where leaves are dying). Regardless of the color, the meadow is predicted as Magnoliopsida by the model.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>imglist<span class="ot">&lt;-</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">path =</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folder =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Data"</span>) <span class="sc">~</span> <span class="st">"Input"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Output"</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"low"</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Gafanha"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Duer"</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"NDVI"</span>) <span class="sc">~</span> <span class="st">"NDVI"</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"ortho"</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">resampled =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"resampled"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"no_Xantho"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"colored"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"corrected_per_bands"</span>) <span class="sc">~</span> <span class="st">"Bands"</span>,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"corrected.tif"</span>) <span class="sc">~</span> <span class="st">"lm_all"</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(alt <span class="sc">!=</span> <span class="st">"NA"</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".aux.xml"</span>))</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>shp_roi<span class="ot">&lt;-</span><span class="st">"Data/reflectance_calibration_low_&amp;_high_flights/"</span> <span class="sc">%&gt;%</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">case_when</span>(name <span class="sc">==</span> <span class="st">"Microphytobenthos"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"ZOS"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"BL"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"SED"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"GRE"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"RED"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"Xanthophyceae"</span> <span class="sc">~</span> <span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as</span>(<span class="st">"Spatial"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vect</span>()</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>zoom_extent<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom_extent_map_Gafanha_comparison"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>background_GafHigh<span class="ot">&lt;-</span><span class="st">"Data/shp/Aveiro"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"background_Gafanha_high"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a><span class="do">###### Preview ###########</span></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>mask_aveiro <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_Aveiro"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>Flight_aveiro<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gafanha"</span></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(<span class="st">"12m and 120m Flights"</span>),</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.742485</span>) ,</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">40.597599</span>) </span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_aveiro))  <span class="sc">%&gt;%</span> </span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>p1_background<span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/shp/Aveiro/Background_p1_aveiro.shp"</span>)</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>),</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#BDBDBD"</span>))<span class="sc">+</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> p1_background, <span class="at">fill =</span> <span class="st">"white"</span>,<span class="at">show.legend =</span> F, <span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_aveiro, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),<span class="at">show.legend =</span> F, <span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">519749</span>,<span class="dv">535233</span>) ,</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">4493310</span>,<span class="dv">4508794</span>) )<span class="sc">+</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_aveiro,</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">18</span>,</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_void()+</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_label(aes(x = 521000, y = 4507794, label = "C"), size = 20)+</span></span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.75</span>, <span class="sc">-</span><span class="fl">8.6</span>, <span class="at">by =</span> <span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>) ,</span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a><span class="do">######### RGB #########</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a> Gafanha_low_ortho<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>         alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a>         type <span class="sc">==</span> <span class="st">"ortho"</span>,</span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a>         resampled <span class="sc">==</span> <span class="st">"TRUE"</span>,</span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a>         col <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() </span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(Gafanha_low_ortho)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B3"</span>, <span class="st">"B5"</span>,<span class="st">"alpha"</span>)</span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a> <span class="fu">values</span>(Gafanha_low_ortho)[<span class="fu">values</span>(Gafanha_low_ortho<span class="sc">$</span>alpha) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a> Gafanha_low_ortho_zoomed<span class="ot">&lt;-</span>Gafanha_low_ortho <span class="sc">%&gt;%</span> </span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>   <span class="fu">crop</span>(zoom_extent)</span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a> map_extent_full<span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.polygons</span>(<span class="fu">ext</span>(Gafanha_low_ortho)))</span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a> sf<span class="sc">::</span><span class="fu">st_crs</span>(map_extent_full)<span class="ot">&lt;-</span><span class="fu">st_crs</span>(Gafanha_low_ortho)</span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a>  map_extent_zommed<span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.polygons</span>(<span class="fu">ext</span>(Gafanha_low_ortho_zoomed)))</span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a> sf<span class="sc">::</span><span class="fu">st_crs</span>(map_extent_zommed)<span class="ot">&lt;-</span><span class="fu">st_crs</span>(Gafanha_low_ortho_zoomed)</span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a> rgb_Gafanha_low_zoomed<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>   tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> Gafanha_low_ortho_zoomed, </span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">r =</span> <span class="dv">3</span>,</span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">b =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_extent, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-147"><a href="#cb47-147" aria-hidden="true" tabindex="-1"></a>   <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb47-148"><a href="#cb47-148" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_void</span>()</span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a> scale_labels<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.74368</span>, <span class="sc">-</span><span class="fl">8.743565</span>,<span class="sc">-</span><span class="fl">8.74342</span>),</span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">40.59792</span>,<span class="dv">3</span>)),</span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a>                          <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>,<span class="st">"20 m"</span>))</span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>  rgb_Gafanha_low<span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, </span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh,</span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F,</span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh,</span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a>   tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> Gafanha_low_ortho,</span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">r =</span> <span class="dv">1</span>,</span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a>         <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> <span class="dv">3</span>,</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a>         <span class="at">maxcell =</span> <span class="dv">4010533</span></span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a>         )<span class="sc">+</span></span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>    ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"tl"</span>,</span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a>                                <span class="at">text_cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a>      <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(p1),</span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.7430</span>,</span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.742702</span>,</span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymin =</span> <span class="fl">40.5970515</span>, </span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymax =</span> <span class="fl">40.5974</span>) <span class="sc">+</span></span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_extent, </span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"transparent"</span>,</span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a>   <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(rgb_Gafanha_low_zoomed),</span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.7430</span>,</span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax=</span><span class="sc">-</span><span class="fl">8.7427</span>,</span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.5977</span>) <span class="sc">+</span></span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.7432439</span>,<span class="sc">-</span><span class="fl">8.743</span>,<span class="sc">-</span><span class="fl">8.7432439</span>,<span class="sc">-</span><span class="fl">8.743</span>),</span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.5976275</span>,<span class="fl">40.5979</span>,<span class="fl">40.5975373</span>,<span class="fl">40.59771</span>),</span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.7437</span>, <span class="sc">-</span><span class="fl">8.74275</span>), <span class="at">breaks =</span> <span class="sc">-</span><span class="fl">8.743</span>)<span class="sc">+</span></span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.59715</span>, <span class="fl">40.5979</span>), <span class="at">breaks =</span> <span class="fl">40.5975</span>)</span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Gaf_Low_RGB.png"</span>,rgb_Gafanha_low , <span class="at">width =</span> <span class="dv">1920</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1129</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a>zoom_extent<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom_extent_map_Gafanha_comparison"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-224"><a href="#cb47-224" aria-hidden="true" tabindex="-1"></a><span class="do">####### Zoomed map ########</span></span>
<span id="cb47-225"><a href="#cb47-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_zoomed<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a>       alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a>       type <span class="sc">==</span> <span class="st">"Pred"</span>,</span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a>       resampled <span class="sc">==</span> <span class="st">"FALSE"</span>,</span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a>       folder <span class="sc">==</span> <span class="st">"Input"</span>,</span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a>       new <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Gafanha_low_pred_zoomed)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_zoomed<span class="ot">&lt;-</span>Gafanha_low_pred_zoomed <span class="sc">%&gt;%</span> </span>
<span id="cb47-239"><a href="#cb47-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_extent)</span>
<span id="cb47-240"><a href="#cb47-240" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_zoomed<span class="ot">&lt;-</span><span class="fu">as.factor</span>(Gafanha_low_pred_zoomed)</span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_map_zoomed<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Gafanha_low_pred_zoomed, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer))<span class="sc">+</span></span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_extent, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>,<span class="st">"#70543e"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="cn">NA</span>, <span class="st">"#42c9bc"</span>), <span class="at">na.value =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_equal()+</span></span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a> <span class="co"># Gafanha_low_pred_map_zoomed</span></span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-255"><a href="#cb47-255" aria-hidden="true" tabindex="-1"></a><span class="do">####  Overall map</span></span>
<span id="cb47-256"><a href="#cb47-256" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a>       alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a>       type <span class="sc">==</span> <span class="st">"Pred"</span>,</span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a>       <span class="co"># resampled == "TRUE",</span></span>
<span id="cb47-261"><a href="#cb47-261" aria-hidden="true" tabindex="-1"></a>       new <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-262"><a href="#cb47-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Gafanha_low_pred)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Gafanha_low_pred)[<span class="fu">values</span>(Gafanha_low_pred) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb47-268"><a href="#cb47-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-269"><a href="#cb47-269" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred<span class="ot">&lt;-</span>Gafanha_low_pred <span class="sc">%&gt;%</span> </span>
<span id="cb47-270"><a href="#cb47-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb47-271"><a href="#cb47-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a><span class="do">####### Pred ######</span></span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_map <span class="ot">&lt;-</span></span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, </span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh,</span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_sf(data = background_GafHigh,</span></span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         fill = "white",</span></span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         show.legend = F, </span></span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         linewidth=0.05,</span></span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         alpha=1,</span></span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         colour="white")+</span></span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a>   ggnewscale<span class="sc">::</span><span class="fu">new_scale</span>(<span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a>    tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Gafanha_low_pred, </span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a>                               <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer),</span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a>                               <span class="at">maxcell =</span> <span class="dv">500832</span><span class="sc">*</span><span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_extent, </span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb47-299"><a href="#cb47-299" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb47-300"><a href="#cb47-300" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(Gafanha_low_pred_map_zoomed), </span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.7430</span>,</span>
<span id="cb47-304"><a href="#cb47-304" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax=</span><span class="sc">-</span><span class="fl">8.7427</span>, </span>
<span id="cb47-305"><a href="#cb47-305" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.5977</span>) <span class="sc">+</span></span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.7432439</span>,<span class="sc">-</span><span class="fl">8.743</span>,<span class="sc">-</span><span class="fl">8.7432439</span>,<span class="sc">-</span><span class="fl">8.743</span>),</span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.5976275</span>,<span class="fl">40.5979</span>,<span class="fl">40.5975373</span>,<span class="fl">40.59771</span>),</span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb47-318"><a href="#cb47-318" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb47-319"><a href="#cb47-319" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb47-323"><a href="#cb47-323" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_equal()+</span></span>
<span id="cb47-324"><a href="#cb47-324" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">20</span>,<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a>         <span class="co"># axis.text.y = element_text(size = 20),</span></span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">0.3</span>),</span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb47-332"><a href="#cb47-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.7437</span>, <span class="sc">-</span><span class="fl">8.74275</span>), <span class="at">breaks =</span> <span class="sc">-</span><span class="fl">8.743</span>)<span class="sc">+</span></span>
<span id="cb47-333"><a href="#cb47-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.59715</span>, <span class="fl">40.5979</span>), <span class="at">breaks =</span> <span class="fl">40.5975</span>)</span>
<span id="cb47-334"><a href="#cb47-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-335"><a href="#cb47-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Gaf_Low_Pred.png"</span>,Gafanha_low_pred_map , <span class="at">width =</span> <span class="dv">1920</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1129</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a><span class="do">################# PLOT AND SAVING ###########</span></span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a>plot_Gaf_Low<span class="ot">&lt;-</span>rgb_Gafanha_low<span class="sc">+</span></span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a>  Gafanha_low_pred_map</span>
<span id="cb47-342"><a href="#cb47-342" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-343"><a href="#cb47-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-345"><a href="#cb47-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-346"><a href="#cb47-346" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Maps Pred/FigX-Gaf_Low_Pred.png"</span>,plot_Gaf_Low , <span class="at">width =</span> <span class="dv">1920</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1009</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div id="cell-fig-GafLow" class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Maps Pred/FigX-Gaf_Low_Pred.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-GafLow" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-GafLow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Maps%20Pred/FigX-Gaf_Low_Pred.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="./Figures/Maps%20Pred/FigX-Gaf_Low_Pred.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-GafLow-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: RGB orthomosaic (Left) and Prediction (Right) of the low altitude flight of Gafanaha, Portugal. The total extent of this flight is 3000m² with a resolution of 8 mm per pixel. Background colors means intertidal area (Light Green) and land area (Light Grey). The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>imglist<span class="ot">&lt;-</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="st">"Data"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">path =</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folder =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Data"</span>) <span class="sc">~</span> <span class="st">"Input"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Output"</span>),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"High"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"low"</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Gafanha"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path,<span class="st">"AveiroHigh"</span>)<span class="sc">~</span><span class="st">"Gafanha"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Duer"</span>),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"NDVI"</span>) <span class="sc">~</span> <span class="st">"NDVI"</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"ortho"</span>),</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">resampled =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"resampled"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"no_Xantho"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"NewPreds"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"colored"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"corrected_per_bands"</span>) <span class="sc">~</span> <span class="st">"Bands"</span>,</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"corrected.tif"</span>) <span class="sc">~</span> <span class="st">"lm_all"</span>,</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(alt <span class="sc">!=</span> <span class="st">"NA"</span>,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".aux.xml"</span>))</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="do">########## ZOOM #############</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>zoom_extent<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>mask_low<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"mask_Gafanha_low"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>Gafanha_low_ortho_zoomed<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>         alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>         type <span class="sc">==</span> <span class="st">"ortho"</span>,</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>         resampled <span class="sc">==</span> <span class="st">"TRUE"</span>,</span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>         col <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_extent)</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Gafanha_low_ortho_zoomed)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B3"</span>, <span class="st">"B5"</span>,<span class="st">"alpha"</span>)</span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a> Gafanha_low_pred_zoomed<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>         alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>         type <span class="sc">==</span> <span class="st">"Pred"</span>,</span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>         <span class="co"># resampled == "TRUE",</span></span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a>         new <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_extent) <span class="sc">%&gt;%</span> </span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(mask_low, <span class="at">inverse =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.factor</span>()</span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Gafanha_low_pred_zoomed)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>zoomed_low_map<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> Gafanha_low_ortho_zoomed,</span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">r =</span> <span class="dv">1</span>,</span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">b =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Gafanha_low_pred_zoomed, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer), <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>), </span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>, </span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>, </span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_extent, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="do">#############</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a> Gafanha_low_ortho<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a>         alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a>         type <span class="sc">==</span> <span class="st">"ortho"</span>,</span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a>         resampled <span class="sc">==</span> <span class="st">"TRUE"</span>,</span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a>         col <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() </span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(Gafanha_low_ortho)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B3"</span>, <span class="st">"B5"</span>,<span class="st">"alpha"</span>)</span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Gafanha_low_ortho)[<span class="fu">values</span>(Gafanha_low_ortho<span class="sc">$</span>alpha) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a> Gafanha_low_pred<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a>         alt <span class="sc">==</span> <span class="st">"low"</span>,</span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a>         type <span class="sc">==</span> <span class="st">"Pred"</span>,</span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a>         <span class="co"># resampled == "TRUE",</span></span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a>         new <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Gafanha_low_pred)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_masked<span class="ot">&lt;-</span>Gafanha_low_pred <span class="sc">%&gt;%</span> </span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># crop(mask_low) %&gt;% </span></span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(mask_low, <span class="at">inverse =</span> T)</span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Gafanha_low_pred_masked)[<span class="fu">values</span>(Gafanha_low_pred_masked) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a>Gafanha_low_pred_masked<span class="ot">&lt;-</span>Gafanha_low_pred_masked <span class="sc">%&gt;%</span> </span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a>rgb_Gafanha_low <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> Gafanha_low_ortho,</span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">r =</span> <span class="dv">1</span>,</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">b =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Gafanha_low_pred_masked, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer))<span class="sc">+</span></span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>), </span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>, </span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>, </span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>,<span class="at">text_cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_extent, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">8.7434247325</span>, <span class="at">y=</span><span class="fl">40.5977530006</span>, <span class="at">xend =</span> <span class="sc">-</span><span class="fl">8.7430558162</span>, <span class="at">yend =</span> <span class="fl">40.5972152706</span>), <span class="at">linetype =</span><span class="st">"dashed"</span> ,<span class="at">linewidth=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(zoomed_low_map), <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.743725</span>, <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.7434057328</span>, <span class="at">ymin =</span> <span class="fl">40.5977200450</span>, <span class="at">ymax =</span> <span class="fl">40.59798</span>) <span class="sc">+</span></span>
<span id="cb49-151"><a href="#cb49-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb49-152"><a href="#cb49-152" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.74336194</span>,<span class="sc">-</span><span class="fl">8.74371</span>,<span class="sc">-</span><span class="fl">8.743243794</span>,<span class="sc">-</span><span class="fl">8.7434057328</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.59762751</span>,<span class="fl">40.5977400850</span>,<span class="fl">40.59762725</span>,<span class="fl">40.5977200450</span>),<span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb49-153"><a href="#cb49-153" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb49-156"><a href="#cb49-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb49-157"><a href="#cb49-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">20</span>,<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggtitle("a ")+</span></span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.7437</span>, <span class="sc">-</span><span class="fl">8.7430</span>, <span class="fl">0.0002</span>))</span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a>rgb_Gafanha_low</span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Gaf_Low_RGB_Pred_V2.png"</span>,rgb_Gafanha_low , <span class="at">width =</span> <span class="dv">890</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1120</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>The high-altitude flight over Gafanha covered nearly 1 km² in total (<a href="#fig-GafHigh" class="quarto-xref">Figure&nbsp;5</a>). A channel delineating a small island was masked in the prediction map due to sunglint and misclassification caused by the turbid shallow water. Most of the intertidal area has been classified as Magnoliopsida by the model, even though there is discoloration of seagrass blades. Only a few pixels have been classified as Chlorophyceae at this scale. Furthermore, the area that was classified as Bacillariophyceae in the low-altitude flight remains mostly classified as such in the high-altitude flight, though some pixels were classified as Magnoliopsida. Patches of Rhodophyceae were correctly classified. In the nothern part of the scene, near the land limit, patches of <em>Spartina sp.</em> were misclassified, either as Magnoliopsida or as Phaeophyceae.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>imglist<span class="ot">&lt;-</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">path =</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folder =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Data"</span>) <span class="sc">~</span> <span class="st">"Input"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Output"</span>),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"High"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"low"</span>),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Gafanha"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"AveiroHigh"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Duer"</span>),</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"Preds"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"NDVI"</span>) <span class="sc">~</span> <span class="st">"NDVI"</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"ortho"</span>),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">resampled =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"resampled"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"no_Xantho"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"NewPreds"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"colored"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"corrected_per_bands"</span>) <span class="sc">~</span> <span class="st">"Bands"</span>,</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"corrected.tif"</span>) <span class="sc">~</span> <span class="st">"lm_all"</span>,</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(alt <span class="sc">!=</span> <span class="st">"NA"</span>,</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".aux.xml"</span>))</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="do">#### Preview ####</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>mask_aveiro <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_Aveiro"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>Flight_aveiro<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gafanha"</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(<span class="st">"12m and 120m Flights"</span>),</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.742485</span>) ,</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">40.597599</span>) </span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_aveiro))  <span class="sc">%&gt;%</span> </span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>p1_background<span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/shp/Aveiro/Background_p1_aveiro.shp"</span>)</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>),</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#BDBDBD"</span>))<span class="sc">+</span></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> p1_background, <span class="at">fill =</span> <span class="st">"white"</span>,<span class="at">show.legend =</span> F, <span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_aveiro, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),<span class="at">show.legend =</span> F, <span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">519749</span>,<span class="dv">535233</span>) ,</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">4493310</span>,<span class="dv">4508794</span>) )<span class="sc">+</span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_aveiro,</span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">20</span>,</span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_void()+</span></span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_label(aes(x = 521000, y = 4507794, label = "C"), size = 20)+</span></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.75</span>, <span class="sc">-</span><span class="fl">8.6</span>, <span class="at">by =</span> <span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>) ,</span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a>land_mask_GafHigh<span class="ot">&lt;-</span><span class="st">"Data/shp/Aveiro"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"mask_Gafanha_high1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a>background_GafHigh<span class="ot">&lt;-</span><span class="st">"Data/shp/Aveiro"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"background_Gafanha_high"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a>GafHigh_ortho<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a>                type <span class="sc">==</span> <span class="st">"ortho"</span>,</span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a>                alt<span class="sc">==</span><span class="st">"high"</span>,</span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a>                col <span class="sc">==</span> <span class="st">"TRUE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GafHigh_ortho)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1"</span>,<span class="st">"B3"</span>, <span class="st">"B5"</span>, <span class="st">"alpha"</span>)</span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a><span class="co"># values(GafHigh_ortho)[values(GafHigh_ortho$B1) == 0] = NA</span></span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a>GafHigh_ortho_masked<span class="ot">&lt;-</span>GafHigh_ortho <span class="sc">%&gt;%</span> </span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(land_mask_GafHigh, <span class="at">inverse =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(land_mask_GafHigh)</span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a>GafHigh_ortho_masked<span class="ot">&lt;-</span><span class="fu">na.omit</span>(GafHigh_ortho_masked, <span class="at">field=</span><span class="cn">NA</span>, <span class="at">geom=</span><span class="cn">FALSE</span>)</span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-125"><a href="#cb50-125" aria-hidden="true" tabindex="-1"></a><span class="do">###### RGB ########</span></span>
<span id="cb50-126"><a href="#cb50-126" aria-hidden="true" tabindex="-1"></a>zoom_gaf_high_sf<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb50-127"><a href="#cb50-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb50-128"><a href="#cb50-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-129"><a href="#cb50-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-130"><a href="#cb50-130" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom_extent_map_Gafanha_High_comparison"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-131"><a href="#cb50-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb50-132"><a href="#cb50-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb50-133"><a href="#cb50-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-134"><a href="#cb50-134" aria-hidden="true" tabindex="-1"></a>Gaflow_extent<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb50-135"><a href="#cb50-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb50-136"><a href="#cb50-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-137"><a href="#cb50-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-138"><a href="#cb50-138" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"GafLow_extent.shp"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-139"><a href="#cb50-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb50-140"><a href="#cb50-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb50-141"><a href="#cb50-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-142"><a href="#cb50-142" aria-hidden="true" tabindex="-1"></a>rgb_Gafanha_High_zoomed<span class="ot">&lt;-</span>GafHigh_ortho_masked <span class="sc">%&gt;%</span> </span>
<span id="cb50-143"><a href="#cb50-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_gaf_high_sf)</span>
<span id="cb50-144"><a href="#cb50-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-145"><a href="#cb50-145" aria-hidden="true" tabindex="-1"></a>rgb_Gafanha_High_zoomed<span class="ot">&lt;-</span></span>
<span id="cb50-146"><a href="#cb50-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb50-147"><a href="#cb50-147" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> rgb_Gafanha_High_zoomed,</span>
<span id="cb50-148"><a href="#cb50-148" aria-hidden="true" tabindex="-1"></a>         <span class="at">r =</span> <span class="dv">1</span>,</span>
<span id="cb50-149"><a href="#cb50-149" aria-hidden="true" tabindex="-1"></a>         <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb50-150"><a href="#cb50-150" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb50-151"><a href="#cb50-151" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_gaf_high_sf, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-152"><a href="#cb50-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb50-153"><a href="#cb50-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-154"><a href="#cb50-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-155"><a href="#cb50-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-156"><a href="#cb50-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-157"><a href="#cb50-157" aria-hidden="true" tabindex="-1"></a>rgb_Gafanha_High <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb50-158"><a href="#cb50-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>,  </span>
<span id="cb50-159"><a href="#cb50-159" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb50-160"><a href="#cb50-160" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb50-161"><a href="#cb50-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh,</span>
<span id="cb50-162"><a href="#cb50-162" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb50-163"><a href="#cb50-163" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb50-164"><a href="#cb50-164" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb50-165"><a href="#cb50-165" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb50-166"><a href="#cb50-166" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb50-167"><a href="#cb50-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh,</span>
<span id="cb50-168"><a href="#cb50-168" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb50-169"><a href="#cb50-169" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F,</span>
<span id="cb50-170"><a href="#cb50-170" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb50-171"><a href="#cb50-171" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb50-172"><a href="#cb50-172" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb50-173"><a href="#cb50-173" aria-hidden="true" tabindex="-1"></a>   tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> GafHigh_ortho_masked,</span>
<span id="cb50-174"><a href="#cb50-174" aria-hidden="true" tabindex="-1"></a>         <span class="at">r =</span> <span class="dv">1</span>,</span>
<span id="cb50-175"><a href="#cb50-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb50-176"><a href="#cb50-176" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> <span class="dv">3</span>,</span>
<span id="cb50-177"><a href="#cb50-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">maxcell =</span> <span class="dv">5007120</span>)<span class="sc">+</span></span>
<span id="cb50-178"><a href="#cb50-178" aria-hidden="true" tabindex="-1"></a>    ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>,</span>
<span id="cb50-179"><a href="#cb50-179" aria-hidden="true" tabindex="-1"></a>                                <span class="at">text_cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb50-180"><a href="#cb50-180" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(p1), </span>
<span id="cb50-181"><a href="#cb50-181" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.744</span>, </span>
<span id="cb50-182"><a href="#cb50-182" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.7412</span>,</span>
<span id="cb50-183"><a href="#cb50-183" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin =</span> <span class="fl">40.5923</span>,</span>
<span id="cb50-184"><a href="#cb50-184" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> <span class="fl">40.595</span>) <span class="sc">+</span></span>
<span id="cb50-185"><a href="#cb50-185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_gaf_high_sf,</span>
<span id="cb50-186"><a href="#cb50-186" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb50-187"><a href="#cb50-187" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb50-188"><a href="#cb50-188" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb50-189"><a href="#cb50-189" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-190"><a href="#cb50-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> Gaflow_extent,</span>
<span id="cb50-191"><a href="#cb50-191" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb50-192"><a href="#cb50-192" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb50-193"><a href="#cb50-193" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb50-194"><a href="#cb50-194" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb50-195"><a href="#cb50-195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb50-196"><a href="#cb50-196" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.74363778</span>,<span class="sc">-</span><span class="fl">8.74757</span>,<span class="sc">-</span><span class="fl">8.74351982</span>,<span class="sc">-</span><span class="fl">8.7453</span>), </span>
<span id="cb50-197"><a href="#cb50-197" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.5983781677</span>,<span class="fl">40.5995</span>,<span class="fl">40.598377893</span>,<span class="fl">40.5995</span>),</span>
<span id="cb50-198"><a href="#cb50-198" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb50-199"><a href="#cb50-199" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb50-200"><a href="#cb50-200" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-201"><a href="#cb50-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(rgb_Gafanha_High_zoomed),</span>
<span id="cb50-202"><a href="#cb50-202" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.7479</span>, </span>
<span id="cb50-203"><a href="#cb50-203" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.7452</span>, </span>
<span id="cb50-204"><a href="#cb50-204" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.5979</span>,</span>
<span id="cb50-205"><a href="#cb50-205" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.603</span>) <span class="sc">+</span></span>
<span id="cb50-206"><a href="#cb50-206" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb50-207"><a href="#cb50-207" aria-hidden="true" tabindex="-1"></a>   <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb50-208"><a href="#cb50-208" aria-hidden="true" tabindex="-1"></a>   <span class="co"># xlim(c(-8.748, -8.741))+</span></span>
<span id="cb50-209"><a href="#cb50-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(c(40.593,40.601))+</span></span>
<span id="cb50-210"><a href="#cb50-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-211"><a href="#cb50-211" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-212"><a href="#cb50-212" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb50-213"><a href="#cb50-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.747576</span>, <span class="sc">-</span><span class="fl">8.741465</span>),<span class="at">breaks =</span>  <span class="sc">-</span><span class="fl">8.745</span>)<span class="sc">+</span></span>
<span id="cb50-214"><a href="#cb50-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.59297</span>,<span class="fl">40.60109</span>),<span class="at">breaks =</span>  <span class="fl">40.595</span>)</span>
<span id="cb50-215"><a href="#cb50-215" aria-hidden="true" tabindex="-1"></a><span class="co"># rgb_Gafanha_High</span></span>
<span id="cb50-216"><a href="#cb50-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-217"><a href="#cb50-217" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Gaf_High_RGB.png"</span>,rgb_Gafanha_High , <span class="at">width =</span> <span class="dv">712</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1120</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb50-218"><a href="#cb50-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-219"><a href="#cb50-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-220"><a href="#cb50-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-221"><a href="#cb50-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-222"><a href="#cb50-222" aria-hidden="true" tabindex="-1"></a><span class="do">######### Pred #######</span></span>
<span id="cb50-223"><a href="#cb50-223" aria-hidden="true" tabindex="-1"></a>Gafanha_high_pred<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb50-224"><a href="#cb50-224" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb50-225"><a href="#cb50-225" aria-hidden="true" tabindex="-1"></a>       alt <span class="sc">==</span> <span class="st">"high"</span>,</span>
<span id="cb50-226"><a href="#cb50-226" aria-hidden="true" tabindex="-1"></a>       type <span class="sc">==</span> <span class="st">"Pred"</span>,</span>
<span id="cb50-227"><a href="#cb50-227" aria-hidden="true" tabindex="-1"></a>       new <span class="sc">==</span> <span class="st">"TRUE"</span>,</span>
<span id="cb50-228"><a href="#cb50-228" aria-hidden="true" tabindex="-1"></a>       <span class="sc">!</span><span class="fu">str_detect</span>(path, <span class="st">"Probs"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-229"><a href="#cb50-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb50-230"><a href="#cb50-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb50-231"><a href="#cb50-231" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Gafanha_high_pred)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb50-232"><a href="#cb50-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-233"><a href="#cb50-233" aria-hidden="true" tabindex="-1"></a>GafHigh_pred_masked<span class="ot">&lt;-</span>Gafanha_high_pred <span class="sc">%&gt;%</span> </span>
<span id="cb50-234"><a href="#cb50-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(land_mask_GafHigh, <span class="at">inverse =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb50-235"><a href="#cb50-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(land_mask_GafHigh)</span>
<span id="cb50-236"><a href="#cb50-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-237"><a href="#cb50-237" aria-hidden="true" tabindex="-1"></a>GafHigh_pred_masked<span class="ot">&lt;-</span><span class="fu">na.omit</span>(GafHigh_pred_masked, <span class="at">field=</span><span class="cn">NA</span>, <span class="at">geom=</span><span class="cn">FALSE</span>) </span>
<span id="cb50-238"><a href="#cb50-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-239"><a href="#cb50-239" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(GafHigh_pred_masked)[<span class="fu">values</span>(GafHigh_pred_masked) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb50-240"><a href="#cb50-240" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(GafHigh_pred_masked)[<span class="fu">values</span>(GafHigh_pred_masked) <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb50-241"><a href="#cb50-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-242"><a href="#cb50-242" aria-hidden="true" tabindex="-1"></a>GafHigh_pred_masked<span class="ot">&lt;-</span>GafHigh_pred_masked <span class="sc">%&gt;%</span> </span>
<span id="cb50-243"><a href="#cb50-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb50-244"><a href="#cb50-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-245"><a href="#cb50-245" aria-hidden="true" tabindex="-1"></a>Gafanha_High_zoomed_pred<span class="ot">&lt;-</span>GafHigh_pred_masked <span class="sc">%&gt;%</span> </span>
<span id="cb50-246"><a href="#cb50-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_gaf_high_sf)</span>
<span id="cb50-247"><a href="#cb50-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-248"><a href="#cb50-248" aria-hidden="true" tabindex="-1"></a>Gafanha_High_zoomed_pred<span class="ot">&lt;-</span></span>
<span id="cb50-249"><a href="#cb50-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb50-250"><a href="#cb50-250" aria-hidden="true" tabindex="-1"></a>   tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Gafanha_High_zoomed_pred, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer),</span>
<span id="cb50-251"><a href="#cb50-251" aria-hidden="true" tabindex="-1"></a>                            <span class="at">show.legend =</span> F,</span>
<span id="cb50-252"><a href="#cb50-252" aria-hidden="true" tabindex="-1"></a>                             <span class="at">maxcell =</span> <span class="dv">5007120</span>)<span class="sc">+</span></span>
<span id="cb50-253"><a href="#cb50-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb50-254"><a href="#cb50-254" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb50-255"><a href="#cb50-255" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb50-256"><a href="#cb50-256" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb50-257"><a href="#cb50-257" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb50-258"><a href="#cb50-258" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb50-259"><a href="#cb50-259" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb50-260"><a href="#cb50-260" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb50-261"><a href="#cb50-261" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb50-262"><a href="#cb50-262" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb50-263"><a href="#cb50-263" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb50-264"><a href="#cb50-264" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_gaf_high_sf, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-265"><a href="#cb50-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb50-266"><a href="#cb50-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-267"><a href="#cb50-267" aria-hidden="true" tabindex="-1"></a>Gafanha_high_pred_map<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb50-268"><a href="#cb50-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh, </span>
<span id="cb50-269"><a href="#cb50-269" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb50-270"><a href="#cb50-270" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F,</span>
<span id="cb50-271"><a href="#cb50-271" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb50-272"><a href="#cb50-272" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb50-273"><a href="#cb50-273" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb50-274"><a href="#cb50-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_GafHigh,</span>
<span id="cb50-275"><a href="#cb50-275" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb50-276"><a href="#cb50-276" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F,</span>
<span id="cb50-277"><a href="#cb50-277" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb50-278"><a href="#cb50-278" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb50-279"><a href="#cb50-279" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb50-280"><a href="#cb50-280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, </span>
<span id="cb50-281"><a href="#cb50-281" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb50-282"><a href="#cb50-282" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb50-283"><a href="#cb50-283" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale</span>(<span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb50-284"><a href="#cb50-284" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> GafHigh_pred_masked, </span>
<span id="cb50-285"><a href="#cb50-285" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># show.legend = F,</span></span>
<span id="cb50-286"><a href="#cb50-286" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer),</span>
<span id="cb50-287"><a href="#cb50-287" aria-hidden="true" tabindex="-1"></a>                             <span class="at">maxcell =</span> <span class="dv">5010420</span>)<span class="sc">+</span></span>
<span id="cb50-288"><a href="#cb50-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb50-289"><a href="#cb50-289" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb50-290"><a href="#cb50-290" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb50-291"><a href="#cb50-291" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb50-292"><a href="#cb50-292" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb50-293"><a href="#cb50-293" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb50-294"><a href="#cb50-294" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb50-295"><a href="#cb50-295" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb50-296"><a href="#cb50-296" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb50-297"><a href="#cb50-297" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb50-298"><a href="#cb50-298" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb50-299"><a href="#cb50-299" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_gaf_high_sf, </span>
<span id="cb50-300"><a href="#cb50-300" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb50-301"><a href="#cb50-301" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb50-302"><a href="#cb50-302" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb50-303"><a href="#cb50-303" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-304"><a href="#cb50-304" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> Gaflow_extent,</span>
<span id="cb50-305"><a href="#cb50-305" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb50-306"><a href="#cb50-306" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"red"</span>,</span>
<span id="cb50-307"><a href="#cb50-307" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb50-308"><a href="#cb50-308" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb50-309"><a href="#cb50-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb50-310"><a href="#cb50-310" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.74363778</span>,<span class="sc">-</span><span class="fl">8.74757</span>,<span class="sc">-</span><span class="fl">8.74351982</span>,<span class="sc">-</span><span class="fl">8.7453</span>), </span>
<span id="cb50-311"><a href="#cb50-311" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.5983781677</span>,<span class="fl">40.5995</span>,<span class="fl">40.598377893</span>,<span class="fl">40.5995</span>),</span>
<span id="cb50-312"><a href="#cb50-312" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb50-313"><a href="#cb50-313" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb50-314"><a href="#cb50-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(Gafanha_High_zoomed_pred), </span>
<span id="cb50-315"><a href="#cb50-315" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.7479</span>, </span>
<span id="cb50-316"><a href="#cb50-316" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.7452</span>, </span>
<span id="cb50-317"><a href="#cb50-317" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.5979</span>,</span>
<span id="cb50-318"><a href="#cb50-318" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.603</span>) <span class="sc">+</span></span>
<span id="cb50-319"><a href="#cb50-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb50-320"><a href="#cb50-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb50-321"><a href="#cb50-321" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">20</span>,<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-322"><a href="#cb50-322" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-323"><a href="#cb50-323" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.text.y = element_text(size = 20),</span></span>
<span id="cb50-324"><a href="#cb50-324" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-325"><a href="#cb50-325" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-326"><a href="#cb50-326" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.96</span>,<span class="fl">0.23</span>),</span>
<span id="cb50-327"><a href="#cb50-327" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">23</span>),</span>
<span id="cb50-328"><a href="#cb50-328" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">1.2</span>,<span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb50-329"><a href="#cb50-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.747576</span>, <span class="sc">-</span><span class="fl">8.741465</span>),<span class="at">breaks =</span>  <span class="sc">-</span><span class="fl">8.745</span>)<span class="sc">+</span></span>
<span id="cb50-330"><a href="#cb50-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.59297</span>,<span class="fl">40.60109</span>),<span class="at">breaks =</span>  <span class="fl">40.595</span>)</span>
<span id="cb50-331"><a href="#cb50-331" aria-hidden="true" tabindex="-1"></a><span class="co"># Gafanha_high_pred_map</span></span>
<span id="cb50-332"><a href="#cb50-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-333"><a href="#cb50-333" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Gaf_High_Pred.png"</span>,Gafanha_high_pred_map , <span class="at">width =</span> <span class="dv">712</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1120</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb50-334"><a href="#cb50-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-335"><a href="#cb50-335" aria-hidden="true" tabindex="-1"></a><span class="do">################# PLOT AND SAVING ###########</span></span>
<span id="cb50-336"><a href="#cb50-336" aria-hidden="true" tabindex="-1"></a>plot_GafHigh<span class="ot">&lt;-</span>rgb_Gafanha_High<span class="sc">+</span></span>
<span id="cb50-337"><a href="#cb50-337" aria-hidden="true" tabindex="-1"></a>  Gafanha_high_pred_map</span>
<span id="cb50-338"><a href="#cb50-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-339"><a href="#cb50-339" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Maps Pred/FigX-Gaf_High_Pred.png"</span>,plot_GafHigh , <span class="at">width =</span> <span class="dv">2105</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1363</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb50-340"><a href="#cb50-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-341"><a href="#cb50-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-342"><a href="#cb50-342" aria-hidden="true" tabindex="-1"></a><span class="do">#########</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [25]:</pre></div><div id="cell-fig-GafHigh" class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Maps Pred/FigX-Gaf_High_Pred.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-GafHigh" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-GafHigh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Maps%20Pred/FigX-Gaf_High_Pred.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="./Figures/Maps%20Pred/FigX-Gaf_High_Pred.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-GafHigh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: RGB orthomosaic (Left) and Prediction (Right) of the high altitude flight of Gafanaha, Portugal. The total extent of this flight is about 1 km² with a resolution of 80 mm per pixel. Background colors means intertidal area (Light Green), land area (Light Grey) and water (Light Blue). The red triangle shows the extent of the low altitude flight of Gafanha. The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>The high altitude flight acquired over the inner lagoon of the Ria de Aveiro is the largest of all flights, covering almost 1.5 km² (<a href="#fig-Boat" class="quarto-xref">Figure&nbsp;6</a>). On this site, only seagrass and red algae where seen on the field. The classification provided consistent results, with a patchy Magnoliopsida meadow mixed with Rhodophyceae on the eastern part of the scene. As shown in the zoom (<a href="#fig-Boat" class="quarto-xref">Figure&nbsp;6</a>), the edges of the meadow can be colonised by Chlorophyceae.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>imglist<span class="ot">&lt;-</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">path =</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folder =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Data"</span>) <span class="sc">~</span> <span class="st">"Input"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Output"</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"High"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"low"</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Gafanha"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"AveiroHigh"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Duer"</span>),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"Preds"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"NDVI"</span>) <span class="sc">~</span> <span class="st">"NDVI"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"ortho"</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">resampled =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"resampled"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"no_Xantho"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"NewPreds"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"colored"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"corrected_per_bands"</span>) <span class="sc">~</span> <span class="st">"Bands"</span>,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"corrected.tif"</span>) <span class="sc">~</span> <span class="st">"lm_all"</span>,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(alt <span class="sc">!=</span> <span class="st">"NA"</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".aux.xml"</span>))</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="do">########### PREVIEW #############</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>mask_aveiro <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_Aveiro"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>Flight_aveiro<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Marinha Lanzarote"</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"120m Flight"</span>),</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>( </span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">8.690677</span>) ,</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>        <span class="fl">40.665120</span>) </span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_aveiro))  <span class="sc">%&gt;%</span> </span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>p1_background<span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/shp/Aveiro/Background_p1_aveiro.shp"</span>)</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>),</span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#BDBDBD"</span>))<span class="sc">+</span></span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> p1_background, <span class="at">fill =</span> <span class="st">"white"</span>,<span class="at">show.legend =</span> F, <span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_aveiro, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),<span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>,<span class="at">show.legend =</span> F,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">519749</span>,<span class="dv">535233</span>) ,</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">4493310</span>,<span class="dv">4508794</span>) )<span class="sc">+</span></span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_aveiro,</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">10</span>,</span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_void()+</span></span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_label(aes(x = 521000, y = 4507794, label = "C"), size = 20)+</span></span>
<span id="cb52-83"><a href="#cb52-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.75</span>, <span class="sc">-</span><span class="fl">8.6</span>, <span class="at">by =</span> <span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>) ,</span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb52-86"><a href="#cb52-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-87"><a href="#cb52-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb52-88"><a href="#cb52-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb52-89"><a href="#cb52-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb52-90"><a href="#cb52-90" aria-hidden="true" tabindex="-1"></a><span class="do">##### ZOOM and masking #####</span></span>
<span id="cb52-91"><a href="#cb52-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-92"><a href="#cb52-92" aria-hidden="true" tabindex="-1"></a>Boat_rgb<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb52-93"><a href="#cb52-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"Boat_high_RGB_merged.tif"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-94"><a href="#cb52-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-95"><a href="#cb52-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb52-96"><a href="#cb52-96" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Boat_rgb)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1"</span>,<span class="st">"B3"</span>,<span class="st">"B5"</span>)</span>
<span id="cb52-97"><a href="#cb52-97" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Boat_rgb)[<span class="fu">values</span>(Boat_rgb) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb52-98"><a href="#cb52-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-99"><a href="#cb52-99" aria-hidden="true" tabindex="-1"></a>mask_boat<span class="ot">&lt;-</span><span class="st">"Data/shp/Aveiro"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb52-100"><a href="#cb52-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb52-101"><a href="#cb52-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-102"><a href="#cb52-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-103"><a href="#cb52-103" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"boat"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-104"><a href="#cb52-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-105"><a href="#cb52-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb52-106"><a href="#cb52-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-107"><a href="#cb52-107" aria-hidden="true" tabindex="-1"></a>background_Boat<span class="ot">&lt;-</span><span class="st">"Data/shp/Aveiro"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb52-108"><a href="#cb52-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb52-109"><a href="#cb52-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-110"><a href="#cb52-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-111"><a href="#cb52-111" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"background_Boat"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-112"><a href="#cb52-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-113"><a href="#cb52-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb52-114"><a href="#cb52-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-115"><a href="#cb52-115" aria-hidden="true" tabindex="-1"></a>zoom_boat_high_sf<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb52-116"><a href="#cb52-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb52-117"><a href="#cb52-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-118"><a href="#cb52-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-119"><a href="#cb52-119" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom_extent_map_Boat_comparison"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-120"><a href="#cb52-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-121"><a href="#cb52-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb52-122"><a href="#cb52-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-123"><a href="#cb52-123" aria-hidden="true" tabindex="-1"></a>zoom_boat_high_sf_2<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb52-124"><a href="#cb52-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb52-125"><a href="#cb52-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-126"><a href="#cb52-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-127"><a href="#cb52-127" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom_extent_map_Boat_2_comparison"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-128"><a href="#cb52-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-129"><a href="#cb52-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb52-130"><a href="#cb52-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-131"><a href="#cb52-131" aria-hidden="true" tabindex="-1"></a>rgb_Boat_zoomed<span class="ot">&lt;-</span>Boat_rgb <span class="sc">%&gt;%</span> </span>
<span id="cb52-132"><a href="#cb52-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_boat_high_sf)</span>
<span id="cb52-133"><a href="#cb52-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-134"><a href="#cb52-134" aria-hidden="true" tabindex="-1"></a>rgb_Boat_zoomed_2<span class="ot">&lt;-</span>Boat_rgb <span class="sc">%&gt;%</span> </span>
<span id="cb52-135"><a href="#cb52-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_boat_high_sf_2)</span>
<span id="cb52-136"><a href="#cb52-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-137"><a href="#cb52-137" aria-hidden="true" tabindex="-1"></a>Boat_rgb_mask<span class="ot">&lt;-</span>Boat_rgb <span class="sc">%&gt;%</span> </span>
<span id="cb52-138"><a href="#cb52-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(mask_boat, <span class="at">inverse =</span> T)</span>
<span id="cb52-139"><a href="#cb52-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-140"><a href="#cb52-140" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb52-141"><a href="#cb52-141" aria-hidden="true" tabindex="-1"></a>rgb_Boat_zoomed_map<span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-142"><a href="#cb52-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> rgb_Boat_zoomed,</span>
<span id="cb52-143"><a href="#cb52-143" aria-hidden="true" tabindex="-1"></a>                      <span class="at">r =</span> <span class="dv">3</span>,</span>
<span id="cb52-144"><a href="#cb52-144" aria-hidden="true" tabindex="-1"></a>                      <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb52-145"><a href="#cb52-145" aria-hidden="true" tabindex="-1"></a>                      <span class="at">b =</span> <span class="dv">1</span>,</span>
<span id="cb52-146"><a href="#cb52-146" aria-hidden="true" tabindex="-1"></a>                      <span class="at">max_col_value =</span> <span class="dv">4000</span>)<span class="sc">+</span></span>
<span id="cb52-147"><a href="#cb52-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-148"><a href="#cb52-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-149"><a href="#cb52-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb52-150"><a href="#cb52-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-151"><a href="#cb52-151" aria-hidden="true" tabindex="-1"></a>rgb_Boat_zoomed_map_2</span>
<span id="cb52-152"><a href="#cb52-152" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-153"><a href="#cb52-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> rgb_Boat_zoomed_2,</span>
<span id="cb52-154"><a href="#cb52-154" aria-hidden="true" tabindex="-1"></a>                      <span class="at">r =</span> <span class="dv">3</span>,</span>
<span id="cb52-155"><a href="#cb52-155" aria-hidden="true" tabindex="-1"></a>                      <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb52-156"><a href="#cb52-156" aria-hidden="true" tabindex="-1"></a>                      <span class="at">b =</span> <span class="dv">1</span>,</span>
<span id="cb52-157"><a href="#cb52-157" aria-hidden="true" tabindex="-1"></a>                      <span class="at">interpolate =</span> F,</span>
<span id="cb52-158"><a href="#cb52-158" aria-hidden="true" tabindex="-1"></a>                      <span class="at">max_col_value =</span> <span class="dv">4000</span>)<span class="sc">+</span></span>
<span id="cb52-159"><a href="#cb52-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf_2, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-160"><a href="#cb52-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-161"><a href="#cb52-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb52-162"><a href="#cb52-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-163"><a href="#cb52-163" aria-hidden="true" tabindex="-1"></a><span class="do">####### RGB ############</span></span>
<span id="cb52-164"><a href="#cb52-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-165"><a href="#cb52-165" aria-hidden="true" tabindex="-1"></a>RGB_Boat_map<span class="ot">&lt;-</span></span>
<span id="cb52-166"><a href="#cb52-166" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-167"><a href="#cb52-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>,  </span>
<span id="cb52-168"><a href="#cb52-168" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb52-169"><a href="#cb52-169" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb52-170"><a href="#cb52-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Boat,</span>
<span id="cb52-171"><a href="#cb52-171" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb52-172"><a href="#cb52-172" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb52-173"><a href="#cb52-173" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb52-174"><a href="#cb52-174" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb52-175"><a href="#cb52-175" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb52-176"><a href="#cb52-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Boat,</span>
<span id="cb52-177"><a href="#cb52-177" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb52-178"><a href="#cb52-178" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb52-179"><a href="#cb52-179" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb52-180"><a href="#cb52-180" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb52-181"><a href="#cb52-181" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb52-182"><a href="#cb52-182" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> Boat_rgb_mask,</span>
<span id="cb52-183"><a href="#cb52-183" aria-hidden="true" tabindex="-1"></a>                      <span class="at">r =</span> <span class="dv">3</span>,</span>
<span id="cb52-184"><a href="#cb52-184" aria-hidden="true" tabindex="-1"></a>                      <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb52-185"><a href="#cb52-185" aria-hidden="true" tabindex="-1"></a>                      <span class="at">b =</span> <span class="dv">1</span>,</span>
<span id="cb52-186"><a href="#cb52-186" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># maxcell = 5000,</span></span>
<span id="cb52-187"><a href="#cb52-187" aria-hidden="true" tabindex="-1"></a>                      <span class="at">maxcell =</span> <span class="dv">500832</span><span class="sc">*</span><span class="dv">8</span>,</span>
<span id="cb52-188"><a href="#cb52-188" aria-hidden="true" tabindex="-1"></a>                      <span class="at">max_col_value =</span> <span class="dv">5000</span>)<span class="sc">+</span></span>
<span id="cb52-189"><a href="#cb52-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf,</span>
<span id="cb52-190"><a href="#cb52-190" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>,</span>
<span id="cb52-191"><a href="#cb52-191" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb52-192"><a href="#cb52-192" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-193"><a href="#cb52-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf_2,</span>
<span id="cb52-194"><a href="#cb52-194" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>,</span>
<span id="cb52-195"><a href="#cb52-195" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb52-196"><a href="#cb52-196" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-197"><a href="#cb52-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(rgb_Boat_zoomed_map),</span>
<span id="cb52-198"><a href="#cb52-198" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.6975</span>,</span>
<span id="cb52-199"><a href="#cb52-199" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.69</span>,</span>
<span id="cb52-200"><a href="#cb52-200" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.6666</span>,</span>
<span id="cb52-201"><a href="#cb52-201" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.6711</span>) <span class="sc">+</span></span>
<span id="cb52-202"><a href="#cb52-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(rgb_Boat_zoomed_map_2),</span>
<span id="cb52-203"><a href="#cb52-203" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.6975+0.007</span>,</span>
<span id="cb52-204"><a href="#cb52-204" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.69+0.007</span>,</span>
<span id="cb52-205"><a href="#cb52-205" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.6666</span>,</span>
<span id="cb52-206"><a href="#cb52-206" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.6711</span>) <span class="sc">+</span></span>
<span id="cb52-207"><a href="#cb52-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(p1),</span>
<span id="cb52-208"><a href="#cb52-208" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.6795</span>,</span>
<span id="cb52-209"><a href="#cb52-209" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.6736</span>,</span>
<span id="cb52-210"><a href="#cb52-210" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.6585</span>,</span>
<span id="cb52-211"><a href="#cb52-211" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.6625</span>) <span class="sc">+</span></span>
<span id="cb52-212"><a href="#cb52-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb52-213"><a href="#cb52-213" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.69452127</span>,<span class="sc">-</span><span class="fl">8.6965</span>,<span class="sc">-</span><span class="fl">8.69440039</span>,<span class="sc">-</span><span class="fl">8.69105</span>), </span>
<span id="cb52-214"><a href="#cb52-214" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.66244282</span>,<span class="fl">40.66673</span>,<span class="fl">40.66244282</span>,<span class="fl">40.66673</span>),</span>
<span id="cb52-215"><a href="#cb52-215" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb52-216"><a href="#cb52-216" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb52-217"><a href="#cb52-217" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-218"><a href="#cb52-218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb52-219"><a href="#cb52-219" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.6819877</span>,<span class="sc">-</span><span class="fl">8.69645+0.007</span>,<span class="sc">-</span><span class="fl">8.6818696</span>,<span class="sc">-</span><span class="fl">8.6911+0.007</span>), </span>
<span id="cb52-220"><a href="#cb52-220" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.6652874</span>,<span class="fl">40.66675</span>,<span class="fl">40.6652874</span>,<span class="fl">40.66673</span>),</span>
<span id="cb52-221"><a href="#cb52-221" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb52-222"><a href="#cb52-222" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb52-223"><a href="#cb52-223" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-224"><a href="#cb52-224" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>,</span>
<span id="cb52-225"><a href="#cb52-225" aria-hidden="true" tabindex="-1"></a>                              <span class="at">text_cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb52-226"><a href="#cb52-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.6965</span>,<span class="sc">-</span><span class="fl">8.675</span>),</span>
<span id="cb52-227"><a href="#cb52-227" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="sc">-</span><span class="fl">8.685</span>)<span class="sc">+</span></span>
<span id="cb52-228"><a href="#cb52-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.659</span>,<span class="fl">40.6704</span>),</span>
<span id="cb52-229"><a href="#cb52-229" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="fl">40.664</span>)<span class="sc">+</span></span>
<span id="cb52-230"><a href="#cb52-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb52-231"><a href="#cb52-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-232"><a href="#cb52-232" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.text.x = element_text(size = 20, angle = 20 , hjust = 1),</span></span>
<span id="cb52-233"><a href="#cb52-233" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-234"><a href="#cb52-234" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb52-235"><a href="#cb52-235" aria-hidden="true" tabindex="-1"></a>   <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb52-236"><a href="#cb52-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-237"><a href="#cb52-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-238"><a href="#cb52-238" aria-hidden="true" tabindex="-1"></a><span class="do">####### Pred ######## </span></span>
<span id="cb52-239"><a href="#cb52-239" aria-hidden="true" tabindex="-1"></a>Boat1_pred<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb52-240"><a href="#cb52-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"AveiroBoat1_highPrediction_nnNewStanRawMetrics_Preds_NoXantho_7.tif"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-241"><a href="#cb52-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-242"><a href="#cb52-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb52-243"><a href="#cb52-243" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Boat1_pred)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb52-244"><a href="#cb52-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-245"><a href="#cb52-245" aria-hidden="true" tabindex="-1"></a>Boat2_pred<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb52-246"><a href="#cb52-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"AveiroBoat2_highPrediction_nnNewStanRawMetrics_Preds_NoXantho_7.tif"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-247"><a href="#cb52-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb52-248"><a href="#cb52-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb52-249"><a href="#cb52-249" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Boat2_pred)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb52-250"><a href="#cb52-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-251"><a href="#cb52-251" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Boat1_pred)[<span class="fu">values</span>(Boat1_pred) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb52-252"><a href="#cb52-252" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Boat2_pred)[<span class="fu">values</span>(Boat2_pred) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb52-253"><a href="#cb52-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-254"><a href="#cb52-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-255"><a href="#cb52-255" aria-hidden="true" tabindex="-1"></a>B1_overextent<span class="ot">&lt;-</span><span class="fu">ext</span>(Boat1_pred)</span>
<span id="cb52-256"><a href="#cb52-256" aria-hidden="true" tabindex="-1"></a>B1_overextent[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">ext</span>(Boat2_pred)[<span class="dv">2</span>]</span>
<span id="cb52-257"><a href="#cb52-257" aria-hidden="true" tabindex="-1"></a>B1_overextent[<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">ext</span>(Boat2_pred)[<span class="dv">4</span>]</span>
<span id="cb52-258"><a href="#cb52-258" aria-hidden="true" tabindex="-1"></a>B1_overextent <span class="ot">&lt;-</span> <span class="fu">rast</span>(B1_overextent)</span>
<span id="cb52-259"><a href="#cb52-259" aria-hidden="true" tabindex="-1"></a><span class="fu">res</span>(B1_overextent)<span class="ot">&lt;-</span><span class="fu">res</span>(Boat1_pred)</span>
<span id="cb52-260"><a href="#cb52-260" aria-hidden="true" tabindex="-1"></a><span class="co"># terra::writeRaster(B1$B1,"B1.tif")</span></span>
<span id="cb52-261"><a href="#cb52-261" aria-hidden="true" tabindex="-1"></a><span class="co"># terra::writeRaster(B2$B2,"B2.tif")</span></span>
<span id="cb52-262"><a href="#cb52-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-263"><a href="#cb52-263" aria-hidden="true" tabindex="-1"></a>B2_resampled <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">resample</span>(Boat2_pred,B1_overextent, <span class="at">method =</span> <span class="st">"near"</span>,<span class="at">threads =</span> T)</span>
<span id="cb52-264"><a href="#cb52-264" aria-hidden="true" tabindex="-1"></a><span class="co"># terra::writeRaster(B2_resampled$B1,"B2_resampled.tif", overwrite = T)</span></span>
<span id="cb52-265"><a href="#cb52-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-266"><a href="#cb52-266" aria-hidden="true" tabindex="-1"></a>Boat_pred<span class="ot">&lt;-</span><span class="fu">merge</span>(Boat1_pred,B2_resampled)</span>
<span id="cb52-267"><a href="#cb52-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-268"><a href="#cb52-268" aria-hidden="true" tabindex="-1"></a>Boat_pred_aggregate<span class="ot">&lt;-</span>terra<span class="sc">::</span><span class="fu">aggregate</span>(Boat_pred,<span class="at">fact =</span> <span class="dv">6</span>, <span class="at">fun =</span><span class="st">"modal"</span>) </span>
<span id="cb52-269"><a href="#cb52-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-270"><a href="#cb52-270" aria-hidden="true" tabindex="-1"></a>masked_pred<span class="ot">&lt;-</span>Boat_pred_aggregate <span class="sc">%&gt;%</span> </span>
<span id="cb52-271"><a href="#cb52-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(mask_boat,<span class="at">inverse=</span><span class="cn">TRUE</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb52-272"><a href="#cb52-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb52-273"><a href="#cb52-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-274"><a href="#cb52-274" aria-hidden="true" tabindex="-1"></a>Boat_pred_zoom<span class="ot">&lt;-</span>Boat1_pred <span class="sc">%&gt;%</span> </span>
<span id="cb52-275"><a href="#cb52-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_boat_high_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb52-276"><a href="#cb52-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb52-277"><a href="#cb52-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-278"><a href="#cb52-278" aria-hidden="true" tabindex="-1"></a>Boat_pred_zoom_2<span class="ot">&lt;-</span>Boat2_pred <span class="sc">%&gt;%</span> </span>
<span id="cb52-279"><a href="#cb52-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_boat_high_sf_2) <span class="sc">%&gt;%</span> </span>
<span id="cb52-280"><a href="#cb52-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb52-281"><a href="#cb52-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-282"><a href="#cb52-282" aria-hidden="true" tabindex="-1"></a>Boat_Pred_zoomed_map<span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-283"><a href="#cb52-283" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Boat_pred_zoom, </span>
<span id="cb52-284"><a href="#cb52-284" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer), </span>
<span id="cb52-285"><a href="#cb52-285" aria-hidden="true" tabindex="-1"></a>                             <span class="at">show.legend =</span> F,</span>
<span id="cb52-286"><a href="#cb52-286" aria-hidden="true" tabindex="-1"></a>                             <span class="at">maxcell =</span> <span class="dv">5010420</span>)<span class="sc">+</span></span>
<span id="cb52-287"><a href="#cb52-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>,<span class="st">"#b3ff1a"</span>,<span class="st">"#389318"</span>,<span class="st">"#873e23"</span>),</span>
<span id="cb52-288"><a href="#cb52-288" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb52-289"><a href="#cb52-289" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb52-290"><a href="#cb52-290" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb52-291"><a href="#cb52-291" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorphyceae"</span>,</span>
<span id="cb52-292"><a href="#cb52-292" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>))<span class="sc">+</span></span>
<span id="cb52-293"><a href="#cb52-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf, </span>
<span id="cb52-294"><a href="#cb52-294" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb52-295"><a href="#cb52-295" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb52-296"><a href="#cb52-296" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb52-297"><a href="#cb52-297" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-298"><a href="#cb52-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb52-299"><a href="#cb52-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-300"><a href="#cb52-300" aria-hidden="true" tabindex="-1"></a>Boat_Pred_zoomed_map_2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-301"><a href="#cb52-301" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Boat_pred_zoom_2, </span>
<span id="cb52-302"><a href="#cb52-302" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer), </span>
<span id="cb52-303"><a href="#cb52-303" aria-hidden="true" tabindex="-1"></a>                             <span class="at">show.legend =</span> F,</span>
<span id="cb52-304"><a href="#cb52-304" aria-hidden="true" tabindex="-1"></a>                             <span class="at">maxcell =</span> <span class="dv">5010420</span>)<span class="sc">+</span></span>
<span id="cb52-305"><a href="#cb52-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>,<span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>),</span>
<span id="cb52-306"><a href="#cb52-306" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb52-307"><a href="#cb52-307" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb52-308"><a href="#cb52-308" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb52-309"><a href="#cb52-309" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb52-310"><a href="#cb52-310" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb52-311"><a href="#cb52-311" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>))<span class="sc">+</span></span>
<span id="cb52-312"><a href="#cb52-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf_2, </span>
<span id="cb52-313"><a href="#cb52-313" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb52-314"><a href="#cb52-314" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb52-315"><a href="#cb52-315" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb52-316"><a href="#cb52-316" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-317"><a href="#cb52-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb52-318"><a href="#cb52-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-319"><a href="#cb52-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-320"><a href="#cb52-320" aria-hidden="true" tabindex="-1"></a>Boat_pred_map<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-321"><a href="#cb52-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Boat, </span>
<span id="cb52-322"><a href="#cb52-322" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb52-323"><a href="#cb52-323" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb52-324"><a href="#cb52-324" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb52-325"><a href="#cb52-325" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb52-326"><a href="#cb52-326" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb52-327"><a href="#cb52-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Boat,</span>
<span id="cb52-328"><a href="#cb52-328" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb52-329"><a href="#cb52-329" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb52-330"><a href="#cb52-330" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb52-331"><a href="#cb52-331" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb52-332"><a href="#cb52-332" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb52-333"><a href="#cb52-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, </span>
<span id="cb52-334"><a href="#cb52-334" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb52-335"><a href="#cb52-335" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb52-336"><a href="#cb52-336" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale</span>(<span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb52-337"><a href="#cb52-337" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> masked_pred, </span>
<span id="cb52-338"><a href="#cb52-338" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer),</span>
<span id="cb52-339"><a href="#cb52-339" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># show.legend = F,</span></span>
<span id="cb52-340"><a href="#cb52-340" aria-hidden="true" tabindex="-1"></a>                             <span class="at">maxcell =</span> <span class="dv">5010420</span>,</span>
<span id="cb52-341"><a href="#cb52-341" aria-hidden="true" tabindex="-1"></a>                             )<span class="sc">+</span></span>
<span id="cb52-342"><a href="#cb52-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb52-343"><a href="#cb52-343" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb52-344"><a href="#cb52-344" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb52-345"><a href="#cb52-345" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb52-346"><a href="#cb52-346" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb52-347"><a href="#cb52-347" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb52-348"><a href="#cb52-348" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb52-349"><a href="#cb52-349" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb52-350"><a href="#cb52-350" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb52-351"><a href="#cb52-351" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb52-352"><a href="#cb52-352" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb52-353"><a href="#cb52-353" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale</span>(<span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb52-354"><a href="#cb52-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf, </span>
<span id="cb52-355"><a href="#cb52-355" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb52-356"><a href="#cb52-356" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb52-357"><a href="#cb52-357" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb52-358"><a href="#cb52-358" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-359"><a href="#cb52-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_boat_high_sf_2, </span>
<span id="cb52-360"><a href="#cb52-360" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb52-361"><a href="#cb52-361" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb52-362"><a href="#cb52-362" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb52-363"><a href="#cb52-363" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-364"><a href="#cb52-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb52-365"><a href="#cb52-365" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.69452127</span>,<span class="sc">-</span><span class="fl">8.6965</span>,<span class="sc">-</span><span class="fl">8.69440039</span>,<span class="sc">-</span><span class="fl">8.69105</span>), </span>
<span id="cb52-366"><a href="#cb52-366" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.66244282</span>,<span class="fl">40.66673</span>,<span class="fl">40.66244282</span>,<span class="fl">40.66673</span>),</span>
<span id="cb52-367"><a href="#cb52-367" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb52-368"><a href="#cb52-368" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb52-369"><a href="#cb52-369" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-370"><a href="#cb52-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb52-371"><a href="#cb52-371" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.6819877</span>,<span class="sc">-</span><span class="fl">8.69645+0.007</span>,<span class="sc">-</span><span class="fl">8.6818696</span>,<span class="sc">-</span><span class="fl">8.6911+0.007</span>), </span>
<span id="cb52-372"><a href="#cb52-372" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">40.6652874</span>,<span class="fl">40.66675</span>,<span class="fl">40.6652874</span>,<span class="fl">40.66673</span>),</span>
<span id="cb52-373"><a href="#cb52-373" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb52-374"><a href="#cb52-374" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb52-375"><a href="#cb52-375" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb52-376"><a href="#cb52-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(Boat_Pred_zoomed_map),</span>
<span id="cb52-377"><a href="#cb52-377" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.6975</span>,</span>
<span id="cb52-378"><a href="#cb52-378" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.69</span>,</span>
<span id="cb52-379"><a href="#cb52-379" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.6666</span>,</span>
<span id="cb52-380"><a href="#cb52-380" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.6711</span>) <span class="sc">+</span></span>
<span id="cb52-381"><a href="#cb52-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(Boat_Pred_zoomed_map_2),</span>
<span id="cb52-382"><a href="#cb52-382" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">8.6975+0.007</span>,</span>
<span id="cb52-383"><a href="#cb52-383" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">8.69+0.007</span>,</span>
<span id="cb52-384"><a href="#cb52-384" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">40.6666</span>,</span>
<span id="cb52-385"><a href="#cb52-385" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">40.6711</span>) <span class="sc">+</span></span>
<span id="cb52-386"><a href="#cb52-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb52-387"><a href="#cb52-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb52-388"><a href="#cb52-388" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(</span>
<span id="cb52-389"><a href="#cb52-389" aria-hidden="true" tabindex="-1"></a>     <span class="co"># axis.text.x = element_text(size = 20, angle = 20,hjust = 1),</span></span>
<span id="cb52-390"><a href="#cb52-390" aria-hidden="true" tabindex="-1"></a>     <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-391"><a href="#cb52-391" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-392"><a href="#cb52-392" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb52-393"><a href="#cb52-393" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-394"><a href="#cb52-394" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">0.38</span>),</span>
<span id="cb52-395"><a href="#cb52-395" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb52-396"><a href="#cb52-396" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>,<span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb52-397"><a href="#cb52-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.6965</span>,<span class="sc">-</span><span class="fl">8.675</span>),</span>
<span id="cb52-398"><a href="#cb52-398" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="sc">-</span><span class="fl">8.685</span>)<span class="sc">+</span></span>
<span id="cb52-399"><a href="#cb52-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.659</span>,<span class="fl">40.6704</span>),</span>
<span id="cb52-400"><a href="#cb52-400" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="fl">40.664</span>)</span>
<span id="cb52-401"><a href="#cb52-401" aria-hidden="true" tabindex="-1"></a><span class="do">################# PLOT AND SAVING ###########</span></span>
<span id="cb52-402"><a href="#cb52-402" aria-hidden="true" tabindex="-1"></a>plot_Boat<span class="ot">&lt;-</span>RGB_Boat_map<span class="sc">/</span></span>
<span id="cb52-403"><a href="#cb52-403" aria-hidden="true" tabindex="-1"></a>  Boat_pred_map</span>
<span id="cb52-404"><a href="#cb52-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-405"><a href="#cb52-405" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Maps Pred/FigX-Boat_Pred.png"</span>,plot_Boat , <span class="at">width =</span> <span class="dv">1000</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1120</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [27]:</pre></div><div id="cell-fig-Boat" class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Maps Pred/FigX-Boat_Pred.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Boat" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Boat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Maps%20Pred/FigX-Boat_Pred.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="./Figures/Maps%20Pred/FigX-Boat_Pred.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Boat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: RGB orthomosaic (Top) and Prediction (Bottom) of the flight made in the inner part of Ria de Aveiro Lagoon, Portugal. The total extent of this flight is about 1.5 km² with a resolution of 80 mm per pixel. Background colors means intertidal area (Light Green), land area (Light Grey) and water (Light Blue). The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>The flight over L’Epine in Noirmoutier Island, France (<a href="#fig-Dike" class="quarto-xref">Figure&nbsp;7</a>) was conducted near a dike crossing the northern part of the scene from west to east. Alongside this dike, brown algae attached to rocks and stranded green algae could be found. Despite the high mixture between Chlorophyceae and Magnoliopsida these two classes were correctly discriminated by the classifier.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [28]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>imglist<span class="ot">&lt;-</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">path =</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="at">recursive =</span> T, <span class="at">full.names =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">folder =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Data"</span>) <span class="sc">~</span> <span class="st">"Input"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Output"</span>),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"High"</span>) <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"low"</span>),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"Gafanha"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"AveiroHigh"</span>) <span class="sc">~</span> <span class="st">"Gafanha"</span>,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Duer"</span>),</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"Preds"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"NDVI"</span>) <span class="sc">~</span> <span class="st">"NDVI"</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"ortho"</span>),</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">resampled =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"resampled"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"no_Xantho"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(path, <span class="st">"NewPreds"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"colored"</span>) <span class="sc">~</span> <span class="st">"TRUE"</span>,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"FALSE"</span>),</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">correction =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"corrected_per_bands"</span>) <span class="sc">~</span> <span class="st">"Bands"</span>,</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_detect</span>(path, <span class="st">"corrected.tif"</span>) <span class="sc">~</span> <span class="st">"lm_all"</span>,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(alt <span class="sc">!=</span> <span class="st">"NA"</span>,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span><span class="fu">str_detect</span>(path,<span class="st">".aux.xml"</span>))</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="do">##### Preview #####</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="st">"Data/shp/"</span>, <span class="at">pattern =</span> <span class="st">".shp"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>mask_BB <span class="ot">&lt;-</span> filelist[<span class="fu">str_detect</span>(filelist,<span class="st">"mask_land_intertidal_BB"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>Flight_BB<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"L'Epine"</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"120m Flight"</span>),</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">2.228239</span>) ,</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>( </span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>        <span class="fl">46.989515</span>) </span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(mask_BB))  <span class="sc">%&gt;%</span> </span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land mask"</span>),</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#BDBDBD"</span>))<span class="sc">+</span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mask_BB, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type), <span class="at">linewidth=</span><span class="fl">0.05</span>,<span class="at">alpha=</span><span class="fl">0.93</span>, <span class="at">show.legend =</span> F,<span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_sf</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">550609</span>,<span class="dv">579539</span>) ,</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">5189447</span>,<span class="dv">5218377</span>) )<span class="sc">+</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>Flight_BB,</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x=</span>lon,</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y=</span>lat,</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> Name,</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> Name),</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># description=Description),</span></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size=</span><span class="fl">0.3</span>,</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"goldenrod"</span>,</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.colour =</span> <span class="st">"goldenrod4"</span>,</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>                 <span class="at">show.legend=</span>F,</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>                 <span class="at">con.size =</span> <span class="dv">2</span>,</span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.fontsize =</span> <span class="dv">10</span>,</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">expand =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) , </span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>) ,</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">"mm"</span>)) <span class="sc">+</span></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_Bede_Map()+</span></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_label(aes(x = 553460, y = 5216442, label = "B"), size = 20)+</span></span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="st">"cm"</span>) ,</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.2</span>),</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span>  <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>),</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, </span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linetype=</span><span class="st">"solid"</span>, </span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">colour =</span><span class="st">"black"</span>),</span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># panel.background = element_rect(fill = "#FFFFFF90"),</span></span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="do">##### RGB ######</span></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>Dike_rgb<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"NorthDike_high_multi_4326_colored.tif"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Dike_rgb)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1"</span>,<span class="st">"B3"</span>,<span class="st">"B5"</span>,<span class="st">"alpha"</span>)</span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Dike_rgb)[<span class="fu">values</span>(Dike_rgb<span class="sc">$</span>alpha) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb54-104"><a href="#cb54-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-105"><a href="#cb54-105" aria-hidden="true" tabindex="-1"></a>mask_Dike<span class="ot">&lt;-</span><span class="st">"Data/shp/Bourgneuf"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"mask_NorthDike"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb54-111"><a href="#cb54-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb54-112"><a href="#cb54-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a>background_Dike<span class="ot">&lt;-</span><span class="st">"Data/shp/Bourgneuf"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb54-115"><a href="#cb54-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-116"><a href="#cb54-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path, <span class="st">"background"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-121"><a href="#cb54-121" aria-hidden="true" tabindex="-1"></a>zoom_Dike_high_sf<span class="ot">&lt;-</span><span class="st">"Data/shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb54-122"><a href="#cb54-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">".shp"</span>,<span class="at">recursive =</span> T,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb54-123"><a href="#cb54-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-124"><a href="#cb54-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"zoom_extent_map_Dike_comparison"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb54-128"><a href="#cb54-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-129"><a href="#cb54-129" aria-hidden="true" tabindex="-1"></a>Dike_rgb_masked<span class="ot">&lt;-</span>Dike_rgb <span class="sc">%&gt;%</span> </span>
<span id="cb54-130"><a href="#cb54-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_Dike) <span class="sc">%&gt;%</span></span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(mask_Dike)</span>
<span id="cb54-132"><a href="#cb54-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-133"><a href="#cb54-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a>zoom_rgb_dike<span class="ot">&lt;-</span>Dike_rgb_masked <span class="sc">%&gt;%</span> </span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_Dike_high_sf)</span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-137"><a href="#cb54-137" aria-hidden="true" tabindex="-1"></a>zoom_rgb_dike_map<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb54-138"><a href="#cb54-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> zoom_rgb_dike,</span>
<span id="cb54-139"><a href="#cb54-139" aria-hidden="true" tabindex="-1"></a>                      <span class="at">r =</span> <span class="dv">3</span>,</span>
<span id="cb54-140"><a href="#cb54-140" aria-hidden="true" tabindex="-1"></a>                      <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a>                      <span class="at">b =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_Dike_high_sf, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">32630</span>)<span class="sc">+</span></span>
<span id="cb54-144"><a href="#cb54-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb54-145"><a href="#cb54-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-147"><a href="#cb54-147" aria-hidden="true" tabindex="-1"></a>RGB_Dike_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb54-148"><a href="#cb54-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">""</span>,  </span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Dike,</span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb54-153"><a href="#cb54-153" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb54-154"><a href="#cb54-154" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb54-156"><a href="#cb54-156" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb54-157"><a href="#cb54-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Dike,</span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_rgb</span>(<span class="at">data =</span> Dike_rgb_masked,</span>
<span id="cb54-164"><a href="#cb54-164" aria-hidden="true" tabindex="-1"></a>                      <span class="at">r =</span> <span class="dv">3</span>,</span>
<span id="cb54-165"><a href="#cb54-165" aria-hidden="true" tabindex="-1"></a>                      <span class="at">g =</span> <span class="dv">2</span>,</span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a>                      <span class="at">b =</span> <span class="dv">1</span>,</span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># maxcell = 500,</span></span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a>                      <span class="at">maxcell =</span> <span class="dv">500832</span><span class="sc">*</span><span class="dv">8</span></span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a>                      )<span class="sc">+</span></span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_Dike_high_sf, </span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>, </span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(zoom_rgb_dike_map), </span>
<span id="cb54-176"><a href="#cb54-176" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">2.226</span>, </span>
<span id="cb54-177"><a href="#cb54-177" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">46.9888</span>,</span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">46.9893</span>) <span class="sc">+</span></span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(p1),</span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">2.226</span>,</span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">46.9875</span>) <span class="sc">+</span></span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.226834</span>,<span class="sc">-</span><span class="fl">2.225905</span>,<span class="sc">-</span><span class="fl">2.226834</span>,<span class="sc">-</span><span class="fl">2.225905</span>),</span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">46.9886439</span>,<span class="fl">46.9892105</span>,<span class="fl">46.9885538</span>,<span class="fl">46.988805</span>),</span>
<span id="cb54-185"><a href="#cb54-185" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb54-186"><a href="#cb54-186" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-187"><a href="#cb54-187" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"tl"</span>,<span class="at">text_cex=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.2293</span>,<span class="sc">-</span><span class="fl">2.2253</span>),</span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="sc">-</span><span class="fl">2.228</span>)<span class="sc">+</span></span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">46.9882</span>,<span class="fl">46.98935</span>),</span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="fl">46.9890</span>)<span class="sc">+</span></span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-194"><a href="#cb54-194" aria-hidden="true" tabindex="-1"></a>    <span class="co"># axis.text.x =element_text(size = 20, angle = 20, hjust = 1),</span></span>
<span id="cb54-195"><a href="#cb54-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span><span class="fu">element_blank</span>(),</span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a>   <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-200"><a href="#cb54-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-201"><a href="#cb54-201" aria-hidden="true" tabindex="-1"></a><span class="do">##### Pred ######</span></span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a>Dike_Pred<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span> </span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(path,<span class="st">"Noirmoutier_highPrediction_nnNewStanRawMetrics_Preds_NoXantho_7_4326.tif"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span> </span>
<span id="cb54-206"><a href="#cb54-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb54-207"><a href="#cb54-207" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Dike_Pred)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"layer"</span>)</span>
<span id="cb54-208"><a href="#cb54-208" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Dike_Pred)[<span class="fu">values</span>(Dike_Pred) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb54-209"><a href="#cb54-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-210"><a href="#cb54-210" aria-hidden="true" tabindex="-1"></a>Dike_Pred_masked<span class="ot">&lt;-</span>Dike_Pred <span class="sc">%&gt;%</span> </span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_Dike) <span class="sc">%&gt;%</span> </span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mask</span>(mask_Dike) <span class="sc">%&gt;%</span> </span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a>zoom_Pred_dike<span class="ot">&lt;-</span>Dike_Pred_masked <span class="sc">%&gt;%</span> </span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(zoom_Dike_high_sf)</span>
<span id="cb54-217"><a href="#cb54-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-218"><a href="#cb54-218" aria-hidden="true" tabindex="-1"></a>zoom_Pred_dike_map<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> zoom_Pred_dike, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer), <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb54-220"><a href="#cb54-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>,<span class="st">"#b3ff1a"</span>,<span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#42c9bc"</span>),</span>
<span id="cb54-221"><a href="#cb54-221" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb54-224"><a href="#cb54-224" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorphyceae"</span>,</span>
<span id="cb54-225"><a href="#cb54-225" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb54-226"><a href="#cb54-226" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb54-227"><a href="#cb54-227" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_Dike_high_sf, <span class="at">fill =</span> <span class="st">"transparent"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-232"><a href="#cb54-232" aria-hidden="true" tabindex="-1"></a>Dike_pred_map<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb54-233"><a href="#cb54-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Dike, </span>
<span id="cb54-234"><a href="#cb54-234" aria-hidden="true" tabindex="-1"></a>          <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Type),</span>
<span id="cb54-235"><a href="#cb54-235" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb54-237"><a href="#cb54-237" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.93</span>,</span>
<span id="cb54-238"><a href="#cb54-238" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"grey30"</span>)<span class="sc">+</span></span>
<span id="cb54-239"><a href="#cb54-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> background_Dike,</span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.legend =</span> F, </span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth=</span><span class="fl">0.05</span>,</span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha=</span><span class="fl">0.4</span>,</span>
<span id="cb54-244"><a href="#cb54-244" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb54-245"><a href="#cb54-245" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="st">""</span>,  </span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Intertidal area"</span>, <span class="st">"Land area"</span>, <span class="st">"water"</span>),</span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7DC27D"</span>, <span class="st">"#CFCFCF"</span>,<span class="st">"#42c9bc"</span>))<span class="sc">+</span></span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale</span>(<span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> Dike_Pred_masked, </span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> layer),</span>
<span id="cb54-251"><a href="#cb54-251" aria-hidden="true" tabindex="-1"></a>                             <span class="at">maxcell =</span> <span class="dv">5010420</span>,</span>
<span id="cb54-252"><a href="#cb54-252" aria-hidden="true" tabindex="-1"></a>                             )<span class="sc">+</span></span>
<span id="cb54-253"><a href="#cb54-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>),</span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"#70543e"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>, <span class="st">"#42c9bc"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb54-256"><a href="#cb54-256" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb54-257"><a href="#cb54-257" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,</span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Water"</span>))<span class="sc">+</span></span>
<span id="cb54-264"><a href="#cb54-264" aria-hidden="true" tabindex="-1"></a>  ggnewscale<span class="sc">::</span><span class="fu">new_scale</span>(<span class="st">"fill"</span>)<span class="sc">+</span></span>
<span id="cb54-265"><a href="#cb54-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> zoom_Dike_high_sf, </span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>, </span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb54-268"><a href="#cb54-268" aria-hidden="true" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb54-269"><a href="#cb54-269" aria-hidden="true" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-270"><a href="#cb54-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_custom</span>(<span class="fu">ggplotGrob</span>(zoom_Pred_dike_map), </span>
<span id="cb54-271"><a href="#cb54-271" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xmin =</span> <span class="sc">-</span><span class="fl">2.226</span>, </span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> <span class="fl">46.9888</span>,</span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fl">46.9893</span>) <span class="sc">+</span></span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(x,y,<span class="at">group=</span>grp),</span>
<span id="cb54-275"><a href="#cb54-275" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.226834</span>,<span class="sc">-</span><span class="fl">2.225905</span>,<span class="sc">-</span><span class="fl">2.226834</span>,<span class="sc">-</span><span class="fl">2.225905</span>),</span>
<span id="cb54-276"><a href="#cb54-276" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y=</span><span class="fu">c</span>(<span class="fl">46.9886439</span>,<span class="fl">46.9892105</span>,<span class="fl">46.9885538</span>,<span class="fl">46.988805</span>),</span>
<span id="cb54-277"><a href="#cb54-277" aria-hidden="true" tabindex="-1"></a>                              <span class="at">grp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotation_custom(ggplotGrob(Boat_Pred_zoomed_map), xmin = -8.697, xmax = -8.692, ymin = 40.667,ymax = 40.6705) +</span></span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">+</span></span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span> <span class="dv">20</span>,<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.50</span>),</span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>,<span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.2293</span>,<span class="sc">-</span><span class="fl">2.2253</span>),</span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="sc">-</span><span class="fl">2.228</span>)<span class="sc">+</span></span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">46.9882</span>,<span class="fl">46.98935</span>),</span>
<span id="cb54-292"><a href="#cb54-292" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="fl">46.9890</span>)</span>
<span id="cb54-293"><a href="#cb54-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-294"><a href="#cb54-294" aria-hidden="true" tabindex="-1"></a><span class="do">################# PLOT AND SAVING ###########</span></span>
<span id="cb54-295"><a href="#cb54-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-296"><a href="#cb54-296" aria-hidden="true" tabindex="-1"></a>plot_Dike<span class="ot">&lt;-</span>RGB_Dike_map<span class="sc">/</span></span>
<span id="cb54-297"><a href="#cb54-297" aria-hidden="true" tabindex="-1"></a>  Dike_pred_map</span>
<span id="cb54-298"><a href="#cb54-298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-299"><a href="#cb54-299" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Maps Pred/FigX-Dike_Pred.png"</span>,plot_Dike , <span class="at">width =</span> <span class="dv">1200</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">900</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [29]:</pre></div><div id="cell-fig-Dike" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Maps Pred/FigX-Dike_Pred.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Dike" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Dike-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Maps%20Pred/FigX-Dike_Pred.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="./Figures/Maps%20Pred/FigX-Dike_Pred.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Dike-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: RGB orthomosaic (Top) and Prediction (Bottom) of Northern part of Noirmoutier Island, France. The total extent of this flight is about 28 000 m² with a resolution of 80 mm per pixel. Background colors means intertidal area (Light Green) and land area (Light Grey). The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="validation-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="validation-1"><span class="header-section-number">3.2</span> Validation</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [30]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="st">"Output/Validation_data"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="st">"ResultsNewNN_NoXanthowithNDVIWithOldandBoat.csv"</span>,<span class="at">recursive =</span> T, <span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Truth_ID =</span> <span class="st">"Truth"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Truth =</span>  <span class="fu">case_when</span>(Truth_ID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sediment"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Sediment"</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Water"</span>,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"Spartina"</span>,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>                          Truth_ID <span class="sc">==</span> <span class="dv">41</span> <span class="sc">~</span> <span class="st">"Bleached seagrasses"</span>,</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred_Class =</span> <span class="fu">case_when</span>(Pred_Class <span class="sc">==</span> <span class="st">"Clorophyta"</span> <span class="sc">~</span> <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"Phaeophyta"</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"Rhodphyta"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"Deep_Sediment"</span> <span class="sc">~</span> <span class="st">"Sediment"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"MPB"</span> <span class="sc">~</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>                                Pred_Class <span class="sc">==</span> <span class="st">"Bare_Sediment"</span> <span class="sc">~</span> <span class="st">"Sediment"</span>,</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>                                 Pred_Class <span class="sc">==</span> <span class="st">"Magnoliosida"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>                                (Pred_Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">&amp;</span> NDVI <span class="sc">&gt;</span> <span class="fl">0.2</span>) <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>                                (Pred_Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">&amp;</span> NDVI <span class="sc">&lt;=</span> <span class="fl">0.2</span> )<span class="sc">~</span> <span class="st">"Sediment"</span>,</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Pred_Class)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Truth <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>                Truth  <span class="sc">!=</span> <span class="st">"Spartina"</span>,</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>                Truth <span class="sc">!=</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>                Truth <span class="sc">!=</span> <span class="st">"Bleached seagrasses"</span>,</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>                Truth <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Pred_Class != "Low_SPC",</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>                Pred_Class <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>                 Pred_Class <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>                 Pred_Class <span class="sc">!=</span> <span class="st">"SunGlint"</span>,</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>Flight <span class="sc">==</span> <span class="st">"Handfisher_1_old"</span>,</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>Flight <span class="sc">==</span> <span class="st">"Handfisher_2_old"</span>,</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>                <span class="sc">!</span>Flight <span class="sc">==</span> <span class="st">"Handfisher_2"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>NDVI)</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">as.character</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Truth))</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">as.character</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Pred_Class))</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>ab<span class="ot">&lt;-</span><span class="fu">setdiff</span>(a,b)</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>ba<span class="ot">&lt;-</span><span class="fu">setdiff</span>(b,a)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>(<span class="fu">length</span>(ab) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">length</span>(ba) <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>lines_to_add<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Pred_Class =</span> <span class="fu">c</span>(ab,ba),</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Pred_ID =</span> <span class="cn">NA</span>,</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Flight =</span> <span class="cn">NA</span>,</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Truth_ID =</span> <span class="cn">NA</span>,</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Truth =</span> <span class="fu">c</span>(ab,ba))</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(lines_to_add)</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(lines_to_add)</span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred_Class =</span> <span class="fu">as_factor</span>(Pred_Class),</span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>         <span class="at">Truth =</span> <span class="fu">as_factor</span>(Truth),</span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>         <span class="at">Truth =</span> <span class="fu">fct_relevel</span>(Truth, <span class="fu">c</span>(<span class="st">"Sediment"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Phaeophyceae"</span>)),</span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pred_Class =</span> <span class="fu">fct_relevel</span>(Pred_Class, <span class="fu">c</span>(<span class="st">"Sediment"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Phaeophyceae"</span>)),</span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>         <span class="at">Flight =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(Flight, <span class="st">"Boat"</span>) <span class="sc">~</span> <span class="st">"Boat"</span>,</span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> Flight))</span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a><span class="do">####### GafanahaLow #######</span></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>df_GafanhaLow<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"GafanhaLow"</span>)</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>validation_metrics_GafanhaLow<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_GafanhaLow<span class="sc">$</span>Pred_Class,df_GafanhaLow<span class="sc">$</span>Truth)</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a>conf_mat_GafanhaLow<span class="ot">&lt;-</span>validation_metrics_GafanhaLow[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a>conf_mat_GafanhaLow[<span class="dv">6</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a>conf_mat_GafanhaLow[,<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_GafanhaLow))){</span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_GafanhaLow[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_GafanhaLow[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a>conf_mat_std_GafanhaLow<span class="ot">&lt;-</span>conf_mat_GafanhaLow</span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_GafanhaLow)){</span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_GafanhaLow)){</span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_GafanhaLow[row,col]<span class="ot">&lt;-</span>conf_mat_std_GafanhaLow[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_GafanhaLow[row,col])</span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaLow<span class="ot">&lt;-</span>conf_mat_std_GafanhaLow <span class="sc">%&gt;%</span> </span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-106"><a href="#cb56-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-107"><a href="#cb56-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb56-108"><a href="#cb56-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-109"><a href="#cb56-109" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaLow<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_GafanhaLow, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb56-110"><a href="#cb56-110" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_GafanhaLow)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb56-111"><a href="#cb56-111" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_GafanhaLow)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">18.1</span>,<span class="fl">21.9</span>,<span class="fl">8.2</span>,<span class="fl">11.8</span>)</span>
<span id="cb56-112"><a href="#cb56-112" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaLow_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_GafanhaLow,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb56-113"><a href="#cb56-113" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb56-114"><a href="#cb56-114" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaLow_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_GafanhaLow_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_GafanhaLow)[<span class="fu">values</span>(confmat_rast_GafanhaLow) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_GafanhaLow)[<span class="fu">values</span>(confmat_rast_GafanhaLow) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="do">####### GafanhaHigh #######</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>df_GafanhaHigh<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"GafanhaHigh"</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>validation_metrics_GafanhaHigh<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_GafanhaHigh<span class="sc">$</span>Pred_Class,df_GafanhaHigh<span class="sc">$</span>Truth)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>conf_mat_GafanhaHigh<span class="ot">&lt;-</span>validation_metrics_GafanhaHigh[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>conf_mat_GafanhaHigh[<span class="dv">6</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>conf_mat_GafanhaHigh[,<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_GafanhaHigh))){</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_GafanhaHigh[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_GafanhaHigh[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>conf_mat_std_GafanhaHigh<span class="ot">&lt;-</span>conf_mat_GafanhaHigh</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_GafanhaHigh)){</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_GafanhaHigh)){</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_GafanhaHigh[row,col]<span class="ot">&lt;-</span>conf_mat_std_GafanhaHigh[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_GafanhaHigh[row,col])</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaHigh<span class="ot">&lt;-</span>conf_mat_std_GafanhaHigh <span class="sc">%&gt;%</span> </span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaHigh<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_GafanhaHigh, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_GafanhaHigh)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_GafanhaHigh)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">14.1</span>,<span class="fl">17.9</span>,<span class="fl">8.2</span>,<span class="fl">11.8</span>)</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaHigh_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_GafanhaHigh,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaHigh_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_GafanhaHigh_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_GafanhaHigh)[<span class="fu">values</span>(confmat_rast_GafanhaHigh) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_GafanhaHigh)[<span class="fu">values</span>(confmat_rast_GafanhaHigh) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_GafanhaHigh &lt;-</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_GafanhaHigh),</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Gafanha Low")+</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a><span class="do">####### DuerLow #######</span></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>df_DuerLow<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"DuerLow"</span>)</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>validation_metrics_DuerLow<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_DuerLow<span class="sc">$</span>Pred_Class,df_DuerLow<span class="sc">$</span>Truth)</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>conf_mat_DuerLow<span class="ot">&lt;-</span>validation_metrics_DuerLow[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>conf_mat_DuerLow[<span class="dv">5</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>conf_mat_DuerLow[,<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_DuerLow))){</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_DuerLow[i,], <span class="at">na.rm =</span> T)</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_DuerLow[,i], <span class="at">na.rm =</span> T)</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>conf_mat_std_DuerLow<span class="ot">&lt;-</span>conf_mat_DuerLow</span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a><span class="co"># for(row in 1:nrow(conf_mat_std_DuerLow)){</span></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a><span class="co">#   for(col in 1:ncol(conf_mat_std_DuerLow)){</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     conf_mat_std_DuerLow[row,col]&lt;-conf_mat_std_DuerLow[row,col]/((df_sum$row[row] + df_sum$col[col])-conf_mat_std_DuerLow[row,col])</span></span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_DuerLow)){</span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_DuerLow)){</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_DuerLow[row,col]<span class="ot">&lt;-</span>conf_mat_std_DuerLow[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>col[col]))</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a>confmat_rast_DuerLow<span class="ot">&lt;-</span>conf_mat_std_DuerLow <span class="sc">%&gt;%</span> </span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a>confmat_rast_DuerLow<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_DuerLow, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_DuerLow)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_DuerLow)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">18.1</span>,<span class="fl">21.9</span>,<span class="dv">0</span>,<span class="fl">3.8</span>)</span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a>confmat_rast_DuerLow_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_DuerLow,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a>confmat_rast_DuerLow_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_DuerLow_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_DuerLow)[<span class="fu">values</span>(confmat_rast_DuerLow) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_DuerLow)[<span class="fu">values</span>(confmat_rast_DuerLow) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_DuerLow &lt;-</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_DuerLow),</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Duer Low")+</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="do">####### Horse_rooster #######</span></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>df_Horse_rooster<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Horse_rooster"</span>)</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>validation_metrics_Horse_rooster<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_Horse_rooster<span class="sc">$</span>Pred_Class,df_Horse_rooster<span class="sc">$</span>Truth)</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>conf_mat_Horse_rooster<span class="ot">&lt;-</span>validation_metrics_Horse_rooster[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>conf_mat_Horse_rooster[<span class="dv">6</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>conf_mat_Horse_rooster[,<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>conf_mat_Horse_rooster[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>conf_mat_Horse_rooster[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_Horse_rooster))){</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Horse_rooster[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Horse_rooster[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>conf_mat_std_Horse_rooster<span class="ot">&lt;-</span>conf_mat_Horse_rooster</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_Horse_rooster)){</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_Horse_rooster)){</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_Horse_rooster[row,col]<span class="ot">&lt;-</span>conf_mat_std_Horse_rooster[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_Horse_rooster[row,col])</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>confmat_rast_Horse_rooster<span class="ot">&lt;-</span>conf_mat_std_Horse_rooster <span class="sc">%&gt;%</span> </span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true" tabindex="-1"></a>confmat_rast_Horse_rooster<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_Horse_rooster, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_Horse_rooster)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_Horse_rooster)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">14.1</span>,<span class="fl">17.9</span>,<span class="fl">4.2</span>,<span class="fl">7.8</span>)</span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true" tabindex="-1"></a>confmat_rast_Horse_rooster_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_Horse_rooster,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true" tabindex="-1"></a>confmat_rast_Horse_rooster_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_Horse_rooster_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Horse_rooster)[<span class="fu">values</span>(confmat_rast_Horse_rooster) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Horse_rooster)[<span class="fu">values</span>(confmat_rast_Horse_rooster) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_Horse_rooster &lt;-</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_Horse_rooster),</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed",</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Mataducos")+</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="do">####### Handfisher_1 #######</span></span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>df_Handfisher_1<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Handfisher_1"</span>)</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>validation_metrics_Handfisher_1<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_Handfisher_1<span class="sc">$</span>Pred_Class,df_Handfisher_1<span class="sc">$</span>Truth)</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1<span class="ot">&lt;-</span>validation_metrics_Handfisher_1[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[<span class="dv">5</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[<span class="dv">6</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[<span class="dv">3</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[,<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[,<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>conf_mat_Handfisher_1[,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_Handfisher_1))){</span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Handfisher_1[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Handfisher_1[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a>conf_mat_std_Handfisher_1<span class="ot">&lt;-</span>conf_mat_Handfisher_1</span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_Handfisher_1)){</span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_Handfisher_1)){</span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_Handfisher_1[row,col]<span class="ot">&lt;-</span>conf_mat_std_Handfisher_1[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_Handfisher_1[row,col])</span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a>confmat_rast_Handfisher_1<span class="ot">&lt;-</span>conf_mat_std_Handfisher_1 <span class="sc">%&gt;%</span> </span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a>confmat_rast_Handfisher_1<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_Handfisher_1, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_Handfisher_1)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_Handfisher_1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">22.1</span>,<span class="fl">25.9</span>,<span class="fl">4.2</span>,<span class="fl">7.8</span>)</span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a>confmat_rast_Handfisher_1_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_Handfisher_1,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a>confmat_rast_Handfisher_1_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_Handfisher_1_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Handfisher_1)[<span class="fu">values</span>(confmat_rast_Handfisher_1) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Handfisher_1)[<span class="fu">values</span>(confmat_rast_Handfisher_1) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_Handfisher_1 &lt;-</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_Handfisher_1),</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Barbatre")+</span></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a><span class="do">####### Boat #######</span></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>df_Boat<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Boat"</span>)</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>validation_metrics_Boat<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_Boat<span class="sc">$</span>Pred_Class,df_Boat<span class="sc">$</span>Truth)</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>conf_mat_Boat<span class="ot">&lt;-</span>validation_metrics_Boat[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>conf_mat_Boat[<span class="dv">6</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>conf_mat_Boat[,<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>conf_mat_Boat[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>conf_mat_Boat[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_Boat))){</span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Boat[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Boat[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>conf_mat_std_Boat<span class="ot">&lt;-</span>conf_mat_Boat</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_Boat)){</span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_Boat)){</span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_Boat[row,col]<span class="ot">&lt;-</span>conf_mat_std_Boat[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_Boat[row,col])</span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a>confmat_rast_Boat<span class="ot">&lt;-</span>conf_mat_std_Boat <span class="sc">%&gt;%</span> </span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true" tabindex="-1"></a>confmat_rast_Boat<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_Boat, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_Boat)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_Boat)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">22.1</span>,<span class="fl">25.9</span>,<span class="fl">8.2</span>,<span class="fl">11.8</span>)</span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true" tabindex="-1"></a>confmat_rast_Boat_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_Boat,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb66-84"><a href="#cb66-84" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb66-85"><a href="#cb66-85" aria-hidden="true" tabindex="-1"></a>confmat_rast_Boat_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_Boat_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Boat)[<span class="fu">values</span>(confmat_rast_Boat) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Boat)[<span class="fu">values</span>(confmat_rast_Boat) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_Boat &lt;-</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_Boat),</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Inner Lagoon")+</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="do">####### Arz #######</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>df_Arz<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Arz"</span>)</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>validation_metrics_Arz<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_Arz<span class="sc">$</span>Pred_Class,df_Arz<span class="sc">$</span>Truth)</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz<span class="ot">&lt;-</span>validation_metrics_Arz[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz[<span class="dv">3</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz[,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz[<span class="dv">5</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>conf_mat_Arz[,<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_Arz))){</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Arz[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Arz[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>conf_mat_std_Arz<span class="ot">&lt;-</span>conf_mat_Arz</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_Arz)){</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_Arz)){</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_Arz[row,col]<span class="ot">&lt;-</span>conf_mat_std_Arz[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_Arz[row,col])</span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>confmat_rast_Arz<span class="ot">&lt;-</span>conf_mat_std_Arz <span class="sc">%&gt;%</span> </span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a>confmat_rast_Arz<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_Arz, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_Arz)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_Arz)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">14.1</span>,<span class="fl">17.9</span>,<span class="dv">0</span>,<span class="fl">3.8</span>)</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a>confmat_rast_Arz_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_Arz,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>confmat_rast_Arz_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_Arz_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Arz)[<span class="fu">values</span>(confmat_rast_Arz) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Arz)[<span class="fu">values</span>(confmat_rast_Arz) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_Arz &lt;-</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_Arz),</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Arz Island")+</span></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a><span class="do">####### NorthDike #######</span></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>df_NorthDike<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"NorthDike"</span>)</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>validation_metrics_NorthDike<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_NorthDike<span class="sc">$</span>Pred_Class,df_NorthDike<span class="sc">$</span>Truth)</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>conf_mat_NorthDike<span class="ot">&lt;-</span>validation_metrics_NorthDike[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a>conf_mat_NorthDike[<span class="dv">5</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a>conf_mat_NorthDike[,<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a>conf_mat_NorthDike[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>conf_mat_NorthDike[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_NorthDike))){</span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_NorthDike[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_NorthDike[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>conf_mat_std_NorthDike<span class="ot">&lt;-</span>conf_mat_NorthDike</span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_NorthDike)){</span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_NorthDike)){</span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_NorthDike[row,col]<span class="ot">&lt;-</span>conf_mat_std_NorthDike[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_NorthDike[row,col])</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a>confmat_rast_NorthDike<span class="ot">&lt;-</span>conf_mat_std_NorthDike <span class="sc">%&gt;%</span> </span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a>confmat_rast_NorthDike<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_NorthDike, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_NorthDike)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_NorthDike)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">18.1</span>,<span class="fl">21.9</span>,<span class="fl">4.2</span>,<span class="fl">7.8</span>)</span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a>confmat_rast_NorthDike_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_NorthDike,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a>confmat_rast_NorthDike_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_NorthDike_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_NorthDike)[<span class="fu">values</span>(confmat_rast_NorthDike) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_NorthDike)[<span class="fu">values</span>(confmat_rast_NorthDike) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_NorthDike &lt;-</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_NorthDike),</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("L'Epine")+</span></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="do">####### Kerdrean #######</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>df_Kerdrean<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Kerdrean"</span>)</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>validation_metrics_Kerdrean<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_Kerdrean<span class="sc">$</span>Pred_Class,df_Kerdrean<span class="sc">$</span>Truth)</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>conf_mat_Kerdrean<span class="ot">&lt;-</span>validation_metrics_Kerdrean[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>conf_mat_Kerdrean[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>conf_mat_Kerdrean[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_Kerdrean))){</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Kerdrean[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_Kerdrean[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>conf_mat_std_Kerdrean<span class="ot">&lt;-</span>conf_mat_Kerdrean</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_Kerdrean)){</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_Kerdrean)){</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_Kerdrean[row,col]<span class="ot">&lt;-</span>conf_mat_std_Kerdrean[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_Kerdrean[row,col])</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>confmat_rast_Kerdrean<span class="ot">&lt;-</span>conf_mat_std_Kerdrean <span class="sc">%&gt;%</span> </span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>confmat_rast_Kerdrean<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_Kerdrean, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_Kerdrean)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_Kerdrean)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">22.1</span>,<span class="fl">25.9</span>,<span class="dv">0</span>,<span class="fl">3.8</span>)</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a>confmat_rast_Kerdrean_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_Kerdrean,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>confmat_rast_Kerdrean_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_Kerdrean_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Kerdrean)[<span class="fu">values</span>(confmat_rast_Kerdrean) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_Kerdrean)[<span class="fu">values</span>(confmat_rast_Kerdrean) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_Kerdrean &lt;-</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot()+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_spatraster(data = (confmat_rast_Kerdrean),</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                   show.legend = F,</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.rm = TRUE</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                   )+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_Bede("mixed", </span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                   discrete = F,</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                   na.value = "white",</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                   trans = "sqrt",</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                   labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                   breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(fill = "Proportion \n of pixels (%)")+</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Sediment","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0),</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                      position = "top",</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_y_continuous(breaks = seq(1,9, by = 2),</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels = c("Phaeophyceae","Rhodophyceae","Magnoliopsida","Chlorophyceae","Sediment"),</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                      expand = c(0, 0.1),</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                      limits = c(0,10))+</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_path(</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = data.frame(</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       x = c(0,10,0,10,0,10,0,10,0,10,0,10,0,0,2,2,4,4,6,6,8,8,10,10),</span></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="co">#       y = c(0,0,2,2,4,4,6,6,8,8,10,10,0,10,0,10,0,10,0,10,0,10,0,10),</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="co">#       group = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12)</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     aes(x,y,group= group),</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     linewidth = 1</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     )+</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_void()+</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("L'Epine")+</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(plot.title = element_text(hjust = 0.5),</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot.margin = unit(c(0,30,0,30), "pt"))</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>confmat_rast_Arz_centroid<span class="ot">&lt;-</span>confmat_rast_Arz_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Arz"</span>)</span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>confmat_rast_Boat_centroid<span class="ot">&lt;-</span>confmat_rast_Boat_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Boat"</span>)</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>confmat_rast_DuerLow_centroid<span class="ot">&lt;-</span>confmat_rast_DuerLow_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"DuerLow"</span>)</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaHigh_centroid<span class="ot">&lt;-</span>confmat_rast_GafanhaHigh_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Gaf_High"</span>)</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>confmat_rast_GafanhaLow_centroid<span class="ot">&lt;-</span>confmat_rast_GafanhaLow_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Gaf_Low"</span>)</span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>confmat_rast_Handfisher_1_centroid<span class="ot">&lt;-</span>confmat_rast_Handfisher_1_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Handfisher"</span>)</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a>confmat_rast_Horse_rooster_centroid<span class="ot">&lt;-</span>confmat_rast_Horse_rooster_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Rooster"</span>)</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>confmat_rast_Kerdrean_centroid<span class="ot">&lt;-</span>confmat_rast_Kerdrean_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"kerdrean"</span>)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a>confmat_rast_NorthDike_centroid<span class="ot">&lt;-</span>confmat_rast_NorthDike_centroid <span class="sc">%&gt;%</span> </span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">site =</span> <span class="st">"Dike"</span>)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>centroid_cells<span class="ot">&lt;-</span><span class="fu">rbind</span>(confmat_rast_Arz_centroid,confmat_rast_Boat_centroid,confmat_rast_DuerLow_centroid,confmat_rast_GafanhaHigh_centroid,confmat_rast_GafanhaLow_centroid,confmat_rast_Handfisher_1_centroid,confmat_rast_Horse_rooster_centroid,confmat_rast_Kerdrean_centroid,confmat_rast_NorthDike_centroid) <span class="sc">%&gt;%</span> </span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(layer <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a><span class="do">##### Global #####</span></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a>validation_metrics<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df<span class="sc">$</span>Pred_Class,df<span class="sc">$</span>Truth)</span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>metrics_by_class<span class="ot">&lt;-</span>validation_metrics<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>conf_mat<span class="ot">&lt;-</span>validation_metrics[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat))){</span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat[i,])</span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat[,i])</span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a>conf_mat_std<span class="ot">&lt;-</span>conf_mat</span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std)){</span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std)){</span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a>    conf_mat_std[row,col]<span class="ot">&lt;-</span>conf_mat_std[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std[row,col])</span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a>confmat_rast<span class="ot">&lt;-</span>conf_mat_std <span class="sc">%&gt;%</span> </span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>)</span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a><span class="co"># crs(confmat_rast)&lt;-"4326"</span></span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a> <span class="fu">values</span>(confmat_rast)[<span class="fu">values</span>(confmat_rast) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a>df_summarize<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Flight) <span class="sc">%&gt;%</span> </span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">length</span>(Flight)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-112"><a href="#cb74-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-113"><a href="#cb74-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="fu">case_when</span>(Flight <span class="sc">==</span> <span class="st">"GafanhaHigh"</span> <span class="sc">~</span> <span class="st">"Gafanha High"</span>,</span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"GafanhaLow"</span> <span class="sc">~</span> <span class="st">"Gafanha Low"</span>,</span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"Boat"</span> <span class="sc">~</span> <span class="st">"Marinha Lanzarote"</span>,</span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"Horse_rooster"</span> <span class="sc">~</span> <span class="st">"Mataducos"</span>,</span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"NorthDike"</span> <span class="sc">~</span> <span class="st">"L'Epine"</span>,</span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"Handfisher_1"</span> <span class="sc">~</span> <span class="st">"Barbâtre"</span>,</span>
<span id="cb74-120"><a href="#cb74-120" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"Arz"</span> <span class="sc">~</span> <span class="st">"Arz Island"</span>,</span>
<span id="cb74-121"><a href="#cb74-121" aria-hidden="true" tabindex="-1"></a>                   Flight <span class="sc">==</span> <span class="st">"DuerLow"</span> <span class="sc">~</span> <span class="st">"Duer"</span>,</span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a>                   <span class="cn">TRUE</span> <span class="sc">~</span> Flight))</span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a>df_corrected_accuracy<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>),</span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">lab =</span> <span class="fu">c</span>(metrics_by_class[<span class="dv">1</span>,<span class="dv">11</span>],metrics_by_class[<span class="dv">2</span>,<span class="dv">11</span>], metrics_by_class[<span class="dv">3</span>,<span class="dv">11</span>], metrics_by_class[<span class="dv">4</span>,<span class="dv">11</span>],metrics_by_class[<span class="dv">5</span>,<span class="dv">11</span>],metrics_by_class[<span class="dv">6</span>,<span class="dv">11</span>]))</span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a>df_Sens_Spec<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-130"><a href="#cb74-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>, <span class="dv">11</span>, <span class="fl">12.9</span>, <span class="fl">12.9</span>, <span class="fl">12.9</span>, <span class="fl">12.9</span>, <span class="fl">12.9</span>,<span class="fl">12.9</span>),</span>
<span id="cb74-131"><a href="#cb74-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="dv">11</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="fu">c</span>(metrics_by_class<span class="sc">$</span>Recall[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)],metrics_by_class<span class="sc">$</span>Precision[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)])</span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-134"><a href="#cb74-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-135"><a href="#cb74-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>df_Label_Sites<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">24</span>),</span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>),</span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"Gafanha High, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"GafanhaHigh"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Gafanha Low, "</span>,df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-145"><a href="#cb74-145" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"GafanhaLow"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-146"><a href="#cb74-146" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-147"><a href="#cb74-147" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-148"><a href="#cb74-148" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Inner Lagoon, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-149"><a href="#cb74-149" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Boat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-150"><a href="#cb74-150" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-151"><a href="#cb74-151" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-152"><a href="#cb74-152" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Mataducos, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-153"><a href="#cb74-153" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Horse_rooster"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-154"><a href="#cb74-154" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-155"><a href="#cb74-155" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-156"><a href="#cb74-156" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"L'Epine, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-157"><a href="#cb74-157" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"NorthDike"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-158"><a href="#cb74-158" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-159"><a href="#cb74-159" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-160"><a href="#cb74-160" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Barbâtre, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-161"><a href="#cb74-161" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Handfisher_1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-162"><a href="#cb74-162" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-163"><a href="#cb74-163" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-164"><a href="#cb74-164" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Arz Island, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-165"><a href="#cb74-165" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Arz"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-166"><a href="#cb74-166" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-167"><a href="#cb74-167" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-168"><a href="#cb74-168" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Duer, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-169"><a href="#cb74-169" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"DuerLow"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-170"><a href="#cb74-170" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-171"><a href="#cb74-171" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)),</span>
<span id="cb74-172"><a href="#cb74-172" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="st">"Kerdrean, "</span>, df_summarize <span class="sc">%&gt;%</span> </span>
<span id="cb74-173"><a href="#cb74-173" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">filter</span>(Flight <span class="sc">==</span> <span class="st">"Kerdrean"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-174"><a href="#cb74-174" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">pull</span>(prop) <span class="sc">%&gt;%</span> </span>
<span id="cb74-175"><a href="#cb74-175" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">round</span>(<span class="dv">2</span>)))</span>
<span id="cb74-176"><a href="#cb74-176" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-177"><a href="#cb74-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-178"><a href="#cb74-178" aria-hidden="true" tabindex="-1"></a>x_axis_text<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-179"><a href="#cb74-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>),</span>
<span id="cb74-180"><a href="#cb74-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">12.5</span>,<span class="fl">12.5</span>,<span class="fl">12.5</span>,<span class="fl">12.5</span>,<span class="fl">12.5</span>,<span class="fl">12.5</span>),</span>
<span id="cb74-181"><a href="#cb74-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Phaeophyceae"</span>)</span>
<span id="cb74-182"><a href="#cb74-182" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-183"><a href="#cb74-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-184"><a href="#cb74-184" aria-hidden="true" tabindex="-1"></a>y_axis_text<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-185"><a href="#cb74-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>),</span>
<span id="cb74-186"><a href="#cb74-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb74-187"><a href="#cb74-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Phaeophyceae"</span>)</span>
<span id="cb74-188"><a href="#cb74-188" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-189"><a href="#cb74-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-190"><a href="#cb74-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-191"><a href="#cb74-191" aria-hidden="true" tabindex="-1"></a>centroid_cells_df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">st_coordinates</span>(<span class="fu">st_cast</span>(centroid_cells<span class="sc">$</span>geometry,<span class="st">"MULTIPOINT"</span>)),centroid_cells<span class="sc">$</span>site)</span>
<span id="cb74-192"><a href="#cb74-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-193"><a href="#cb74-193" aria-hidden="true" tabindex="-1"></a>centroid_cells_df<span class="sc">$</span>col <span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb74-194"><a href="#cb74-194" aria-hidden="true" tabindex="-1"></a>centroid_cells_df<span class="sc">$</span>row <span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb74-195"><a href="#cb74-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-196"><a href="#cb74-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-197"><a href="#cb74-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-198"><a href="#cb74-198" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(centroid_cells_df<span class="sc">$</span>centroid_cells.site))){</span>
<span id="cb74-199"><a href="#cb74-199" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-200"><a href="#cb74-200" aria-hidden="true" tabindex="-1"></a>  df_temp<span class="ot">&lt;-</span>centroid_cells_df <span class="sc">%&gt;%</span> </span>
<span id="cb74-201"><a href="#cb74-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(centroid_cells_df<span class="sc">$</span>centroid_cells.site <span class="sc">==</span> <span class="fu">unique</span>(centroid_cells_df<span class="sc">$</span>centroid_cells.site)[i])</span>
<span id="cb74-202"><a href="#cb74-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-203"><a href="#cb74-203" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Column </span></span>
<span id="cb74-204"><a href="#cb74-204" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-205"><a href="#cb74-205" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>( ii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.character</span>(df_temp<span class="sc">$</span>X)))){</span>
<span id="cb74-206"><a href="#cb74-206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(df_temp <span class="sc">%&gt;%</span> </span>
<span id="cb74-207"><a href="#cb74-207" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(X <span class="sc">==</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(df_temp<span class="sc">$</span>X))[ii])) <span class="sc">==</span> <span class="dv">6</span>){</span>
<span id="cb74-208"><a href="#cb74-208" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-209"><a href="#cb74-209" aria-hidden="true" tabindex="-1"></a>      centroid_cells_df<span class="ot">&lt;-</span>centroid_cells_df <span class="sc">%&gt;%</span> </span>
<span id="cb74-210"><a href="#cb74-210" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">case_when</span>(centroid_cells.site <span class="sc">==</span> <span class="fu">unique</span>(centroid_cells_df<span class="sc">$</span>centroid_cells.site)[i] <span class="sc">~</span></span>
<span id="cb74-211"><a href="#cb74-211" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">case_when</span>(<span class="fu">as.character</span>(X) <span class="sc">==</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(df_temp<span class="sc">$</span>X))[ii] <span class="sc">~</span> </span>
<span id="cb74-212"><a href="#cb74-212" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">paste0</span>(<span class="st">"col"</span>,ii),</span>
<span id="cb74-213"><a href="#cb74-213" aria-hidden="true" tabindex="-1"></a>                                   <span class="cn">TRUE</span> <span class="sc">~</span> col),</span>
<span id="cb74-214"><a href="#cb74-214" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> col))</span>
<span id="cb74-215"><a href="#cb74-215" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-216"><a href="#cb74-216" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-217"><a href="#cb74-217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-218"><a href="#cb74-218" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### ROW</span></span>
<span id="cb74-219"><a href="#cb74-219" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>( iii <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.character</span>(df_temp<span class="sc">$</span>Y)))){</span>
<span id="cb74-220"><a href="#cb74-220" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(df_temp <span class="sc">%&gt;%</span> </span>
<span id="cb74-221"><a href="#cb74-221" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(Y <span class="sc">==</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(df_temp<span class="sc">$</span>Y))[iii])) <span class="sc">==</span> <span class="dv">6</span>){</span>
<span id="cb74-222"><a href="#cb74-222" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb74-223"><a href="#cb74-223" aria-hidden="true" tabindex="-1"></a>      centroid_cells_df<span class="ot">&lt;-</span>centroid_cells_df <span class="sc">%&gt;%</span> </span>
<span id="cb74-224"><a href="#cb74-224" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">case_when</span>(centroid_cells.site <span class="sc">==</span> <span class="fu">unique</span>(centroid_cells_df<span class="sc">$</span>centroid_cells.site)[i] <span class="sc">~</span></span>
<span id="cb74-225"><a href="#cb74-225" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">case_when</span>(<span class="fu">as.character</span>(Y) <span class="sc">==</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(df_temp<span class="sc">$</span>Y))[iii] <span class="sc">~</span> </span>
<span id="cb74-226"><a href="#cb74-226" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">paste0</span>(<span class="st">"row"</span>,iii),</span>
<span id="cb74-227"><a href="#cb74-227" aria-hidden="true" tabindex="-1"></a>                                   <span class="cn">TRUE</span> <span class="sc">~</span> row),</span>
<span id="cb74-228"><a href="#cb74-228" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> row))</span>
<span id="cb74-229"><a href="#cb74-229" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-230"><a href="#cb74-230" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-231"><a href="#cb74-231" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-232"><a href="#cb74-232" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-233"><a href="#cb74-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-234"><a href="#cb74-234" aria-hidden="true" tabindex="-1"></a><span class="co"># other_table_path&lt;-data.frame(</span></span>
<span id="cb74-235"><a href="#cb74-235" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = c(1,25,1,25,1,25,1,25,</span></span>
<span id="cb74-236"><a href="#cb74-236" aria-hidden="true" tabindex="-1"></a><span class="co">#         1,1,5,5,9,9,13,13,17,17,21,21,25,25</span></span>
<span id="cb74-237"><a href="#cb74-237" aria-hidden="true" tabindex="-1"></a><span class="co">#         ),</span></span>
<span id="cb74-238"><a href="#cb74-238" aria-hidden="true" tabindex="-1"></a><span class="co">#   y= c(-2,-2,-3,-3,-4,-4,-5,-5,</span></span>
<span id="cb74-239"><a href="#cb74-239" aria-hidden="true" tabindex="-1"></a><span class="co">#        -2,-5,-2,-5,-2,-5,-2,-5,-2,-5,-2,-5,-2,-5</span></span>
<span id="cb74-240"><a href="#cb74-240" aria-hidden="true" tabindex="-1"></a><span class="co">#        ),</span></span>
<span id="cb74-241"><a href="#cb74-241" aria-hidden="true" tabindex="-1"></a><span class="co">#   group=c(1,1,9,9,10,10,11,11,</span></span>
<span id="cb74-242"><a href="#cb74-242" aria-hidden="true" tabindex="-1"></a><span class="co">#           2,2,3,3,4,4,5,5,6,6,7,7,8,8</span></span>
<span id="cb74-243"><a href="#cb74-243" aria-hidden="true" tabindex="-1"></a><span class="co">#           )</span></span>
<span id="cb74-244"><a href="#cb74-244" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb74-245"><a href="#cb74-245" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb74-246"><a href="#cb74-246" aria-hidden="true" tabindex="-1"></a><span class="co"># other_table_title &lt;- data.frame(</span></span>
<span id="cb74-247"><a href="#cb74-247" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = c(-1,3,7,11,15,19,23),</span></span>
<span id="cb74-248"><a href="#cb74-248" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = c(-1.5,-1.5,-1.5,-1.5,-1.5,-1.5,-1.5),</span></span>
<span id="cb74-249"><a href="#cb74-249" aria-hidden="true" tabindex="-1"></a><span class="co">#   label = c("Metrics","Sediment","Bacillariophyceae","Chlorophyceae","Magnoliopsida","Rhodophyceae","Phaeophyceae"),</span></span>
<span id="cb74-250"><a href="#cb74-250" aria-hidden="true" tabindex="-1"></a><span class="co">#   group = c(1,2,3,4,5,6,7)</span></span>
<span id="cb74-251"><a href="#cb74-251" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb74-252"><a href="#cb74-252" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb74-253"><a href="#cb74-253" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy_by_class&lt;-validation_metrics$byClass %&gt;% </span></span>
<span id="cb74-254"><a href="#cb74-254" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame()</span></span>
<span id="cb74-255"><a href="#cb74-255" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb74-256"><a href="#cb74-256" aria-hidden="true" tabindex="-1"></a><span class="co"># other_table_values &lt;- data.frame(</span></span>
<span id="cb74-257"><a href="#cb74-257" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = c(3,7,11,15,19,23,</span></span>
<span id="cb74-258"><a href="#cb74-258" aria-hidden="true" tabindex="-1"></a><span class="co">#         3,7,11,15,19,23,</span></span>
<span id="cb74-259"><a href="#cb74-259" aria-hidden="true" tabindex="-1"></a><span class="co">#         3,7,11,15,19,23),</span></span>
<span id="cb74-260"><a href="#cb74-260" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = c(-2.5,-2.5,-2.5,-2.5,-2.5,-2.5,</span></span>
<span id="cb74-261"><a href="#cb74-261" aria-hidden="true" tabindex="-1"></a><span class="co">#         -3.5,-3.5,-3.5,-3.5,-3.5,-3.5,</span></span>
<span id="cb74-262"><a href="#cb74-262" aria-hidden="true" tabindex="-1"></a><span class="co">#         -4.5,-4.5,-4.5,-4.5,-4.5,-4.5),</span></span>
<span id="cb74-263"><a href="#cb74-263" aria-hidden="true" tabindex="-1"></a><span class="co">#   label = round(c(accuracy_by_class$Sensitivity[c(1:6)],</span></span>
<span id="cb74-264"><a href="#cb74-264" aria-hidden="true" tabindex="-1"></a><span class="co">#             accuracy_by_class$Specificity[c(1:6)],</span></span>
<span id="cb74-265"><a href="#cb74-265" aria-hidden="true" tabindex="-1"></a><span class="co">#             accuracy_by_class$`Balanced Accuracy`[c(1:6)]),2)</span></span>
<span id="cb74-266"><a href="#cb74-266" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb74-267"><a href="#cb74-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-268"><a href="#cb74-268" aria-hidden="true" tabindex="-1"></a>other_table_path<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-269"><a href="#cb74-269" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">26</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">26</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">26</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">26</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">26</span>,</span>
<span id="cb74-270"><a href="#cb74-270" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">3.857</span>,<span class="fl">3.857</span>,<span class="fl">7.714</span>,<span class="fl">7.714</span>,<span class="fl">11.571</span>,<span class="fl">11.571</span>,<span class="fl">15.429</span>,<span class="fl">15.429</span>,<span class="fl">19.286</span>,<span class="fl">19.286</span>,<span class="fl">23.142</span>,<span class="fl">23.142</span>,<span class="dv">26</span>,<span class="dv">26</span></span>
<span id="cb74-271"><a href="#cb74-271" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb74-272"><a href="#cb74-272" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb74-273"><a href="#cb74-273" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">5</span></span>
<span id="cb74-274"><a href="#cb74-274" aria-hidden="true" tabindex="-1"></a>       ),</span>
<span id="cb74-275"><a href="#cb74-275" aria-hidden="true" tabindex="-1"></a>  <span class="at">group=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">14</span>,</span>
<span id="cb74-276"><a href="#cb74-276" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">8</span></span>
<span id="cb74-277"><a href="#cb74-277" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb74-278"><a href="#cb74-278" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-279"><a href="#cb74-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-280"><a href="#cb74-280" aria-hidden="true" tabindex="-1"></a>other_table_title <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-281"><a href="#cb74-281" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.529</span>,<span class="fl">1.929</span>,<span class="fl">5.786</span>,<span class="fl">9.643</span>,<span class="fl">13.5</span>,<span class="fl">17.359</span>,<span class="fl">21.215</span>,<span class="fl">24.571</span>),</span>
<span id="cb74-282"><a href="#cb74-282" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>),</span>
<span id="cb74-283"><a href="#cb74-283" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Metrics"</span>,<span class="st">"Sediment"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Phaeophyceae"</span>, <span class="st">"Overall"</span>)</span>
<span id="cb74-284"><a href="#cb74-284" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-285"><a href="#cb74-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-286"><a href="#cb74-286" aria-hidden="true" tabindex="-1"></a>other_table_y_axis<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb74-287"><a href="#cb74-287" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>,<span class="sc">-</span><span class="fl">0.4</span>),</span>
<span id="cb74-288"><a href="#cb74-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">4.5</span>),</span>
<span id="cb74-289"><a href="#cb74-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Sensitivity"</span>,<span class="st">"Specificity"</span>, <span class="st">"Accuracy"</span>)</span>
<span id="cb74-290"><a href="#cb74-290" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-291"><a href="#cb74-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-292"><a href="#cb74-292" aria-hidden="true" tabindex="-1"></a>accuracy_by_class<span class="ot">&lt;-</span>validation_metrics<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb74-293"><a href="#cb74-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb74-294"><a href="#cb74-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-295"><a href="#cb74-295" aria-hidden="true" tabindex="-1"></a>other_table_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-296"><a href="#cb74-296" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.929</span>,<span class="fl">5.786</span>,<span class="fl">9.643</span>,<span class="fl">13.5</span>,<span class="fl">17.359</span>,<span class="fl">21.215</span>,<span class="fl">24.571</span>,</span>
<span id="cb74-297"><a href="#cb74-297" aria-hidden="true" tabindex="-1"></a>        <span class="fl">1.929</span>,<span class="fl">5.786</span>,<span class="fl">9.643</span>,<span class="fl">13.5</span>,<span class="fl">17.359</span>,<span class="fl">21.215</span>,<span class="fl">24.571</span>,</span>
<span id="cb74-298"><a href="#cb74-298" aria-hidden="true" tabindex="-1"></a>        <span class="fl">1.929</span>,<span class="fl">5.786</span>,<span class="fl">9.643</span>,<span class="fl">13.5</span>,<span class="fl">17.359</span>,<span class="fl">21.215</span>),</span>
<span id="cb74-299"><a href="#cb74-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>,</span>
<span id="cb74-300"><a href="#cb74-300" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>,</span>
<span id="cb74-301"><a href="#cb74-301" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">4.5</span>,<span class="sc">-</span><span class="fl">4.5</span>,<span class="sc">-</span><span class="fl">4.5</span>,<span class="sc">-</span><span class="fl">4.5</span>,<span class="sc">-</span><span class="fl">4.5</span>,<span class="sc">-</span><span class="fl">4.5</span>),</span>
<span id="cb74-302"><a href="#cb74-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">c</span>(accuracy_by_class<span class="sc">$</span>Sensitivity[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)],<span class="fu">mean</span>(accuracy_by_class<span class="sc">$</span>Sensitivity),</span>
<span id="cb74-303"><a href="#cb74-303" aria-hidden="true" tabindex="-1"></a>            accuracy_by_class<span class="sc">$</span>Specificity[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)],<span class="fu">mean</span>(accuracy_by_class<span class="sc">$</span>Specificity),</span>
<span id="cb74-304"><a href="#cb74-304" aria-hidden="true" tabindex="-1"></a>            accuracy_by_class<span class="sc">$</span><span class="st">`</span><span class="at">Balanced Accuracy</span><span class="st">`</span>[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)]),<span class="dv">2</span>)</span>
<span id="cb74-305"><a href="#cb74-305" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-306"><a href="#cb74-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-307"><a href="#cb74-307" aria-hidden="true" tabindex="-1"></a>global_accuracy_coord<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">24.571</span>,</span>
<span id="cb74-308"><a href="#cb74-308" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="sc">-</span><span class="fl">4.5</span>,</span>
<span id="cb74-309"><a href="#cb74-309" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(validation_metrics<span class="sc">$</span>overall[<span class="dv">1</span>]),<span class="dv">2</span>))  </span>
<span id="cb74-310"><a href="#cb74-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-311"><a href="#cb74-311" aria-hidden="true" tabindex="-1"></a>centroid_cells_df_rows<span class="ot">&lt;-</span>centroid_cells_df <span class="sc">%&gt;%</span> </span>
<span id="cb74-312"><a href="#cb74-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(row)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-313"><a href="#cb74-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Row =</span> <span class="fu">paste0</span>(centroid_cells.site,<span class="st">"_"</span>,row))</span>
<span id="cb74-314"><a href="#cb74-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-315"><a href="#cb74-315" aria-hidden="true" tabindex="-1"></a>centroid_cells_df_cols<span class="ot">&lt;-</span>centroid_cells_df <span class="sc">%&gt;%</span> </span>
<span id="cb74-316"><a href="#cb74-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(col)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-317"><a href="#cb74-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cols =</span> <span class="fu">paste0</span>(centroid_cells.site,<span class="st">"_"</span>,col))</span>
<span id="cb74-318"><a href="#cb74-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-319"><a href="#cb74-319" aria-hidden="true" tabindex="-1"></a>plot_matrix_global <span class="ot">&lt;-</span></span>
<span id="cb74-320"><a href="#cb74-320" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb74-321"><a href="#cb74-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> (confmat_rast),</span>
<span id="cb74-322"><a href="#cb74-322" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># show.legend = F,</span></span>
<span id="cb74-323"><a href="#cb74-323" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-324"><a href="#cb74-324" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-325"><a href="#cb74-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_GafanhaLow,</span>
<span id="cb74-326"><a href="#cb74-326" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-327"><a href="#cb74-327" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-328"><a href="#cb74-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_GafanhaLow_sf,</span>
<span id="cb74-329"><a href="#cb74-329" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-330"><a href="#cb74-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_GafanhaHigh,</span>
<span id="cb74-331"><a href="#cb74-331" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-332"><a href="#cb74-332" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-333"><a href="#cb74-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_GafanhaHigh_sf,</span>
<span id="cb74-334"><a href="#cb74-334" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-335"><a href="#cb74-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_Boat,</span>
<span id="cb74-336"><a href="#cb74-336" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-337"><a href="#cb74-337" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-338"><a href="#cb74-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_Boat_sf,</span>
<span id="cb74-339"><a href="#cb74-339" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-340"><a href="#cb74-340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_Horse_rooster,</span>
<span id="cb74-341"><a href="#cb74-341" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-342"><a href="#cb74-342" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-343"><a href="#cb74-343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_Horse_rooster_sf,</span>
<span id="cb74-344"><a href="#cb74-344" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-345"><a href="#cb74-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_NorthDike,</span>
<span id="cb74-346"><a href="#cb74-346" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-347"><a href="#cb74-347" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-348"><a href="#cb74-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_NorthDike_sf,</span>
<span id="cb74-349"><a href="#cb74-349" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-350"><a href="#cb74-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_Handfisher_1,</span>
<span id="cb74-351"><a href="#cb74-351" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-352"><a href="#cb74-352" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-353"><a href="#cb74-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_Handfisher_1_sf,</span>
<span id="cb74-354"><a href="#cb74-354" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-355"><a href="#cb74-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_Arz,</span>
<span id="cb74-356"><a href="#cb74-356" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-357"><a href="#cb74-357" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-358"><a href="#cb74-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_Arz_sf,</span>
<span id="cb74-359"><a href="#cb74-359" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-360"><a href="#cb74-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_DuerLow,</span>
<span id="cb74-361"><a href="#cb74-361" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-362"><a href="#cb74-362" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-363"><a href="#cb74-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_DuerLow_sf,</span>
<span id="cb74-364"><a href="#cb74-364" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-365"><a href="#cb74-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_Kerdrean,</span>
<span id="cb74-366"><a href="#cb74-366" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb74-367"><a href="#cb74-367" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb74-368"><a href="#cb74-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_Kerdrean_sf,</span>
<span id="cb74-369"><a href="#cb74-369" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-370"><a href="#cb74-370" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_sf(data = centroid_cells,</span></span>
<span id="cb74-371"><a href="#cb74-371" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         fill = "transparent")+</span></span>
<span id="cb74-372"><a href="#cb74-372" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-373"><a href="#cb74-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> centroid_cells_df_rows, </span>
<span id="cb74-374"><a href="#cb74-374" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">group =</span> Row),</span>
<span id="cb74-375"><a href="#cb74-375" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb74-376"><a href="#cb74-376" aria-hidden="true" tabindex="-1"></a>            <span class="at">linejoin =</span> <span class="st">"round"</span>,</span>
<span id="cb74-377"><a href="#cb74-377" aria-hidden="true" tabindex="-1"></a>            <span class="at">lineend =</span> <span class="st">"round"</span>,</span>
<span id="cb74-378"><a href="#cb74-378" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb74-379"><a href="#cb74-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> centroid_cells_df_cols, </span>
<span id="cb74-380"><a href="#cb74-380" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">group =</span> cols),</span>
<span id="cb74-381"><a href="#cb74-381" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb74-382"><a href="#cb74-382" aria-hidden="true" tabindex="-1"></a>            <span class="at">linejoin =</span> <span class="st">"round"</span>,</span>
<span id="cb74-383"><a href="#cb74-383" aria-hidden="true" tabindex="-1"></a>            <span class="at">lineend =</span> <span class="st">"round"</span>,</span>
<span id="cb74-384"><a href="#cb74-384" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb74-385"><a href="#cb74-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb74-386"><a href="#cb74-386" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("black","firebrick4","goldenrod","yellow","chartreuse3"),</span></span>
<span id="cb74-387"><a href="#cb74-387" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("khaki1","goldenrod","firebrick3","chartreuse4"),</span></span>
<span id="cb74-388"><a href="#cb74-388" aria-hidden="true" tabindex="-1"></a>    <span class="at">colours =</span> <span class="fu">c</span>(<span class="st">"khaki1"</span>,<span class="st">"firebrick4"</span>,<span class="st">"firebrick4"</span>,<span class="st">"firebrick4"</span>,<span class="st">"#3e0b0b"</span>),</span>
<span id="cb74-389"><a href="#cb74-389" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("#7d0000","#00b300","#00b300","#00b300","#007d00"),</span></span>
<span id="cb74-390"><a href="#cb74-390" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"white"</span>, </span>
<span id="cb74-391"><a href="#cb74-391" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> <span class="st">"sqrt"</span>,</span>
<span id="cb74-392"><a href="#cb74-392" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.05"</span>,<span class="st">"0.25"</span>, <span class="st">"0.50"</span>, <span class="st">"0.75"</span>, <span class="st">"1"</span>),</span>
<span id="cb74-393"><a href="#cb74-393" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span>,<span class="fl">0.9999</span>))<span class="sc">+</span></span>
<span id="cb74-394"><a href="#cb74-394" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_Bede("mixed", </span></span>
<span id="cb74-395"><a href="#cb74-395" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 discrete = F,</span></span>
<span id="cb74-396"><a href="#cb74-396" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 reverse = TRUE,</span></span>
<span id="cb74-397"><a href="#cb74-397" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 na.value = "white",</span></span>
<span id="cb74-398"><a href="#cb74-398" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 trans = "sqrt",</span></span>
<span id="cb74-399"><a href="#cb74-399" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb74-400"><a href="#cb74-400" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb74-401"><a href="#cb74-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Proportion </span><span class="sc">\n</span><span class="st"> of pixels"</span>)<span class="sc">+</span></span>
<span id="cb74-402"><a href="#cb74-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb74-403"><a href="#cb74-403" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sediment"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Phaeophyceae"</span>),</span>
<span id="cb74-404"><a href="#cb74-404" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb74-405"><a href="#cb74-405" aria-hidden="true" tabindex="-1"></a>                     <span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb74-406"><a href="#cb74-406" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.6</span>,<span class="dv">29</span>))<span class="sc">+</span></span>
<span id="cb74-407"><a href="#cb74-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb74-408"><a href="#cb74-408" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Phaeophyceae"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Magnoliopsida"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Bacillariophyceae"</span>,<span class="st">"Sediment"</span>),</span>
<span id="cb74-409"><a href="#cb74-409" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>),</span>
<span id="cb74-410"><a href="#cb74-410" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="fl">15.5</span>))<span class="sc">+</span></span>
<span id="cb74-411"><a href="#cb74-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">26</span>,<span class="dv">26</span>,<span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb74-412"><a href="#cb74-412" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>)),</span>
<span id="cb74-413"><a href="#cb74-413" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb74-414"><a href="#cb74-414" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-415"><a href="#cb74-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">23.142</span>,<span class="dv">26</span>,<span class="dv">26</span>,<span class="fl">23.142</span>),</span>
<span id="cb74-416"><a href="#cb74-416" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>)),</span>
<span id="cb74-417"><a href="#cb74-417" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb74-418"><a href="#cb74-418" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb74-419"><a href="#cb74-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb74-420"><a href="#cb74-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-421"><a href="#cb74-421" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">12</span>),</span>
<span id="cb74-422"><a href="#cb74-422" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>),</span>
<span id="cb74-423"><a href="#cb74-423" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">14</span>)</span>
<span id="cb74-424"><a href="#cb74-424" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb74-425"><a href="#cb74-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(x,y,<span class="at">group=</span> group),</span>
<span id="cb74-426"><a href="#cb74-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb74-427"><a href="#cb74-427" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-428"><a href="#cb74-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> other_table_path,</span>
<span id="cb74-429"><a href="#cb74-429" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb74-430"><a href="#cb74-430" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> y,</span>
<span id="cb74-431"><a href="#cb74-431" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> group),</span>
<span id="cb74-432"><a href="#cb74-432" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb74-433"><a href="#cb74-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb74-434"><a href="#cb74-434" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_corrected_accuracy,</span>
<span id="cb74-435"><a href="#cb74-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(lab,<span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">"%"</span>)),</span>
<span id="cb74-436"><a href="#cb74-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#ffffff99"</span>,</span>
<span id="cb74-437"><a href="#cb74-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span></span>
<span id="cb74-438"><a href="#cb74-438" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-439"><a href="#cb74-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-440"><a href="#cb74-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_Sens_Spec,</span>
<span id="cb74-441"><a href="#cb74-441" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(lab,<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">"%"</span>)),</span>
<span id="cb74-442"><a href="#cb74-442" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb74-443"><a href="#cb74-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span></span>
<span id="cb74-444"><a href="#cb74-444" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-445"><a href="#cb74-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-446"><a href="#cb74-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> other_table_title,</span>
<span id="cb74-447"><a href="#cb74-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb74-448"><a href="#cb74-448" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb74-449"><a href="#cb74-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span></span>
<span id="cb74-450"><a href="#cb74-450" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-451"><a href="#cb74-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-452"><a href="#cb74-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> other_table_y_axis,</span>
<span id="cb74-453"><a href="#cb74-453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb74-454"><a href="#cb74-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb74-455"><a href="#cb74-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb74-456"><a href="#cb74-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span></span>
<span id="cb74-457"><a href="#cb74-457" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb74-458"><a href="#cb74-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-459"><a href="#cb74-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> other_table_values,</span>
<span id="cb74-460"><a href="#cb74-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb74-461"><a href="#cb74-461" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb74-462"><a href="#cb74-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span></span>
<span id="cb74-463"><a href="#cb74-463" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-464"><a href="#cb74-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-465"><a href="#cb74-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> global_accuracy_coord,</span>
<span id="cb74-466"><a href="#cb74-466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label),</span>
<span id="cb74-467"><a href="#cb74-467" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb74-468"><a href="#cb74-468" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb74-469"><a href="#cb74-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"firebrick4"</span></span>
<span id="cb74-470"><a href="#cb74-470" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-471"><a href="#cb74-471" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-472"><a href="#cb74-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb74-473"><a href="#cb74-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_Label_Sites,</span>
<span id="cb74-474"><a href="#cb74-474" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb74-475"><a href="#cb74-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#ffffff99"</span>,</span>
<span id="cb74-476"><a href="#cb74-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">6.8</span></span>
<span id="cb74-477"><a href="#cb74-477" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-478"><a href="#cb74-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-479"><a href="#cb74-479" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> x_axis_text,</span>
<span id="cb74-480"><a href="#cb74-480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb74-481"><a href="#cb74-481" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb74-482"><a href="#cb74-482" aria-hidden="true" tabindex="-1"></a>    <span class="co"># vjust = 1,</span></span>
<span id="cb74-483"><a href="#cb74-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb74-484"><a href="#cb74-484" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb74-485"><a href="#cb74-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="dv">40</span></span>
<span id="cb74-486"><a href="#cb74-486" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-487"><a href="#cb74-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb74-488"><a href="#cb74-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> y_axis_text,</span>
<span id="cb74-489"><a href="#cb74-489" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb74-490"><a href="#cb74-490" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb74-491"><a href="#cb74-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb74-492"><a href="#cb74-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">9</span>,</span>
<span id="cb74-493"><a href="#cb74-493" aria-hidden="true" tabindex="-1"></a>    <span class="co"># angle = 20</span></span>
<span id="cb74-494"><a href="#cb74-494" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb74-495"><a href="#cb74-495" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-496"><a href="#cb74-496" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(</span></span>
<span id="cb74-497"><a href="#cb74-497" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   aes(x = 13.8, y = 12.72, label = "Producer's Accuracy"),</span></span>
<span id="cb74-498"><a href="#cb74-498" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   # fill = "#ffffff99",</span></span>
<span id="cb74-499"><a href="#cb74-499" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   size = 9,</span></span>
<span id="cb74-500"><a href="#cb74-500" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   angle = 20</span></span>
<span id="cb74-501"><a href="#cb74-501" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )+</span></span>
<span id="cb74-502"><a href="#cb74-502" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(</span></span>
<span id="cb74-503"><a href="#cb74-503" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   aes(x = 0, y = 0, label = "User's Accuracy"),</span></span>
<span id="cb74-504"><a href="#cb74-504" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   # fill = "#ffffff99",</span></span>
<span id="cb74-505"><a href="#cb74-505" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   size = 9</span></span>
<span id="cb74-506"><a href="#cb74-506" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )+</span></span>
<span id="cb74-507"><a href="#cb74-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"References"</span>)<span class="sc">+</span></span>
<span id="cb74-508"><a href="#cb74-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prediction"</span>)<span class="sc">+</span></span>
<span id="cb74-509"><a href="#cb74-509" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot2::annotation_custom(ggplotGrob(small_validation_matrices), xmin = 12, ymin = 0)+</span></span>
<span id="cb74-510"><a href="#cb74-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb74-511"><a href="#cb74-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb74-512"><a href="#cb74-512" aria-hidden="true" tabindex="-1"></a>  <span class="co"># axis.title.x = element_text(size = 35),</span></span>
<span id="cb74-513"><a href="#cb74-513" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_text(size = 35),</span></span>
<span id="cb74-514"><a href="#cb74-514" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-515"><a href="#cb74-515" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-516"><a href="#cb74-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-517"><a href="#cb74-517" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.text.x = element_text(size = 30),</span></span>
<span id="cb74-518"><a href="#cb74-518" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-519"><a href="#cb74-519" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.text.y = element_text(size = 25),</span></span>
<span id="cb74-520"><a href="#cb74-520" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-521"><a href="#cb74-521" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb74-522"><a href="#cb74-522" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-523"><a href="#cb74-523" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb74-524"><a href="#cb74-524" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-525"><a href="#cb74-525" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line=</span><span class="fu">element_blank</span>(),</span>
<span id="cb74-526"><a href="#cb74-526" aria-hidden="true" tabindex="-1"></a>        <span class="co"># legend.position = "top",</span></span>
<span id="cb74-527"><a href="#cb74-527" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.73</span>, <span class="fl">0.9</span>),</span>
<span id="cb74-528"><a href="#cb74-528" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction=</span><span class="st">"horizontal"</span>,</span>
<span id="cb74-529"><a href="#cb74-529" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">"cm"</span>),</span>
<span id="cb74-530"><a href="#cb74-530" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb74-531"><a href="#cb74-531" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb74-532"><a href="#cb74-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb74-533"><a href="#cb74-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated aesthetics after name standardisation: size</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_matrix_global</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="do">############ Metrics of each sites ###################</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>Arz_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_Arz<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Arz Island"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>Arz_metrics_overall<span class="ot">&lt;-</span>validation_metrics_Arz<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Arz Island"</span>,</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>Arz_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(Arz_metrics_ByClass,Arz_metrics_overall)</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>Boat_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_Boat<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Marinha Lanzarote"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>Boat_metrics_overall<span class="ot">&lt;-</span>validation_metrics_Boat<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Marinha Lanzarote"</span>,</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>Boat_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(Boat_metrics_ByClass,Boat_metrics_overall)</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>DuerLow_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_DuerLow<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Duer"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>DuerLow_metrics_overall<span class="ot">&lt;-</span>validation_metrics_DuerLow<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Duer"</span>,</span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>DuerLow_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(DuerLow_metrics_ByClass,DuerLow_metrics_overall)</span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a>GafanhaHigh_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_GafanhaHigh<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-58"><a href="#cb76-58" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-59"><a href="#cb76-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Gafanha High"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-60"><a href="#cb76-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-61"><a href="#cb76-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-62"><a href="#cb76-62" aria-hidden="true" tabindex="-1"></a>GafanhaHigh_metrics_overall<span class="ot">&lt;-</span>validation_metrics_GafanhaHigh<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-63"><a href="#cb76-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-64"><a href="#cb76-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-65"><a href="#cb76-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-66"><a href="#cb76-66" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Gafanha High"</span>,</span>
<span id="cb76-67"><a href="#cb76-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-68"><a href="#cb76-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-69"><a href="#cb76-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-70"><a href="#cb76-70" aria-hidden="true" tabindex="-1"></a>GafanhaHigh_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(GafanhaHigh_metrics_ByClass,GafanhaHigh_metrics_overall)</span>
<span id="cb76-71"><a href="#cb76-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-72"><a href="#cb76-72" aria-hidden="true" tabindex="-1"></a>GafanhaLow_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_GafanhaLow<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-73"><a href="#cb76-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-74"><a href="#cb76-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-75"><a href="#cb76-75" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-76"><a href="#cb76-76" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Gafanha Low"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-77"><a href="#cb76-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-78"><a href="#cb76-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-79"><a href="#cb76-79" aria-hidden="true" tabindex="-1"></a>GafanhaLow_metrics_overall<span class="ot">&lt;-</span>validation_metrics_GafanhaLow<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-80"><a href="#cb76-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-81"><a href="#cb76-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-82"><a href="#cb76-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-83"><a href="#cb76-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Gafanha Low"</span>,</span>
<span id="cb76-84"><a href="#cb76-84" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-85"><a href="#cb76-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-86"><a href="#cb76-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-87"><a href="#cb76-87" aria-hidden="true" tabindex="-1"></a>GafanhaLow_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(GafanhaLow_metrics_ByClass,GafanhaLow_metrics_overall)</span>
<span id="cb76-88"><a href="#cb76-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-89"><a href="#cb76-89" aria-hidden="true" tabindex="-1"></a>Handfisher_1_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_Handfisher_1<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-90"><a href="#cb76-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-91"><a href="#cb76-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-92"><a href="#cb76-92" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-93"><a href="#cb76-93" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Barbâtre"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-94"><a href="#cb76-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-95"><a href="#cb76-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-96"><a href="#cb76-96" aria-hidden="true" tabindex="-1"></a>Handfisher_1_metrics_overall<span class="ot">&lt;-</span>validation_metrics_Handfisher_1<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-97"><a href="#cb76-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-98"><a href="#cb76-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-99"><a href="#cb76-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-100"><a href="#cb76-100" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Barbâtre"</span>,</span>
<span id="cb76-101"><a href="#cb76-101" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-102"><a href="#cb76-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-103"><a href="#cb76-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-104"><a href="#cb76-104" aria-hidden="true" tabindex="-1"></a>Handfisher_1_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(Handfisher_1_metrics_ByClass,Handfisher_1_metrics_overall)</span>
<span id="cb76-105"><a href="#cb76-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-106"><a href="#cb76-106" aria-hidden="true" tabindex="-1"></a>Horse_rooster_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_Horse_rooster<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-107"><a href="#cb76-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-108"><a href="#cb76-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-109"><a href="#cb76-109" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-110"><a href="#cb76-110" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Mataducos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-111"><a href="#cb76-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-112"><a href="#cb76-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-113"><a href="#cb76-113" aria-hidden="true" tabindex="-1"></a>Horse_rooster_metrics_overall<span class="ot">&lt;-</span>validation_metrics_Horse_rooster<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-114"><a href="#cb76-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-115"><a href="#cb76-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-116"><a href="#cb76-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-117"><a href="#cb76-117" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Mataducos"</span>,</span>
<span id="cb76-118"><a href="#cb76-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-119"><a href="#cb76-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-120"><a href="#cb76-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-121"><a href="#cb76-121" aria-hidden="true" tabindex="-1"></a>Horse_rooster_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(Horse_rooster_metrics_ByClass,Horse_rooster_metrics_overall)</span>
<span id="cb76-122"><a href="#cb76-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-123"><a href="#cb76-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-124"><a href="#cb76-124" aria-hidden="true" tabindex="-1"></a>Kerdrean_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_Kerdrean<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-125"><a href="#cb76-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-126"><a href="#cb76-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-127"><a href="#cb76-127" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-128"><a href="#cb76-128" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Kerdrean"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-129"><a href="#cb76-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-130"><a href="#cb76-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-131"><a href="#cb76-131" aria-hidden="true" tabindex="-1"></a>Kerdrean_metrics_overall<span class="ot">&lt;-</span>validation_metrics_Kerdrean<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-132"><a href="#cb76-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-133"><a href="#cb76-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-134"><a href="#cb76-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-135"><a href="#cb76-135" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"Kerdrean"</span>,</span>
<span id="cb76-136"><a href="#cb76-136" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-137"><a href="#cb76-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-138"><a href="#cb76-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-139"><a href="#cb76-139" aria-hidden="true" tabindex="-1"></a>Kerdrean_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(Kerdrean_metrics_ByClass,Kerdrean_metrics_overall)</span>
<span id="cb76-140"><a href="#cb76-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-141"><a href="#cb76-141" aria-hidden="true" tabindex="-1"></a>NorthDike_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics_NorthDike<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-142"><a href="#cb76-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-143"><a href="#cb76-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-144"><a href="#cb76-144" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.),</span>
<span id="cb76-145"><a href="#cb76-145" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"L'Epine"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-146"><a href="#cb76-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class,Site),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-147"><a href="#cb76-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-148"><a href="#cb76-148" aria-hidden="true" tabindex="-1"></a>NorthDike_metrics_overall<span class="ot">&lt;-</span>validation_metrics_NorthDike<span class="sc">$</span>overall <span class="sc">%&gt;%</span> </span>
<span id="cb76-149"><a href="#cb76-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-150"><a href="#cb76-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-151"><a href="#cb76-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="st">"All"</span>,</span>
<span id="cb76-152"><a href="#cb76-152" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="st">"L'Epine"</span>,</span>
<span id="cb76-153"><a href="#cb76-153" aria-hidden="true" tabindex="-1"></a>         <span class="at">metric =</span> <span class="fu">rownames</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-154"><a href="#cb76-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(Class,Site,metric,value)</span>
<span id="cb76-155"><a href="#cb76-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-156"><a href="#cb76-156" aria-hidden="true" tabindex="-1"></a>NorthDike_metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(NorthDike_metrics_ByClass,NorthDike_metrics_overall)</span>
<span id="cb76-157"><a href="#cb76-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-158"><a href="#cb76-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-159"><a href="#cb76-159" aria-hidden="true" tabindex="-1"></a>BySite_Metrics<span class="ot">&lt;-</span><span class="fu">rbind</span>(NorthDike_metrics,Kerdrean_metrics,Horse_rooster_metrics,Handfisher_1_metrics,GafanhaLow_metrics,GafanhaHigh_metrics,DuerLow_metrics,Boat_metrics,Arz_metrics)</span>
<span id="cb76-160"><a href="#cb76-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-161"><a href="#cb76-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-162"><a href="#cb76-162" aria-hidden="true" tabindex="-1"></a>Overall_metrics_ByClass<span class="ot">&lt;-</span>validation_metrics<span class="sc">$</span>byClass <span class="sc">%&gt;%</span> </span>
<span id="cb76-163"><a href="#cb76-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-164"><a href="#cb76-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">rownames</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb76-165"><a href="#cb76-165" aria-hidden="true" tabindex="-1"></a>           <span class="fu">gsub</span>(<span class="st">"Class: "</span>,<span class="st">""</span>,.)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-166"><a href="#cb76-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Class),<span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb76-167"><a href="#cb76-167" aria-hidden="true" tabindex="-1"></a><span class="do">################</span></span>
<span id="cb76-168"><a href="#cb76-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-169"><a href="#cb76-169" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Validation/ConfusionMatrixGlobal.png"</span>,plot_matrix_global , <span class="at">width =</span> <span class="dv">1920</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1032</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb76-170"><a href="#cb76-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-171"><a href="#cb76-171" aria-hidden="true" tabindex="-1"></a><span class="do">######### Focus on green macrophytes</span></span>
<span id="cb76-172"><a href="#cb76-172" aria-hidden="true" tabindex="-1"></a>df_green<span class="ot">&lt;-</span>df <span class="sc">%&gt;%</span> </span>
<span id="cb76-173"><a href="#cb76-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pred_Class <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Magnoliopsida"</span>, <span class="st">"Chlorophyceae"</span>),</span>
<span id="cb76-174"><a href="#cb76-174" aria-hidden="true" tabindex="-1"></a>         Truth <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Magnoliopsida"</span>, <span class="st">"Chlorophyceae"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-175"><a href="#cb76-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pred_Class =</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(Pred_Class)),</span>
<span id="cb76-176"><a href="#cb76-176" aria-hidden="true" tabindex="-1"></a>         <span class="at">Truth =</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(Truth)))</span>
<span id="cb76-177"><a href="#cb76-177" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb76-178"><a href="#cb76-178" aria-hidden="true" tabindex="-1"></a>validation_metrics_green<span class="ot">&lt;-</span><span class="fu">confusionMatrix</span>(df_green<span class="sc">$</span>Pred_Class,df_green<span class="sc">$</span>Truth)</span>
<span id="cb76-179"><a href="#cb76-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-180"><a href="#cb76-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-181"><a href="#cb76-181" aria-hidden="true" tabindex="-1"></a>conf_mat_green<span class="ot">&lt;-</span>validation_metrics_green[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb76-182"><a href="#cb76-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-183"><a href="#cb76-183" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-184"><a href="#cb76-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb76-185"><a href="#cb76-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-186"><a href="#cb76-186" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(conf_mat_green))){</span>
<span id="cb76-187"><a href="#cb76-187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span> ){</span>
<span id="cb76-188"><a href="#cb76-188" aria-hidden="true" tabindex="-1"></a>    df_sum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">row =</span> <span class="cn">NA</span>,</span>
<span id="cb76-189"><a href="#cb76-189" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col =</span> <span class="cn">NA</span>)</span>
<span id="cb76-190"><a href="#cb76-190" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-191"><a href="#cb76-191" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_green[i,],<span class="at">na.rm =</span> T)</span>
<span id="cb76-192"><a href="#cb76-192" aria-hidden="true" tabindex="-1"></a>  df_sum[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(conf_mat_green[,i],<span class="at">na.rm =</span> T)</span>
<span id="cb76-193"><a href="#cb76-193" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-194"><a href="#cb76-194" aria-hidden="true" tabindex="-1"></a>conf_mat_std_green<span class="ot">&lt;-</span>conf_mat_green</span>
<span id="cb76-195"><a href="#cb76-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-196"><a href="#cb76-196" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(conf_mat_std_green)){</span>
<span id="cb76-197"><a href="#cb76-197" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(conf_mat_std_green)){</span>
<span id="cb76-198"><a href="#cb76-198" aria-hidden="true" tabindex="-1"></a>    conf_mat_std_green[row,col]<span class="ot">&lt;-</span>conf_mat_std_green[row,col]<span class="sc">/</span>((df_sum<span class="sc">$</span>row[row] <span class="sc">+</span> df_sum<span class="sc">$</span>col[col])<span class="sc">-</span>conf_mat_std_green[row,col])</span>
<span id="cb76-199"><a href="#cb76-199" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb76-200"><a href="#cb76-200" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-201"><a href="#cb76-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-202"><a href="#cb76-202" aria-hidden="true" tabindex="-1"></a>confmat_rast_green<span class="ot">&lt;-</span>conf_mat_std_green <span class="sc">%&gt;%</span> </span>
<span id="cb76-203"><a href="#cb76-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-204"><a href="#cb76-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-205"><a href="#cb76-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb76-206"><a href="#cb76-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-207"><a href="#cb76-207" aria-hidden="true" tabindex="-1"></a>confmat_rast_green<span class="ot">&lt;-</span><span class="fu">subst</span>(confmat_rast_green, <span class="cn">NA</span>, <span class="sc">-</span><span class="dv">99</span>)</span>
<span id="cb76-208"><a href="#cb76-208" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(confmat_rast_green)<span class="ot">&lt;-</span><span class="st">"layer"</span></span>
<span id="cb76-209"><a href="#cb76-209" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(confmat_rast_green)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb76-210"><a href="#cb76-210" aria-hidden="true" tabindex="-1"></a>confmat_rast_green_sf<span class="ot">&lt;-</span><span class="fu">as.polygons</span>(confmat_rast_green,<span class="at">aggregate=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb76-211"><a href="#cb76-211" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span>
<span id="cb76-212"><a href="#cb76-212" aria-hidden="true" tabindex="-1"></a>confmat_rast_green_centroid<span class="ot">&lt;-</span><span class="fu">st_centroid</span>(confmat_rast_green_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_green)[<span class="fu">values</span>(confmat_rast_green) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(confmat_rast_green)[<span class="fu">values</span>(confmat_rast_green) <span class="sc">==</span> <span class="sc">-</span><span class="dv">99</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>labels_green<span class="ot">&lt;-</span>validation_metrics_green[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> <span class="st">"V1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">1.5</span>),</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>plot_green<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_spatraster</span>(<span class="at">data =</span> confmat_rast_green,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> confmat_rast_green_sf,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"transparent"</span>)<span class="sc">+</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("black","firebrick4","goldenrod","yellow","chartreuse3"),</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("khaki1","goldenrod","firebrick3","chartreuse4"),</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">colours =</span> <span class="fu">c</span>(<span class="st">"khaki1"</span>,<span class="st">"firebrick4"</span>,<span class="st">"firebrick4"</span>,<span class="st">"firebrick4"</span>,<span class="st">"#3e0b0b"</span>),</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("#7d0000","#00b300","#00b300","#00b300","#007d00"),</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"white"</span>, </span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">trans =</span> <span class="st">"sqrt"</span>,</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.05"</span>,<span class="st">"0.25"</span>, <span class="st">"0.50"</span>, <span class="st">"1"</span>),</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_Bede("mixed", </span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 discrete = F,</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 reverse = TRUE,</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 na.value = "white",</span></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 trans = "sqrt",</span></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 labels = c("5","25", "50", "75", "100"),</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 breaks = c(0.05,0.25,0.50,0.75,0.9999))+</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Proportion </span><span class="sc">\n</span><span class="st"> of pixels"</span>)<span class="sc">+</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Chlorophyceae"</span>,<span class="st">"Magnoliopsida"</span>),</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Magnoliopsida"</span>,<span class="st">"Chlorophyceae"</span>),</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> labels_green,<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label ))<span class="sc">+</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"References"</span>)<span class="sc">+</span></span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Prediction"</span>)<span class="sc">+</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot2::annotation_custom(ggplotGrob(small_validation_matrices), xmin = 12, ymin = 0)+</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( </span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line=</span><span class="fu">element_blank</span>(),</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">angle =</span><span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># legend.position = "top",</span></span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># legend.position = c(0.73, 0.9),</span></span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># legend.direction="horizontal",</span></span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># legend.key.width = unit(2,"cm"),</span></span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>)</span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"./Figures/Validation/ConfusionMatrixGreen.png"</span>, plot_green, <span class="at">width =</span> <span class="dv">671</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">479</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [31]:</pre></div><div id="cell-fig-Validation" class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Validation/ConfusionMatrixGlobal.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Validation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Validation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Validation/ConfusionMatrixGlobal.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" data-glightbox="description: .lightbox-desc-8"><img src="./Figures/Validation/ConfusionMatrixGlobal.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Validation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: A global confusion matrix on the left is derived from validation data across each flight, while a mosaic of confusion matrices from individual flights is presented on the right. The labels inside the matrices indicate the balanced accuracy for each class. The labels at the bottom of the matrices indicate the User’s accuracy for each class, and those on the right indicate the Producer’s Accuracy. The values adjacent to the names of each site represent the proportion of total pixels from that site contributing to the overall matrix. Grey lines within the mosaic indicate the absence of validation data for the class at that site. The table at the bottom summarizes the Sensitivity, Specificity, and Accuracy for each class and for the overall model.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>A total of 536,000 pixels was used to validate the Neural Network classifier. The sites with the lowest and highest number of validation data were Kerdrean (5557 pixels) and Marinha Lanzarote (159713 pixels), respectively. Model global accuracy was 94.26% with a Kappa coefficient of 0.92 (<a href="#fig-Validation" class="quarto-xref">Figure&nbsp;8</a>). The least performing site was Gafanha High (global accuracy of 75.45%) whereas Mataducos was the site with the most accurate prediction (global accuracy of 98.05%). Overall, the classes Phaeophyceae, Magnoliopsida, Sediment and Rhodophyceae were correctly classified with a balanced accuracy of 1, 0.96, 0.96 and 0.91 respectively. Bacillariophyceae was the least performing class (accuracy of 0.72 ) mainly due to the confusion between Magnoliopsida and Sediment.</p>
</section>
<section id="variable-importance" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="variable-importance"><span class="header-section-number">3.3</span> Variable importance</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [32]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">################# SPECTRA ########### </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>SP1<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Output/Spectra_VIP.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Min/Max Standardised Spectra"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">!=</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"A - MagnoliopsidaL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"STD"</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>SP2<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Output/Spectra_VIP2.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">%&gt;%</span> </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Raw Spectra"</span>,</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> mean <span class="sc">/</span> <span class="dv">10000</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">!=</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">!=</span> <span class="st">"A - MagnoliopsidaL"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">reframe</span>(Class,Wavelength, mean, type) <span class="sc">%&gt;%</span> </span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> <span class="st">"mean"</span>)</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>SP<span class="ot">&lt;-</span>SP1 <span class="sc">%&gt;%</span> </span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(SP2)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>SP_plot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(SP, <span class="fu">aes</span>( <span class="at">x =</span> Wavelength, <span class="at">y =</span> value, <span class="at">color =</span> Class))<span class="sc">+</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">scale =</span> <span class="st">"free"</span>,<span class="at">ncol =</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#389318"</span>, <span class="st">"#873e23"</span>, <span class="st">"#b3002d"</span>, <span class="st">"#b3ff1a"</span>, <span class="st">"#DAA520"</span>))<span class="sc">+</span></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Reflectance"</span>)<span class="sc">+</span></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wavelength (nm)"</span>)<span class="sc">+</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>),</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>),</span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="at">alpha=</span><span class="dv">0</span>), <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color=</span><span class="st">"black"</span>))</span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a><span class="do">############## VIP ##############</span></span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>filelist<span class="ot">&lt;-</span><span class="st">"Data"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">"NN_VIP_byClass_NoXanth.csv"</span>, <span class="at">recursive =</span> T,<span class="at">full.names =</span> T)</span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>VIP<span class="ot">&lt;-</span>filelist[<span class="fu">which</span>(<span class="fu">str_detect</span>(filelist,<span class="st">"VIP"</span>))] <span class="sc">%&gt;%</span> </span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Magnoliopsida =</span> (Magnoliosida <span class="sc">+</span> Low_SPC)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Magnoliosida ,Low_SPC))</span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>VIP1<span class="ot">&lt;-</span>VIP <span class="sc">%&gt;%</span></span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Water,</span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a>                   SunGlint,</span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a>                   Deep_Sediment,</span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a>                   Bare_Sediment)) <span class="sc">%&gt;%</span></span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::filter(!str_detect(X,"NDVI")) %&gt;% </span></span>
<span id="cb80-68"><a href="#cb80-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isSTD =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(X,<span class="st">"Stan"</span>) <span class="sc">~</span> <span class="st">"Standardised"</span>, </span>
<span id="cb80-69"><a href="#cb80-69" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"RAW"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-70"><a href="#cb80-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(X,isSTD), <span class="at">names_to =</span> <span class="st">"Class"</span>,<span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-71"><a href="#cb80-71" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(X <span class="sc">!=</span> <span class="st">"NDVI"</span>,</span>
<span id="cb80-72"><a href="#cb80-72" aria-hidden="true" tabindex="-1"></a>                X <span class="sc">!=</span> <span class="st">"NDVI_Stan"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-73"><a href="#cb80-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Class) <span class="sc">%&gt;%</span></span>
<span id="cb80-74"><a href="#cb80-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">STD =</span> (value<span class="sc">-</span><span class="fu">min</span>(value))<span class="sc">/</span>(<span class="fu">max</span>(value)<span class="sc">-</span><span class="fu">min</span>(value))) <span class="sc">%&gt;%</span> </span>
<span id="cb80-75"><a href="#cb80-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-76"><a href="#cb80-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">==</span> <span class="st">"Magnoliosida"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb80-77"><a href="#cb80-77" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb80-78"><a href="#cb80-78" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Clorophyta"</span> <span class="sc">~</span> <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb80-79"><a href="#cb80-79" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Rhodphyta"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb80-80"><a href="#cb80-80" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"MPB"</span> <span class="sc">~</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb80-81"><a href="#cb80-81" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Phaeophyta"</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb80-82"><a href="#cb80-82" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> Class),</span>
<span id="cb80-83"><a href="#cb80-83" aria-hidden="true" tabindex="-1"></a>         <span class="at">Variable =</span> <span class="fu">str_replace_all</span>(<span class="fu">str_replace_all</span>(<span class="fu">str_replace_all</span>(X,<span class="st">"Reflectance"</span>,<span class="st">""</span>),<span class="st">"Stan"</span>,<span class="st">""</span>),<span class="st">"_"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-84"><a href="#cb80-84" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">!=</span> <span class="st">"Total"</span>) </span>
<span id="cb80-85"><a href="#cb80-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-86"><a href="#cb80-86" aria-hidden="true" tabindex="-1"></a>VIP_summarised<span class="ot">&lt;-</span>VIP1 <span class="sc">%&gt;%</span> </span>
<span id="cb80-87"><a href="#cb80-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Variable, Class) <span class="sc">%&gt;%</span> </span>
<span id="cb80-88"><a href="#cb80-88" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">sumVIP =</span> <span class="fu">sum</span>(STD)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-89"><a href="#cb80-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-90"><a href="#cb80-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Class) <span class="sc">%&gt;%</span> </span>
<span id="cb80-91"><a href="#cb80-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">STD =</span> (sumVIP<span class="sc">-</span><span class="fu">min</span>(sumVIP))<span class="sc">/</span>(<span class="fu">max</span>(sumVIP)<span class="sc">-</span><span class="fu">min</span>(sumVIP)))</span>
<span id="cb80-92"><a href="#cb80-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-93"><a href="#cb80-93" aria-hidden="true" tabindex="-1"></a>VIP_subPLOT<span class="ot">&lt;-</span>VIP_summarised <span class="sc">%&gt;%</span> </span>
<span id="cb80-94"><a href="#cb80-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> STD, <span class="at">fill =</span> Class)) <span class="sc">+</span></span>
<span id="cb80-95"><a href="#cb80-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>,<span class="at">position =</span>  <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb80-96"><a href="#cb80-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>()<span class="sc">+</span></span>
<span id="cb80-97"><a href="#cb80-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb80-98"><a href="#cb80-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Class)<span class="sc">+</span></span>
<span id="cb80-99"><a href="#cb80-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"Class"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>, <span class="st">"Magnoliopsida"</span>, <span class="st">"Phaeophyceae"</span>,<span class="st">"Rhodophyceae"</span>),</span>
<span id="cb80-100"><a href="#cb80-100" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#DAA520"</span>,<span class="st">"#b3ff1a"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>))<span class="sc">+</span></span>
<span id="cb80-101"><a href="#cb80-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb80-102"><a href="#cb80-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>,<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"grey9"</span>,<span class="st">"grey9"</span>,<span class="st">"grey9"</span>,<span class="st">"grey9"</span>,<span class="cn">NA</span>)))<span class="sc">+</span></span>
<span id="cb80-103"><a href="#cb80-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Importance"</span>)<span class="sc">+</span></span>
<span id="cb80-104"><a href="#cb80-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>,</span>
<span id="cb80-105"><a href="#cb80-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb80-106"><a href="#cb80-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-107"><a href="#cb80-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb80-108"><a href="#cb80-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-109"><a href="#cb80-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-110"><a href="#cb80-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb80-111"><a href="#cb80-111" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">'cm'</span>),</span>
<span id="cb80-112"><a href="#cb80-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb80-113"><a href="#cb80-113" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb80-114"><a href="#cb80-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span>
<span id="cb80-115"><a href="#cb80-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-116"><a href="#cb80-116" aria-hidden="true" tabindex="-1"></a>VIP_PLOT<span class="ot">&lt;-</span>VIP_subPLOT<span class="sc">+</span></span>
<span id="cb80-117"><a href="#cb80-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_text(aes(label = "Standardised Reflectance Spectra"), color = "black", size = 8)+</span></span>
<span id="cb80-118"><a href="#cb80-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inset_element</span>(SP_plot,<span class="at">left =</span> <span class="fl">0.6341</span>, <span class="at">top =</span> <span class="fl">0.47</span>, <span class="at">bottom =</span> <span class="sc">-</span><span class="fl">0.01</span>, <span class="at">right =</span> <span class="fl">0.90</span>,  <span class="at">align_to =</span> <span class="st">"full"</span>)</span>
<span id="cb80-119"><a href="#cb80-119" aria-hidden="true" tabindex="-1"></a>VIP_PLOT</span>
<span id="cb80-120"><a href="#cb80-120" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/VIP/Fig_VIP.png"</span>, VIP_PLOT, <span class="at">width =</span> <span class="dv">1920</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1129</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span>
<span id="cb80-121"><a href="#cb80-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-122"><a href="#cb80-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-123"><a href="#cb80-123" aria-hidden="true" tabindex="-1"></a><span class="do">################# VIP NDVI ######################</span></span>
<span id="cb80-124"><a href="#cb80-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-125"><a href="#cb80-125" aria-hidden="true" tabindex="-1"></a>VIP_NDVI<span class="ot">&lt;-</span></span>
<span id="cb80-126"><a href="#cb80-126" aria-hidden="true" tabindex="-1"></a>  VIP <span class="sc">%&gt;%</span></span>
<span id="cb80-127"><a href="#cb80-127" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Water,</span>
<span id="cb80-128"><a href="#cb80-128" aria-hidden="true" tabindex="-1"></a>                   SunGlint,</span>
<span id="cb80-129"><a href="#cb80-129" aria-hidden="true" tabindex="-1"></a>                   Deep_Sediment,</span>
<span id="cb80-130"><a href="#cb80-130" aria-hidden="true" tabindex="-1"></a>                   Bare_Sediment)) <span class="sc">%&gt;%</span></span>
<span id="cb80-131"><a href="#cb80-131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::filter(!str_detect(X,"NDVI")) %&gt;% </span></span>
<span id="cb80-132"><a href="#cb80-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">isSTD =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(X,<span class="st">"Stan"</span>) <span class="sc">~</span> <span class="st">"Standardised"</span>, </span>
<span id="cb80-133"><a href="#cb80-133" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"RAW"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-134"><a href="#cb80-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(X,isSTD), <span class="at">names_to =</span> <span class="st">"Class"</span>,<span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-135"><a href="#cb80-135" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(X <span class="sc">==</span> <span class="st">"NDVI"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-136"><a href="#cb80-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Class) <span class="sc">%&gt;%</span></span>
<span id="cb80-137"><a href="#cb80-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">STD =</span> (value<span class="sc">-</span><span class="fu">min</span>(value))<span class="sc">/</span>(<span class="fu">max</span>(value)<span class="sc">-</span><span class="fu">min</span>(value))) <span class="sc">%&gt;%</span> </span>
<span id="cb80-138"><a href="#cb80-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-139"><a href="#cb80-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">==</span> <span class="st">"Magnoliosida"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb80-140"><a href="#cb80-140" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Low_SPC"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb80-141"><a href="#cb80-141" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Clorophyta"</span> <span class="sc">~</span> <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb80-142"><a href="#cb80-142" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Rhodphyta"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb80-143"><a href="#cb80-143" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"MPB"</span> <span class="sc">~</span> <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb80-144"><a href="#cb80-144" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Phaeophyta"</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb80-145"><a href="#cb80-145" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> Class),</span>
<span id="cb80-146"><a href="#cb80-146" aria-hidden="true" tabindex="-1"></a>         <span class="at">Variable =</span> <span class="fu">str_replace_all</span>(<span class="fu">str_replace_all</span>(<span class="fu">str_replace_all</span>(X,<span class="st">"Reflectance"</span>,<span class="st">""</span>),<span class="st">"Stan"</span>,<span class="st">""</span>),<span class="st">"_"</span>,<span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-147"><a href="#cb80-147" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">!=</span> <span class="st">"Total"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-148"><a href="#cb80-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Class) <span class="sc">%&gt;%</span> </span>
<span id="cb80-149"><a href="#cb80-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-150"><a href="#cb80-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">STD =</span> (sum<span class="sc">-</span><span class="fu">min</span>(sum))<span class="sc">/</span>(<span class="fu">max</span>(sum)<span class="sc">-</span><span class="fu">min</span>(sum))) <span class="sc">%&gt;%</span> </span>
<span id="cb80-151"><a href="#cb80-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Class, <span class="at">y =</span> STD, <span class="at">fill =</span> Class)) <span class="sc">+</span></span>
<span id="cb80-152"><a href="#cb80-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>,<span class="at">position =</span>  <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb80-153"><a href="#cb80-153" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coord_polar()+</span></span>
<span id="cb80-154"><a href="#cb80-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb80-155"><a href="#cb80-155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~Class)+</span></span>
<span id="cb80-156"><a href="#cb80-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"Class"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bacillariophyceae"</span>,<span class="st">"Chlorophyceae"</span>, <span class="st">"Magnoliopsida"</span>, <span class="st">"Phaeophyceae"</span>,<span class="st">"Rhodophyceae"</span>),</span>
<span id="cb80-157"><a href="#cb80-157" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#DAA520"</span>,<span class="st">"#b3ff1a"</span>, <span class="st">"#389318"</span>,<span class="st">"#873e23"</span>,<span class="st">"#b3002d"</span>))<span class="sc">+</span>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb80-158"><a href="#cb80-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>,<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"grey9"</span>,<span class="st">"grey9"</span>,<span class="st">"grey9"</span>,<span class="st">"grey9"</span>,<span class="cn">NA</span>)))<span class="sc">+</span></span>
<span id="cb80-159"><a href="#cb80-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Importance"</span>)<span class="sc">+</span></span>
<span id="cb80-160"><a href="#cb80-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>,</span>
<span id="cb80-161"><a href="#cb80-161" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb80-162"><a href="#cb80-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb80-163"><a href="#cb80-163" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb80-164"><a href="#cb80-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-165"><a href="#cb80-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-166"><a href="#cb80-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb80-167"><a href="#cb80-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">'cm'</span>),</span>
<span id="cb80-168"><a href="#cb80-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb80-169"><a href="#cb80-169" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb80-170"><a href="#cb80-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [33]:</pre></div><div id="cell-fig-VIP" class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"Figures/VIP/Fig_VIP.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-VIP" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-VIP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="Figures/VIP/Fig_VIP.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" data-glightbox="description: .lightbox-desc-9"><img src="Figures/VIP/Fig_VIP.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VIP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Variable Importance of the Neural Network Classifier for each vegetation class. The bigger the slice, the more important is the variable to predict accuratly this class. The bottom right plot shows the drone standardised reflectance spectra of each class.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>The computation of the variable importance makes it possible to identify which wavelengths are the most useful for class prediction (<a href="#fig-VIP" class="quarto-xref">Figure&nbsp;9</a>). The spectral bands at 444 , 717 and 842 nm of the Micasense camera are important for none of the vegetation classes. The band at 531 nm is the only important predictor for the classifier to accurately predict chlorophyceae. In fact, at this wavelength, the Chlorophyceae spectra has the maximum reflectance among of all vegetation classes. The bands at 531 and 740 nm are the most important predictors for Phaeophyceae, corresponding to the minimum reflectance among all classes. Bands at 475 and 560 nm are the most important predictors for Bacillariophyceae and Rhodophyceae, respectively. Four predictors, ranging from the green (560 nm) to the RedEdge (705 nm) bands are important to accurately predict magnoliopsida.</p>
</section>
<section id="effect-of-the-flight-height-on-the-prediction" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="effect-of-the-flight-height-on-the-prediction"><span class="header-section-number">3.4</span> Effect of the flight height on the prediction</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [34]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">list.files</span>(<span class="st">"./Output"</span>,<span class="at">pattern =</span> <span class="st">"output_80_filtered_Upscaling.csv"</span>)) <span class="sc">==</span> <span class="dv">0</span> ){</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a> imglist<span class="ot">&lt;-</span><span class="st">"Output/High_Flights_correction/Low_flight_spatial_resampling/"</span> <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">list.files</span>(<span class="st">".tif"</span>,<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">path =</span> <span class="st">"."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">size =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path,<span class="st">"_8_7x7.tif"</span>) <span class="sc">~</span> <span class="dv">8</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">str_detect</span>(path,<span class="st">"16.tif"</span>) <span class="sc">~</span> <span class="dv">16</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">str_detect</span>(path,<span class="st">"32.tif"</span>) <span class="sc">~</span> <span class="dv">32</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">str_detect</span>(path,<span class="st">"48.tif"</span>) <span class="sc">~</span> <span class="dv">48</span>,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">str_detect</span>(path,<span class="st">"64.tif"</span>) <span class="sc">~</span> <span class="dv">64</span>,</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">str_detect</span>(path,<span class="st">"80.tif"</span>) <span class="sc">~</span> <span class="dv">80</span>),</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(path, <span class="st">"ortho"</span>) <span class="sc">~</span> <span class="st">"ortho"</span>,</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">str_detect</span>(path, <span class="st">"pred"</span>) <span class="sc">~</span> <span class="st">"Pred"</span>,</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Prob"</span>))</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>pred_8<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(size <span class="sc">==</span> <span class="dv">8</span>,</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>          type <span class="sc">==</span> <span class="st">"Pred"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>   terra<span class="sc">::</span><span class="fu">rast</span>()</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(pred_8)<span class="ot">&lt;-</span><span class="st">"Pred_8"</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a> pred_80<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(size <span class="sc">==</span> <span class="dv">80</span>,</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>          type <span class="sc">==</span> <span class="st">"Pred"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>   terra<span class="sc">::</span><span class="fu">rast</span>()</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(pred_80)<span class="ot">&lt;-</span><span class="st">"Pred_80"</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>prob_80<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(size <span class="sc">==</span> <span class="dv">80</span>,</span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>          type <span class="sc">==</span> <span class="st">"Prob"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>   terra<span class="sc">::</span><span class="fu">rast</span>()</span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(prob_80)<span class="ot">&lt;-</span><span class="st">"Prob_80"</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a> model_80<span class="ot">&lt;-</span>imglist <span class="sc">%&gt;%</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(size <span class="sc">==</span> <span class="dv">80</span>,</span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>          type <span class="sc">==</span> <span class="st">"Pred"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">pull</span>(path) <span class="sc">%&gt;%</span></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a>   terra<span class="sc">::</span><span class="fu">rast</span>()</span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a> <span class="fu">values</span>(model_80)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncell</span>(model_80))</span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(model_80)<span class="ot">&lt;-</span><span class="st">"ID_80"</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a> model_80_rs_to_8<span class="ot">&lt;-</span>terra<span class="sc">::</span><span class="fu">resample</span>(model_80,pred_8,<span class="at">method =</span> <span class="st">"near"</span>)</span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(model_80_rs_to_8)<span class="ot">&lt;-</span><span class="st">"ID_80"</span></span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-50"><a href="#cb82-50" aria-hidden="true" tabindex="-1"></a> df_80_8<span class="ot">&lt;-</span>terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">list</span>(model_80_rs_to_8,pred_8)) <span class="sc">%&gt;%</span></span>
<span id="cb82-51"><a href="#cb82-51" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.data.frame</span>(<span class="at">xy=</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb82-52"><a href="#cb82-52" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>Pred_8 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb82-53"><a href="#cb82-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-54"><a href="#cb82-54" aria-hidden="true" tabindex="-1"></a> df_80<span class="ot">&lt;-</span>terra<span class="sc">::</span><span class="fu">rast</span>(<span class="fu">list</span>(model_80,pred_80,prob_80)) <span class="sc">%&gt;%</span></span>
<span id="cb82-55"><a href="#cb82-55" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.data.frame</span>(<span class="at">xy=</span>F) <span class="sc">%&gt;%</span></span>
<span id="cb82-56"><a href="#cb82-56" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>Pred_80 <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb82-57"><a href="#cb82-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-58"><a href="#cb82-58" aria-hidden="true" tabindex="-1"></a><span class="do">#############</span></span>
<span id="cb82-59"><a href="#cb82-59" aria-hidden="true" tabindex="-1"></a>output_80<span class="ot">&lt;-</span>df_80 <span class="sc">%&gt;%</span> </span>
<span id="cb82-60"><a href="#cb82-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(df_80_8, <span class="at">by =</span> <span class="st">"ID_80"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-61"><a href="#cb82-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Pred_8)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-62"><a href="#cb82-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class_80 =</span> <span class="fu">case_when</span>(Pred_80 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb82-63"><a href="#cb82-63" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Green Algae"</span>,</span>
<span id="cb82-64"><a href="#cb82-64" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb82-65"><a href="#cb82-65" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb82-66"><a href="#cb82-66" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Microphytobenthos"</span>,</span>
<span id="cb82-67"><a href="#cb82-67" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb82-68"><a href="#cb82-68" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb82-69"><a href="#cb82-69" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb82-70"><a href="#cb82-70" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb82-71"><a href="#cb82-71" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Water"</span>,</span>
<span id="cb82-72"><a href="#cb82-72" aria-hidden="true" tabindex="-1"></a>                              Pred_80 <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb82-73"><a href="#cb82-73" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(Pred_80)),</span>
<span id="cb82-74"><a href="#cb82-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">Class_8 =</span> <span class="fu">case_when</span>(Pred_8 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb82-75"><a href="#cb82-75" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Green Algae"</span>,</span>
<span id="cb82-76"><a href="#cb82-76" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb82-77"><a href="#cb82-77" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb82-78"><a href="#cb82-78" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Microphytobenthos"</span>,</span>
<span id="cb82-79"><a href="#cb82-79" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb82-80"><a href="#cb82-80" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb82-81"><a href="#cb82-81" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb82-82"><a href="#cb82-82" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb82-83"><a href="#cb82-83" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"Water"</span>,</span>
<span id="cb82-84"><a href="#cb82-84" aria-hidden="true" tabindex="-1"></a>                              Pred_8 <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"Xanthophyceae"</span>,</span>
<span id="cb82-85"><a href="#cb82-85" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(Pred_8))</span>
<span id="cb82-86"><a href="#cb82-86" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb82-87"><a href="#cb82-87" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">filter</span>(Class_80 <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb82-88"><a href="#cb82-88" aria-hidden="true" tabindex="-1"></a>                 Class_80 <span class="sc">!=</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb82-89"><a href="#cb82-89" aria-hidden="true" tabindex="-1"></a>                 Class_80 <span class="sc">!=</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb82-90"><a href="#cb82-90" aria-hidden="true" tabindex="-1"></a>                 Class_8 <span class="sc">!=</span> <span class="st">"Water"</span>,</span>
<span id="cb82-91"><a href="#cb82-91" aria-hidden="true" tabindex="-1"></a>                 Class_8 <span class="sc">!=</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb82-92"><a href="#cb82-92" aria-hidden="true" tabindex="-1"></a>                 Class_8 <span class="sc">!=</span> <span class="st">"Sun Glint"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-93"><a href="#cb82-93" aria-hidden="true" tabindex="-1"></a>           <span class="fu">group_by</span>(ID_80, Prob_80) <span class="sc">%&gt;%</span> </span>
<span id="cb82-94"><a href="#cb82-94" aria-hidden="true" tabindex="-1"></a>           <span class="fu">summarise</span>(<span class="at">prop_Sed =</span> <span class="fu">sum</span>((Pred_8 <span class="sc">==</span> <span class="dv">1</span>)<span class="sc">|</span>(Pred_8 <span class="sc">==</span> <span class="dv">3</span>))<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb82-95"><a href="#cb82-95" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop_Green =</span> <span class="fu">sum</span>(Pred_8 <span class="sc">==</span> <span class="dv">2</span>)<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb82-96"><a href="#cb82-96" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop_Magno =</span> <span class="fu">sum</span>((Pred_8 <span class="sc">==</span> <span class="dv">4</span>)<span class="sc">|</span>(Pred_8 <span class="sc">==</span> <span class="dv">6</span>))<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb82-97"><a href="#cb82-97" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop_MPB =</span> <span class="fu">sum</span>(Pred_8 <span class="sc">==</span> <span class="dv">5</span>)<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb82-98"><a href="#cb82-98" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop_Rodo =</span> <span class="fu">sum</span>(Pred_8 <span class="sc">==</span> <span class="dv">8</span>)<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb82-99"><a href="#cb82-99" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prop_Xantho =</span> <span class="fu">sum</span>(Pred_8 <span class="sc">==</span> <span class="dv">11</span>)<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb82-100"><a href="#cb82-100" aria-hidden="true" tabindex="-1"></a>                     <span class="at">True =</span> <span class="fu">unique</span>(Class_80)) <span class="sc">%&gt;%</span></span>
<span id="cb82-101"><a href="#cb82-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(ID_80,True,Prob_80), <span class="at">names_to =</span> <span class="st">"Class"</span>, <span class="at">values_to =</span> <span class="st">"Proportion"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-102"><a href="#cb82-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">==</span> <span class="st">"prop_Sed"</span> <span class="sc">~</span> <span class="st">"Bare Sediment"</span>,</span>
<span id="cb82-103"><a href="#cb82-103" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Green"</span> <span class="sc">~</span> <span class="st">"Green Algae"</span>,</span>
<span id="cb82-104"><a href="#cb82-104" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Magno"</span> <span class="sc">~</span> <span class="st">"Magnoliopsida"</span>,</span>
<span id="cb82-105"><a href="#cb82-105" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_MPB"</span> <span class="sc">~</span> <span class="st">"Microphytobenthos"</span>,</span>
<span id="cb82-106"><a href="#cb82-106" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Pheo"</span> <span class="sc">~</span> <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb82-107"><a href="#cb82-107" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Rodo"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb82-108"><a href="#cb82-108" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Glint"</span> <span class="sc">~</span> <span class="st">"Sun Glint"</span>,</span>
<span id="cb82-109"><a href="#cb82-109" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Water"</span> <span class="sc">~</span> <span class="st">"Water"</span>,</span>
<span id="cb82-110"><a href="#cb82-110" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"prop_Xantho"</span> <span class="sc">~</span> <span class="st">"Xanthophyceae"</span>),</span>
<span id="cb82-111"><a href="#cb82-111" aria-hidden="true" tabindex="-1"></a>         <span class="at">same =</span> <span class="fu">case_when</span>(True <span class="sc">==</span> Class <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-112"><a href="#cb82-112" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-113"><a href="#cb82-113" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>Proportion <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb82-114"><a href="#cb82-114" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb82-115"><a href="#cb82-115" aria-hidden="true" tabindex="-1"></a>  list<span class="ot">&lt;-</span>output_80 <span class="sc">%&gt;%</span> </span>
<span id="cb82-116"><a href="#cb82-116" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Proportion <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb82-117"><a href="#cb82-117" aria-hidden="true" tabindex="-1"></a>                Class <span class="sc">==</span> True) <span class="sc">%&gt;%</span> </span>
<span id="cb82-118"><a href="#cb82-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(ID_80)</span>
<span id="cb82-119"><a href="#cb82-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-120"><a href="#cb82-120" aria-hidden="true" tabindex="-1"></a>output_80_filtered<span class="ot">&lt;-</span>output_80 <span class="sc">%&gt;%</span> </span>
<span id="cb82-121"><a href="#cb82-121" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>ID_80 <span class="sc">%in%</span> list )</span>
<span id="cb82-122"><a href="#cb82-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-123"><a href="#cb82-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-124"><a href="#cb82-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-125"><a href="#cb82-125" aria-hidden="true" tabindex="-1"></a>output_80_filtered_same<span class="ot">&lt;-</span>output_80_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb82-126"><a href="#cb82-126" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(same <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb82-127"><a href="#cb82-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-128"><a href="#cb82-128" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(output_80_filtered, <span class="st">"./Output/output_80_filtered_Upscaling.csv"</span>)</span>
<span id="cb82-129"><a href="#cb82-129" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(output_80_filtered_same, <span class="st">"./Output/output_80_filtered_same_Upscaling.csv"</span>)</span>
<span id="cb82-130"><a href="#cb82-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-131"><a href="#cb82-131" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb82-132"><a href="#cb82-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-133"><a href="#cb82-133" aria-hidden="true" tabindex="-1"></a>  output_80_filtered<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"./Output/output_80_filtered_Upscaling.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-134"><a href="#cb82-134" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Proportion =</span> Proportion <span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-135"><a href="#cb82-135" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">%&gt;%</span> </span>
<span id="cb82-136"><a href="#cb82-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb82-137"><a href="#cb82-137" aria-hidden="true" tabindex="-1"></a>  output_80_filtered_same<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"./Output/output_80_filtered_same_Upscaling.csv"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb82-138"><a href="#cb82-138" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Proportion =</span> Proportion <span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-139"><a href="#cb82-139" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">%&gt;%</span> </span>
<span id="cb82-140"><a href="#cb82-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb82-141"><a href="#cb82-141" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-142"><a href="#cb82-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-143"><a href="#cb82-143" aria-hidden="true" tabindex="-1"></a><span class="do">################# LM ####################</span></span>
<span id="cb82-144"><a href="#cb82-144" aria-hidden="true" tabindex="-1"></a>lm_sediment<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb82-145"><a href="#cb82-145" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Bare Sediment"</span>) </span>
<span id="cb82-146"><a href="#cb82-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-147"><a href="#cb82-147" aria-hidden="true" tabindex="-1"></a> lm_sediment<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_sediment<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_sediment<span class="sc">$</span>Proportion)</span>
<span id="cb82-148"><a href="#cb82-148" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb82-149"><a href="#cb82-149" aria-hidden="true" tabindex="-1"></a> lm_green<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb82-150"><a href="#cb82-150" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Green Algae"</span>) </span>
<span id="cb82-151"><a href="#cb82-151" aria-hidden="true" tabindex="-1"></a>  lm_green<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_green<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_green<span class="sc">$</span>Proportion)</span>
<span id="cb82-152"><a href="#cb82-152" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb82-153"><a href="#cb82-153" aria-hidden="true" tabindex="-1"></a> lm_magno<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb82-154"><a href="#cb82-154" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Magnoliopsida"</span>) </span>
<span id="cb82-155"><a href="#cb82-155" aria-hidden="true" tabindex="-1"></a>   lm_magno<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_magno<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_magno<span class="sc">$</span>Proportion)</span>
<span id="cb82-156"><a href="#cb82-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-157"><a href="#cb82-157" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb82-158"><a href="#cb82-158" aria-hidden="true" tabindex="-1"></a> lm_MPB<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb82-159"><a href="#cb82-159" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Microphytobenthos"</span>)</span>
<span id="cb82-160"><a href="#cb82-160" aria-hidden="true" tabindex="-1"></a>    lm_MPB<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_MPB<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_MPB<span class="sc">$</span>Proportion)</span>
<span id="cb82-161"><a href="#cb82-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-162"><a href="#cb82-162" aria-hidden="true" tabindex="-1"></a>lm_Rodo<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb82-163"><a href="#cb82-163" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Rodophyceae"</span>)</span>
<span id="cb82-164"><a href="#cb82-164" aria-hidden="true" tabindex="-1"></a>    lm_Rodo<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_Rodo<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_Rodo<span class="sc">$</span>Proportion)</span>
<span id="cb82-165"><a href="#cb82-165" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb82-166"><a href="#cb82-166" aria-hidden="true" tabindex="-1"></a> <span class="do">########### ALPHA ###############</span></span>
<span id="cb82-167"><a href="#cb82-167" aria-hidden="true" tabindex="-1"></a>alpha_sed<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">prop =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-168"><a href="#cb82-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> lm_sediment<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span>prop<span class="sc">+</span>lm_sediment<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],</span>
<span id="cb82-169"><a href="#cb82-169" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)),</span>
<span id="cb82-170"><a href="#cb82-170" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>),</span>
<span id="cb82-171"><a href="#cb82-171" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">1.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb82-172"><a href="#cb82-172" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(.)),</span>
<span id="cb82-173"><a href="#cb82-173" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb82-174"><a href="#cb82-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(xmin,xmax),<span class="at">names_to =</span> <span class="st">"name_x"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-175"><a href="#cb82-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(ymax,ymin), <span class="at">names_to =</span> <span class="st">"name_y"</span>,<span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-176"><a href="#cb82-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-177"><a href="#cb82-177" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name_x,name_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-178"><a href="#cb82-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">case_when</span>(alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-179"><a href="#cb82-179" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> alpha),</span>
<span id="cb82-180"><a href="#cb82-180" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">%&gt;%</span> </span>
<span id="cb82-181"><a href="#cb82-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> (alpha <span class="sc">-</span> <span class="fu">min</span>(alpha))<span class="sc">/</span> (<span class="fu">max</span>(alpha) <span class="sc">-</span> <span class="fu">min</span>(alpha)))</span>
<span id="cb82-182"><a href="#cb82-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-183"><a href="#cb82-183" aria-hidden="true" tabindex="-1"></a>alpha_green<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">prop =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-184"><a href="#cb82-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> lm_green<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span>prop<span class="sc">+</span>lm_green<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],</span>
<span id="cb82-185"><a href="#cb82-185" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)),</span>
<span id="cb82-186"><a href="#cb82-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>),</span>
<span id="cb82-187"><a href="#cb82-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">1.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb82-188"><a href="#cb82-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(.)),</span>
<span id="cb82-189"><a href="#cb82-189" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb82-190"><a href="#cb82-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(xmin,xmax),<span class="at">names_to =</span> <span class="st">"name_x"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-191"><a href="#cb82-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(ymax,ymin), <span class="at">names_to =</span> <span class="st">"name_y"</span>,<span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-192"><a href="#cb82-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-193"><a href="#cb82-193" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name_x,name_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-194"><a href="#cb82-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">case_when</span>(alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-195"><a href="#cb82-195" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> alpha),</span>
<span id="cb82-196"><a href="#cb82-196" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">%&gt;%</span> </span>
<span id="cb82-197"><a href="#cb82-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> (alpha <span class="sc">-</span> <span class="fu">min</span>(alpha))<span class="sc">/</span> (<span class="fu">max</span>(alpha) <span class="sc">-</span> <span class="fu">min</span>(alpha)))</span>
<span id="cb82-198"><a href="#cb82-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-199"><a href="#cb82-199" aria-hidden="true" tabindex="-1"></a>alpha_magno<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">prop =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-200"><a href="#cb82-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> lm_magno<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span>prop<span class="sc">+</span>lm_magno<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],</span>
<span id="cb82-201"><a href="#cb82-201" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)),</span>
<span id="cb82-202"><a href="#cb82-202" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>),</span>
<span id="cb82-203"><a href="#cb82-203" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">1.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb82-204"><a href="#cb82-204" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(.)),</span>
<span id="cb82-205"><a href="#cb82-205" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb82-206"><a href="#cb82-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(xmin,xmax),<span class="at">names_to =</span> <span class="st">"name_x"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-207"><a href="#cb82-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(ymax,ymin), <span class="at">names_to =</span> <span class="st">"name_y"</span>,<span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-208"><a href="#cb82-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-209"><a href="#cb82-209" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name_x,name_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-210"><a href="#cb82-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">case_when</span>(alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-211"><a href="#cb82-211" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> alpha),</span>
<span id="cb82-212"><a href="#cb82-212" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">%&gt;%</span> </span>
<span id="cb82-213"><a href="#cb82-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> (alpha <span class="sc">-</span> <span class="fu">min</span>(alpha))<span class="sc">/</span> (<span class="fu">max</span>(alpha) <span class="sc">-</span> <span class="fu">min</span>(alpha)))</span>
<span id="cb82-214"><a href="#cb82-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-215"><a href="#cb82-215" aria-hidden="true" tabindex="-1"></a>alpha_MPB<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">prop =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-216"><a href="#cb82-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> lm_MPB<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span>prop<span class="sc">+</span>lm_MPB<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],</span>
<span id="cb82-217"><a href="#cb82-217" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)),</span>
<span id="cb82-218"><a href="#cb82-218" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>),</span>
<span id="cb82-219"><a href="#cb82-219" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">1.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb82-220"><a href="#cb82-220" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(.)),</span>
<span id="cb82-221"><a href="#cb82-221" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb82-222"><a href="#cb82-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(xmin,xmax),<span class="at">names_to =</span> <span class="st">"name_x"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-223"><a href="#cb82-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(ymax,ymin), <span class="at">names_to =</span> <span class="st">"name_y"</span>,<span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-224"><a href="#cb82-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-225"><a href="#cb82-225" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name_x,name_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-226"><a href="#cb82-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">case_when</span>(alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-227"><a href="#cb82-227" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> alpha),</span>
<span id="cb82-228"><a href="#cb82-228" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">%&gt;%</span> </span>
<span id="cb82-229"><a href="#cb82-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> (alpha <span class="sc">-</span> <span class="fu">min</span>(alpha))<span class="sc">/</span> (<span class="fu">max</span>(alpha) <span class="sc">-</span> <span class="fu">min</span>(alpha)))</span>
<span id="cb82-230"><a href="#cb82-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-231"><a href="#cb82-231" aria-hidden="true" tabindex="-1"></a>alpha_Rodo<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">prop =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-232"><a href="#cb82-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> lm_Rodo<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span>prop<span class="sc">+</span>lm_Rodo<span class="sc">$</span>coefficients[[<span class="dv">1</span>]],</span>
<span id="cb82-233"><a href="#cb82-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)),</span>
<span id="cb82-234"><a href="#cb82-234" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmin =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,  <span class="fl">0.01</span>),</span>
<span id="cb82-235"><a href="#cb82-235" aria-hidden="true" tabindex="-1"></a>         <span class="at">xmax =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">1.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb82-236"><a href="#cb82-236" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(.)),</span>
<span id="cb82-237"><a href="#cb82-237" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymax =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb82-238"><a href="#cb82-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(xmin,xmax),<span class="at">names_to =</span> <span class="st">"name_x"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-239"><a href="#cb82-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(ymax,ymin), <span class="at">names_to =</span> <span class="st">"name_y"</span>,<span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-240"><a href="#cb82-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">nrow</span>(.)<span class="sc">/</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-241"><a href="#cb82-241" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(name_x,name_y)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-242"><a href="#cb82-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">case_when</span>(alpha <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-243"><a href="#cb82-243" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> alpha),</span>
<span id="cb82-244"><a href="#cb82-244" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">%&gt;%</span> </span>
<span id="cb82-245"><a href="#cb82-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> (alpha <span class="sc">-</span> <span class="fu">min</span>(alpha))<span class="sc">/</span> (<span class="fu">max</span>(alpha) <span class="sc">-</span> <span class="fu">min</span>(alpha)))</span>
<span id="cb82-246"><a href="#cb82-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-247"><a href="#cb82-247" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha_xantho&lt;-data.frame(prop = seq(0,1,  0.01)) %&gt;% </span></span>
<span id="cb82-248"><a href="#cb82-248" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(alpha = lm_xantho$coefficients[[2]]*prop+lm_xantho$coefficients[[1]],</span></span>
<span id="cb82-249"><a href="#cb82-249" aria-hidden="true" tabindex="-1"></a><span class="co">#          ID = c(1:nrow(.)),</span></span>
<span id="cb82-250"><a href="#cb82-250" aria-hidden="true" tabindex="-1"></a><span class="co">#          xmin = seq(0,1,  0.01),</span></span>
<span id="cb82-251"><a href="#cb82-251" aria-hidden="true" tabindex="-1"></a><span class="co">#          xmax = seq(0.01,1.01,0.01),</span></span>
<span id="cb82-252"><a href="#cb82-252" aria-hidden="true" tabindex="-1"></a><span class="co">#          ymin = rep(0,nrow(.)),</span></span>
<span id="cb82-253"><a href="#cb82-253" aria-hidden="true" tabindex="-1"></a><span class="co">#          ymax = rep(1,nrow(.))) %&gt;% </span></span>
<span id="cb82-254"><a href="#cb82-254" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(c(xmin,xmax),names_to = "name_x", values_to = "x") %&gt;% </span></span>
<span id="cb82-255"><a href="#cb82-255" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(c(ymax,ymin), names_to = "name_y",values_to = "y") %&gt;% </span></span>
<span id="cb82-256"><a href="#cb82-256" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(y = rep(c(0,1,1,0),nrow(.)/4)) %&gt;% </span></span>
<span id="cb82-257"><a href="#cb82-257" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::select(-c(name_x,name_y)) %&gt;% </span></span>
<span id="cb82-258"><a href="#cb82-258" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(alpha = case_when(alpha &gt; 1 ~ 1,</span></span>
<span id="cb82-259"><a href="#cb82-259" aria-hidden="true" tabindex="-1"></a><span class="co">#                            TRUE ~ alpha),</span></span>
<span id="cb82-260"><a href="#cb82-260" aria-hidden="true" tabindex="-1"></a><span class="co">#          alpha = 1-alpha) %&gt;% </span></span>
<span id="cb82-261"><a href="#cb82-261" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(alpha = (alpha - min(alpha))/ (max(alpha) - min(alpha)))</span></span>
<span id="cb82-262"><a href="#cb82-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-263"><a href="#cb82-263" aria-hidden="true" tabindex="-1"></a><span class="do">#################</span></span>
<span id="cb82-264"><a href="#cb82-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-265"><a href="#cb82-265" aria-hidden="true" tabindex="-1"></a>sediment<span class="ot">&lt;-</span>output_80_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb82-266"><a href="#cb82-266" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True <span class="sc">==</span> <span class="st">"Bare Sediment"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-267"><a href="#cb82-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">!=</span> True <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb82-268"><a href="#cb82-268" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> Class)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-269"><a href="#cb82-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_80,Class) <span class="sc">%&gt;%</span> </span>
<span id="cb82-270"><a href="#cb82-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">Prob_80 =</span> <span class="fu">unique</span>(Prob_80),</span>
<span id="cb82-271"><a href="#cb82-271" aria-hidden="true" tabindex="-1"></a>          <span class="at">True =</span> <span class="fu">unique</span>(True),</span>
<span id="cb82-272"><a href="#cb82-272" aria-hidden="true" tabindex="-1"></a>          <span class="at">Class =</span> <span class="fu">unique</span>(Class),</span>
<span id="cb82-273"><a href="#cb82-273" aria-hidden="true" tabindex="-1"></a>          <span class="at">Proportion =</span> <span class="fu">sum</span>(Proportion)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-274"><a href="#cb82-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as.factor</span>(Class),</span>
<span id="cb82-275"><a href="#cb82-275" aria-hidden="true" tabindex="-1"></a>         <span class="at">Class =</span> forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(Class,<span class="st">"Bare Sediment"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-276"><a href="#cb82-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb82-277"><a href="#cb82-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Proportion , <span class="at">y =</span> <span class="fu">after_stat</span>(ndensity) , <span class="at">fill =</span> Class),<span class="at">alpha =</span> <span class="fl">0.8</span>,<span class="at">show.legend =</span> F,<span class="at">position =</span> <span class="st">"fill"</span>,<span class="at">adjust =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb82-278"><a href="#cb82-278" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ True)+</span></span>
<span id="cb82-279"><a href="#cb82-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray85"</span>,<span class="st">"#70543e"</span>))<span class="sc">+</span></span>
<span id="cb82-280"><a href="#cb82-280" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_alpha_manual(values = c(0.5,1))+</span></span>
<span id="cb82-281"><a href="#cb82-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb82-282"><a href="#cb82-282" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_polygon(data = alpha_sed, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_sed$alpha,color=NA, fill = "white")+</span></span>
<span id="cb82-283"><a href="#cb82-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (lm_sediment<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span>lm_sediment<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])<span class="sc">*</span><span class="dv">100</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb82-284"><a href="#cb82-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Bare Sediment"</span>)<span class="sc">+</span></span>
<span id="cb82-285"><a href="#cb82-285" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(geom="text",x = lm_sediment$coefficients[[2]]*0.85+lm_sediment$coefficients[[1]]+0.05, y = 0.85, label = "p = 0.85", angle = - 90, size = 7)+</span></span>
<span id="cb82-286"><a href="#cb82-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-287"><a href="#cb82-287" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb82-288"><a href="#cb82-288" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_blank(),</span></span>
<span id="cb82-289"><a href="#cb82-289" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.x = element_text(size = 20)</span></span>
<span id="cb82-290"><a href="#cb82-290" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-291"><a href="#cb82-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-292"><a href="#cb82-292" aria-hidden="true" tabindex="-1"></a>green<span class="ot">&lt;-</span>output_80_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb82-293"><a href="#cb82-293" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True <span class="sc">==</span> <span class="st">"Green Algae"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-294"><a href="#cb82-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">!=</span> True <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb82-295"><a href="#cb82-295" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> Class)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-296"><a href="#cb82-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_80,Class) <span class="sc">%&gt;%</span> </span>
<span id="cb82-297"><a href="#cb82-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">Prob_80 =</span> <span class="fu">unique</span>(Prob_80),</span>
<span id="cb82-298"><a href="#cb82-298" aria-hidden="true" tabindex="-1"></a>          <span class="at">True =</span> <span class="fu">unique</span>(True),</span>
<span id="cb82-299"><a href="#cb82-299" aria-hidden="true" tabindex="-1"></a>          <span class="at">Class =</span> <span class="fu">unique</span>(Class),</span>
<span id="cb82-300"><a href="#cb82-300" aria-hidden="true" tabindex="-1"></a>          <span class="at">Proportion =</span> <span class="fu">sum</span>(Proportion)) <span class="sc">%&gt;%</span></span>
<span id="cb82-301"><a href="#cb82-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as.factor</span>(Class),</span>
<span id="cb82-302"><a href="#cb82-302" aria-hidden="true" tabindex="-1"></a>         <span class="at">Class =</span> forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(Class,<span class="st">"Green Algae"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-303"><a href="#cb82-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb82-304"><a href="#cb82-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Proportion , <span class="at">y =</span> <span class="fu">after_stat</span>(ndensity) , <span class="at">fill =</span> Class),<span class="at">alpha =</span> <span class="fl">0.8</span>,<span class="at">show.legend =</span> F,<span class="at">position =</span> <span class="st">"fill"</span>,<span class="at">adjust =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb82-305"><a href="#cb82-305" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ True)+</span></span>
<span id="cb82-306"><a href="#cb82-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray85"</span>, <span class="st">"#b3ff1a"</span>))<span class="sc">+</span></span>
<span id="cb82-307"><a href="#cb82-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_alpha_manual(values = c(0.5,1))+</span></span>
<span id="cb82-308"><a href="#cb82-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb82-309"><a href="#cb82-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_polygon(data = alpha_green, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_green$alpha,color=NA, fill = "white")+</span></span>
<span id="cb82-310"><a href="#cb82-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (lm_green<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span>lm_green<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])<span class="sc">*</span><span class="dv">100</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb82-311"><a href="#cb82-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Green Algae"</span>)<span class="sc">+</span></span>
<span id="cb82-312"><a href="#cb82-312" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(geom="text",x = lm_green$coefficients[[2]]*0.85+lm_green$coefficients[[1]]+0.05, y = 0.85, label = "p = 0.85", angle = - 90, size = 7)+</span></span>
<span id="cb82-313"><a href="#cb82-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-314"><a href="#cb82-314" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb82-315"><a href="#cb82-315" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_blank(),</span></span>
<span id="cb82-316"><a href="#cb82-316" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.x = element_text(size = 20)</span></span>
<span id="cb82-317"><a href="#cb82-317" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-318"><a href="#cb82-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-319"><a href="#cb82-319" aria-hidden="true" tabindex="-1"></a>magno<span class="ot">&lt;-</span>output_80_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb82-320"><a href="#cb82-320" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True <span class="sc">==</span> <span class="st">"Magnoliopsida"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-321"><a href="#cb82-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">!=</span> True <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb82-322"><a href="#cb82-322" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> Class)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-323"><a href="#cb82-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_80,Class) <span class="sc">%&gt;%</span> </span>
<span id="cb82-324"><a href="#cb82-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">Prob_80 =</span> <span class="fu">unique</span>(Prob_80),</span>
<span id="cb82-325"><a href="#cb82-325" aria-hidden="true" tabindex="-1"></a>          <span class="at">True =</span> <span class="fu">unique</span>(True),</span>
<span id="cb82-326"><a href="#cb82-326" aria-hidden="true" tabindex="-1"></a>          <span class="at">Class =</span> <span class="fu">unique</span>(Class),</span>
<span id="cb82-327"><a href="#cb82-327" aria-hidden="true" tabindex="-1"></a>          <span class="at">Proportion =</span> <span class="fu">sum</span>(Proportion)) <span class="sc">%&gt;%</span></span>
<span id="cb82-328"><a href="#cb82-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as.factor</span>(Class),</span>
<span id="cb82-329"><a href="#cb82-329" aria-hidden="true" tabindex="-1"></a>         <span class="at">Class =</span> forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(Class,<span class="st">"Magnoliopsida"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-330"><a href="#cb82-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb82-331"><a href="#cb82-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Proportion , <span class="at">y =</span> <span class="fu">after_stat</span>(ndensity) , <span class="at">fill =</span> Class),<span class="at">alpha =</span> <span class="fl">0.8</span>,<span class="at">show.legend =</span> F, <span class="at">position =</span> <span class="st">"fill"</span>,<span class="at">adjust =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb82-332"><a href="#cb82-332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ True)+</span></span>
<span id="cb82-333"><a href="#cb82-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray85"</span>,<span class="st">"#389350"</span>))<span class="sc">+</span></span>
<span id="cb82-334"><a href="#cb82-334" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_alpha_manual(values = c(0.5,1))+</span></span>
<span id="cb82-335"><a href="#cb82-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb82-336"><a href="#cb82-336" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_polygon(data = alpha_magno, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_magno$alpha,color=NA, fill = "white")+</span></span>
<span id="cb82-337"><a href="#cb82-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (lm_magno<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span>lm_magno<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])<span class="sc">*</span><span class="dv">100</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb82-338"><a href="#cb82-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Magnoliopsida"</span>)<span class="sc">+</span></span>
<span id="cb82-339"><a href="#cb82-339" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(geom="text",x = lm_magno$coefficients[[2]]*0.85+lm_magno$coefficients[[1]]+0.05, y = 0.85, label = "p = 0.85", angle = - 90, size = 7)+</span></span>
<span id="cb82-340"><a href="#cb82-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-341"><a href="#cb82-341" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb82-342"><a href="#cb82-342" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_blank(),</span></span>
<span id="cb82-343"><a href="#cb82-343" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.x = element_text(size = 20)</span></span>
<span id="cb82-344"><a href="#cb82-344" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-345"><a href="#cb82-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-346"><a href="#cb82-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-347"><a href="#cb82-347" aria-hidden="true" tabindex="-1"></a>MPB<span class="ot">&lt;-</span>output_80_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb82-348"><a href="#cb82-348" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True <span class="sc">==</span> <span class="st">"Microphytobenthos"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-349"><a href="#cb82-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">!=</span> True <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb82-350"><a href="#cb82-350" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> Class)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-351"><a href="#cb82-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_80,Class) <span class="sc">%&gt;%</span> </span>
<span id="cb82-352"><a href="#cb82-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">Prob_80 =</span> <span class="fu">unique</span>(Prob_80),</span>
<span id="cb82-353"><a href="#cb82-353" aria-hidden="true" tabindex="-1"></a>          <span class="at">True =</span> <span class="fu">unique</span>(True),</span>
<span id="cb82-354"><a href="#cb82-354" aria-hidden="true" tabindex="-1"></a>          <span class="at">Class =</span> <span class="fu">unique</span>(Class),</span>
<span id="cb82-355"><a href="#cb82-355" aria-hidden="true" tabindex="-1"></a>          <span class="at">Proportion =</span> <span class="fu">sum</span>(Proportion)) <span class="sc">%&gt;%</span></span>
<span id="cb82-356"><a href="#cb82-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as.factor</span>(Class),</span>
<span id="cb82-357"><a href="#cb82-357" aria-hidden="true" tabindex="-1"></a>         <span class="at">Class =</span> forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(Class,<span class="st">"Microphytobenthos"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-358"><a href="#cb82-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb82-359"><a href="#cb82-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Proportion , <span class="at">y =</span> <span class="fu">after_stat</span>(ndensity) , <span class="at">fill =</span> Class),<span class="at">alpha =</span> <span class="fl">0.8</span>,<span class="at">show.legend =</span> F,<span class="at">position =</span> <span class="st">"fill"</span>,<span class="at">adjust =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb82-360"><a href="#cb82-360" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ True)+</span></span>
<span id="cb82-361"><a href="#cb82-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray85"</span>,<span class="st">"#DAA520"</span>))<span class="sc">+</span></span>
<span id="cb82-362"><a href="#cb82-362" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_alpha_manual(values = c(0.5,1))+</span></span>
<span id="cb82-363"><a href="#cb82-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb82-364"><a href="#cb82-364" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_polygon(data = alpha_MPB, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_MPB$alpha,color=NA, fill = "white")+</span></span>
<span id="cb82-365"><a href="#cb82-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (lm_MPB<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span>lm_MPB<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])<span class="sc">*</span><span class="dv">100</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb82-366"><a href="#cb82-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Microphytobenthos"</span>)<span class="sc">+</span></span>
<span id="cb82-367"><a href="#cb82-367" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(geom="text",x = lm_MPB$coefficients[[2]]*0.85+lm_MPB$coefficients[[1]]+0.05, y = 0.85, label = "p = 0.85", angle = - 90, size = 7)+</span></span>
<span id="cb82-368"><a href="#cb82-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-369"><a href="#cb82-369" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)</span>
<span id="cb82-370"><a href="#cb82-370" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_blank(),</span></span>
<span id="cb82-371"><a href="#cb82-371" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.x = element_text(size = 20)</span></span>
<span id="cb82-372"><a href="#cb82-372" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb82-373"><a href="#cb82-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-374"><a href="#cb82-374" aria-hidden="true" tabindex="-1"></a>rodo<span class="ot">&lt;-</span>output_80_filtered <span class="sc">%&gt;%</span> </span>
<span id="cb82-375"><a href="#cb82-375" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(True <span class="sc">==</span> <span class="st">"Rodophyceae"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-376"><a href="#cb82-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">case_when</span>(Class <span class="sc">!=</span> True <span class="sc">~</span> <span class="st">"Others Classes"</span>,</span>
<span id="cb82-377"><a href="#cb82-377" aria-hidden="true" tabindex="-1"></a>                           Class <span class="sc">==</span> <span class="st">"Rodophyceae"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb82-378"><a href="#cb82-378" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> Class),</span>
<span id="cb82-379"><a href="#cb82-379" aria-hidden="true" tabindex="-1"></a>         <span class="at">True =</span> <span class="fu">case_when</span>(True <span class="sc">==</span> <span class="st">"Rodophyceae"</span> <span class="sc">~</span> <span class="st">"Rhodophyceae"</span>,</span>
<span id="cb82-380"><a href="#cb82-380" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> True)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-381"><a href="#cb82-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID_80,Class) <span class="sc">%&gt;%</span> </span>
<span id="cb82-382"><a href="#cb82-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">Prob_80 =</span> <span class="fu">unique</span>(Prob_80),</span>
<span id="cb82-383"><a href="#cb82-383" aria-hidden="true" tabindex="-1"></a>          <span class="at">True =</span> <span class="fu">unique</span>(True),</span>
<span id="cb82-384"><a href="#cb82-384" aria-hidden="true" tabindex="-1"></a>          <span class="at">Class =</span> <span class="fu">unique</span>(Class),</span>
<span id="cb82-385"><a href="#cb82-385" aria-hidden="true" tabindex="-1"></a>          <span class="at">Proportion =</span> <span class="fu">sum</span>(Proportion)) <span class="sc">%&gt;%</span></span>
<span id="cb82-386"><a href="#cb82-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">factor</span>(Class, <span class="fu">c</span>(<span class="st">"Others Classes"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Bacillariophyceae"</span>, <span class="st">"Magnoliopsida"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Phaeophyceae"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb82-387"><a href="#cb82-387" aria-hidden="true" tabindex="-1"></a>         <span class="co"># Class = forcats::fct_relevel(Class,"Rodophyceae", after = Inf)) %&gt;%</span></span>
<span id="cb82-388"><a href="#cb82-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb82-389"><a href="#cb82-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Proportion , <span class="at">y =</span> <span class="fu">after_stat</span>(ndensity) , <span class="at">fill =</span> Class),<span class="at">alpha =</span> <span class="fl">0.8</span>,<span class="at">position =</span> <span class="st">"fill"</span>,<span class="at">adjust =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb82-390"><a href="#cb82-390" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ True)+</span></span>
<span id="cb82-391"><a href="#cb82-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">"Class"</span>,</span>
<span id="cb82-392"><a href="#cb82-392" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Others Classes"</span>,<span class="st">"Rhodophyceae"</span>,<span class="st">"Bacillariophyceae"</span>, <span class="st">"Magnoliopsida"</span>,<span class="st">"Chlorophyceae"</span>,<span class="st">"Phaeophyceae"</span>),</span>
<span id="cb82-393"><a href="#cb82-393" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray85"</span>,<span class="st">"#b3002d"</span>,<span class="st">"#DAA520"</span>,<span class="st">"#389350"</span>,<span class="st">"#b3ff1a"</span>,<span class="st">"#70543e"</span>),</span>
<span id="cb82-394"><a href="#cb82-394" aria-hidden="true" tabindex="-1"></a>                    <span class="at">drop =</span> F)<span class="sc">+</span></span>
<span id="cb82-395"><a href="#cb82-395" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_alpha_manual(values = c(0.5,1))+</span></span>
<span id="cb82-396"><a href="#cb82-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb82-397"><a href="#cb82-397" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_polygon(data = alpha_Rodo, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_Rodo$alpha,color=NA, fill = "white")+</span></span>
<span id="cb82-398"><a href="#cb82-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (lm_Rodo<span class="sc">$</span>coefficients[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">85</span><span class="sc">+</span>lm_Rodo<span class="sc">$</span>coefficients[[<span class="dv">1</span>]])<span class="sc">*</span><span class="dv">100</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="at">linewidth =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb82-399"><a href="#cb82-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Rhodophyceae"</span>)<span class="sc">+</span></span>
<span id="cb82-400"><a href="#cb82-400" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(geom="text",x = lm_Rodo$coefficients[[2]]*0.85+lm_Rodo$coefficients[[1]]+0.05, y = 0.85, label = "p = 0.85", angle = - 90, size = 7)+</span></span>
<span id="cb82-401"><a href="#cb82-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-402"><a href="#cb82-402" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-403"><a href="#cb82-403" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_blank(),</span></span>
<span id="cb82-404"><a href="#cb82-404" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.x = element_text(size = 20),</span></span>
<span id="cb82-405"><a href="#cb82-405" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-406"><a href="#cb82-406" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">"cm"</span>),</span>
<span id="cb82-407"><a href="#cb82-407" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb82-408"><a href="#cb82-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-409"><a href="#cb82-409" aria-hidden="true" tabindex="-1"></a><span class="co"># xantho&lt;-output_80_filtered %&gt;% </span></span>
<span id="cb82-410"><a href="#cb82-410" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(True == "Xanthophyceae") %&gt;% </span></span>
<span id="cb82-411"><a href="#cb82-411" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot()+</span></span>
<span id="cb82-412"><a href="#cb82-412" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(mapping = aes(x = Proportion , y = after_stat(ndensity) , fill = Class),position = "fill",adjust = 3)+</span></span>
<span id="cb82-413"><a href="#cb82-413" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ True)+</span></span>
<span id="cb82-414"><a href="#cb82-414" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_manual(values=c("#70543e", "#b3ff1a", "#389350", "#DAA520","#b3002d", "#cccc00"))+</span></span>
<span id="cb82-415"><a href="#cb82-415" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_alpha_manual(values = c(0.5,1))+</span></span>
<span id="cb82-416"><a href="#cb82-416" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_Bede()+</span></span>
<span id="cb82-417"><a href="#cb82-417" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_polygon(data = alpha_xantho, mapping = aes(x=x, y = y, alpha = alpha, group = ID),alpha = alpha_xantho$alpha,color=NA, fill = "white")+</span></span>
<span id="cb82-418"><a href="#cb82-418" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_vline(xintercept = lm_xantho$coefficients[[2]]*0.85+lm_xantho$coefficients[[1]])+</span></span>
<span id="cb82-419"><a href="#cb82-419" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggtitle("Xanthophyceae")+</span></span>
<span id="cb82-420"><a href="#cb82-420" aria-hidden="true" tabindex="-1"></a><span class="co">#   annotate(geom="text",x = lm_xantho$coefficients[[2]]*0.85+lm_xantho$coefficients[[1]]+0.05, y = 0.85, label = "p = 0.85", angle = - 90, size = 7)+</span></span>
<span id="cb82-421"><a href="#cb82-421" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(size = 15, angle = 45, hjust = 0.7),</span></span>
<span id="cb82-422"><a href="#cb82-422" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.text.y = element_text(size = 15),</span></span>
<span id="cb82-423"><a href="#cb82-423" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.title.y = element_blank(),</span></span>
<span id="cb82-424"><a href="#cb82-424" aria-hidden="true" tabindex="-1"></a><span class="co">#         axis.title.x = element_text(size = 20))</span></span>
<span id="cb82-425"><a href="#cb82-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-426"><a href="#cb82-426" aria-hidden="true" tabindex="-1"></a>plot<span class="ot">&lt;-</span>(sediment <span class="sc">+</span> green) <span class="sc">/</span></span>
<span id="cb82-427"><a href="#cb82-427" aria-hidden="true" tabindex="-1"></a>(MPB <span class="sc">+</span> rodo)<span class="sc">+</span></span>
<span id="cb82-428"><a href="#cb82-428" aria-hidden="true" tabindex="-1"></a>magno<span class="sc">+</span></span>
<span id="cb82-429"><a href="#cb82-429" aria-hidden="true" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span></span>
<span id="cb82-430"><a href="#cb82-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb82-431"><a href="#cb82-431" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>, <span class="at">hjust =</span> <span class="fl">0.55</span>),</span>
<span id="cb82-432"><a href="#cb82-432" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>),</span>
<span id="cb82-433"><a href="#cb82-433" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb82-434"><a href="#cb82-434" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb82-435"><a href="#cb82-435" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid=</span><span class="fu">element_blank</span>())<span class="sc">&amp;</span></span>
<span id="cb82-436"><a href="#cb82-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>),<span class="at">limits=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">100.01</span>),<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">&amp;</span></span>
<span id="cb82-437"><a href="#cb82-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">&amp;</span></span>
<span id="cb82-438"><a href="#cb82-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Percent Cover (%)"</span>) <span class="sc">&amp;</span> </span>
<span id="cb82-439"><a href="#cb82-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span>
<span id="cb82-440"><a href="#cb82-440" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-441"><a href="#cb82-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Figures/Upscaling/density_vs_Proportion.png"</span>,plot , <span class="at">width =</span> <span class="dv">833</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height =</span> <span class="dv">1118</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [35]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>output_80_filtered_same<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"./Output/output_80_filtered_same_Upscaling.csv"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Proportion =</span> Proportion <span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="do">################# LM ####################</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>lm_sediment<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Bare Sediment"</span>) </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a> lm_sediment<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_sediment<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_sediment<span class="sc">$</span>Proportion)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a> lm_green<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Green Algae"</span>) </span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  lm_green<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_green<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_green<span class="sc">$</span>Proportion)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a> lm_magno<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Magnoliopsida"</span>) </span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>   lm_magno<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_magno<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_magno<span class="sc">$</span>Proportion)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a> lm_MPB<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Microphytobenthos"</span>)</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>    lm_MPB<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_MPB<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_MPB<span class="sc">$</span>Proportion)</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>lm_Rodo<span class="ot">&lt;-</span>output_80_filtered_same <span class="sc">%&gt;%</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">"Rodophyceae"</span>)</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>    lm_Rodo<span class="ot">&lt;-</span> <span class="fu">lm</span>(lm_Rodo<span class="sc">$</span>Prob_80 <span class="sc">~</span> lm_Rodo<span class="sc">$</span>Proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [36]:</pre></div><div id="cell-fig-upscaling" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"Figures/Upscaling/density_vs_Proportion.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-upscaling" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-upscaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="Figures/Upscaling/density_vs_Proportion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" data-glightbox="description: .lightbox-desc-10"><img src="Figures/Upscaling/density_vs_Proportion.png" class="img-fluid figure-img" style="width:90.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-upscaling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Kernel density plot showing the proportion of pixel well classified based on the percent cover of the class in high altitude flight pixels of Gafanha, Portugal. Each subplot shows all the pixels of the same classes on the hight altitude flight. Percent cover of classes is retrieve using the result of the classification of the low altitude flight of Gafanha, Portugal. The vertical dashed line shows the 0.85 probability of the model. Everything on the right of this line has a probability higher then 0.85 and everuthing on the left of this line has a probability lower.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>Using the very high precision low altitude flight, we determined the minimal percent cover required to classify correctly classify a given class using the high altitude flight (<a href="#fig-upscaling" class="quarto-xref">Figure&nbsp;10</a>). When the percent cover of the class is 100 %, big pixels are well classified for all the classes excepted for Bare Sediment, where it’s well classified 80% of the time. A vegetative percent cover of at least 80% is need to have all the big pixels well classified, at the exception of Magnoliopsida that needs an higher percent cover (&gt;90 %) to be well classified. Concerning the probability of each class, a really high Percent cover is needed to confidently predict Bacillariophyceae. To predict Chlorophyceae with a confidence of 0.85, a percent cover of 93 % is needed, 90 % for magnoliopsida, 92 % for Rhodophyceae and 97 % for Bacillariophyceae.</p>
</section>
</section>
<section id="discussion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Discussion</h1>
<p>The primary objective of this study was to develop a method for the accurate classification of macrophytes on intertidal mudflats, specifically focusing on distinguishing between Chlorophyceae (green algae) and marine Magnoliopsida (seagrasses) using multispectral drone data. The challenge arises from the shared pigment composition between these two vegetation classes, complicating their differentiation using remote sensing techniques. This challenge has been addressed through the utilization of high-resolution drone flights allowing a precise photointerpretation of pure pixels of the different vegetation classes used as training data, providing a robust foundation for subsequent classification analyses. In achieving 94.26 accuracy across all study sites, this method demonstrates its efficacy in accurately classifying macrophytes, thus offering a reliable approach for vegetation classification in intertidal mudflats using remote sensing data.</p>
<section id="vegetation-discrimination" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="vegetation-discrimination"><span class="header-section-number">4.1</span> Vegetation Discrimination</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [37]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df_pigment<span class="ot">&lt;-</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Classes=</span><span class="fu">c</span>(<span class="st">"Magnoliopsida"</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Bacillariophyceae"</span>,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Rhodophyceae"</span>),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">chlb=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">chlc=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuco=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">zea=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">diad=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lutein=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Neox=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">PE=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">%&gt;%</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Classes) <span class="sc">%&gt;%</span> </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.array</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ext</span>(df_pigment)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>y_axis_text_pigment<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="dv">5</span>),</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">4.5</span>), </span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>                                <span class="at">lab =</span> <span class="fu">c</span>(<span class="st">"Rhodophyceae"</span>,</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Phaeophyceae"</span>,</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Bacillariophy."</span>,</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Chlorophyceae"</span>,</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Magnoliopsida"</span>)</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>x_axis_text_pigment<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">5.5</span>,<span class="dv">9</span>),</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>                                <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">4.5</span>,<span class="fl">5.5</span>,<span class="fl">6.5</span>,<span class="fl">7.5</span>,<span class="fl">8.5</span>),</span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>                                <span class="at">lab =</span> <span class="fu">c</span>(<span class="st">"Chlb"</span>,<span class="st">"Chlc"</span>,<span class="st">"Fuco"</span>,<span class="st">"Zea"</span>,<span class="st">"Diad"</span>,<span class="st">"Lut"</span>,<span class="st">"Neo"</span>,<span class="st">"PE"</span>,<span class="st">"PC"</span>)</span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a>min_x_line <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.5</span></span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>max_y_line <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>line_grid<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">xmin=</span><span class="cn">NA</span>,</span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xmax=</span><span class="cn">NA</span>,</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymin=</span><span class="cn">NA</span>,</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax=</span><span class="cn">NA</span>,</span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group=</span><span class="cn">NA</span>)</span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>max_y_line){</span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">=</span>min_x_line</span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">=</span><span class="dv">9</span></span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">=</span>i</span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">4</span>]<span class="ot">=</span>i</span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span>,<span class="dv">5</span>]<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a>nrowgrid<span class="ot">=</span><span class="fu">nrow</span>(line_grid)</span>
<span id="cb85-58"><a href="#cb85-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb85-59"><a href="#cb85-59" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>nrowgrid,<span class="dv">1</span>]<span class="ot">=</span>i</span>
<span id="cb85-60"><a href="#cb85-60" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>nrowgrid,<span class="dv">2</span>]<span class="ot">=</span>i</span>
<span id="cb85-61"><a href="#cb85-61" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>nrowgrid,<span class="dv">3</span>]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb85-62"><a href="#cb85-62" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>nrowgrid,<span class="dv">4</span>]<span class="ot">=</span>max_y_line</span>
<span id="cb85-63"><a href="#cb85-63" aria-hidden="true" tabindex="-1"></a>  line_grid[i<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>nrowgrid,<span class="dv">5</span>]<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span>nrowgrid</span>
<span id="cb85-64"><a href="#cb85-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-65"><a href="#cb85-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-66"><a href="#cb85-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-67"><a href="#cb85-67" aria-hidden="true" tabindex="-1"></a> line_grid[<span class="fu">nrow</span>(line_grid)<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">=</span> min_x_line</span>
<span id="cb85-68"><a href="#cb85-68" aria-hidden="true" tabindex="-1"></a> line_grid[<span class="fu">nrow</span>(line_grid),<span class="dv">2</span>] <span class="ot">=</span> min_x_line</span>
<span id="cb85-69"><a href="#cb85-69" aria-hidden="true" tabindex="-1"></a> line_grid[<span class="fu">nrow</span>(line_grid),<span class="dv">3</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb85-70"><a href="#cb85-70" aria-hidden="true" tabindex="-1"></a> line_grid[<span class="fu">nrow</span>(line_grid),<span class="dv">4</span>] <span class="ot">=</span> max_y_line</span>
<span id="cb85-71"><a href="#cb85-71" aria-hidden="true" tabindex="-1"></a> line_grid[<span class="fu">nrow</span>(line_grid),<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">nrow</span>(line_grid)</span>
<span id="cb85-72"><a href="#cb85-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-73"><a href="#cb85-73" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-74"><a href="#cb85-74" aria-hidden="true" tabindex="-1"></a> line_grid<span class="ot">&lt;-</span> line_grid <span class="sc">%&gt;%</span> </span>
<span id="cb85-75"><a href="#cb85-75" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="dv">9</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">19</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-76"><a href="#cb85-76" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">20</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-77"><a href="#cb85-77" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">21</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-78"><a href="#cb85-78" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">22</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-79"><a href="#cb85-79" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">23</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-80"><a href="#cb85-80" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">24</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-81"><a href="#cb85-81" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">25</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-82"><a href="#cb85-82" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">26</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-83"><a href="#cb85-83" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">6</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">27</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-84"><a href="#cb85-84" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">28</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-85"><a href="#cb85-85" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">29</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb85-86"><a href="#cb85-86" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">9</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">30</span>))</span>
<span id="cb85-87"><a href="#cb85-87" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-88"><a href="#cb85-88" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-89"><a href="#cb85-89" aria-hidden="true" tabindex="-1"></a> Absorption_wv<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">4.5</span>,<span class="fl">5.5</span>,<span class="fl">6.5</span>,<span class="fl">7.5</span>,<span class="fl">8.5</span>),</span>
<span id="cb85-90"><a href="#cb85-90" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">rep</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="dv">9</span>),</span>
<span id="cb85-91"><a href="#cb85-91" aria-hidden="true" tabindex="-1"></a>                            <span class="at">lab =</span> <span class="fu">c</span>(<span class="st">"650"</span>,<span class="st">"636"</span>,<span class="st">"550"</span>,<span class="st">"489"</span>,<span class="st">"496"</span>,<span class="st">"490"</span>,<span class="st">"450"</span>,<span class="st">"566"</span>,<span class="st">"615"</span>))</span>
<span id="cb85-92"><a href="#cb85-92" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-93"><a href="#cb85-93" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-94"><a href="#cb85-94" aria-hidden="true" tabindex="-1"></a>rast_pigment<span class="ot">&lt;-</span><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb85-95"><a href="#cb85-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data =</span> (df_pigment),</span>
<span id="cb85-96"><a href="#cb85-96" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># show.legend = F,</span></span>
<span id="cb85-97"><a href="#cb85-97" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb85-98"><a href="#cb85-98" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb85-99"><a href="#cb85-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb85-100"><a href="#cb85-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb85-101"><a href="#cb85-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("black","firebrick4","goldenrod","yellow","chartreuse3"),</span></span>
<span id="cb85-102"><a href="#cb85-102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("khaki1","goldenrod","firebrick3","chartreuse4"),</span></span>
<span id="cb85-103"><a href="#cb85-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">colours =</span> <span class="fu">c</span>(<span class="st">"firebrick4"</span>,<span class="st">"orange"</span>,<span class="st">"#007d00"</span>),</span>
<span id="cb85-104"><a href="#cb85-104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># colours = c("#7d0000","#00b300","#00b300","#00b300","#007d00"),</span></span>
<span id="cb85-105"><a href="#cb85-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"white"</span>,</span>
<span id="cb85-106"><a href="#cb85-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Absence"</span>,<span class="st">"no se"</span>,<span class="st">"Presence"</span>),</span>
<span id="cb85-107"><a href="#cb85-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb85-108"><a href="#cb85-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb85-109"><a href="#cb85-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> y_axis_text_pigment,</span>
<span id="cb85-110"><a href="#cb85-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb85-111"><a href="#cb85-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb85-112"><a href="#cb85-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb85-113"><a href="#cb85-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb85-114"><a href="#cb85-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># angle = 20</span></span>
<span id="cb85-115"><a href="#cb85-115" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb85-116"><a href="#cb85-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb85-117"><a href="#cb85-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">lab =</span> <span class="st">"Absorption (nm)"</span>),</span>
<span id="cb85-118"><a href="#cb85-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb85-119"><a href="#cb85-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb85-120"><a href="#cb85-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb85-121"><a href="#cb85-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb85-122"><a href="#cb85-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># angle = 20</span></span>
<span id="cb85-123"><a href="#cb85-123" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb85-124"><a href="#cb85-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb85-125"><a href="#cb85-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Absorption_wv,</span>
<span id="cb85-126"><a href="#cb85-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb85-127"><a href="#cb85-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb85-128"><a href="#cb85-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb85-129"><a href="#cb85-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb85-130"><a href="#cb85-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># angle = 20</span></span>
<span id="cb85-131"><a href="#cb85-131" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb85-132"><a href="#cb85-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb85-133"><a href="#cb85-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> x_axis_text_pigment,</span>
<span id="cb85-134"><a href="#cb85-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> lab),</span>
<span id="cb85-135"><a href="#cb85-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = "#ffffff99",</span></span>
<span id="cb85-136"><a href="#cb85-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb85-137"><a href="#cb85-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb85-138"><a href="#cb85-138" aria-hidden="true" tabindex="-1"></a>    <span class="co"># angle = 20</span></span>
<span id="cb85-139"><a href="#cb85-139" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb85-140"><a href="#cb85-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> line_grid, </span>
<span id="cb85-141"><a href="#cb85-141" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> xmin, <span class="at">xend =</span> xmax, <span class="at">y =</span> ymin, <span class="at">yend =</span> ymax, <span class="at">group =</span> group),</span>
<span id="cb85-142"><a href="#cb85-142" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb85-143"><a href="#cb85-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb85-144"><a href="#cb85-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">6.1</span>))<span class="sc">+</span></span>
<span id="cb85-145"><a href="#cb85-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb85-146"><a href="#cb85-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb85-147"><a href="#cb85-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># axis.title.x = element_text(size = 35),</span></span>
<span id="cb85-148"><a href="#cb85-148" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.title.y = element_text(size = 35),</span></span>
<span id="cb85-149"><a href="#cb85-149" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-150"><a href="#cb85-150" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-151"><a href="#cb85-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-152"><a href="#cb85-152" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.text.x = element_text(size = 30),</span></span>
<span id="cb85-153"><a href="#cb85-153" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-154"><a href="#cb85-154" aria-hidden="true" tabindex="-1"></a>        <span class="co"># axis.text.y = element_text(size = 25),</span></span>
<span id="cb85-155"><a href="#cb85-155" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-156"><a href="#cb85-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-157"><a href="#cb85-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-158"><a href="#cb85-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-159"><a href="#cb85-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb85-160"><a href="#cb85-160" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line=</span><span class="fu">element_blank</span>(),</span>
<span id="cb85-161"><a href="#cb85-161" aria-hidden="true" tabindex="-1"></a>        <span class="co"># legend.position = "top",</span></span>
<span id="cb85-162"><a href="#cb85-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb85-163"><a href="#cb85-163" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction=</span><span class="st">"horizontal"</span>,</span>
<span id="cb85-164"><a href="#cb85-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">"cm"</span>),</span>
<span id="cb85-165"><a href="#cb85-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb85-166"><a href="#cb85-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb85-167"><a href="#cb85-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb85-168"><a href="#cb85-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">"center"</span>)</span>
<span id="cb85-169"><a href="#cb85-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-170"><a href="#cb85-170" aria-hidden="true" tabindex="-1"></a><span class="co"># rast_pigment</span></span>
<span id="cb85-171"><a href="#cb85-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-172"><a href="#cb85-172" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"./Figures/Disc_Pigment_Table.png"</span>,rast_pigment, <span class="at">width=</span> <span class="dv">1066</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height=</span><span class="dv">516</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [38]:</pre></div><div id="cell-fig-Pigm" class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pigment composition of the different vegetation classes. Green indicate the presence of the pigment in the class while red indicate the abscence. Chlb : Chlorophyll-b ; Chlc : Chlorophyll-c ; Fuco : Fucoxanthin ; Zea : Zeaxanthin ; Diad : Diadinoxanthin ; Lut : Lutein ; Neo : Neoxanthin ; PE : Phycoerythrin ; PC : Phycocyanin.</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Disc_Pigment_Table.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-Pigm" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Pigm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Disc_Pigment_Table.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" data-glightbox="description: .lightbox-desc-11"><img src="./Figures/Disc_Pigment_Table.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Pigm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Photosynthetic and carotenoid pigments present (Green) or absent (Red) in each taxonomic class present in the Neural Network Classifier, along with their absorption wavelength measured with spectroradiometer. Chl b: chlorophyll b, Chl c: chlorophyll c, Fuco: fucoxanthin, Zea: zeaxanthin, Diato: diatoxanthin, Diadino: diadinoxanthin, Neo: neoxanthin.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>The discrimination of seagrasses from green macroalgae presents significant challenges, primarily due to the shared pigment composition between these taxa, as depicted in <a href="#fig-Pigm" class="quarto-xref">Figure&nbsp;11</a> but also by the frequent spatial mixing of these green macrophytes. This similarity in pigment composition, including photosynthetic and carotenoid pigments like chlorophyll b and c, fucoxanthin, and neoxanthin, results in spectral signatures that are often indistinguishable to non exper eyes. This spectral overlap is further complicated by the intermingling of seagrasses and green macroalgae in the same spatial locations, posing a significant challenge for remote sensing aimed at accurately mapping and monitoring coastal ecosystems. Our study addresses these complexities by utilizing high-resolution drone imagery with 10 spectral bands. <span class="citation" data-cites="Davies2023">Davies et al. (<a href="#ref-Davies2023" role="doc-biblioref">2023a</a>)</span> has shown that having at least 8 spectral bands ranging between 500 nm to 850 nm with including a band at 530 nm and another one at 730 nm is crucial to accurately discriminate green macrophytes.</p>
<div class="columns">
<div class="column">
<div class="cell-container"><div class="cell-decorator"><pre>In [39]:</pre></div><div id="cell-fig-ValidationGreen" class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Validation/ConfusionMatrixGreen.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ValidationGreen" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ValidationGreen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Validation/ConfusionMatrixGreen.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" data-glightbox="description: .lightbox-desc-12"><img src="./Figures/Validation/ConfusionMatrixGreen.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ValidationGreen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Sample of <a href="#fig-Validation" class="quarto-xref">Figure&nbsp;8</a> focusing on green macrophytes. The labels inside the matrice indicate the number of pixels.
</figcaption>
</figure>
</div>
</div>
</div></div>
</div><div class="column">
<p>The Micasense RedEdge-MX DUAL camera used in this study meets these two criteria, enabling the classifier to achieve 97% of accuracy between these two classes (<a href="#fig-ValidationGreen" class="quarto-xref">Figure&nbsp;12</a>). Even if the pigment compostion of green macrophytes is similar, differences in the spectral shape can still be observed (<a href="#fig-vegetation" class="quarto-xref">Figure&nbsp;2</a>). Several factors can explain these differences such has different pigment concentration or proportion, different cellular organisation and 3D disposition of the plant a whole on the intertidal mudflat <span class="citation" data-cites="beach1997vivo">Hedley et al. (<a href="#ref-hedley2018influence" role="doc-biblioref">2018</a>)</span>.</p>
</div>
</div>
<p>The VIP analysis of the Neural Network model (<a href="#fig-VIP" class="quarto-xref">Figure&nbsp;9</a>) shows that the 531 nm band is the most important spectral band for accurately identifying Chlorophyceae. In fact, at this wavelength, Chlorophyceae exhibits the highest reflectance among all other classes, highlighting the difference in accessories carotenoid proportion between seagrasses and green algae (<span class="citation" data-cites="repolho2017seagrass">Repolho et al. (<a href="#ref-repolho2017seagrass" role="doc-biblioref">2017</a>)</span>).</p>
<p>Concerning Phaeophyceae, the thick cell walls of plant of this class make it really reflective in the infrared part of the spectra whereas the presence of Fucoxanthin and Zeaxanthin result in a low reflectance in the visible part of the electromagnetic spectra. These two key features has been identified by the Neural Network as the two principal predictors to accurately identify Brown algae (<a href="#fig-VIP" class="quarto-xref">Figure&nbsp;9</a>). Similarly, the presence of phycoerythrin and phycocyanin in Rhodophyceae contributes to the lowest reflectance among all classes in the spectral range of 560 to 615 nm (<a href="#fig-VIP" class="quarto-xref">Figure&nbsp;9</a>). The band at 560 nm has been identified as important for accurately identifying this class Resolution impact on the prediction. Regarding Bacillariophyceae, the VIP analysis (<a href="#fig-VIP" class="quarto-xref">Figure&nbsp;9</a>) indicates that 475 nm is the most important predictor for this class. This could be attributed to the absence of lutein, neoxanthin, and zeaxanthin in diatoms, absorbing in the blue part of spectra, resulting in the highest visible reflectance among all classes. Furethemore, it is vegetation with the lowest concentration of chlorphyll-a, pigment absorbing light both in the blue and the red. The transparency of Bacillariophyceae makes the reflectance of the sediment part of the overall reflectance of Bacillariophyceae, further explaining the high reflectance in the blue.</p>
</section>
<section id="spectral-spatial-temporal-resolution-impact-on-the-prediction" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="spectral-spatial-temporal-resolution-impact-on-the-prediction"><span class="header-section-number">4.2</span> Spectral Spatial Temporal Resolution impact on the prediction</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [40]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>high_alt<span class="ot">&lt;-</span> <span class="st">"Data/image/micasense/Gafanha_high_multi.tif"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>()</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># low_alt&lt;- "Data/image/micasense/Gafanha_Low_Multi_rsp.tif" %&gt;% </span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   rast() </span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>low_alt<span class="ot">&lt;-</span> <span class="st">"Data/image/micasense/Gafanha_low_multi.tif"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resample</span>(high_alt, <span class="at">method =</span> <span class="st">"med"</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>low_alt_pred<span class="ot">&lt;-</span> <span class="st">"Data/image/prediction/NewPreds/Gafanha_Low_Pred_rsp.tif"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rast</span>() </span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>mask<span class="ot">&lt;-</span><span class="st">"Data/shp/Mask_Alt_Compare_All.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vect</span>()</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>high_alt_masked<span class="ot">&lt;-</span><span class="fu">crop</span>(high_alt,mask)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>high_alt_masked<span class="ot">&lt;-</span><span class="fu">mask</span>(high_alt_masked,mask)</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>low_alt_masked<span class="ot">&lt;-</span><span class="fu">crop</span>(low_alt,mask)</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>low_alt_masked<span class="ot">&lt;-</span><span class="fu">mask</span>(low_alt_masked,mask)</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>low_alt_pred_masked<span class="ot">&lt;-</span><span class="fu">crop</span>(low_alt_pred,mask)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>low_alt_pred_masked<span class="ot">&lt;-</span><span class="fu">mask</span>(low_alt_pred_masked,mask)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>stk<span class="ot">&lt;-</span><span class="fu">rast</span>(<span class="fu">list</span>(<span class="fu">c</span>(high_alt_masked,low_alt_masked,low_alt_pred_masked)))<span class="sc">%&gt;%</span> </span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stk)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"B1_high"</span>,<span class="st">"B2_high"</span>,<span class="st">"B3_high"</span>,<span class="st">"B4_high"</span>,<span class="st">"B5_high"</span>,<span class="st">"B6_high"</span>,<span class="st">"B7_high"</span>,<span class="st">"B8_high"</span>,<span class="st">"B9_high"</span>,<span class="st">"B10_high"</span>,</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>              <span class="st">"B1_low"</span>,<span class="st">"B2_low"</span>,<span class="st">"B3_low"</span>,<span class="st">"B4_low"</span>,<span class="st">"B5_low"</span>,<span class="st">"B6_low"</span>,<span class="st">"B7_low"</span>,<span class="st">"B8_low"</span>,<span class="st">"B9_low"</span>,<span class="st">"B10_low"</span>,</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pred"</span>)</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>stk_long<span class="ot">&lt;-</span>stk <span class="sc">%&gt;%</span> </span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">px_ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(stk))) <span class="sc">%&gt;%</span> </span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(px_ID,pred),<span class="at">values_to =</span> <span class="st">"Value"</span>,<span class="at">names_to =</span> <span class="st">"Bands"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alt =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(Bands, <span class="st">"low"</span>) <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">str_detect</span>(Bands, <span class="st">"high"</span>) <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">Bands =</span> <span class="fu">gsub</span>(<span class="st">"_high"</span>,<span class="st">""</span>,Bands),</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">Bands =</span> <span class="fu">gsub</span>(<span class="st">"_low"</span>,<span class="st">""</span>,Bands))</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>stk_summarized<span class="ot">&lt;-</span>stk_long <span class="sc">%&gt;%</span> </span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(px_ID,alt) %&gt;% </span></span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reframe(Value = mean(Value),</span></span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#         pred = unique(pred)) %&gt;% </span></span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"alt"</span>, <span class="at">values_from =</span> <span class="st">"Value"</span>)</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>stk_summarized <span class="sc">%&gt;%</span> </span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Bands) <span class="sc">%&gt;%</span> </span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Low<span class="sc">&lt;</span><span class="dv">10000</span>,</span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a>         High <span class="sc">&lt;</span> <span class="dv">10000</span>,</span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>         Low <span class="sc">&lt;</span> <span class="fu">quantile</span>(Low,<span class="at">probs =</span> <span class="fl">0.99</span>),</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a>         High <span class="sc">&lt;</span> <span class="fu">quantile</span>(High,<span class="at">probs =</span> <span class="fl">0.99</span>),</span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true" tabindex="-1"></a>         Low <span class="sc">&gt;</span> <span class="fu">quantile</span>(Low,<span class="at">probs =</span> <span class="fl">0.01</span>),</span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true" tabindex="-1"></a>         High <span class="sc">&gt;</span> <span class="fu">quantile</span>(High,<span class="at">probs =</span> <span class="fl">0.01</span>),</span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span>pred <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb88-64"><a href="#cb88-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pred) <span class="sc">%&gt;%</span> </span>
<span id="cb88-65"><a href="#cb88-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-66"><a href="#cb88-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Low =</span> Low <span class="sc">/</span><span class="dv">10000</span>, </span>
<span id="cb88-67"><a href="#cb88-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">High =</span> High<span class="sc">/</span><span class="dv">10000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-68"><a href="#cb88-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Low, <span class="at">y=</span>High))<span class="sc">+</span></span>
<span id="cb88-69"><a href="#cb88-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(aes(color = as.factor(pred)))</span></span>
<span id="cb88-70"><a href="#cb88-70" aria-hidden="true" tabindex="-1"></a>  ggpointdensity<span class="sc">::</span><span class="fu">geom_pointdensity</span>(<span class="at">adjust =</span> .<span class="dv">03</span>)<span class="sc">+</span></span>
<span id="cb88-71"><a href="#cb88-71" aria-hidden="true" tabindex="-1"></a>  viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">6000</span>),</span>
<span id="cb88-72"><a href="#cb88-72" aria-hidden="true" tabindex="-1"></a>                               <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2000</span>,<span class="dv">4000</span>,<span class="dv">6000</span>),</span>
<span id="cb88-73"><a href="#cb88-73" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2000"</span>,<span class="st">"4000"</span>,<span class="st">"6000"</span>))<span class="sc">+</span></span>
<span id="cb88-74"><a href="#cb88-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_smooth(method = "loess")+</span></span>
<span id="cb88-75"><a href="#cb88-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span> )<span class="sc">+</span></span>
<span id="cb88-76"><a href="#cb88-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede</span>()<span class="sc">+</span></span>
<span id="cb88-77"><a href="#cb88-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb88-78"><a href="#cb88-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.6</span>))<span class="sc">+</span></span>
<span id="cb88-79"><a href="#cb88-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Reflectance of the 120m flight"</span>)<span class="sc">+</span></span>
<span id="cb88-80"><a href="#cb88-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Reflectance of the 12m flight"</span>)<span class="sc">+</span></span>
<span id="cb88-81"><a href="#cb88-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Pixel density"</span>)<span class="sc">+</span></span>
<span id="cb88-82"><a href="#cb88-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb88-83"><a href="#cb88-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb88-84"><a href="#cb88-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>,<span class="st">"line"</span>))</span>
<span id="cb88-85"><a href="#cb88-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-86"><a href="#cb88-86" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"./Figures/Compare_reflectance.png"</span>,plot, <span class="at">width=</span> <span class="dv">472</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">height=</span><span class="dv">402</span><span class="sc">*</span><span class="dv">4</span>, <span class="at">units =</span> <span class="st">"px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="columns">
<div class="column">
<div class="cell-container"><div class="cell-decorator"><pre>In [41]:</pre></div><div id="cell-fig-CompareRef" class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pigment composition of the different vegetation classes. Green indicate the presence of the pigment in the class while red indicate the abscence. Chlb : Chlorophyll-b ; Chlc : Chlorophyll-c ; Fuco : Fucoxanthin ; Zea : Zeaxanthin ; Diad : Diadinoxanthin ; Lut : Lutein ; Neo : Neoxanthin ; PE : Phycoerythrin ; PC : Phycocyanin.</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Figures/Compare_reflectance.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-CompareRef" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-CompareRef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="./Figures/Compare_reflectance.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" data-glightbox="description: .lightbox-desc-13"><img src="./Figures/Compare_reflectance.png" class="img-fluid figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-CompareRef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Comparison of reflectance retrieved from both low-altitude and high-altitude flights over a common area. The red dashed line represents a 1 to 1 relationship.
</figcaption>
</figure>
</div>
</div>
</div></div>
</div><div class="column">
<p>In the present study, the main novelty is the usage of two different altitude (12m and 120m) in the neural network model building. The spatial resolution of the low altitude fights (8mm) allows for an accurate selection of pure pixel of the classes used in the neural network model</p>
</div>
</div>
</section>
<section id="big-picture" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="big-picture"><span class="header-section-number">4.3</span> Big picture</h2>
</section>
</section>
<section id="conclusion" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion</h1>
</section>
<section id="bibliography" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Bibliography</h1>
<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure&nbsp;1: Sites observed by drone. A: Gulf of Morbihan, B: Bourngeuf Bay, C: Ria de Aveiro Lagoon. Light green represent terrestrial areas whereas darkgreen represent intertidal areas.</span>
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;2: Class of vegetation used to train the Neural Network model and their standardised spectral signature</span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;3: Schematic representation of the workflow. Diamonds represent input or output data, and rectangles represent Python processing algorithms. The overall workflow of this study is divided into two distinct parts based on the spatial resolution of the drone flights: high-resolution flights were utilized for training and prediction of the Neural Network model, whereas low-resolution flights were solely employed for prediction purposes.</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;4: RGB orthomosaic (Left) and Prediction (Right) of the low altitude flight of Gafanaha, Portugal. The total extent of this flight is 3000m² with a resolution of 8 mm per pixel. Background colors means intertidal area (Light Green) and land area (Light Grey). The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.</span>
<span class="glightbox-desc lightbox-desc-5">Figure&nbsp;5: RGB orthomosaic (Left) and Prediction (Right) of the high altitude flight of Gafanaha, Portugal. The total extent of this flight is about 1 km² with a resolution of 80 mm per pixel. Background colors means intertidal area (Light Green), land area (Light Grey) and water (Light Blue). The red triangle shows the extent of the low altitude flight of Gafanha. The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.</span>
<span class="glightbox-desc lightbox-desc-6">Figure&nbsp;6: RGB orthomosaic (Top) and Prediction (Bottom) of the flight made in the inner part of Ria de Aveiro Lagoon, Portugal. The total extent of this flight is about 1.5 km² with a resolution of 80 mm per pixel. Background colors means intertidal area (Light Green), land area (Light Grey) and water (Light Blue). The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.</span>
<span class="glightbox-desc lightbox-desc-7">Figure&nbsp;7: RGB orthomosaic (Top) and Prediction (Bottom) of Northern part of Noirmoutier Island, France. The total extent of this flight is about 28 000 m² with a resolution of 80 mm per pixel. Background colors means intertidal area (Light Green) and land area (Light Grey). The zoom covers an area equivalent to a 10-meter Sentinel-2 pixel size.</span>
<span class="glightbox-desc lightbox-desc-8">Figure&nbsp;8: A global confusion matrix on the left is derived from validation data across each flight, while a mosaic of confusion matrices from individual flights is presented on the right. The labels inside the matrices indicate the balanced accuracy for each class. The labels at the bottom of the matrices indicate the User’s accuracy for each class, and those on the right indicate the Producer’s Accuracy. The values adjacent to the names of each site represent the proportion of total pixels from that site contributing to the overall matrix. Grey lines within the mosaic indicate the absence of validation data for the class at that site. The table at the bottom summarizes the Sensitivity, Specificity, and Accuracy for each class and for the overall model.</span>
<span class="glightbox-desc lightbox-desc-9">Figure&nbsp;9: Variable Importance of the Neural Network Classifier for each vegetation class. The bigger the slice, the more important is the variable to predict accuratly this class. The bottom right plot shows the drone standardised reflectance spectra of each class.</span>
<span class="glightbox-desc lightbox-desc-10">Figure&nbsp;10: Kernel density plot showing the proportion of pixel well classified based on the percent cover of the class in high altitude flight pixels of Gafanha, Portugal. Each subplot shows all the pixels of the same classes on the hight altitude flight. Percent cover of classes is retrieve using the result of the classification of the low altitude flight of Gafanha, Portugal. The vertical dashed line shows the 0.85 probability of the model. Everything on the right of this line has a probability higher then 0.85 and everuthing on the left of this line has a probability lower.</span>
<span class="glightbox-desc lightbox-desc-11">Figure&nbsp;11: Photosynthetic and carotenoid pigments present (Green) or absent (Red) in each taxonomic class present in the Neural Network Classifier, along with their absorption wavelength measured with spectroradiometer. Chl b: chlorophyll b, Chl c: chlorophyll c, Fuco: fucoxanthin, Zea: zeaxanthin, Diato: diatoxanthin, Diadino: diadinoxanthin, Neo: neoxanthin.</span>
<span class="glightbox-desc lightbox-desc-12">Figure&nbsp;12: Sample of <a href="#fig-Validation" class="quarto-xref">Figure&nbsp;8</a> focusing on green macrophytes. The labels inside the matrice indicate the number of pixels.</span>
<span class="glightbox-desc lightbox-desc-13">Figure&nbsp;13: Comparison of reflectance retrieved from both low-altitude and high-altitude flights over a common area. The red dashed line represents a 1 to 1 relationship.</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-adade2021" class="csl-entry" role="listitem">
Adade, R., Aibinu, A.M., Ekumah, B., Asaana, J., 2021. Unmanned aerial vehicle (UAV) applications in coastal zone management—a review. Environmental Monitoring and Assessment 193, 1–12.
</div>
<div id="ref-angnuureng2022" class="csl-entry" role="listitem">
Angnuureng, D.B., Brempong, K., Jayson-Quashigah, P., Dada, O., Akuoko, S., Frimpomaa, J., Mattah, P., Almar, R., 2022. Satellite, drone and video camera multi-platform monitoring of coastal erosion at an engineered pocket beach: A showcase for coastal management at elmina bay, ghana (west africa). Regional Studies in Marine Science 53, 102437.
</div>
<div id="ref-bannari2022" class="csl-entry" role="listitem">
Bannari, A., Ali, T.S., Abahussain, A., 2022. The capabilities of sentinel-MSI (2A/2B) and landsat-OLI (8/9) in seagrass and algae species differentiation using spectral reflectance. Ocean Science 18, 361–388.
</div>
<div id="ref-beach1997vivo" class="csl-entry" role="listitem">
Beach, K., Borgeas, H., Nishimura, N., Smith, C., 1997. In vivo absorbance spectra and the ecophysiology of reef macroalgae. Coral Reefs 16, 21–28.
</div>
<div id="ref-Brunier2022Topographic" class="csl-entry" role="listitem">
Brunier, G., Oiry, S., Gruet, Y., Dubois, S.F., Barillé, L., 2022. Topographic analysis of intertidal polychaete reefs (sabellaria alveolata) at a very high spatial resolution. Remote Sensing 2022, Vol. 14, Page 307 14, 307. <a href="https://doi.org/10.3390/RS14020307">https://doi.org/10.3390/RS14020307</a>
</div>
<div id="ref-Cao2017" class="csl-entry" role="listitem">
Cao, J., Thorson, J.T., Richards, R.A., Chen, Y., 2017. Spatiotemporal index standardization improves the stock assessment of northern shrimp in the gulf of maine. Canadian Journal of Fisheries and Aquatic Sciences 74, 1781–1793. <a href="https://doi.org/10.1139/cjfas-2016-0137">https://doi.org/10.1139/cjfas-2016-0137</a>
</div>
<div id="ref-casella2020" class="csl-entry" role="listitem">
Casella, E., Drechsel, J., Winter, C., Benninghoff, M., Rovere, A., 2020. Accuracy of sand beach topography surveying by drones and photogrammetry. Geo-Marine Letters 40, 255–268.
</div>
<div id="ref-coffer2023" class="csl-entry" role="listitem">
Coffer, M.M., Graybill, D.D., Whitman, P.J., Schaeffer, B.A., Salls, W.B., Zimmerman, R.C., Hill, V., Lebrasse, M.C., Li, J., Keith, D.J., others, 2023. Providing a framework for seagrass mapping in united states coastal ecosystems using high spatial resolution satellite imagery. Journal of Environmental Management 337, 117669.
</div>
<div id="ref-collin2019improving" class="csl-entry" role="listitem">
Collin, A., Dubois, S., James, D., Houet, T., 2019. Improving intertidal reef mapping using UAV surface, red edge, and near-infrared data. Drones 3, 67.
</div>
<div id="ref-Davies2023" class="csl-entry" role="listitem">
Davies, B.F.R., Gernez, P., Geraud, A., Oiry, Simon, Rosa, P., Zoffoli, M.L., Barillé, L., 2023a. Multi- and hyperspectral classification of soft-bottom intertidal vegetation using a spectral library for coastal biodiversity remote sensing. Remote Sensing of Environment 290, 113554. <a href="https://doi.org/10.1016/j.rse.2023.113554">https://doi.org/10.1016/j.rse.2023.113554</a>
</div>
<div id="ref-BedeGbif" class="csl-entry" role="listitem">
Davies, B.F.R., Sousa, A.I., Figueira, R., Oiry, S., Gernez, P., Barillé, L., 2023b. Benthic intertidal vegetation from the tagus estuary and aveiro lagoon. <a href="https://doi.org/10.15468/n4ak6x">https://doi.org/10.15468/n4ak6x</a>
</div>
<div id="ref-devlin2023nutrients" class="csl-entry" role="listitem">
Devlin, M., Brodie, J., 2023. Nutrients and eutrophication, in: Marine Pollution–Monitoring, Management and Mitigation. Springer, pp. 75–100.
</div>
<div id="ref-Douay2022" class="csl-entry" role="listitem">
Douay, F., Verpoorter, C., Duong, G., Spilmont, N., Gevaert, F., 2022. New hyperspectral procedure to discriminate intertidal macroalgae. Remote Sensing 14. <a href="https://doi.org/10.3390/rs14020346">https://doi.org/10.3390/rs14020346</a>
</div>
<div id="ref-duffy2019" class="csl-entry" role="listitem">
Duffy, J.E., Benedetti-Cecchi, L., Trinanes, J., Muller-Karger, F.E., Ambo-Rappe, R., Boström, C., Buschmann, A.H., Byrnes, J., Coles, R.G., Creed, J., others, 2019. Toward a coordinated global observing system for seagrasses and marine macroalgae. Frontiers in Marine Science 6, 317.
</div>
<div id="ref-fairley2022drone" class="csl-entry" role="listitem">
Fairley, I., Williamson, B.J., McIlvenny, J., King, N., Masters, I., Lewis, M., Neill, S., Glasby, D., Coles, D., Powell, B., others, 2022. Drone-based large-scale particle image velocimetry applied to tidal stream energy resource assessment. Renewable Energy 196, 839–855.
</div>
<div id="ref-gardner2018" class="csl-entry" role="listitem">
Gardner, R.C., Finlayson, C., 2018. Global wetland outlook: State of the world’s wetlands and their services to people. Stetson Law.
</div>
<div id="ref-hedley2018influence" class="csl-entry" role="listitem">
Hedley, J.D., Mirhakak, M., Wentworth, A., Dierssen, H.M., 2018. Influence of three-dimensional coral structures on hyperspectral benthic reflectance and water-leaving reflectance. Applied Sciences 8, 2688.
</div>
<div id="ref-jankowska2019" class="csl-entry" role="listitem">
Jankowska, E., Michel, L.N., Lepoint, G., Włodarska-Kowalczuk, M., 2019. Stabilizing effects of seagrass meadows on coastal water benthic food webs. Journal of Experimental Marine Biology and Ecology 510, 54–63.
</div>
<div id="ref-joyce2023" class="csl-entry" role="listitem">
Joyce, K.E., Fickas, K.C., Kalamandeen, M., 2023. The unique value proposition for using drones to map coastal ecosystems. Cambridge Prisms: Coastal Futures 1, e6.
</div>
<div id="ref-kirk1994light" class="csl-entry" role="listitem">
Kirk, J.T., 1994. Light and photosynthesis in aquatic ecosystems. Cambridge university press.
</div>
<div id="ref-lin2018" class="csl-entry" role="listitem">
Lin, H., Sun, T., Zhou, Y., Gu, R., Zhang, X., Yang, W., 2018. Which genes in a typical intertidal seagrass (zostera japonica) indicate copper-, lead-, and cadmium pollution? Frontiers in Plant Science 9, 1545.
</div>
<div id="ref-deSantos2019" class="csl-entry" role="listitem">
Los Santos, C.B. de, Krause-Jensen, D., Alcoverro, T., Marbà, N., Duarte, C.M., Van Katwijk, M.M., Pérez, M., Romero, J., Sánchez-Lizaso, J.L., Roca, G., others, 2019. Recent trend reversal for declining european seagrass meadows. Nature communications 10, 3356.
</div>
<div id="ref-Miloslavich2018" class="csl-entry" role="listitem">
Miloslavich, P., Bax, N.J., Simmons, S.E., Klein, E., Appeltans, W., Aburto-Oropeza, O., Garcia, M.A., Batten, S.D., Benedetti-Cecchi, L., Checkley, D.M., Chiba, S., Duffy, J.E., Dunn, D.C., Fischer, A., Gunn, J., Kudela, R., Marsac, F., Muller-Karger, F.E., Obura, D., Shin, Y.J., 2018. Essential ocean variables for global sustained observations of biodiversity and ecosystem changes. Global Change Biology 24, 2416–2433. <a href="https://doi.org/10.1111/GCB.14108">https://doi.org/10.1111/GCB.14108</a>
</div>
<div id="ref-nguyen2021" class="csl-entry" role="listitem">
Nguyen, H.M., Ralph, P.J., Marı́n-Guirao, L., Pernice, M., Procaccini, G., 2021. Seagrasses in an era of ocean warming: A review. Biological Reviews 96, 2009–2030.
</div>
<div id="ref-nijland2019" class="csl-entry" role="listitem">
Nijland, W., Reshitnyk, L., Rubidge, E., 2019. Satellite remote sensing of canopy-forming kelp on a complex coastline: A novel procedure using the landsat image archive. Remote Sensing of Environment 220, 41–50.
</div>
<div id="ref-oh2017use" class="csl-entry" role="listitem">
Oh, J., Kim, D., Lee, H., 2017. Use of a drone for mapping and time series image acquisition of tidal zones. Journal of the Korean Institute of Intelligent Systems 27, 119–125.
</div>
<div id="ref-orth2006" class="csl-entry" role="listitem">
Orth, R.J., Carruthers, T.J., Dennison, W.C., Duarte, C.M., Fourqurean, J.W., Heck, K.L., Hughes, A.R., Kendrick, G.A., Kenworthy, W.J., Olyarnik, S., others, 2006. A global crisis for seagrass ecosystems. Bioscience 56, 987–996.
</div>
<div id="ref-Pereira2013" class="csl-entry" role="listitem">
Pereira, H.M., Ferrier, S., Walters, M., Geller, G.N., Jongman, R.H., Scholes, R.J., Bruford, M.W., Brummitt, N., Butchart, S.H., Cardoso, A., others, 2013. Essential biodiversity variables. Science 339, 277–278.
</div>
<div id="ref-ralph2002" class="csl-entry" role="listitem">
Ralph, P., Polk, S., Moore, K., Orth, R., Smith Jr, W., 2002. Operation of the xanthophyll cycle in the seagrass zostera marina in response to variable irradiance. Journal of Experimental Marine Biology and Ecology 271, 189–207.
</div>
<div id="ref-repolho2017seagrass" class="csl-entry" role="listitem">
Repolho, T., Duarte, B., Dionı́sio, G., Paula, J.R., Lopes, A.R., Rosa, I.C., Grilo, T.F., Caçador, I., Calado, R., Rosa, R., 2017. Seagrass ecophysiological performance under ocean warming and acidification. Scientific Reports 7, 41443.
</div>
<div id="ref-Roca2022" class="csl-entry" role="listitem">
Roca, M., Dunbar, M.B., Román, A., Caballero, I., Zoffoli, M.L., Gernez, P., Navarro, G., 2022. Monitoring the marine invasive alien species rugulopteryx okamurae using unmanned aerial vehicles and satellites. Frontiers in Marine Science 9. <a href="https://doi.org/10.3389/fmars.2022.1004012">https://doi.org/10.3389/fmars.2022.1004012</a>
</div>
<div id="ref-Roman2021" class="csl-entry" role="listitem">
Román, A., Tovar-Sánchez, A., Olivé, I., Navarro, G., 2021. Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes. Frontiers in Marine Science 1225.
</div>
<div id="ref-rossiter2020uav" class="csl-entry" role="listitem">
Rossiter, T., Furey, T., McCarthy, T., Stengel, D.B., 2020. UAV-mounted hyperspectral mapping of intertidal macroalgae. Estuarine, Coastal and Shelf Science 242, 106789.
</div>
<div id="ref-soissons2018" class="csl-entry" role="listitem">
Soissons, L.M., Haanstra, E.P., Van Katwijk, M.M., Asmus, R., Auby, I., Barillé, L., Brun, F.G., Cardoso, P.G., Desroy, N., Fournier, J., others, 2018. Latitudinal patterns in european seagrass carbon reserves: Influence of seasonal fluctuations versus short-term stress and disturbance events. Frontiers in Plant Science 9, 88.
</div>
<div id="ref-tallam2023" class="csl-entry" role="listitem">
Tallam, K., Nguyen, N., Ventura, J., Fricker, A., Calhoun, S., O’Leary, J., Fitzgibbons, M., Robbins, I., Walter, R.K., 2023. Application of deep learning for classification of intertidal eelgrass from drone-acquired imagery. Remote Sensing 15, 2321.
</div>
<div id="ref-Traganos2018" class="csl-entry" role="listitem">
Traganos, D., Reinartz, P., 2018. Mapping mediterranean seagrasses with sentinel-2 imagery. Marine Pollution Bulletin 134, 197–209. <a href="https://doi.org/10.1016/j.marpolbul.2017.06.075">https://doi.org/10.1016/j.marpolbul.2017.06.075</a>
</div>
<div id="ref-tuya2013" class="csl-entry" role="listitem">
Tuya, F., Hernandez-Zerpa, H., Espino, F., Haroun, R., 2013. Drastic decadal decline of the seagrass cymodocea nodosa at gran canaria (eastern atlantic): Interactions with the green algae caulerpa prolifera. Aquatic Botany 105, 1–6.
</div>
<div id="ref-unsworth2022" class="csl-entry" role="listitem">
Unsworth, R.K., Cullen-Unsworth, L.C., Jones, B.L., Lilley, R.J., 2022. The planetary role of seagrass conservation. Science 377, 609–613.
</div>
<div id="ref-wang2022" class="csl-entry" role="listitem">
Wang, Z., Fang, Z., Liang, J., Song, X., 2022. Assessment of global habitat suitability and risk of ocean green tides. Harmful Algae 119, 102324.
</div>
<div id="ref-xu2021" class="csl-entry" role="listitem">
Xu, S., Xu, S., Zhou, Y., Yue, S., Zhang, X., Gu, R., Zhang, Y., Qiao, Y., Liu, M., 2021. Long-term changes in the unique and largest seagrass meadows in the bohai sea (china) using satellite (1974–2019) and sonar data: Implication for conservation and restoration. Remote Sensing 13, 856.
</div>
<div id="ref-Zoffoli2021" class="csl-entry" role="listitem">
Zoffoli, M.L., Gernez, P., Godet, L., Peters, S., Oiry, S., Barillé, L., 2021. Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series. Ecological Indicators 130, 108033. <a href="https://doi.org/10.1016/j.ecolind.2021.108033">https://doi.org/10.1016/j.ecolind.2021.108033</a>
</div>
<div id="ref-Zoffoli2022" class="csl-entry" role="listitem">
Zoffoli, M.L., Gernez, P., Oiry, S., Godet, L., Dalloyau, S., Davies, B.F.R., Barillé, L., 2022. Remote sensing in seagrass ecology: Coupled dynamics between migratory herbivorous birds and intertidal meadows observed by satellite during four decades. Remote Sensing in Ecology and Conservation. <a href="https://doi.org/10.1002/rse2.319">https://doi.org/10.1002/rse2.319</a>
</div>
</div>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"selector":".lightbox","openEffect":"zoom","loop":false,"closeEffect":"zoom","descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script> 
  
</body></html>